{"id": 1, "query_string": " with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sum(SR_RETURN_AMT) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1998 group by sr_customer_sk ,sr_store_sk)  select top (100) c_customer_id from customer_total_return ctr1 ,store ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'TN' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id;", "predicates": {"date_dim": ["d_year"], "store": ["s_state"], "store_returns": ["sr_store_sk"]}, "payload": {"customer": ["c_customer_id", "c_customer_sk"], "date_dim": ["d_date_sk"], "store": ["s_store_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_customer_id"]}}
{"id": 2, "query_string": " with wscs as  (select sold_date_sk         ,sales_price   from (select ws_sold_date_sk sold_date_sk               ,ws_ext_sales_price sales_price         from web_sales          union all         select cs_sold_date_sk sold_date_sk               ,cs_ext_sales_price sales_price         from catalog_sales) a),  wswscs as   (select d_week_seq,         sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales  from wscs      ,date_dim  where d_date_sk = sold_date_sk  group by d_week_seq)  select d_week_seq1        ,round(sun_sales1/sun_sales2,2)        ,round(mon_sales1/mon_sales2,2)        ,round(tue_sales1/tue_sales2,2)        ,round(wed_sales1/wed_sales2,2)        ,round(thu_sales1/thu_sales2,2)        ,round(fri_sales1/fri_sales2,2)        ,round(sat_sales1/sat_sales2,2)  from  (select wswscs.d_week_seq d_week_seq1         ,sun_sales sun_sales1         ,mon_sales mon_sales1         ,tue_sales tue_sales1         ,wed_sales wed_sales1         ,thu_sales thu_sales1         ,fri_sales fri_sales1         ,sat_sales sat_sales1   from wswscs,date_dim    where date_dim.d_week_seq = wswscs.d_week_seq and         d_year = 1999) y,  (select wswscs.d_week_seq d_week_seq2         ,sun_sales sun_sales2         ,mon_sales mon_sales2         ,tue_sales tue_sales2         ,wed_sales wed_sales2         ,thu_sales thu_sales2         ,fri_sales fri_sales2         ,sat_sales sat_sales2   from wswscs       ,date_dim    where date_dim.d_week_seq = wswscs.d_week_seq and         d_year = 1999+1) z  where d_week_seq1=d_week_seq2-53  order by d_week_seq1;", "predicates": {"date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_week_seq", "d_day_name"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 3, "query_string": " select top (100) dt.d_year         ,item.i_brand_id brand_id         ,item.i_brand brand        ,sum(ss_ext_sales_price) sum_agg  from  date_dim dt        ,store_sales       ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk    and store_sales.ss_item_sk = item.i_item_sk    and item.i_manufact_id = 615    and dt.d_moy=11  group by dt.d_year       ,item.i_brand       ,item.i_brand_id  order by dt.d_year          ,sum_agg desc          ,brand_id  ;", "predicates": {"date_dim": ["d_moy"], "item": ["i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"date_dim": ["d_year"], "item": ["i_brand_id"]}}
{"id": 4, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year  union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total        ,'c' sale_type  from customer      ,catalog_sales      ,date_dim  where c_customer_sk = cs_bill_customer_sk    and cs_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year          )   select top (100)                    t_s_secyear.customer_id                  ,t_s_secyear.customer_first_name                  ,t_s_secyear.customer_last_name                  ,t_s_secyear.customer_birth_country  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_c_firstyear      ,year_total t_c_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id    and t_s_firstyear.customer_id = t_c_secyear.customer_id    and t_s_firstyear.customer_id = t_c_firstyear.customer_id    and t_s_firstyear.customer_id = t_w_firstyear.customer_id    and t_s_firstyear.customer_id = t_w_secyear.customer_id    and t_s_firstyear.sale_type = 's'    and t_c_firstyear.sale_type = 'c'    and t_w_firstyear.sale_type = 'w'    and t_s_secyear.sale_type = 's'    and t_c_secyear.sale_type = 'c'    and t_w_secyear.sale_type = 'w'    and t_s_firstyear.dyear =  1999    and t_s_secyear.dyear = 1999+1    and t_c_firstyear.dyear =  1999    and t_c_secyear.dyear =  1999+1    and t_w_firstyear.dyear = 1999    and t_w_secyear.dyear = 1999+1    and t_s_firstyear.year_total > 0    and t_c_firstyear.year_total > 0    and t_w_firstyear.year_total > 0    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end            > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end  order by t_s_secyear.customer_id          ,t_s_secyear.customer_first_name          ,t_s_secyear.customer_last_name          ,t_s_secyear.customer_birth_country;", "predicates": {"date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_ext_list_price", "cs_ext_discount_amt", "cs_bill_customer_sk", "cs_ext_sales_price", "cs_ext_wholesale_cost", "cs_sold_date_sk"], "customer": ["c_login", "c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id"], "date_dim": ["d_date_sk"], "store_sales": ["ss_ext_discount_amt", "ss_ext_sales_price", "ss_ext_wholesale_cost", "ss_customer_sk", "ss_ext_list_price", "ss_sold_date_sk"], "web_sales": ["ws_ext_discount_amt", "ws_ext_wholesale_cost", "ws_ext_list_price", "ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 5, "query_string": " with ssr as  (select s_store_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  ss_store_sk as store_sk,             ss_sold_date_sk  as date_sk,             ss_ext_sales_price as sales_price,             ss_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from store_sales     union all     select sr_store_sk as store_sk,            sr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            sr_return_amt as return_amt,            sr_net_loss as net_loss     from store_returns    ) salesreturns,      date_dim,      store  where date_sk = d_date_sk        and d_date between cast('2001-08-21' as date)                    and dateadd(day, 14, cast('2001-08-21' as date))        and store_sk = s_store_sk  group by s_store_id)  ,  csr as  (select cp_catalog_page_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  cs_catalog_page_sk as page_sk,             cs_sold_date_sk  as date_sk,             cs_ext_sales_price as sales_price,             cs_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from catalog_sales     union all     select cr_catalog_page_sk as page_sk,            cr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            cr_return_amount as return_amt,            cr_net_loss as net_loss     from catalog_returns    ) salesreturns,      date_dim,      catalog_page  where date_sk = d_date_sk        and d_date between cast('2001-08-21' as date)                   and dateadd(day, 14, cast('2001-08-21' as date))        and page_sk = cp_catalog_page_sk  group by cp_catalog_page_id)  ,  wsr as  (select web_site_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  ws_web_site_sk as wsr_web_site_sk,             ws_sold_date_sk  as date_sk,             ws_ext_sales_price as sales_price,             ws_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from web_sales     union all     select ws_web_site_sk as wsr_web_site_sk,            wr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            wr_return_amt as return_amt,            wr_net_loss as net_loss     from web_returns left outer join web_sales on          ( wr_item_sk = ws_item_sk            and wr_order_number = ws_order_number)    ) salesreturns,      date_dim,      web_site  where date_sk = d_date_sk        and d_date between cast('2001-08-21' as date)                   and dateadd(day, 14, cast('2001-08-21' as date))        and wsr_web_site_sk = web_site_sk  group by web_site_id)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , concat('store' , s_store_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from   ssr  union all  select 'catalog channel' as channel         , concat('catalog_page' , cp_catalog_page_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from  csr  union all  select 'web channel' as channel         , concat('web_site' , web_site_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from   wsr  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_page": ["cp_catalog_page_sk", "cp_catalog_page_id"], "catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_return_amount", "cr_catalog_page_sk"], "catalog_sales": ["cs_catalog_page_sk", "cs_net_profit", "cs_sold_date_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_net_loss"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit", "ss_ext_sales_price"], "web_returns": ["wr_returned_date_sk", "wr_return_amt", "wr_net_loss", "wr_item_sk", "wr_order_number"], "web_sales": ["ws_net_profit", "ws_ext_sales_price", "ws_sold_date_sk", "ws_web_site_sk"], "web_site": ["web_site_id", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 6, "query_string": " select top (100) a.ca_state state, count(*) cnt  from customer_address a      ,customer c      ,store_sales s      ,date_dim d      ,item i  where       a.ca_address_sk = c.c_current_addr_sk  \tand c.c_customer_sk = s.ss_customer_sk  \tand s.ss_sold_date_sk = d.d_date_sk  \tand s.ss_item_sk = i.i_item_sk  \tand d.d_month_seq =   \t     (select distinct (d_month_seq)  \t      from date_dim                where d_year = 1998  \t        and d_moy = 1 )  \tand i.i_current_price > 1.2 *               (select avg(j.i_current_price)   \t     from item j   \t     where j.i_category = i.i_category)  group by a.ca_state  having count(*) >= 10  order by cnt, a.ca_state   ;", "predicates": {"date_dim": ["d_month_seq", "d_moy", "d_year"], "item": ["i_category", "i_current_price"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk", "d_month_seq"], "item": ["i_item_sk", "i_category", "i_current_price"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_item_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_state"]}}
{"id": 7, "query_string": " select top (100) i_item_id,          avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4   from store_sales, customer_demographics, date_dim, item, promotion  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_cdemo_sk = cd_demo_sk and        ss_promo_sk = p_promo_sk and        cd_gender = 'M' and         cd_marital_status = 'M' and        cd_education_status = 'Unknown' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 2002   group by i_item_id  order by i_item_id  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "promotion": ["p_channel_event", "p_channel_email"]}, "payload": {"customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"], "promotion": ["p_promo_sk"], "store_sales": ["ss_promo_sk", "ss_item_sk", "ss_cdemo_sk", "ss_list_price", "ss_quantity", "ss_sales_price", "ss_coupon_amt", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 8, "query_string": " select top (100) s_store_name       ,sum(ss_net_profit)  from store_sales      ,date_dim      ,store,      (select ca_zip      from (       SELECT substring(ca_zip,1,5) ca_zip       FROM customer_address       WHERE substring(ca_zip,1,5) IN (                           '23958','65658','10240','88637','82137','54634',                           '83626','45925','66051','57952','77395',                           '37864','82841','75467','91197','99672',                           '47856','98216','74948','24766','60531',                           '87290','45055','72767','29460','78269',                           '90043','10667','73063','55821','35942',                           '30002','55017','28977','11712','27955',                           '52124','97398','49988','95134','91490',                           '43027','48910','63041','85218','65072',                           '29389','81088','39208','28082','45275',                           '40328','82240','94987','73889','94029',                           '60537','93977','96788','32731','78441',                           '77230','97303','70349','23070','42176',                           '17683','29987','55182','92677','29189',                           '99610','53788','53508','72072','66666',                           '24983','66975','97515','43371','83089',                           '62956','42667','20413','27231','54989',                           '27925','52707','99144','73909','82005',                           '65064','53661','23259','58588','23314',                           '44201','13499','91493','83786','55575',                           '88685','38950','99537','10922','68084',                           '62246','73674','32897','59087','22562',                           '46560','55950','56155','74419','32227',                           '81865','54964','21345','87358','91562',                           '38888','44041','47888','13395','56465',                           '12952','13278','98498','32762','84496',                           '27696','12205','70893','93329','96914',                           '47378','89232','23970','78666','65617',                           '65955','11647','36771','49439','81244',                           '90677','10160','39989','79689','78398',                           '45773','33576','85722','19861','48944',                           '46025','90613','43166','79020','31065',                           '29979','65969','25488','19635','84556',                           '70219','87432','40413','58600','44146',                           '85963','86479','91116','45100','53312',                           '22696','86457','29731','31618','96117',                           '25802','35139','73480','38522','86094',                           '47021','43087','64023','63061','17368',                           '45996','66360','23334','11633','29081',                           '98490','80989','41060','55585','28715',                           '37128','48275','21352','63840','67887',                           '67043','47661','68631','50362','72374',                           '22361','16924','58180','80563','30779',                           '26540','65274','86037','40834','37530',                           '64986','45979','95843','65202','40279',                           '88862','66842','92899','21973','65321',                           '96212','28494','67551','39304','71259',                           '76564','39712','85337','78181','21638',                           '61441','33675','64814','65181','64856',                           '81575','68267','58965','35483','44309',                           '14671','66501','79527','85463','10001',                           '94388','37651','52599','61232','98993',                           '20073','34101','57103','40613','26736',                           '41801','19862','51052','80817','21158',                           '60904','68829','16655','53187','28652',                           '22930','99939','43900','26452','67200',                           '71010','43631','40865','26797','38502',                           '50923','55441','21320','94922','96974',                           '76738','97356','86863','14068','56024',                           '93368','85795','44569','68563','57355',                           '13555','61223','65028','25574','59022',                           '37843','36518','72538','62108','36349',                           '17681','27297','98483','93594','40541',                           '19021','28718','78226','22720','51505',                           '89705','24008','96009','46868','77019',                           '83596','39760','20875','38311','14982',                           '41288','43384','45520','40267','22100',                           '51475','15509','79989','65667','40627',                           '27597','87834','64000','99185','34448',                           '51810','19919','10709','65149','96154',                           '16047','18093','62793','84063','72372',                           '99098','40571','67656','97332','69152',                           '44086','27712','32488','53443','62120',                           '18366','70962','53967','88810','55052',                           '29441','88828','58120','43694','54774',                           '16785','63449','32177','70870','34313',                           '34641','74066','35047','85941','92511',                           '98277','78539','77330','82902','35089',                           '62796','85373','83447','31647','58306',                           '25250','10014','84045','98675')      intersect       select ca_zip       from (SELECT substring(ca_zip,1,5) ca_zip,count(*) cnt             FROM customer_address, customer             WHERE ca_address_sk = c_current_addr_sk and                   c_preferred_cust_flag='Y'             group by ca_zip             having count(*) > 10)A1)A2) V1  where ss_store_sk = s_store_sk   and ss_sold_date_sk = d_date_sk   and d_qoy = 2 and d_year = 2001   and (substring(s_zip,1,2) = substring(V1.ca_zip,1,2))  group by s_store_name  order by s_store_name  ;", "predicates": {"customer": ["c_preferred_cust_flag"], "date_dim": ["d_qoy", "d_year"]}, "payload": {"customer": ["c_current_addr_sk"], "customer_address": ["ca_address_sk", "ca_zip"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 9, "query_string": " select case when (select count(*)                    from store_sales                    where ss_quantity between 1 and 20) > 32465             then (select avg(ss_ext_sales_price)                    from store_sales                    where ss_quantity between 1 and 20)              else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 1 and 20) end bucket1 ,        case when (select count(*)                   from store_sales                   where ss_quantity between 21 and 40) > 7910             then (select avg(ss_ext_sales_price)                   from store_sales                   where ss_quantity between 21 and 40)              else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 21 and 40) end bucket2,        case when (select count(*)                   from store_sales                   where ss_quantity between 41 and 60) > 41571             then (select avg(ss_ext_sales_price)                   from store_sales                   where ss_quantity between 41 and 60)             else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 41 and 60) end bucket3,        case when (select count(*)                   from store_sales                   where ss_quantity between 61 and 80) > 16598             then (select avg(ss_ext_sales_price)                   from store_sales                   where ss_quantity between 61 and 80)             else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 61 and 80) end bucket4,        case when (select count(*)                   from store_sales                   where ss_quantity between 81 and 100) > 35422             then (select avg(ss_ext_sales_price)                   from store_sales                   where ss_quantity between 81 and 100)             else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 81 and 100) end bucket5 from reason where r_reason_sk = 1;", "predicates": {"store_sales": ["ss_quantity"]}, "payload": {"store_sales": ["ss_ext_tax", "ss_net_paid_inc_tax"]}, "group_by": {}, "order_by": {}}
{"id": 10, "query_string": " select top (100)    cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3,   cd_dep_count,   count(*) cnt4,   cd_dep_employed_count,   count(*) cnt5,   cd_dep_college_count,   count(*) cnt6  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_county in ('Dale County','Fayette County','Day County','Lubbock County','Broome County') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 1999 and                 d_moy between 3 and 3+3) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 1999 and                   d_moy between 3 ANd 3+3) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 1999 and                   d_moy between 3 and 3+3))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count;", "predicates": {"customer_address": ["ca_county"], "date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 11, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag           ,c_birth_country          ,c_login          ,c_email_address          ,d_year   union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag           ,c_birth_country          ,c_login          ,c_email_address          ,d_year          )   select top (100)                    t_s_secyear.customer_id                  ,t_s_secyear.customer_first_name                  ,t_s_secyear.customer_last_name                  ,t_s_secyear.customer_birth_country  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id          and t_s_firstyear.customer_id = t_w_secyear.customer_id          and t_s_firstyear.customer_id = t_w_firstyear.customer_id          and t_s_firstyear.sale_type = 's'          and t_w_firstyear.sale_type = 'w'          and t_s_secyear.sale_type = 's'          and t_w_secyear.sale_type = 'w'          and t_s_firstyear.dyear = 1999          and t_s_secyear.dyear = 1999+1          and t_w_firstyear.dyear = 1999          and t_w_secyear.dyear = 1999+1          and t_s_firstyear.year_total > 0          and t_w_firstyear.year_total > 0          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end              > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end  order by t_s_secyear.customer_id          ,t_s_secyear.customer_first_name          ,t_s_secyear.customer_last_name          ,t_s_secyear.customer_birth_country;", "predicates": {"date_dim": ["d_year"]}, "payload": {"customer": ["c_login", "c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_ext_list_price", "ss_ext_discount_amt"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_discount_amt", "ws_ext_list_price"]}, "group_by": {}, "order_by": {}}
{"id": 12, "query_string": " select top (100) i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from\t \tweb_sales     \t,item      \t,date_dim where  \tws_item_sk = i_item_sk    \tand i_category in ('Music', 'Books', 'Women')   \tand ws_sold_date_sk = d_date_sk \tand d_date between cast('2002-05-24' as date)  \t\t\t\tand dateadd(day, 30, cast('2002-05-24' as date)) group by  \ti_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  \ti_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_desc", "i_class", "i_item_id", "i_category"]}}
{"id": 13, "query_string": " select avg(ss_quantity)        ,avg(ss_ext_sales_price)        ,avg(ss_ext_wholesale_cost)        ,sum(ss_ext_wholesale_cost)  from store_sales      ,store      ,customer_demographics      ,household_demographics      ,customer_address      ,date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2001  and((ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'W'   and cd_education_status = 'Primary'   and ss_sales_price between 100.00 and 150.00   and hd_dep_count = 3         )or      (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'U'   and cd_education_status = 'Advanced Degree'   and ss_sales_price between 50.00 and 100.00      and hd_dep_count = 1      ) or       (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'M'   and cd_education_status = 'Secondary'   and ss_sales_price between 150.00 and 200.00    and hd_dep_count = 1        ))  and((ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('SD', 'OK', 'TX')   and ss_net_profit between 100 and 200        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('NC', 'KY', 'IN')   and ss_net_profit between 150 and 300        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('GA', 'CA', 'VA')   and ss_net_profit between 50 and 250        ));", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "household_demographics": ["hd_dep_count"], "store_sales": ["ss_sales_price", "ss_net_profit"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_dep_count", "hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_ext_sales_price", "ss_cdemo_sk", "ss_addr_sk", "ss_quantity", "ss_sales_price", "ss_ext_wholesale_cost", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 14, "query_string": " with  cross_items as  (select i_item_sk ss_item_sk  from item,  (select iss.i_brand_id brand_id      ,iss.i_class_id class_id      ,iss.i_category_id category_id  from store_sales      ,item iss      ,date_dim d1  where ss_item_sk = iss.i_item_sk    and ss_sold_date_sk = d1.d_date_sk    and d1.d_year between 2000 AND 2000 + 2  intersect   select ics.i_brand_id      ,ics.i_class_id      ,ics.i_category_id  from catalog_sales      ,item ics      ,date_dim d2  where cs_item_sk = ics.i_item_sk    and cs_sold_date_sk = d2.d_date_sk    and d2.d_year between 2000 AND 2000 + 2  intersect  select iws.i_brand_id      ,iws.i_class_id      ,iws.i_category_id  from web_sales      ,item iws      ,date_dim d3  where ws_item_sk = iws.i_item_sk    and ws_sold_date_sk = d3.d_date_sk    and d3.d_year between 2000 AND 2000 + 2) a  where i_brand_id = brand_id       and i_class_id = class_id       and i_category_id = category_id ),  avg_sales as  (select avg(quantity*list_price) average_sales   from (select ss_quantity quantity              ,ss_list_price list_price        from store_sales            ,date_dim        where ss_sold_date_sk = d_date_sk          and d_year between 2000 and 2000 + 2        union all         select cs_quantity quantity               ,cs_list_price list_price        from catalog_sales            ,date_dim        where cs_sold_date_sk = d_date_sk          and d_year between 2000 and 2000 + 2         union all        select ws_quantity quantity              ,ws_list_price list_price        from web_sales            ,date_dim        where ws_sold_date_sk = d_date_sk          and d_year between 2000 and 2000 + 2) x)   select top (100) channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)  from(        select 'store' channel, i_brand_id,i_class_id              ,i_category_id,sum(ss_quantity*ss_list_price) sales              , count(*) number_sales        from store_sales            ,item            ,date_dim        where ss_item_sk in (select ss_item_sk from cross_items)          and ss_item_sk = i_item_sk          and ss_sold_date_sk = d_date_sk          and d_year = 2000+2           and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)        union all        select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales        from catalog_sales            ,item            ,date_dim        where cs_item_sk in (select ss_item_sk from cross_items)          and cs_item_sk = i_item_sk          and cs_sold_date_sk = d_date_sk          and d_year = 2000+2           and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)        union all        select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales        from web_sales            ,item            ,date_dim        where ws_item_sk in (select ss_item_sk from cross_items)          and ws_item_sk = i_item_sk          and ws_sold_date_sk = d_date_sk          and d_year = 2000+2          and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)  ) y  group by rollup (channel, i_brand_id,i_class_id,i_category_id)  order by channel,i_brand_id,i_class_id,i_category_id  ; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_list_price", "cs_quantity"], "date_dim": ["d_date_sk"], "item": ["i_category_id", "i_class_id", "i_item_sk", "i_brand_id"], "store_sales": ["ss_sold_date_sk", "ss_list_price", "ss_quantity", "ss_item_sk"], "web_sales": ["ws_list_price", "ws_sold_date_sk", "ws_item_sk", "ws_quantity"]}, "group_by": {}, "order_by": {}}
{"id": 15, "query_string": " select top (100) ca_zip        ,sum(cs_sales_price)  from catalog_sales      ,customer      ,customer_address      ,date_dim  where cs_bill_customer_sk = c_customer_sk  \tand c_current_addr_sk = ca_address_sk   \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',                                    '85392', '85460', '80348', '81792')  \t      or ca_state in ('CA','WA','GA')  \t      or cs_sales_price > 500)  \tand cs_sold_date_sk = d_date_sk  \tand d_qoy = 2 and d_year = 1998  group by ca_zip  order by ca_zip  ;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"catalog_sales": ["cs_sales_price", "cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip", "ca_state"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_zip"]}}
{"id": 16, "query_string": " select top (100)     count(distinct cs_order_number) as \"order count\"   ,sum(cs_ext_ship_cost) as \"total shipping cost\"   ,sum(cs_net_profit) as \"total net profit\" from    catalog_sales cs1   ,date_dim   ,customer_address   ,call_center where     d_date between '2002-3-01' and             dateadd(day, 60, cast('2002-3-01' as date)) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'IN' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County',                   'Williamson County' ) and exists (select *             from catalog_sales cs2             where cs1.cs_order_number = cs2.cs_order_number               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select *                from catalog_returns cr1                where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number);", "predicates": {"call_center": ["cc_county"], "customer_address": ["ca_state"], "date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_order_number"], "catalog_sales": ["cs_order_number", "cs_warehouse_sk", "cs_ext_ship_cost", "cs_ship_addr_sk", "cs_net_profit", "cs_call_center_sk", "cs_ship_date_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 17, "query_string": " select top (100) i_item_id        ,i_item_desc        ,s_state        ,count(ss_quantity) as store_sales_quantitycount        ,avg(ss_quantity) as store_sales_quantityave        ,stdev(ss_quantity) as store_sales_quantitystdev        ,stdev(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov        ,count(sr_return_quantity) as store_returns_quantitycount        ,avg(sr_return_quantity) as store_returns_quantityave        ,stdev(sr_return_quantity) as store_returns_quantitystdev        ,stdev(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov        ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave        ,stdev(cs_quantity) as catalog_sales_quantitystdev        ,stdev(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov  from store_sales      ,store_returns      ,catalog_sales      ,date_dim d1      ,date_dim d2      ,date_dim d3      ,store      ,item  where d1.d_quarter_name = '1998Q1'    and d1.d_date_sk = ss_sold_date_sk    and i_item_sk = ss_item_sk    and s_store_sk = ss_store_sk    and ss_customer_sk = sr_customer_sk    and ss_item_sk = sr_item_sk    and ss_ticket_number = sr_ticket_number    and sr_returned_date_sk = d2.d_date_sk    and d2.d_quarter_name in ('1998Q1','1998Q2','1998Q3')    and sr_customer_sk = cs_bill_customer_sk    and sr_item_sk = cs_item_sk    and cs_sold_date_sk = d3.d_date_sk    and d3.d_quarter_name in ('1998Q1','1998Q2','1998Q3')  group by i_item_id          ,i_item_desc          ,s_state  order by i_item_id          ,i_item_desc          ,s_state;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_quarter_name"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_state", "s_store_sk"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_return_quantity", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 18, "query_string": " select top (100) i_item_id,         ca_country,         ca_state,          ca_county,         avg( cast(cs_quantity as decimal(12,2))) agg1,         avg( cast(cs_list_price as decimal(12,2))) agg2,         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,         avg( cast(cs_sales_price as decimal(12,2))) agg4,         avg( cast(cs_net_profit as decimal(12,2))) agg5,         avg( cast(c_birth_year as decimal(12,2))) agg6,         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7  from catalog_sales, customer_demographics cd1,        customer_demographics cd2, customer, customer_address, date_dim, item  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd1.cd_demo_sk and        cs_bill_customer_sk = c_customer_sk and        cd1.cd_gender = 'F' and         cd1.cd_education_status = 'Secondary' and        c_current_cdemo_sk = cd2.cd_demo_sk and        c_current_addr_sk = ca_address_sk and        c_birth_month in (2,4,8,5,10,11) and        d_year = 2002 and        ca_state in ('KS','NM','WV'                    ,'IN','OK','MO','FL')  group by rollup (i_item_id, ca_country, ca_state, ca_county)  order by ca_country,         ca_state,          ca_county, \ti_item_id  ;", "predicates": {"customer": ["c_birth_month"], "customer_address": ["ca_state"], "customer_demographics": ["cd_education_status", "cd_gender"], "date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_quantity", "cs_sales_price", "cs_bill_customer_sk", "cs_item_sk", "cs_net_profit", "cs_list_price", "cs_coupon_amt", "cs_sold_date_sk", "cs_bill_cdemo_sk"], "customer": ["c_birth_year", "c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_county", "ca_country", "ca_state"], "customer_demographics": ["cd_demo_sk", "cd_dep_count"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_state", "ca_county", "ca_country"], "item": ["i_item_id"]}}
{"id": 19, "query_string": " select top (100) i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,  \tsum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item,customer,customer_address,store  where d_date_sk = ss_sold_date_sk    and ss_item_sk = i_item_sk    and i_manager_id=26    and d_moy=12    and d_year=2002    and ss_customer_sk = c_customer_sk     and c_current_addr_sk = ca_address_sk    and substring(ca_zip,1,5) <> substring(s_zip,1,5)     and ss_store_sk = s_store_sk   group by i_brand       ,i_brand_id       ,i_manufact_id       ,i_manufact  order by ext_price desc          ,i_brand          ,i_brand_id          ,i_manufact_id          ,i_manufact  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip"], "date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_brand_id", "i_manufact_id", "i_brand", "i_manufact"], "store": ["s_zip", "s_store_sk"]}, "group_by": {}, "order_by": {"item": ["i_brand", "i_manufact", "i_brand_id", "i_manufact_id"]}}
{"id": 20, "query_string": " select top (100) i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from\tcatalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Music', 'Books', 'Women')    and cs_sold_date_sk = d_date_sk  and d_date between cast('2002-05-24' as date)   \t\t\t\tand dateadd(day, 30, cast('2002-05-24' as date))  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"]}, "group_by": {}, "order_by": {"item": ["i_item_desc", "i_class", "i_item_id", "i_category"]}}
{"id": 21, "query_string": " select top (100) *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-28' as date)) \t                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between dateadd(day, -30, cast ('2001-02-28' as date))                     and dateadd(day, 30, cast ('2001-02-28' as date))    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  ;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"]}, "payload": {"date_dim": ["d_date_sk", "d_date"], "item": ["i_item_id", "i_item_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 22, "query_string": " select top (100) i_product_name              ,i_brand              ,i_class              ,i_category              ,avg(inv_quantity_on_hand) qoh        from inventory            ,date_dim            ,item        where inv_date_sk=d_date_sk               and inv_item_sk=i_item_sk               and d_month_seq between 1191 and 1191 + 11        group by rollup(i_product_name                        ,i_brand                        ,i_class                        ,i_category) order by qoh, i_product_name, i_brand, i_class, i_category;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_brand", "i_product_name", "i_category", "i_class"]}, "group_by": {}, "order_by": {"item": ["i_product_name", "i_class", "i_brand", "i_category"]}}
{"id": 23, "query_string": " with frequent_ss_items as   (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt   from store_sales       ,date_dim        ,item   where ss_sold_date_sk = d_date_sk     and ss_item_sk = i_item_sk      and d_year in (1998,1998+1,1998+2,1998+3)   group by substring(i_item_desc,1,30),i_item_sk,d_date   having count(*) >4),  max_store_sales as  (select max(csales) tpcds_cmax    from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales         from store_sales             ,customer             ,date_dim          where ss_customer_sk = c_customer_sk          and ss_sold_date_sk = d_date_sk          and d_year in (1998,1998+1,1998+2,1998+3)          group by c_customer_sk) a),  best_ss_customer as  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales   from store_sales       ,customer   where ss_customer_sk = c_customer_sk   group by c_customer_sk   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select   * from  max_store_sales))   select top (100) sum(sales)  from (select cs_quantity*cs_list_price sales        from catalog_sales            ,date_dim         where d_year = 1998           and d_moy = 7           and cs_sold_date_sk = d_date_sk           and cs_item_sk in (select item_sk from frequent_ss_items)          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)       union all       select ws_quantity*ws_list_price sales        from web_sales             ,date_dim         where d_year = 1998           and d_moy = 7           and ws_sold_date_sk = d_date_sk           and ws_item_sk in (select item_sk from frequent_ss_items)          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) b  ; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"customer": ["c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "item": ["i_item_sk", "i_item_desc"], "store_sales": ["ss_item_sk", "ss_sales_price", "ss_customer_sk", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 24, "query_string": " with ssales as (select c_last_name       ,c_first_name       ,s_store_name       ,ca_state       ,s_state       ,i_color       ,i_current_price       ,i_manager_id       ,i_units       ,i_size       ,sum(ss_net_paid) netpaid from store_sales     ,store_returns     ,store     ,item     ,customer     ,customer_address where ss_ticket_number = sr_ticket_number   and ss_item_sk = sr_item_sk   and ss_customer_sk = c_customer_sk   and ss_item_sk = i_item_sk   and ss_store_sk = s_store_sk   and c_current_addr_sk = ca_address_sk   and c_birth_country <> upper(ca_country)   and s_zip = ca_zip and s_market_id=9 group by c_last_name         ,c_first_name         ,s_store_name         ,ca_state         ,s_state         ,i_color         ,i_current_price         ,i_manager_id         ,i_units         ,i_size) select c_last_name       ,c_first_name       ,s_store_name       ,sum(netpaid) paid from ssales where i_color = 'metallic' group by c_last_name         ,c_first_name         ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid)                                  from ssales) order by c_last_name         ,c_first_name         ,s_store_name; ", "predicates": {"item": ["i_color"], "store": ["s_market_id"]}, "payload": {"customer": ["c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_current_addr_sk"], "customer_address": ["ca_address_sk", "ca_country", "ca_zip", "ca_state"], "item": ["i_item_sk", "i_units", "i_manager_id", "i_current_price", "i_size"], "store": ["s_zip", "s_store_name", "s_state", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_net_paid_inc_tax"]}, "group_by": {}, "order_by": {}}
{"id": 25, "query_string": " select top (100)   i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  ,avg(ss_net_profit) as store_sales_profit  ,avg(sr_net_loss) as store_returns_loss  ,avg(cs_net_profit) as catalog_sales_profit  from  store_sales  ,store_returns  ,catalog_sales  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,item  where  d1.d_moy = 4  and d1.d_year = 1998  and d1.d_date_sk = ss_sold_date_sk  and i_item_sk = ss_item_sk  and s_store_sk = ss_store_sk  and ss_customer_sk = sr_customer_sk  and ss_item_sk = sr_item_sk  and ss_ticket_number = sr_ticket_number  and sr_returned_date_sk = d2.d_date_sk  and d2.d_moy               between 4 and  10  and d2.d_year              = 1998  and sr_customer_sk = cs_bill_customer_sk  and sr_item_sk = cs_item_sk  and cs_sold_date_sk = d3.d_date_sk  and d3.d_moy               between 4 and  10   and d3.d_year              = 1998  group by  i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  order by  i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  ;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_store_name", "s_store_sk", "s_store_id"], "store_returns": ["sr_returned_date_sk", "sr_net_loss", "sr_customer_sk", "sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 26, "query_string": " select top (100) i_item_id,          avg(cs_quantity) agg1,         avg(cs_list_price) agg2,         avg(cs_coupon_amt) agg3,         avg(cs_sales_price) agg4   from catalog_sales, customer_demographics, date_dim, item, promotion  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd_demo_sk and        cs_promo_sk = p_promo_sk and        cd_gender = 'M' and         cd_marital_status = 'M' and        cd_education_status = 'Unknown' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 2002   group by i_item_id  order by i_item_id  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "promotion": ["p_channel_event", "p_channel_email"]}, "payload": {"item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 27, "query_string": " select top (100) i_item_id,         s_state, grouping(s_state) g_state,         avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4  from store_sales, customer_demographics, date_dim, store, item  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_store_sk = s_store_sk and        ss_cdemo_sk = cd_demo_sk and        cd_gender = 'F' and        cd_marital_status = 'D' and        cd_education_status = '4 yr Degree' and        d_year = 2000 and        s_state in ('TN','TN', 'TN', 'TN', 'TN', 'TN')  group by rollup (i_item_id, s_state)  order by i_item_id          ,s_state  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "store": ["s_state"]}, "payload": {"customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"], "store": ["s_state", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_cdemo_sk", "ss_list_price", "ss_quantity", "ss_sales_price", "ss_coupon_amt", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_id"], "store": ["s_state"]}}
{"id": 28, "query_string": " select top (100) * from (select avg(ss_list_price) B1_LP             ,count(ss_list_price) B1_CNT             ,count(distinct ss_list_price) B1_CNTD       from store_sales       where ss_quantity between 0 and 5         and (ss_list_price between 134 and 134+10               or ss_coupon_amt between 5883 and 5883+1000              or ss_wholesale_cost between 78 and 78+20)) B1,      (select avg(ss_list_price) B2_LP             ,count(ss_list_price) B2_CNT             ,count(distinct ss_list_price) B2_CNTD       from store_sales       where ss_quantity between 6 and 10         and (ss_list_price between 179 and 179+10           or ss_coupon_amt between 10983 and 10983+1000           or ss_wholesale_cost between 76 and 76+20)) B2,      (select avg(ss_list_price) B3_LP             ,count(ss_list_price) B3_CNT             ,count(distinct ss_list_price) B3_CNTD       from store_sales       where ss_quantity between 11 and 15         and (ss_list_price between 79 and 79+10           or ss_coupon_amt between 16829 and 16829+1000           or ss_wholesale_cost between 40 and 40+20)) B3,      (select avg(ss_list_price) B4_LP             ,count(ss_list_price) B4_CNT             ,count(distinct ss_list_price) B4_CNTD       from store_sales       where ss_quantity between 16 and 20         and (ss_list_price between 72 and 72+10           or ss_coupon_amt between 9422 and 9422+1000           or ss_wholesale_cost between 61 and 61+20)) B4,      (select avg(ss_list_price) B5_LP             ,count(ss_list_price) B5_CNT             ,count(distinct ss_list_price) B5_CNTD       from store_sales       where ss_quantity between 21 and 25         and (ss_list_price between 146 and 146+10           or ss_coupon_amt between 2146 and 2146+1000           or ss_wholesale_cost between 77 and 77+20)) B5,      (select avg(ss_list_price) B6_LP             ,count(ss_list_price) B6_CNT             ,count(distinct ss_list_price) B6_CNTD       from store_sales       where ss_quantity between 26 and 30         and (ss_list_price between 141 and 141+10           or ss_coupon_amt between 3442 and 3442+1000           or ss_wholesale_cost between 80 and 80+20)) B6;", "predicates": {"store_sales": ["ss_list_price", "ss_coupon_amt", "ss_quantity", "ss_wholesale_cost"]}, "payload": {"store_sales": ["ss_list_price"]}, "group_by": {}, "order_by": {}}
{"id": 29, "query_string": " select top (100)        i_item_id     ,i_item_desc     ,s_store_id     ,s_store_name     ,stdev(ss_quantity)        as store_sales_quantity     ,stdev(sr_return_quantity) as store_returns_quantity     ,stdev(cs_quantity)        as catalog_sales_quantity  from     store_sales    ,store_returns    ,catalog_sales    ,date_dim             d1    ,date_dim             d2    ,date_dim             d3    ,store    ,item  where      d1.d_moy               = 4   and d1.d_year              = 1998  and d1.d_date_sk           = ss_sold_date_sk  and i_item_sk              = ss_item_sk  and s_store_sk             = ss_store_sk  and ss_customer_sk         = sr_customer_sk  and ss_item_sk             = sr_item_sk  and ss_ticket_number       = sr_ticket_number  and sr_returned_date_sk    = d2.d_date_sk  and d2.d_moy               between 4 and  4 + 3   and d2.d_year              = 1998  and sr_customer_sk         = cs_bill_customer_sk  and sr_item_sk             = cs_item_sk  and cs_sold_date_sk        = d3.d_date_sk       and d3.d_year              in (1998,1998+1,1998+2)  group by     i_item_id    ,i_item_desc    ,s_store_id    ,s_store_name  order by     i_item_id     ,i_item_desc    ,s_store_id    ,s_store_name  ;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_store_name", "s_store_sk", "s_store_id"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_return_quantity", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 30, "query_string": " with customer_total_return as  (select wr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   \tsum(wr_return_amt) as ctr_total_return  from web_returns      ,date_dim      ,customer_address  where wr_returned_date_sk = d_date_sk     and d_year =2000    and wr_returning_addr_sk = ca_address_sk   group by wr_returning_customer_sk          ,ca_state)   select top (100) c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag        ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address        ,c_last_review_date,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  \t\t\t  from customer_total_return ctr2                    \t  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'IA'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag                   ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address                   ,c_last_review_date,ctr_total_return;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_year"]}, "payload": {"customer": ["c_birth_year", "c_login", "c_customer_sk", "c_birth_month", "c_salutation", "c_birth_day", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_current_addr_sk", "c_email_address", "c_customer_id", "c_last_review_date"], "customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "web_returns": ["wr_return_amt", "wr_returning_addr_sk", "wr_returned_date_sk", "wr_returning_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_birth_year", "c_login", "c_birth_month", "c_birth_country", "c_salutation", "c_birth_day", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id", "c_last_review_date"]}}
{"id": 31, "query_string": " with ss as  (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales  from store_sales,date_dim,customer_address  where ss_sold_date_sk = d_date_sk   and ss_addr_sk=ca_address_sk  group by ca_county,d_qoy, d_year),  ws as  (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales  from web_sales,date_dim,customer_address  where ws_sold_date_sk = d_date_sk   and ws_bill_addr_sk=ca_address_sk  group by ca_county,d_qoy, d_year)  select          ss1.ca_county        ,ss1.d_year        ,ws2.web_sales/ws1.web_sales web_q1_q2_increase        ,ss2.store_sales/ss1.store_sales store_q1_q2_increase        ,ws3.web_sales/ws2.web_sales web_q2_q3_increase        ,ss3.store_sales/ss2.store_sales store_q2_q3_increase  from         ss ss1        ,ss ss2        ,ss ss3        ,ws ws1        ,ws ws2        ,ws ws3  where     ss1.d_qoy = 1     and ss1.d_year = 1998     and ss1.ca_county = ss2.ca_county     and ss2.d_qoy = 2     and ss2.d_year = 1998  and ss2.ca_county = ss3.ca_county     and ss3.d_qoy = 3     and ss3.d_year = 1998     and ss1.ca_county = ws1.ca_county     and ws1.d_qoy = 1     and ws1.d_year = 1998     and ws1.ca_county = ws2.ca_county     and ws2.d_qoy = 2     and ws2.d_year = 1998     and ws1.ca_county = ws3.ca_county     and ws3.d_qoy = 3     and ws3.d_year =1998     and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end         > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end     and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end        > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end  order by store_q1_q2_increase;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"customer_address": ["ca_address_sk", "ca_county"], "date_dim": ["d_date_sk", "d_year"], "store_sales": ["ss_sold_date_sk", "ss_addr_sk", "ss_ext_sales_price"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_bill_addr_sk"]}, "group_by": {}, "order_by": {}}
{"id": 32, "query_string": " select top (100) sum(cs_ext_discount_amt)  as \"excess discount amount\"  from     catalog_sales     ,item     ,date_dim where i_manufact_id = 337 and i_item_sk = cs_item_sk  and d_date between '2002-03-15' and          dateadd(day, 90, cast('2002-03-15' as date)) and d_date_sk = cs_sold_date_sk  and cs_ext_discount_amt        > (           select              1.3 * avg(cs_ext_discount_amt)           from              catalog_sales             ,date_dim          where                cs_item_sk = i_item_sk            and d_date between '2002-03-15' and                              dateadd(day, 90, cast('2002-03-15' as date))           and d_date_sk = cs_sold_date_sk        ) ;", "predicates": {"catalog_sales": ["cs_ext_discount_amt"], "date_dim": ["d_date"], "item": ["i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 33, "query_string": " with ss as (  select           i_manufact_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id in (select   i_manufact_id from  item where i_category in ('Sports'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 3  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  cs as (  select           i_manufact_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Sports'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 3  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  ws as (  select           i_manufact_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Sports'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 3  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_manufact_id)   select top (100) i_manufact_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_manufact_id  order by total_sales;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_category"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_addr_sk", "cs_item_sk", "cs_ext_sales_price"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_manufact_id"], "store_sales": ["ss_sold_date_sk", "ss_addr_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk", "ws_bill_addr_sk"]}, "group_by": {}, "order_by": {}}
{"id": 34, "query_string": " select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = '5001-10000')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  \tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  \telse null  \tend)  > 1.2     and date_dim.d_year in (1999,1999+1,1999+2)     and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',                            'Williamson County','Williamson County','Williamson County','Williamson County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;", "predicates": {"date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count", "hd_buy_potential"], "store": ["s_county"]}, "payload": {"customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_preferred_cust_flag"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 35, "query_string": " select top (100)     ca_state,   cd_gender,   cd_marital_status,   cd_dep_count,   count(*) cnt1,   sum(cd_dep_count),   max(cd_dep_count),   stdev(cd_dep_count),   cd_dep_employed_count,   count(*) cnt2,   sum(cd_dep_employed_count),   max(cd_dep_employed_count),   stdev(cd_dep_employed_count),   cd_dep_college_count,   count(*) cnt3,   sum(cd_dep_college_count),   max(cd_dep_college_count),   stdev(cd_dep_college_count)  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2002 and                 d_qoy < 4) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_qoy < 4) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_qoy < 4))  group by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  ;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_state"], "customer_demographics": ["cd_dep_college_count", "cd_gender", "cd_demo_sk", "cd_dep_employed_count", "cd_dep_count", "cd_marital_status"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 36, "query_string": " select top (100)      sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  \tpartition by grouping(i_category)+grouping(i_class),  \tcase when grouping(i_class) = 0 then i_category end   \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent  from     store_sales    ,date_dim       d1    ,item    ,store  where     d1.d_year = 1998   and d1.d_date_sk = ss_sold_date_sk  and i_item_sk  = ss_item_sk   and s_store_sk  = ss_store_sk  and s_state in ('TN','TN','TN','TN',                  'TN','TN','TN','TN')  group by rollup(i_category,i_class)  order by    lochierarchy desc   ,case when (grouping(i_category)+grouping(i_class)) = 0 then i_category end   ,rank_within_parent   ;", "predicates": {"date_dim": ["d_year"], "store": ["s_state"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_class", "i_item_sk", "i_category"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_ext_sales_price", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 37, "query_string": " select top (100) i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 63 and 63 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('1999-01-15' as date) and dateadd(day, 60, cast('1999-01-15' as date))  and i_manufact_id in (850,843,680,871)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  ;", "predicates": {"date_dim": ["d_date"], "inventory": ["inv_quantity_on_hand"], "item": ["i_current_price", "i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc", "i_current_price"]}, "group_by": {}, "order_by": {}}
{"id": 38, "query_string": " select top (100) count(*) from (     select distinct c_last_name, c_first_name, d_date     from store_sales, date_dim, customer           where store_sales.ss_sold_date_sk = date_dim.d_date_sk       and store_sales.ss_customer_sk = customer.c_customer_sk       and d_month_seq between 1191 and 1191 + 11   intersect     select distinct c_last_name, c_first_name, d_date     from catalog_sales, date_dim, customer           where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk       and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk       and d_month_seq between 1191 and 1191 + 11   intersect     select distinct c_last_name, c_first_name, d_date     from web_sales, date_dim, customer           where web_sales.ws_sold_date_sk = date_dim.d_date_sk       and web_sales.ws_bill_customer_sk = customer.c_customer_sk       and d_month_seq between 1191 and 1191 + 11 ) hot_cust;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk", "ws_item_sk", "ws_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 39, "query_string": " with inv as (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy        ,stdev,mean, case mean when 0 then null else stdev/mean end cov  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy             ,stdev(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean       from inventory           ,item           ,warehouse           ,date_dim       where inv_item_sk = i_item_sk         and inv_warehouse_sk = w_warehouse_sk         and inv_date_sk = d_date_sk         and d_year =2001       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo  where case mean when 0 then 0 else stdev/mean end > 1) select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov from inv inv1,inv inv2 where inv1.i_item_sk = inv2.i_item_sk   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk   and inv1.d_moy=2   and inv2.d_moy=2+1 order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov         ,inv2.d_moy,inv2.mean, inv2.cov; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_item_sk"], "warehouse": ["w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 40, "query_string": " select top (100)     w_state   ,i_item_id   ,sum(case when (cast(d_date as date) < cast ('2001-02-28' as date))   \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before   ,sum(case when (cast(d_date as date) >= cast ('2001-02-28' as date))   \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after  from    catalog_sales left outer join catalog_returns on        (cs_order_number = cr_order_number          and cs_item_sk = cr_item_sk)   ,warehouse    ,item   ,date_dim  where      i_current_price between 0.99 and 1.49  and i_item_sk          = cs_item_sk  and cs_warehouse_sk    = w_warehouse_sk   and cs_sold_date_sk    = d_date_sk  and d_date between dateadd(day, -30, cast ('2001-02-28' as date))                 and dateadd(day, 30, cast ('2001-02-28' as date))   group by     w_state,i_item_id  order by w_state,i_item_id;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_refunded_cash"], "date_dim": ["d_date_sk", "d_date"], "item": ["i_item_id", "i_item_sk"], "warehouse": ["w_state", "w_warehouse_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_id"], "warehouse": ["w_state"]}}
{"id": 41, "query_string": " select distinct top (100) i_product_name  from item i1  where i_manufact_id between 933 and 933+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'lemon' or i_color = 'medium') and          (i_units = 'Tsp' or i_units = 'Unknown') and         (i_size = 'extra large' or i_size = 'petite')         ) or         (i_category = 'Women' and         (i_color = 'azure' or i_color = 'burnished') and         (i_units = 'Box' or i_units = 'Bunch') and         (i_size = 'economy' or i_size = 'medium')         ) or         (i_category = 'Men' and         (i_color = 'peach' or i_color = 'sky') and         (i_units = 'Case' or i_units = 'Ton') and         (i_size = 'N/A' or i_size = 'large')         ) or         (i_category = 'Men' and         (i_color = 'gainsboro' or i_color = 'peru') and         (i_units = 'Oz' or i_units = 'Gram') and         (i_size = 'extra large' or i_size = 'petite')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'bisque' or i_color = 'burlywood') and          (i_units = 'Pound' or i_units = 'Dozen') and         (i_size = 'extra large' or i_size = 'petite')         ) or         (i_category = 'Women' and         (i_color = 'cream' or i_color = 'powder') and         (i_units = 'Tbl' or i_units = 'Gross') and         (i_size = 'economy' or i_size = 'medium')         ) or         (i_category = 'Men' and         (i_color = 'pale' or i_color = 'orange') and         (i_units = 'Lb' or i_units = 'Ounce') and         (i_size = 'N/A' or i_size = 'large')         ) or         (i_category = 'Men' and         (i_color = 'red' or i_color = 'almond') and         (i_units = 'Pallet' or i_units = 'Carton') and         (i_size = 'extra large' or i_size = 'petite')         )))) > 0  order by i_product_name  ;", "predicates": {"item": ["i_color", "i_units", "i_manufact_id", "i_category", "i_size", "i_manufact"]}, "payload": {"item": ["i_color", "i_units", "i_product_name", "i_category", "i_size", "i_manufact"]}, "group_by": {}, "order_by": {}}
{"id": 42, "query_string": " select top (100) dt.d_year  \t,item.i_category_id  \t,item.i_category  \t,sum(ss_ext_sales_price)  from \tdate_dim dt  \t,store_sales  \t,item  where dt.d_date_sk = store_sales.ss_sold_date_sk  \tand store_sales.ss_item_sk = item.i_item_sk  \tand item.i_manager_id = 1  \t  \tand dt.d_moy=12  \tand dt.d_year=2001  group by \tdt.d_year  \t\t,item.i_category_id  \t\t,item.i_category  order by       sum(ss_ext_sales_price) desc,dt.d_year  \t\t,item.i_category_id  \t\t,item.i_category  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_item_sk", "i_category", "i_category_id"]}, "group_by": {}, "order_by": {"item": ["i_category", "i_category_id"]}}
{"id": 43, "query_string": " select top (100) s_store_name, s_store_id,         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales  from date_dim, store_sales, store  where d_date_sk = ss_sold_date_sk and        s_store_sk = ss_store_sk and        s_gmt_offset = -5 and        d_year = 2001   group by s_store_name, s_store_id  order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales  ;", "predicates": {"date_dim": ["d_year"], "store": ["s_gmt_offset"]}, "payload": {"date_dim": ["d_date_sk", "d_day_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 44, "query_string": " select top (100) asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing from(select *      from (select item_sk,rank() over (order by rank_col asc) rnk            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col                   from store_sales ss1                  where ss_store_sk = 4                  group by ss_item_sk                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col                                                   from store_sales                                                   where ss_store_sk = 4                                                     and ss_customer_sk is null                                                   group by ss_store_sk))V1)V11      where rnk  < 11) asceding,     (select *      from (select item_sk,rank() over (order by rank_col desc) rnk            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col                  from store_sales ss1                  where ss_store_sk = 4                  group by ss_item_sk                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col                                                   from store_sales                                                   where ss_store_sk = 4                                                     and ss_customer_sk is null                                                   group by ss_store_sk))V2)V21      where rnk  < 11) descending, item i1, item i2 where asceding.rnk = descending.rnk    and i1.i_item_sk=asceding.item_sk   and i2.i_item_sk=descending.item_sk order by asceding.rnk;", "predicates": {"store_sales": ["ss_store_sk", "ss_customer_sk"]}, "payload": {"store_sales": ["ss_net_profit", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 45, "query_string": " select top (100) ca_zip, ca_city, sum(ws_sales_price)  from web_sales, customer, customer_address, date_dim, item  where ws_bill_customer_sk = c_customer_sk  \tand c_current_addr_sk = ca_address_sk   \tand ws_item_sk = i_item_sk   \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')  \t      or   \t      i_item_id in (select i_item_id                              from item                              where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)                              )  \t    )  \tand ws_sold_date_sk = d_date_sk  \tand d_qoy = 1 and d_year = 1998  group by ca_zip, ca_city  order by ca_zip, ca_city  ;", "predicates": {"customer_address": ["ca_zip"], "date_dim": ["d_qoy", "d_year"], "item": ["i_item_id"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip", "ca_city"], "date_dim": ["d_date_sk"], "web_sales": ["ws_sales_price", "ws_sold_date_sk", "ws_bill_customer_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 46, "query_string": " select top (100) c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,ca_city bought_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics,customer_address      where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and (household_demographics.hd_dep_count = 1 or          household_demographics.hd_vehicle_count= 1)     and date_dim.d_dow in (6,0)     and date_dim.d_year in (1998,1998+1,1998+2)      and store.s_city in ('Midway','Fairview','Midway','Fairview','Fairview')      group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr     where ss_customer_sk = c_customer_sk       and customer.c_current_addr_sk = current_addr.ca_address_sk       and current_addr.ca_city <> bought_city   order by c_last_name           ,c_first_name           ,ca_city           ,bought_city           ,ss_ticket_number   ;", "predicates": {"date_dim": ["d_dow", "d_year"], "household_demographics": ["hd_vehicle_count", "hd_dep_count"], "store": ["s_city"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk", "c_first_name", "c_last_name"], "customer_address": ["ca_city", "ca_address_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_addr_sk", "ss_coupon_amt", "ss_customer_sk", "ss_hdemo_sk", "ss_net_profit", "ss_sold_date_sk", "ss_store_sk", "ss_ticket_number"]}, "group_by": {}, "order_by": {}}
{"id": 47, "query_string": " with v1 as(  select i_category, i_brand,         s_store_name, s_company_name,         d_year, d_moy,         sum(ss_sales_price) sum_sales,         avg(sum(ss_sales_price)) over           (partition by i_category, i_brand,                      s_store_name, s_company_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      s_store_name, s_company_name            order by d_year, d_moy) rn  from item, store_sales, date_dim, store  where ss_item_sk = i_item_sk and        ss_sold_date_sk = d_date_sk and        ss_store_sk = s_store_sk and        (          d_year = 2000 or          ( d_year = 2000-1 and d_moy =12) or          ( d_year = 2000+1 and d_moy =1)        )  group by i_category, i_brand,           s_store_name, s_company_name,           d_year, d_moy),  v2 as(  select v1.i_category, v1.i_brand         ,v1.d_year         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1.s_store_name = v1_lag.s_store_name and        v1.s_store_name = v1_lead.s_store_name and        v1.s_company_name = v1_lag.s_company_name and        v1.s_company_name = v1_lead.s_company_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select top (100) *  from v2  where  d_year = 2000 and             avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, nsum  ;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk", "d_moy", "d_year"], "item": ["i_brand", "i_item_sk", "i_category"], "store": ["s_store_name", "s_store_sk", "s_company_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 48, "query_string": " select sum (ss_quantity)  from store_sales, store, customer_demographics, customer_address, date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2002  and    (   (    cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'U'    and     cd_education_status = 'Secondary'    and     ss_sales_price between 100.00 and 150.00      )  or   (   cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'D'    and     cd_education_status = 'Primary'    and     ss_sales_price between 50.00 and 100.00      )  or   (   cd_demo_sk = ss_cdemo_sk   and     cd_marital_status = 'W'    and     cd_education_status = '2 yr Degree'    and     ss_sales_price between 150.00 and 200.00    )  )  and  (   (   ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('UT', 'OK', 'KS')   and ss_net_profit between 0 and 2000     )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('CA', 'WA', 'GA')   and ss_net_profit between 150 and 3000    )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('NC', 'AL', 'MS')   and ss_net_profit between 50 and 25000    )  );", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "store_sales": ["ss_sales_price", "ss_net_profit"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_cdemo_sk", "ss_addr_sk", "ss_quantity", "ss_sales_price", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 49, "query_string": " select top (100) channel, item, return_ratio, return_rank, currency_rank from  (select  'web' as channel  ,web.item  ,web.return_ratio  ,web.return_rank  ,web.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect ws.ws_item_sk as item  \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\t web_sales ws left outer join web_returns wr   \t\t\ton (ws.ws_order_number = wr.wr_order_number and   \t\t\tws.ws_item_sk = wr.wr_item_sk)                  ,date_dim  \t\twhere   \t\t\twr.wr_return_amt > 10000   \t\t\tand ws.ws_net_profit > 1                          and ws.ws_net_paid > 0                          and ws.ws_quantity > 0                          and ws_sold_date_sk = d_date_sk                          and d_year = 1998                          and d_moy = 12  \t\tgroup by ws.ws_item_sk  \t) in_web  ) web  where   (  web.return_rank <= 10  or  web.currency_rank <= 10  )  union  select   'catalog' as channel  ,catalog.item  ,catalog.return_ratio  ,catalog.return_rank  ,catalog.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect   \t\tcs.cs_item_sk as item  \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\tcatalog_sales cs left outer join catalog_returns cr  \t\t\ton (cs.cs_order_number = cr.cr_order_number and   \t\t\tcs.cs_item_sk = cr.cr_item_sk)                 ,date_dim  \t\twhere   \t\t\tcr.cr_return_amount > 10000   \t\t\tand cs.cs_net_profit > 1                          and cs.cs_net_paid > 0                          and cs.cs_quantity > 0                          and cs_sold_date_sk = d_date_sk                          and d_year = 1998                          and d_moy = 12                  group by cs.cs_item_sk  \t) in_cat  ) catalog  where   (  catalog.return_rank <= 10  or  catalog.currency_rank <=10  )  union  select   'store' as channel  ,store.item  ,store.return_ratio  ,store.return_rank  ,store.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect sts.ss_item_sk as item  \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\tstore_sales sts left outer join store_returns sr  \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)                 ,date_dim  \t\twhere   \t\t\tsr.sr_return_amt > 10000   \t\t\tand sts.ss_net_profit > 1                          and sts.ss_net_paid > 0                           and sts.ss_quantity > 0                          and ss_sold_date_sk = d_date_sk                          and d_year = 1998                          and d_moy = 12  \t\tgroup by sts.ss_item_sk  \t) in_store  ) store  where  (  store.return_rank <= 10  or   store.currency_rank <= 10  )  ) a  order by 1,4,5,2  ;", "predicates": {"catalog_returns": ["cr_return_amount"], "catalog_sales": ["cs_net_paid", "cs_net_profit", "cs_quantity"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_return_amt"], "store_sales": ["ss_net_paid", "ss_quantity", "ss_net_profit"], "web_returns": ["wr_return_amt"], "web_sales": ["ws_net_profit", "ws_net_paid", "ws_quantity"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_quantity", "cr_return_amount"], "store_returns": ["sr_return_amt", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_return_amt", "wr_return_quantity", "wr_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 50, "query_string": " select top (100)     s_store_name   ,s_company_id   ,s_street_number   ,s_street_name   ,s_street_type   ,s_suite_number   ,s_city   ,s_county   ,s_state   ,s_zip   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and                   (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and                   (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and                  (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    store_sales   ,store_returns   ,store   ,date_dim d1   ,date_dim d2 where     d2.d_year = 1998 and d2.d_moy  = 8 and ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_sold_date_sk   = d1.d_date_sk and sr_returned_date_sk   = d2.d_date_sk and ss_customer_sk = sr_customer_sk and ss_store_sk = s_store_sk group by    s_store_name   ,s_company_id   ,s_street_number   ,s_street_name   ,s_street_type   ,s_suite_number   ,s_city   ,s_county   ,s_state   ,s_zip order by s_store_name         ,s_company_id         ,s_street_number         ,s_street_name         ,s_street_type         ,s_suite_number         ,s_city         ,s_county         ,s_state         ,s_zip;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 51, "query_string": " WITH web_v1 as ( select   ws_item_sk item_sk, d_date,   sum(sum(ws_sales_price))       over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from web_sales     ,date_dim where ws_sold_date_sk=d_date_sk   and d_month_seq between 1191 and 1191+11   and ws_item_sk is not NULL group by ws_item_sk, d_date), store_v1 as ( select   ss_item_sk item_sk, d_date,   sum(sum(ss_sales_price))       over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from store_sales     ,date_dim where ss_sold_date_sk=d_date_sk   and d_month_seq between 1191 and 1191+11   and ss_item_sk is not NULL group by ss_item_sk, d_date)  select top (100) * from (select item_sk      ,d_date      ,web_sales      ,store_sales      ,max(web_sales)          over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative      ,max(store_sales)          over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative      from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk                  ,case when web.d_date is not null then web.d_date else store.d_date end d_date                  ,web.cume_sales web_sales                  ,store.cume_sales store_sales            from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk                                                           and web.d_date = store.d_date)           )x )y where web_cumulative > store_cumulative order by item_sk         ,d_date;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_sales_price", "ss_item_sk"], "web_sales": ["ws_sold_date_sk", "ws_sales_price", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 52, "query_string": " select top (100) dt.d_year  \t,item.i_brand_id brand_id  \t,item.i_brand brand  \t,sum(ss_ext_sales_price) ext_price  from date_dim dt      ,store_sales      ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=2001  group by dt.d_year  \t,item.i_brand  \t,item.i_brand_id  order by dt.d_year  \t,ext_price desc  \t,brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"item": ["i_brand_id"]}}
{"id": 53, "query_string": " select top (100) * from  (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1191,1191+1,1191+2,1191+3,1191+4,1191+5,1191+6,1191+7,1191+8,1191+9,1191+10,1191+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', \t\t'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', \t\t'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0  \tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales  \telse null end > 0.1 order by avg_quarterly_sales, \t sum_sales, \t i_manufact_id;", "predicates": {"date_dim": ["d_month_seq"], "item": ["i_brand", "i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_qoy"], "item": ["i_item_sk", "i_manufact_id", "i_brand", "i_category", "i_class"], "store": ["s_store_sk"]}, "group_by": {}, "order_by": {}}
{"id": 54, "query_string": " with my_customers as (  select distinct c_customer_sk         , c_current_addr_sk  from            ( select cs_sold_date_sk sold_date_sk,                  cs_bill_customer_sk customer_sk,                  cs_item_sk item_sk           from   catalog_sales           union all           select ws_sold_date_sk sold_date_sk,                  ws_bill_customer_sk customer_sk,                  ws_item_sk item_sk           from   web_sales          ) cs_or_ws_sales,          item,          date_dim,          customer  where   sold_date_sk = d_date_sk          and item_sk = i_item_sk          and i_category = 'Electronics'          and i_class = 'stereo'          and c_customer_sk = cs_or_ws_sales.customer_sk          and d_moy = 3          and d_year = 2002  )  , my_revenue as (  select c_customer_sk,         sum(ss_ext_sales_price) as revenue  from   my_customers,         store_sales,         customer_address,         store,         date_dim  where  c_current_addr_sk = ca_address_sk         and ca_county = s_county         and ca_state = s_state         and ss_sold_date_sk = d_date_sk         and c_customer_sk = ss_customer_sk         and d_month_seq between (select distinct d_month_seq+1                                  from   date_dim where d_year = 2002 and d_moy = 3)                            and  (select distinct d_month_seq+3                                  from   date_dim where d_year = 2002 and d_moy = 3)  group by c_customer_sk  )  , segments as  (select cast((revenue/50) as int) as segment   from   my_revenue  )   select top (100) segment, count(*) as num_customers, segment*50 as segment_base  from segments  group by segment  order by segment, num_customers  ;", "predicates": {"date_dim": ["d_month_seq", "d_moy", "d_year"], "item": ["i_class", "i_category"]}, "payload": {"customer_address": ["ca_address_sk", "ca_county", "ca_state"], "date_dim": ["d_date_sk", "d_month_seq"], "item": ["i_item_sk"], "store": ["s_state", "s_county"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_ext_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 55, "query_string": " select top (100) i_brand_id brand_id, i_brand brand,  \tsum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item  where d_date_sk = ss_sold_date_sk  \tand ss_item_sk = i_item_sk  \tand i_manager_id=15  \tand d_moy=11  \tand d_year=1999  group by i_brand, i_brand_id  order by ext_price desc, i_brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"item": ["i_brand_id"]}}
{"id": 56, "query_string": " with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('grey','misty','blush'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 7  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -7   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('grey','misty','blush'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 7  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -7   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('grey','misty','blush'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 7  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -7  group by i_item_id)   select top (100) i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  ;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_color"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 57, "query_string": " with v1 as(  select i_category, i_brand,         cc_name,         d_year, d_moy,         sum(cs_sales_price) sum_sales,         avg(sum(cs_sales_price)) over           (partition by i_category, i_brand,                      cc_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      cc_name            order by d_year, d_moy) rn  from item, catalog_sales, date_dim, call_center  where cs_item_sk = i_item_sk and        cs_sold_date_sk = d_date_sk and        cc_call_center_sk= cs_call_center_sk and        (          d_year = 2000 or          ( d_year = 2000-1 and d_moy =12) or          ( d_year = 2000+1 and d_moy =1)        )  group by i_category, i_brand,           cc_name , d_year, d_moy),  v2 as(  select v1.i_category         ,v1.d_year         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1. cc_name = v1_lag. cc_name and        v1. cc_name = v1_lead. cc_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select top (100) *  from v2  where  d_year = 2000 and         avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, nsum  ;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"call_center": ["cc_name", "cc_call_center_sk"], "catalog_sales": ["cs_sales_price", "cs_sold_date_sk", "cs_call_center_sk", "cs_item_sk"], "date_dim": ["d_date_sk", "d_moy", "d_year"], "item": ["i_brand", "i_item_sk", "i_category"]}, "group_by": {}, "order_by": {}}
{"id": 58, "query_string": " with ss_items as  (select i_item_id item_id         ,sum(ss_ext_sales_price) ss_item_rev   from store_sales      ,item      ,date_dim  where ss_item_sk = i_item_sk    and d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2001-02-08'))    and ss_sold_date_sk   = d_date_sk  group by i_item_id),  cs_items as  (select i_item_id item_id         ,sum(cs_ext_sales_price) cs_item_rev   from catalog_sales       ,item       ,date_dim  where cs_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2001-02-08'))   and  cs_sold_date_sk = d_date_sk  group by i_item_id),  ws_items as  (select i_item_id item_id         ,sum(ws_ext_sales_price) ws_item_rev   from web_sales       ,item       ,date_dim  where ws_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq =(select d_week_seq                                       from date_dim                                      where d_date = '2001-02-08'))   and ws_sold_date_sk   = d_date_sk  group by i_item_id)   select top (100) ss_items.item_id        ,ss_item_rev        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev        ,cs_item_rev        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev        ,ws_item_rev        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average  from ss_items,cs_items,ws_items  where ss_items.item_id=cs_items.item_id    and ss_items.item_id=ws_items.item_id     and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  order by item_id          ,ss_item_rev  ;", "predicates": {"date_dim": ["d_week_seq", "d_date"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_item_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "item": ["i_item_id", "i_item_sk"], "store_sales": ["ss_sold_date_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 59, "query_string": " with wss as   (select d_week_seq,         ss_store_sk,         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales  from store_sales,date_dim  where d_date_sk = ss_sold_date_sk  group by d_week_seq,ss_store_sk  )   select top (100) s_store_name1,s_store_id1,d_week_seq1        ,sun_sales1/sun_sales2,mon_sales1/mon_sales2        ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2        ,fri_sales1/fri_sales2,sat_sales1/sat_sales2  from  (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1         ,s_store_id s_store_id1,sun_sales sun_sales1         ,mon_sales mon_sales1,tue_sales tue_sales1         ,wed_sales wed_sales1,thu_sales thu_sales1         ,fri_sales fri_sales1,sat_sales sat_sales1   from wss,store,date_dim d   where d.d_week_seq = wss.d_week_seq and         ss_store_sk = s_store_sk and          d_month_seq between 1196 and 1196 + 11) y,  (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2         ,s_store_id s_store_id2,sun_sales sun_sales2         ,mon_sales mon_sales2,tue_sales tue_sales2         ,wed_sales wed_sales2,thu_sales thu_sales2         ,fri_sales fri_sales2,sat_sales sat_sales2   from wss,store,date_dim d   where d.d_week_seq = wss.d_week_seq and         ss_store_sk = s_store_sk and          d_month_seq between 1196+ 12 and 1196 + 23) x  where s_store_id1=s_store_id2    and d_week_seq1=d_week_seq2-52  order by s_store_name1,s_store_id1,d_week_seq1;", "predicates": {"date_dim": ["d_month_seq"], "store": ["s_store_id"]}, "payload": {"date_dim": ["d_date_sk", "d_week_seq", "d_day_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 60, "query_string": " with ss as (  select           i_item_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where          i_item_id in (select   i_item_id from  item where i_category in ('Shoes'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 10  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  cs as (  select           i_item_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Shoes'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 10  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  ws as (  select           i_item_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Shoes'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 10  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_item_id)   select top (100)     i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by i_item_id       ,total_sales  ;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_item_id", "i_category"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 61, "query_string": " select top (100) promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from   (select sum(ss_ext_sales_price) promotions    from  store_sales         ,store         ,promotion         ,date_dim         ,customer         ,customer_address          ,item    where ss_sold_date_sk = d_date_sk    and   ss_store_sk = s_store_sk    and   ss_promo_sk = p_promo_sk    and   ss_customer_sk= c_customer_sk    and   ca_address_sk = c_current_addr_sk    and   ss_item_sk = i_item_sk     and   ca_gmt_offset = -6    and   i_category = 'Sports'    and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')    and   s_gmt_offset = -6    and   d_year = 2002    and   d_moy  = 12) promotional_sales,   (select sum(ss_ext_sales_price) total    from  store_sales         ,store         ,date_dim         ,customer         ,customer_address         ,item    where ss_sold_date_sk = d_date_sk    and   ss_store_sk = s_store_sk    and   ss_customer_sk= c_customer_sk    and   ca_address_sk = c_current_addr_sk    and   ss_item_sk = i_item_sk    and   ca_gmt_offset = -6    and   i_category = 'Sports'    and   s_gmt_offset = -6    and   d_year = 2002    and   d_moy  = 12) all_sales order by promotions, total;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_category"], "promotion": ["p_channel_dmail", "p_channel_email", "p_channel_tv"], "store": ["s_gmt_offset"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_promo_sk", "ss_item_sk", "ss_ext_sales_price", "ss_customer_sk", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 62, "query_string": " select top (100)     substring(w_warehouse_name,1,20)   ,sm_type   ,web_name   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and                   (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and                   (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and                  (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    web_sales   ,warehouse   ,ship_mode   ,web_site   ,date_dim where     d_month_seq between 1191 and 1191 + 11 and ws_ship_date_sk   = d_date_sk and ws_warehouse_sk   = w_warehouse_sk and ws_ship_mode_sk   = sm_ship_mode_sk and ws_web_site_sk    = web_site_sk group by    substring(w_warehouse_name,1,20)   ,sm_type   ,web_name order by substring(w_warehouse_name,1,20)         ,sm_type        ,web_name;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "ship_mode": ["sm_type", "sm_ship_mode_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"], "web_sales": ["ws_ship_date_sk", "ws_ship_mode_sk", "ws_sold_date_sk", "ws_warehouse_sk", "ws_web_site_sk"], "web_site": ["web_name", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 63, "query_string": " select top (100) *  from (select i_manager_id              ,sum(ss_sales_price) sum_sales              ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales       from item           ,store_sales           ,date_dim           ,store       where ss_item_sk = i_item_sk         and ss_sold_date_sk = d_date_sk         and ss_store_sk = s_store_sk         and d_month_seq in (1191,1191+1,1191+2,1191+3,1191+4,1191+5,1191+6,1191+7,1191+8,1191+9,1191+10,1191+11)         and ((    i_category in ('Books','Children','Electronics')               and i_class in ('personal','portable','reference','self-help')               and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', \t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))            or(    i_category in ('Women','Music','Men')               and i_class in ('accessories','classical','fragrances','pants')               and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', \t\t                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id         ,avg_monthly_sales         ,sum_sales;", "predicates": {"date_dim": ["d_month_seq"], "item": ["i_brand", "i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_item_sk", "i_manager_id", "i_brand", "i_category", "i_class"], "store": ["s_store_sk"]}, "group_by": {}, "order_by": {"item": ["i_manager_id"]}}
{"id": 64, "query_string": " with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('khaki','light','orange','metallic','white','orchid') and          i_current_price between 75 and 75 + 10 and          i_current_price between 75 + 1 and 75 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;", "predicates": {"customer_demographics": ["cd_marital_status"], "date_dim": ["d_year"], "item": ["i_color", "i_current_price"], "store": ["s_zip", "s_store_name"]}, "payload": {"household_demographics": ["hd_income_band_sk", "hd_demo_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 65, "query_string": " select top (100) \ts_store_name, \ti_item_desc, \tsc.revenue, \ti_current_price, \ti_wholesale_cost, \ti_brand  from store, item,      (select ss_store_sk, avg(revenue) as ave  \tfrom  \t    (select  ss_store_sk, ss_item_sk,   \t\t     sum(ss_sales_price) as revenue  \t\tfrom store_sales, date_dim  \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1191 and 1191+11  \t\tgroup by ss_store_sk, ss_item_sk) sa  \tgroup by ss_store_sk) sb,      (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue  \tfrom store_sales, date_dim  \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1191 and 1191+11  \tgroup by ss_store_sk, ss_item_sk) sc  where sb.ss_store_sk = sc.ss_store_sk and         sc.revenue <= 0.1 * sb.ave and        s_store_sk = sc.ss_store_sk and        i_item_sk = sc.ss_item_sk  order by s_store_name, i_item_desc;", "predicates": {"date_dim": ["d_month_seq"], "store_sales": ["ss_store_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_brand", "i_wholesale_cost", "i_item_desc"], "store": ["s_store_name", "s_store_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price", "ss_item_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_desc"], "store": ["s_store_name"]}}
{"id": 66, "query_string": " select top (100)            w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country         ,ship_carriers         ,year  \t,sum(jan_sales) as jan_sales  \t,sum(feb_sales) as feb_sales  \t,sum(mar_sales) as mar_sales  \t,sum(apr_sales) as apr_sales  \t,sum(may_sales) as may_sales  \t,sum(jun_sales) as jun_sales  \t,sum(jul_sales) as jul_sales  \t,sum(aug_sales) as aug_sales  \t,sum(sep_sales) as sep_sales  \t,sum(oct_sales) as oct_sales  \t,sum(nov_sales) as nov_sales  \t,sum(dec_sales) as dec_sales  \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot  \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot  \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot  \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot  \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot  \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot  \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot  \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot  \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot  \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot  \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot  \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot  \t,sum(jan_net) as jan_net  \t,sum(feb_net) as feb_net  \t,sum(mar_net) as mar_net  \t,sum(apr_net) as apr_net  \t,sum(may_net) as may_net  \t,sum(jun_net) as jun_net  \t,sum(jul_net) as jul_net  \t,sum(aug_net) as aug_net  \t,sum(sep_net) as sep_net  \t,sum(oct_net) as oct_net  \t,sum(nov_net) as nov_net  \t,sum(dec_net) as dec_net  from (      select   \tw_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,concat('ORIENTAL' , ',' , 'TBS') as ship_carriers        ,d_year as year  \t,sum(case when d_moy = 1   \t\tthen ws_sales_price* ws_quantity else 0 end) as jan_sales  \t,sum(case when d_moy = 2   \t\tthen ws_sales_price* ws_quantity else 0 end) as feb_sales  \t,sum(case when d_moy = 3   \t\tthen ws_sales_price* ws_quantity else 0 end) as mar_sales  \t,sum(case when d_moy = 4   \t\tthen ws_sales_price* ws_quantity else 0 end) as apr_sales  \t,sum(case when d_moy = 5   \t\tthen ws_sales_price* ws_quantity else 0 end) as may_sales  \t,sum(case when d_moy = 6   \t\tthen ws_sales_price* ws_quantity else 0 end) as jun_sales  \t,sum(case when d_moy = 7   \t\tthen ws_sales_price* ws_quantity else 0 end) as jul_sales  \t,sum(case when d_moy = 8   \t\tthen ws_sales_price* ws_quantity else 0 end) as aug_sales  \t,sum(case when d_moy = 9   \t\tthen ws_sales_price* ws_quantity else 0 end) as sep_sales  \t,sum(case when d_moy = 10   \t\tthen ws_sales_price* ws_quantity else 0 end) as oct_sales  \t,sum(case when d_moy = 11  \t\tthen ws_sales_price* ws_quantity else 0 end) as nov_sales  \t,sum(case when d_moy = 12  \t\tthen ws_sales_price* ws_quantity else 0 end) as dec_sales  \t,sum(case when d_moy = 1   \t\tthen ws_net_profit * ws_quantity else 0 end) as jan_net  \t,sum(case when d_moy = 2  \t\tthen ws_net_profit * ws_quantity else 0 end) as feb_net  \t,sum(case when d_moy = 3   \t\tthen ws_net_profit * ws_quantity else 0 end) as mar_net  \t,sum(case when d_moy = 4   \t\tthen ws_net_profit * ws_quantity else 0 end) as apr_net  \t,sum(case when d_moy = 5   \t\tthen ws_net_profit * ws_quantity else 0 end) as may_net  \t,sum(case when d_moy = 6   \t\tthen ws_net_profit * ws_quantity else 0 end) as jun_net  \t,sum(case when d_moy = 7   \t\tthen ws_net_profit * ws_quantity else 0 end) as jul_net  \t,sum(case when d_moy = 8   \t\tthen ws_net_profit * ws_quantity else 0 end) as aug_net  \t,sum(case when d_moy = 9   \t\tthen ws_net_profit * ws_quantity else 0 end) as sep_net  \t,sum(case when d_moy = 10   \t\tthen ws_net_profit * ws_quantity else 0 end) as oct_net  \t,sum(case when d_moy = 11  \t\tthen ws_net_profit * ws_quantity else 0 end) as nov_net  \t,sum(case when d_moy = 12  \t\tthen ws_net_profit * ws_quantity else 0 end) as dec_net      from           web_sales          ,warehouse          ,date_dim          ,time_dim  \t  ,ship_mode      where             ws_warehouse_sk =  w_warehouse_sk         and ws_sold_date_sk = d_date_sk         and ws_sold_time_sk = t_time_sk  \tand ws_ship_mode_sk = sm_ship_mode_sk         and d_year = 1999  \tand t_time between 32010 and 32010+28800   \tand sm_carrier in ('ORIENTAL','TBS')      group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country        ,d_year  union all      select   \tw_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,concat('ORIENTAL', ',', 'TBS') as ship_carriers        ,d_year as year  \t,sum(case when d_moy = 1   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jan_sales  \t,sum(case when d_moy = 2   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as feb_sales  \t,sum(case when d_moy = 3   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as mar_sales  \t,sum(case when d_moy = 4   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as apr_sales  \t,sum(case when d_moy = 5   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as may_sales  \t,sum(case when d_moy = 6   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jun_sales  \t,sum(case when d_moy = 7   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jul_sales  \t,sum(case when d_moy = 8   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as aug_sales  \t,sum(case when d_moy = 9   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as sep_sales  \t,sum(case when d_moy = 10   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as oct_sales  \t,sum(case when d_moy = 11  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as nov_sales  \t,sum(case when d_moy = 12  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as dec_sales  \t,sum(case when d_moy = 1   \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as jan_net  \t,sum(case when d_moy = 2   \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as feb_net  \t,sum(case when d_moy = 3   \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as mar_net  \t,sum(case when d_moy = 4   \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as apr_net  \t,sum(case when d_moy = 5   \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as may_net  \t,sum(case when d_moy = 6   \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as jun_net  \t,sum(case when d_moy = 7   \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as jul_net  \t,sum(case when d_moy = 8   \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as aug_net  \t,sum(case when d_moy = 9   \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as sep_net  \t,sum(case when d_moy = 10   \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as oct_net  \t,sum(case when d_moy = 11  \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as nov_net  \t,sum(case when d_moy = 12  \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as dec_net      from           catalog_sales          ,warehouse          ,date_dim          ,time_dim  \t ,ship_mode      where             cs_warehouse_sk =  w_warehouse_sk         and cs_sold_date_sk = d_date_sk         and cs_sold_time_sk = t_time_sk  \tand cs_ship_mode_sk = sm_ship_mode_sk         and d_year = 1999  \tand t_time between 32010 AND 32010+28800   \tand sm_carrier in ('ORIENTAL','TBS')      group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country        ,d_year  ) x  group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,ship_carriers        ,year  order by w_warehouse_name  ;", "predicates": {"date_dim": ["d_year"], "ship_mode": ["sm_carrier"], "time_dim": ["t_time"]}, "payload": {"catalog_sales": ["cs_warehouse_sk", "cs_ext_list_price", "cs_quantity", "cs_net_paid_inc_tax", "cs_ship_mode_sk", "cs_sold_date_sk", "cs_sold_time_sk"], "date_dim": ["d_date_sk", "d_moy", "d_year"], "ship_mode": ["sm_ship_mode_sk"], "time_dim": ["t_time_sk"], "web_sales": ["ws_ship_mode_sk", "ws_ext_list_price", "ws_sold_date_sk", "ws_quantity", "ws_sold_time_sk", "ws_warehouse_sk", "ws_net_paid"]}, "group_by": {}, "order_by": {}}
{"id": 67, "query_string": " select top (100) * from (select i_category             ,i_class             ,i_brand             ,i_product_name             ,d_year             ,d_qoy             ,d_moy             ,s_store_id             ,sumsales             ,rank() over (partition by i_category order by sumsales desc) rk       from (select i_category                   ,i_class                   ,i_brand                   ,i_product_name                   ,d_year                   ,d_qoy                   ,d_moy                   ,s_store_id                   ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales             from store_sales                 ,date_dim                 ,store                 ,item        where  ss_sold_date_sk=d_date_sk           and ss_item_sk=i_item_sk           and ss_store_sk = s_store_sk           and d_month_seq between 1191 and 1191+11        group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 order by i_category         ,i_class         ,i_brand         ,i_product_name         ,d_year         ,d_qoy         ,d_moy         ,s_store_id         ,sumsales         ,rk;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk", "d_moy", "d_qoy", "d_year"], "item": ["i_item_sk", "i_brand", "i_product_name", "i_category", "i_class"], "store": ["s_store_sk", "s_store_id"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_sales_price", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {"date_dim": ["d_moy", "d_qoy", "d_year"], "item": ["i_brand", "i_class", "i_product_name", "i_category"], "store": ["s_store_id"]}}
{"id": 68, "query_string": " select top (100) c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,extended_price        ,extended_tax        ,list_price  from (select ss_ticket_number              ,ss_customer_sk              ,ca_city bought_city              ,sum(ss_ext_sales_price) extended_price               ,sum(ss_ext_list_price) list_price              ,sum(ss_ext_tax) extended_tax         from store_sales            ,date_dim            ,store            ,household_demographics            ,customer_address         where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_store_sk = store.s_store_sk           and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk         and store_sales.ss_addr_sk = customer_address.ca_address_sk         and date_dim.d_dom between 1 and 2          and (household_demographics.hd_dep_count = 7 or              household_demographics.hd_vehicle_count= 1)         and date_dim.d_year in (1998,1998+1,1998+2)         and store.s_city in ('Fairview','Midway')        group by ss_ticket_number                ,ss_customer_sk                ,ss_addr_sk,ca_city) dn       ,customer       ,customer_address current_addr  where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name          ,ss_ticket_number  ;", "predicates": {"customer_address": ["ca_city"], "date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_city"]}, "payload": {"customer": ["c_current_addr_sk", "c_first_name", "c_last_name", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_city"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_ext_sales_price", "ss_addr_sk", "ss_customer_sk", "ss_ticket_number", "ss_ext_list_price", "ss_ext_tax", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 69, "query_string": " select top (100)    cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_state in ('NC','GA','OH') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2003 and                 d_moy between 1 and 1+2) and    (not exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2003 and                   d_moy between 1 and 1+2) and     not exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2003 and                   d_moy between 1 and 1+2))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  ;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 70, "query_string": " select top (100)      sum(ss_net_profit) as total_sum    ,s_state    ,s_county    ,grouping(s_state)+grouping(s_county) as lochierarchy    ,rank() over (  \tpartition by grouping(s_state)+grouping(s_county),  \tcase when grouping(s_county) = 0 then s_state end   \torder by sum(ss_net_profit) desc) as rank_within_parent  from     store_sales    ,date_dim       d1    ,store  where     d1.d_month_seq between 1191 and 1191+11  and d1.d_date_sk = ss_sold_date_sk  and s_store_sk  = ss_store_sk  and s_state in              ( select s_state                from  (select s_state as s_state,  \t\t\t    rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking                       from   store_sales, store, date_dim                       where  d_month_seq between 1191 and 1191+11  \t\t\t    and d_date_sk = ss_sold_date_sk  \t\t\t    and s_store_sk  = ss_store_sk                       group by s_state                      ) tmp1                 where ranking <= 5              )  group by rollup(s_state,s_county)  order by    lochierarchy desc   ,case when (grouping(s_state)+grouping(s_county)) = 0 then s_state end   ,rank_within_parent  ;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 71, "query_string": " select i_brand_id brand_id, i_brand brand,t_hour,t_minute,  \tsum(ext_price) ext_price  from item, (select ws_ext_sales_price as ext_price,                          ws_sold_date_sk as sold_date_sk,                         ws_item_sk as sold_item_sk,                         ws_sold_time_sk as time_sk                    from web_sales,date_dim                  where d_date_sk = ws_sold_date_sk                    and d_moy=12                    and d_year=1998                  union all                  select cs_ext_sales_price as ext_price,                         cs_sold_date_sk as sold_date_sk,                         cs_item_sk as sold_item_sk,                         cs_sold_time_sk as time_sk                  from catalog_sales,date_dim                  where d_date_sk = cs_sold_date_sk                    and d_moy=12                    and d_year=1998                  union all                  select ss_ext_sales_price as ext_price,                         ss_sold_date_sk as sold_date_sk,                         ss_item_sk as sold_item_sk,                         ss_sold_time_sk as time_sk                  from store_sales,date_dim                  where d_date_sk = ss_sold_date_sk                    and d_moy=12                    and d_year=1998                  ) tmp,time_dim  where    sold_item_sk = i_item_sk    and i_manager_id=1    and time_sk = t_time_sk    and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')  group by i_brand, i_brand_id,t_hour,t_minute  order by ext_price desc, i_brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"], "time_dim": ["t_meal_time"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_brand", "i_item_sk", "i_brand_id"], "time_dim": ["t_hour", "t_minute", "t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 72, "query_string": " select top (100) i_item_desc       ,w_warehouse_name       ,d1.d_week_seq       ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo       ,sum(case when p_promo_sk is not null then 1 else 0 end) promo       ,count(*) total_cnt from catalog_sales join inventory on (cs_item_sk = inv_item_sk) join warehouse on (w_warehouse_sk=inv_warehouse_sk) join item on (i_item_sk = cs_item_sk) join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk) join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk) join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk) join date_dim d2 on (inv_date_sk = d2.d_date_sk) join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk) left outer join promotion on (cs_promo_sk=p_promo_sk) left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number) where d1.d_week_seq = d2.d_week_seq   and inv_quantity_on_hand < cs_quantity    and d3.d_date > dateadd(day, 5, d1.d_date)   and hd_buy_potential = '501-1000'   and d1.d_year = 1999   and cd_marital_status = 'U' group by i_item_desc,w_warehouse_name,d1.d_week_seq order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq;", "predicates": {"customer_demographics": ["cd_marital_status"], "date_dim": ["d_date", "d_year"], "household_demographics": ["hd_buy_potential"], "inventory": ["inv_warehouse_sk"], "warehouse": ["w_warehouse_sk"]}, "payload": {"catalog_sales": ["cs_quantity", "cs_promo_sk", "cs_item_sk", "cs_ship_date_sk", "cs_bill_cdemo_sk", "cs_sold_date_sk", "cs_bill_hdemo_sk"], "customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "household_demographics": ["hd_demo_sk"], "item": ["i_item_sk", "i_item_desc"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {"date_dim": ["d_week_seq"], "item": ["i_item_desc"], "warehouse": ["w_warehouse_name"]}}
{"id": 73, "query_string": " select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = '5001-10000')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (1999,1999+1,1999+2)     and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;", "predicates": {"date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count", "hd_buy_potential"], "store": ["s_county"]}, "payload": {"customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_preferred_cust_flag"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 74, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,d_year as year        ,avg(ss_net_paid) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk    and d_year in (1999,1999+1)  group by c_customer_id          ,c_first_name          ,c_last_name          ,d_year  union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,d_year as year        ,avg(ws_net_paid) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk    and d_year in (1999,1999+1)  group by c_customer_id          ,c_first_name          ,c_last_name          ,d_year          )   select top (100)         t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id          and t_s_firstyear.customer_id = t_w_secyear.customer_id          and t_s_firstyear.customer_id = t_w_firstyear.customer_id          and t_s_firstyear.sale_type = 's'          and t_w_firstyear.sale_type = 'w'          and t_s_secyear.sale_type = 's'          and t_w_secyear.sale_type = 'w'          and t_s_firstyear.year = 1999          and t_s_secyear.year = 1999+1          and t_w_firstyear.year = 1999          and t_w_secyear.year = 1999+1          and t_s_firstyear.year_total > 0          and t_w_firstyear.year_total > 0          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end  order by 1,2,3;", "predicates": {"date_dim": ["d_year"]}, "payload": {"customer": ["c_customer_id", "c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_net_paid"], "web_sales": ["ws_net_paid", "ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_customer_id", "c_last_name", "c_first_name"]}}
{"id": 75, "query_string": " WITH all_sales AS (  SELECT d_year        ,i_brand_id        ,i_class_id        ,i_category_id        ,i_manufact_id        ,SUM(sales_cnt) AS sales_cnt        ,SUM(sales_amt) AS sales_amt  FROM (SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt              ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt        FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk                           JOIN date_dim ON d_date_sk=cs_sold_date_sk                           LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number                                                      AND cs_item_sk=cr_item_sk)        WHERE i_category='Jewelry'        UNION        SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt              ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt        FROM store_sales JOIN item ON i_item_sk=ss_item_sk                         JOIN date_dim ON d_date_sk=ss_sold_date_sk                         LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number                                                  AND ss_item_sk=sr_item_sk)        WHERE i_category='Jewelry'        UNION        SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt              ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt        FROM web_sales JOIN item ON i_item_sk=ws_item_sk                       JOIN date_dim ON d_date_sk=ws_sold_date_sk                       LEFT JOIN web_returns ON (ws_order_number=wr_order_number                                              AND ws_item_sk=wr_item_sk)        WHERE i_category='Jewelry') sales_detail  GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)  SELECT top (100) prev_yr.d_year AS prev_year                           ,curr_yr.d_year AS year                           ,curr_yr.i_brand_id                           ,curr_yr.i_class_id                           ,curr_yr.i_category_id                           ,curr_yr.i_manufact_id                           ,prev_yr.sales_cnt AS prev_yr_cnt                           ,curr_yr.sales_cnt AS curr_yr_cnt                           ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff                           ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff  FROM all_sales curr_yr, all_sales prev_yr  WHERE curr_yr.i_brand_id=prev_yr.i_brand_id    AND curr_yr.i_class_id=prev_yr.i_class_id    AND curr_yr.i_category_id=prev_yr.i_category_id    AND curr_yr.i_manufact_id=prev_yr.i_manufact_id    AND curr_yr.d_year=2000    AND prev_yr.d_year=2000-1    AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9  ORDER BY sales_cnt_diff,sales_amt_diff  ;", "predicates": {"date_dim": ["d_year"], "item": ["i_category"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_quantity", "cr_return_amount"], "date_dim": ["d_date_sk", "d_year"], "item": ["i_class_id", "i_item_sk", "i_category_id", "i_brand_id", "i_manufact_id"], "store_returns": ["sr_return_amt", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_return_amt", "wr_return_quantity", "wr_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 76, "query_string": " select top (100) channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (         SELECT 'store' as channel, 'ss_hdemo_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price          FROM store_sales, item, date_dim          WHERE ss_hdemo_sk IS NULL            AND ss_sold_date_sk=d_date_sk            AND ss_item_sk=i_item_sk         UNION ALL         SELECT 'web' as channel, 'ws_warehouse_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price          FROM web_sales, item, date_dim          WHERE ws_warehouse_sk IS NULL            AND ws_sold_date_sk=d_date_sk            AND ws_item_sk=i_item_sk         UNION ALL         SELECT 'catalog' as channel, 'cs_ship_addr_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price          FROM catalog_sales, item, date_dim          WHERE cs_ship_addr_sk IS NULL            AND cs_sold_date_sk=d_date_sk            AND cs_item_sk=i_item_sk) foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category;", "predicates": {"catalog_sales": ["cs_ship_addr_sk"], "store_sales": ["ss_promo_sk"], "web_sales": ["ws_promo_sk"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_item_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_qoy", "d_year"], "item": ["i_item_sk", "i_category"], "store_sales": ["ss_sold_date_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 77, "query_string": " with ss as  (select s_store_sk,          sum(ss_ext_sales_price) as sales,          sum(ss_net_profit) as profit  from store_sales,       date_dim,       store  where ss_sold_date_sk = d_date_sk        and d_date between cast('2001-08-21' as date)                    and dateadd(day, 30, cast('2001-08-21' as date))         and ss_store_sk = s_store_sk  group by s_store_sk)  ,  sr as  (select s_store_sk,          sum(sr_return_amt) as returns,          sum(sr_net_loss) as profit_loss  from store_returns,       date_dim,       store  where sr_returned_date_sk = d_date_sk        and d_date between cast('2001-08-21' as date)                   and dateadd(day, 30, cast('2001-08-21' as date))        and sr_store_sk = s_store_sk  group by s_store_sk),   cs as  (select cs_call_center_sk,         sum(cs_ext_sales_price) as sales,         sum(cs_net_profit) as profit  from catalog_sales,       date_dim  where cs_sold_date_sk = d_date_sk        and d_date between cast('2001-08-21' as date)                   and dateadd(day, 30, cast('2001-08-21' as date))  group by cs_call_center_sk   ),   cr as  (select cr_call_center_sk,          sum(cr_return_amount) as returns,          sum(cr_net_loss) as profit_loss  from catalog_returns,       date_dim  where cr_returned_date_sk = d_date_sk        and d_date between cast('2001-08-21' as date)                   and dateadd(day, 30, cast('2001-08-21' as date))  group by cr_call_center_sk  ),   ws as  ( select wp_web_page_sk,         sum(ws_ext_sales_price) as sales,         sum(ws_net_profit) as profit  from web_sales,       date_dim,       web_page  where ws_sold_date_sk = d_date_sk        and d_date between cast('2001-08-21' as date)                   and dateadd(day, 30, cast('2001-08-21' as date))        and ws_web_page_sk = wp_web_page_sk  group by wp_web_page_sk),   wr as  (select wp_web_page_sk,         sum(wr_return_amt) as returns,         sum(wr_net_loss) as profit_loss  from web_returns,       date_dim,       web_page  where wr_returned_date_sk = d_date_sk        and d_date between cast('2001-08-21' as date)                   and dateadd(day, 30, cast('2001-08-21' as date))        and wr_web_page_sk = wp_web_page_sk  group by wp_web_page_sk)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , ss.s_store_sk as id         , sales         , coalesce(returns, 0) as returns         , (profit - coalesce(profit_loss,0)) as profit  from   ss left join sr         on  ss.s_store_sk = sr.s_store_sk  union all  select 'catalog channel' as channel         , cs_call_center_sk as id         , sales         , returns         , (profit - profit_loss) as profit  from  cs        , cr  union all  select 'web channel' as channel         , ws.wp_web_page_sk as id         , sales         , coalesce(returns, 0) returns         , (profit - coalesce(profit_loss,0)) as profit  from   ws left join wr         on  ws.wp_web_page_sk = wr.wp_web_page_sk  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_return_amount", "cr_call_center_sk"], "catalog_sales": ["cs_net_profit", "cs_sold_date_sk", "cs_call_center_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_net_loss"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit", "ss_ext_sales_price"], "web_page": ["wp_web_page_sk"], "web_returns": ["wr_web_page_sk", "wr_returned_date_sk", "wr_return_amt", "wr_net_loss"], "web_sales": ["ws_net_profit", "ws_ext_sales_price", "ws_web_page_sk", "ws_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 78, "query_string": " with ws as   (select d_year AS ws_sold_year, ws_item_sk,     ws_bill_customer_sk ws_customer_sk,     sum(ws_quantity) ws_qty,     sum(ws_wholesale_cost) ws_wc,     sum(ws_sales_price) ws_sp    from web_sales    left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk    join date_dim on ws_sold_date_sk = d_date_sk    where wr_order_number is null    group by d_year, ws_item_sk, ws_bill_customer_sk    ), cs as   (select d_year AS cs_sold_year, cs_item_sk,     cs_bill_customer_sk cs_customer_sk,     sum(cs_quantity) cs_qty,     sum(cs_wholesale_cost) cs_wc,     sum(cs_sales_price) cs_sp    from catalog_sales    left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk    join date_dim on cs_sold_date_sk = d_date_sk    where cr_order_number is null    group by d_year, cs_item_sk, cs_bill_customer_sk    ), ss as   (select d_year AS ss_sold_year, ss_item_sk,     ss_customer_sk,     sum(ss_quantity) ss_qty,     sum(ss_wholesale_cost) ss_wc,     sum(ss_sales_price) ss_sp    from store_sales    left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk    join date_dim on ss_sold_date_sk = d_date_sk    where sr_ticket_number is null    group by d_year, ss_item_sk, ss_customer_sk    )  select top (100) ss_item_sk, round(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk) where (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=1998 order by    ss_item_sk,   ss_qty desc, ss_wc desc, ss_sp desc,   other_chan_qty,   other_chan_wholesale_cost,   other_chan_sales_price,   ratio;", "predicates": {"catalog_returns": ["cr_order_number"], "catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_year"], "store_returns": ["sr_ticket_number"], "store_sales": ["ss_customer_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_bill_customer_sk"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "store_returns": ["sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_item_sk", "ss_sales_price", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_wholesale_cost", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 79, "query_string": " select top (100)   c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,store.s_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (household_demographics.hd_dep_count = 6 or household_demographics.hd_vehicle_count > 3)     and date_dim.d_dow = 1     and date_dim.d_year in (2000,2000+1,2000+2)      and store.s_number_employees between 200 and 295     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer     where ss_customer_sk = c_customer_sk  order by c_last_name,c_first_name,substring(s_city,1,30), profit;", "predicates": {"date_dim": ["d_dow", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_number_employees"]}, "payload": {"customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_city", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_addr_sk", "ss_customer_sk", "ss_ticket_number", "ss_coupon_amt", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {"customer": ["c_last_name", "c_first_name"]}}
{"id": 80, "query_string": " with ssr as  (select  s_store_id as store_id,           sum(ss_ext_sales_price) as sales,           sum(coalesce(sr_return_amt, 0)) as returns,           sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit   from store_sales left outer join store_returns on          (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),      date_dim,      store,      item,      promotion  where ss_sold_date_sk = d_date_sk        and d_date between cast('2001-08-21' as date)                    and dateadd(day, 30, cast('2001-08-21' as date))        and ss_store_sk = s_store_sk        and ss_item_sk = i_item_sk        and i_current_price > 50        and ss_promo_sk = p_promo_sk        and p_channel_tv = 'N'  group by s_store_id)  ,  csr as  (select  cp_catalog_page_id as catalog_page_id,           sum(cs_ext_sales_price) as sales,           sum(coalesce(cr_return_amount, 0)) as returns,           sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit   from catalog_sales left outer join catalog_returns on          (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),      date_dim,      catalog_page,      item,      promotion  where cs_sold_date_sk = d_date_sk        and d_date between cast('2001-08-21' as date)                   and dateadd(day, 30, cast('2001-08-21' as date))         and cs_catalog_page_sk = cp_catalog_page_sk        and cs_item_sk = i_item_sk        and i_current_price > 50        and cs_promo_sk = p_promo_sk        and p_channel_tv = 'N' group by cp_catalog_page_id)  ,  wsr as  (select  web_site_id,           sum(ws_ext_sales_price) as sales,           sum(coalesce(wr_return_amt, 0)) as returns,           sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit   from web_sales left outer join web_returns on          (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),      date_dim,      web_site,      item,      promotion  where ws_sold_date_sk = d_date_sk        and d_date between cast('2001-08-21' as date)                   and dateadd(day, 30, cast('2001-08-21' as date))         and ws_web_site_sk = web_site_sk        and ws_item_sk = i_item_sk        and i_current_price > 50        and ws_promo_sk = p_promo_sk        and p_channel_tv = 'N' group by web_site_id)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , concat('store' , store_id) as id         , sales         , returns         , profit  from   ssr  union all  select 'catalog channel' as channel         , concat('catalog_page' , catalog_page_id) as id         , sales         , returns         , profit  from  csr  union all  select 'web channel' as channel         , concat('web_site' , web_site_id) as id         , sales         , returns         , profit  from   wsr  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"], "promotion": ["p_channel_tv"]}, "payload": {"catalog_page": ["cp_catalog_page_sk", "cp_catalog_page_id"], "catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_amount", "cr_net_loss"], "date_dim": ["d_date_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"], "store": ["s_store_sk", "s_store_id"], "store_returns": ["sr_return_amt", "sr_net_loss", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_net_loss", "wr_return_amt", "wr_order_number"], "web_site": ["web_site_id", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 81, "query_string": " with customer_total_return as  (select cr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   \tsum(cr_return_amt_inc_tax) as ctr_total_return  from catalog_returns      ,date_dim      ,customer_address  where cr_returned_date_sk = d_date_sk     and d_year =2001    and cr_returning_addr_sk = ca_address_sk   group by cr_returning_customer_sk          ,ca_state )   select top (100) c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  \t\t\t  from customer_total_return ctr2                    \t  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'IA'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  ;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_year"]}, "payload": {"catalog_returns": ["cr_returned_date_sk", "cr_returning_customer_sk", "cr_return_amt_inc_tax", "cr_returning_addr_sk"], "customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_current_addr_sk", "c_customer_id"], "customer_address": ["ca_street_type", "ca_county", "ca_street_name", "ca_zip", "ca_street_number", "ca_city", "ca_state", "ca_gmt_offset", "ca_location_type", "ca_address_sk", "ca_suite_number", "ca_country"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer": ["c_salutation", "c_customer_id", "c_last_name", "c_first_name"], "customer_address": ["ca_street_type", "ca_county", "ca_street_name", "ca_zip", "ca_street_number", "ca_city", "ca_gmt_offset", "ca_location_type", "ca_suite_number", "ca_country"]}}
{"id": 82, "query_string": " select top (100) i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, store_sales  where i_current_price between 10 and 10+30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2000-03-02' as date) and dateadd(day, 60, cast('2000-03-02' as date))  and i_manufact_id in (472,889,998,72)  and inv_quantity_on_hand between 100 and 500  and ss_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  ;", "predicates": {"date_dim": ["d_date"], "inventory": ["inv_quantity_on_hand"], "item": ["i_current_price", "i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc", "i_current_price"]}, "group_by": {}, "order_by": {}}
{"id": 83, "query_string": " with sr_items as  (select i_item_id item_id,         sum(sr_return_quantity) sr_item_qty  from store_returns,       item,       date_dim  where sr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t  where d_date in ('2002-03-24','2002-08-05','2002-11-22')))  and   sr_returned_date_sk   = d_date_sk  group by i_item_id),  cr_items as  (select i_item_id item_id,         sum(cr_return_quantity) cr_item_qty  from catalog_returns,       item,       date_dim  where cr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t  where d_date in ('2002-03-24','2002-08-05','2002-11-22')))  and   cr_returned_date_sk   = d_date_sk  group by i_item_id),  wr_items as  (select i_item_id item_id,         sum(wr_return_quantity) wr_item_qty  from web_returns,       item,       date_dim  where wr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t\twhere d_date in ('2002-03-24','2002-08-05','2002-11-22')))  and   wr_returned_date_sk   = d_date_sk  group by i_item_id)   select top (100) sr_items.item_id        ,sr_item_qty        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev        ,cr_item_qty        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev        ,wr_item_qty        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average  from sr_items      ,cr_items      ,wr_items  where sr_items.item_id=cr_items.item_id    and sr_items.item_id=wr_items.item_id   order by sr_items.item_id          ,sr_item_qty  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_returned_date_sk", "cr_order_number", "cr_return_quantity"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "item": ["i_item_id", "i_item_sk"], "store_returns": ["sr_returned_date_sk", "sr_return_quantity", "sr_item_sk"], "web_returns": ["wr_item_sk", "wr_returned_date_sk", "wr_return_quantity"]}, "group_by": {}, "order_by": {}}
{"id": 84, "query_string": " select top (100) c_customer_id as customer_id        , concat(coalesce(c_last_name,'') , ', ' , coalesce(c_first_name,'')) as customername  from customer      ,customer_address      ,customer_demographics      ,household_demographics      ,income_band      ,store_returns  where ca_city\t        =  'Oakdale'    and c_current_addr_sk = ca_address_sk    and ib_lower_bound   >=  29920    and ib_upper_bound   <=  29920 + 50000    and ib_income_band_sk = hd_income_band_sk    and cd_demo_sk = c_current_cdemo_sk    and hd_demo_sk = c_current_hdemo_sk    and sr_cdemo_sk = cd_demo_sk  order by c_customer_id  ;", "predicates": {"customer": ["c_current_cdemo_sk"], "customer_address": ["ca_city"], "income_band": ["ib_upper_bound", "ib_lower_bound"]}, "payload": {"customer": ["c_last_name", "c_first_name", "c_current_cdemo_sk", "c_current_addr_sk", "c_customer_id", "c_current_hdemo_sk"], "customer_address": ["ca_address_sk"], "household_demographics": ["hd_income_band_sk", "hd_demo_sk"], "income_band": ["ib_income_band_sk"], "store_returns": ["sr_cdemo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 85, "query_string": " select top (100) substring(r_reason_desc,1,20)        ,avg(ws_quantity)        ,avg(wr_refunded_cash)        ,avg(wr_fee)  from web_sales, web_returns, web_page, customer_demographics cd1,       customer_demographics cd2, customer_address, date_dim, reason   where ws_web_page_sk = wp_web_page_sk    and ws_item_sk = wr_item_sk    and ws_order_number = wr_order_number    and ws_sold_date_sk = d_date_sk and d_year = 2002    and cd1.cd_demo_sk = wr_refunded_cdemo_sk     and cd2.cd_demo_sk = wr_returning_cdemo_sk    and ca_address_sk = wr_refunded_addr_sk    and r_reason_sk = wr_reason_sk    and    (     (      cd1.cd_marital_status = 'U'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Secondary'      and       cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 100.00 and 150.00     )    or     (      cd1.cd_marital_status = 'D'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Primary'       and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 50.00 and 100.00     )    or     (      cd1.cd_marital_status = 'W'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = '2 yr Degree'      and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 150.00 and 200.00     )    )    and    (     (      ca_country = 'United States'      and      ca_state in ('UT', 'OK', 'KS')      and ws_net_profit between 100 and 200       )     or     (      ca_country = 'United States'      and      ca_state in ('CA', 'WA', 'GA')      and ws_net_profit between 150 and 300       )     or     (      ca_country = 'United States'      and      ca_state in ('NC', 'AL', 'MS')      and ws_net_profit between 50 and 250       )    ) group by r_reason_desc order by substring(r_reason_desc,1,20)         ,avg(ws_quantity)         ,avg(wr_refunded_cash)         ,avg(wr_fee);", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "web_sales": ["ws_net_profit", "ws_sales_price"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "reason": ["r_reason_desc", "r_reason_sk"], "web_page": ["wp_web_page_sk"], "web_returns": ["wr_returning_cdemo_sk", "wr_refunded_cdemo_sk", "wr_reason_sk", "wr_item_sk", "wr_refunded_cash", "wr_refunded_addr_sk", "wr_fee", "wr_order_number"], "web_sales": ["ws_net_profit", "ws_item_sk", "ws_sales_price", "ws_quantity", "ws_sold_date_sk", "ws_web_page_sk", "ws_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 86, "query_string": " select top (100)       sum(ws_net_paid) as total_sum    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  \tpartition by grouping(i_category)+grouping(i_class),  \tcase when grouping(i_class) = 0 then i_category end   \torder by sum(ws_net_paid) desc) as rank_within_parent  from     web_sales    ,date_dim       d1    ,item  where     d1.d_month_seq between 1191 and 1191+11  and d1.d_date_sk = ws_sold_date_sk  and i_item_sk  = ws_item_sk  group by rollup(i_category,i_class)  order by    lochierarchy desc,    case when (grouping(i_category)+grouping(i_class)) = 0 then i_category end,    rank_within_parent  ;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_class", "i_item_sk", "i_category"], "web_sales": ["ws_net_paid", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 87, "query_string": " select count(*)  from ((select distinct c_last_name, c_first_name, d_date        from store_sales, date_dim, customer        where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_customer_sk = customer.c_customer_sk          and d_month_seq between 1191 and 1191+11)        except       (select distinct c_last_name, c_first_name, d_date        from catalog_sales, date_dim, customer        where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk          and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk          and d_month_seq between 1191 and 1191+11)        except       (select distinct c_last_name, c_first_name, d_date        from web_sales, date_dim, customer        where web_sales.ws_sold_date_sk = date_dim.d_date_sk          and web_sales.ws_bill_customer_sk = customer.c_customer_sk          and d_month_seq between 1191 and 1191+11) ) cool_cust;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 88, "query_string": " select  * from  (select count(*) h8_30_to_9  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk         and ss_hdemo_sk = household_demographics.hd_demo_sk       and ss_store_sk = s_store_sk      and time_dim.t_hour = 8      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))       and store.s_store_name = 'ese') s1,  (select count(*) h9_to_9_30   from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk       and time_dim.t_hour = 9       and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))      and store.s_store_name = 'ese') s2,  (select count(*) h9_30_to_10   from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 9      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))      and store.s_store_name = 'ese') s3,  (select count(*) h10_to_10_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 10       and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))      and store.s_store_name = 'ese') s4,  (select count(*) h10_30_to_11  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 10       and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))      and store.s_store_name = 'ese') s5,  (select count(*) h11_to_11_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk       and time_dim.t_hour = 11      and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))      and store.s_store_name = 'ese') s6,  (select count(*) h11_30_to_12  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 11      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))      and store.s_store_name = 'ese') s7,  (select count(*) h12_to_12_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 12      and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))      and store.s_store_name = 'ese') s8;", "predicates": {"household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_store_name"], "time_dim": ["t_hour", "t_minute"]}, "payload": {"household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_sold_time_sk"], "time_dim": ["t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 89, "query_string": " select top (100) * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (1999) and         ((i_category in ('Home','Children','Music') and           i_class in ('flatware','infants','pop')          )       or (i_category in ('Women','Electronics','Shoes') and           i_class in ('swimwear','dvd/vcr players','kids')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name;", "predicates": {"date_dim": ["d_year"], "item": ["i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_brand", "i_class", "i_item_sk", "i_category"], "store": ["s_store_name", "s_store_sk", "s_company_name"]}, "group_by": {}, "order_by": {"store": ["s_store_name"]}}
{"id": 90, "query_string": " select top (100) cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio  from ( select count(*) amc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 12 and 12+1          and household_demographics.hd_dep_count = 6          and web_page.wp_char_count between 5000 and 5200) at,       ( select count(*) pmc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 20 and 20+1          and household_demographics.hd_dep_count = 6          and web_page.wp_char_count between 5000 and 5200) pt  order by am_pm_ratio  ;", "predicates": {"household_demographics": ["hd_dep_count"], "time_dim": ["t_hour"], "web_page": ["wp_char_count"]}, "payload": {"household_demographics": ["hd_demo_sk"], "time_dim": ["t_time_sk"], "web_page": ["wp_web_page_sk"], "web_sales": ["ws_sold_time_sk", "ws_web_page_sk", "ws_ship_hdemo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 91, "query_string": " select           cc_call_center_id Call_Center,         cc_name Call_Center_Name,         cc_manager Manager,         sum(cr_net_loss) Returns_Loss from         call_center,         catalog_returns,         date_dim,         customer,         customer_address,         customer_demographics,         household_demographics where         cr_call_center_sk       = cc_call_center_sk and     cr_returned_date_sk     = d_date_sk and     cr_returning_customer_sk= c_customer_sk and     cd_demo_sk              = c_current_cdemo_sk and     hd_demo_sk              = c_current_hdemo_sk and     ca_address_sk           = c_current_addr_sk and     d_year                  = 2002  and     d_moy                   = 12 and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')         or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree')) and     hd_buy_potential like 'Unknown%' and     ca_gmt_offset           = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc;", "predicates": {"customer_address": ["ca_gmt_offset"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_moy", "d_year"], "household_demographics": ["hd_buy_potential"]}, "payload": {"call_center": ["cc_name", "cc_call_center_id", "cc_manager", "cc_call_center_sk"], "catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_returning_customer_sk", "cr_call_center_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk", "c_current_hdemo_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 92, "query_string": " select top (100)     sum(ws_ext_discount_amt)  as \"Excess Discount Amount\"  from      web_sales     ,item     ,date_dim where i_manufact_id = 337 and i_item_sk = ws_item_sk  and d_date between '2002-03-15' and          dateadd(day, 90, cast('2002-03-15' as date)) and d_date_sk = ws_sold_date_sk  and ws_ext_discount_amt        > (           SELECT              1.3 * avg(ws_ext_discount_amt)           FROM              web_sales             ,date_dim          WHERE                ws_item_sk = i_item_sk            and d_date between '2002-03-15' and                              dateadd(day, 90, cast('2002-03-15' as date))           and d_date_sk = ws_sold_date_sk        )  order by sum(ws_ext_discount_amt);", "predicates": {"date_dim": ["d_date"], "item": ["i_manufact_id"], "web_sales": ["ws_ext_discount_amt"]}, "payload": {"item": ["i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 93, "query_string": " select top (100) ss_customer_sk             ,sum(act_sales) sumsales       from (select ss_item_sk                   ,ss_ticket_number                   ,ss_customer_sk                   ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price                                                             else (ss_quantity*ss_sales_price) end act_sales             from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk                                                                and sr_ticket_number = ss_ticket_number)                 ,reason             where sr_reason_sk = r_reason_sk               and r_reason_desc = 'reason 71') t       group by ss_customer_sk       order by sumsales, ss_customer_sk;", "predicates": {"reason": ["r_reason_desc"]}, "payload": {"reason": ["r_reason_sk"], "store_returns": ["sr_reason_sk", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"]}, "group_by": {}, "order_by": {"store_sales": ["ss_customer_sk"]}}
{"id": 94, "query_string": " select top (100)     count(distinct ws_order_number) as \"order count\"   ,sum(ws_ext_ship_cost) as \"total shipping cost\"   ,sum(ws_net_profit) as \"total net profit\" from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '1999-4-01' and             dateadd(day, 60, cast('1999-4-01' as date)) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'DC' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number);", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_date"], "web_site": ["web_company_name"]}, "payload": {"customer_address": ["ca_address_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_net_profit", "ws_ship_date_sk", "ws_ship_addr_sk", "ws_ext_ship_cost", "ws_warehouse_sk", "ws_order_number", "ws_web_site_sk"], "web_site": ["web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 95, "query_string": " with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select top (100)     count(distinct ws_order_number) as \"order count\"   ,sum(ws_ext_ship_cost) as \"total shipping cost\"   ,sum(ws_net_profit) as \"total net profit\" from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '1999-4-01' and             dateadd(day, 60, cast('1999-4-01' as date)) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'DC' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number);", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_date"], "web_site": ["web_company_name"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_net_profit", "ws_ship_date_sk", "ws_item_sk", "ws_ship_addr_sk", "ws_ext_ship_cost", "ws_warehouse_sk", "ws_order_number", "ws_web_site_sk"], "web_site": ["web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 96, "query_string": " select top (100) count(*)  from store_sales     ,household_demographics      ,time_dim, store where ss_sold_time_sk = time_dim.t_time_sk        and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk     and time_dim.t_hour = 15     and time_dim.t_minute >= 30     and household_demographics.hd_dep_count = 3     and store.s_store_name = 'ese' order by count(*);", "predicates": {"household_demographics": ["hd_dep_count"], "store": ["s_store_name"], "time_dim": ["t_hour", "t_minute"]}, "payload": {"household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_sold_time_sk"], "time_dim": ["t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 97, "query_string": " with ssci as ( select ss_customer_sk customer_sk       ,ss_item_sk item_sk from store_sales,date_dim where ss_sold_date_sk = d_date_sk   and d_month_seq between 1191 and 1191 + 11 group by ss_customer_sk         ,ss_item_sk), csci as(  select cs_bill_customer_sk customer_sk       ,cs_item_sk item_sk from catalog_sales,date_dim where cs_sold_date_sk = d_date_sk   and d_month_seq between 1191 and 1191 + 11 group by cs_bill_customer_sk         ,cs_item_sk)  select top (100) sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only       ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only       ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk                                and ssci.item_sk = csci.item_sk);", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk", "cs_item_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 98, "query_string": " select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from\t \tstore_sales     \t,item      \t,date_dim where  \tss_item_sk = i_item_sk    \tand i_category in ('Music', 'Books', 'Women')   \tand ss_sold_date_sk = d_date_sk \tand d_date between cast('2002-05-24' as date)  \t\t\t\tand dateadd(day, 30, cast('2002-05-24' as date)) group by  \ti_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  \ti_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"]}, "group_by": {}, "order_by": {}}
{"id": 99, "query_string": " select top (100)     substring(w_warehouse_name,1,20)   ,sm_type   ,cc_name   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and                   (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and                   (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and                  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    catalog_sales   ,warehouse   ,ship_mode   ,call_center   ,date_dim where     d_month_seq between 1191 and 1191 + 11 and cs_ship_date_sk   = d_date_sk and cs_warehouse_sk   = w_warehouse_sk and cs_ship_mode_sk   = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by    substring(w_warehouse_name,1,20)   ,sm_type   ,cc_name order by substring(w_warehouse_name,1,20)         ,sm_type         ,cc_name;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"call_center": ["cc_name", "cc_call_center_sk"], "catalog_sales": ["cs_warehouse_sk", "cs_call_center_sk", "cs_ship_date_sk", "cs_ship_mode_sk", "cs_sold_date_sk"], "date_dim": ["d_date_sk"], "ship_mode": ["sm_type", "sm_ship_mode_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 1, "query_string": " with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sum(SR_RETURN_AMT) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1998 group by sr_customer_sk ,sr_store_sk)  select top (100) c_customer_id from customer_total_return ctr1 ,store ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'TN' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id;", "predicates": {"date_dim": ["d_year"], "store": ["s_state"], "store_returns": ["sr_store_sk"]}, "payload": {"customer": ["c_customer_id", "c_customer_sk"], "date_dim": ["d_date_sk"], "store": ["s_store_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_customer_id"]}}
{"id": 2, "query_string": " with wscs as  (select sold_date_sk         ,sales_price   from (select ws_sold_date_sk sold_date_sk               ,ws_ext_sales_price sales_price         from web_sales          union all         select cs_sold_date_sk sold_date_sk               ,cs_ext_sales_price sales_price         from catalog_sales) a),  wswscs as   (select d_week_seq,         sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales  from wscs      ,date_dim  where d_date_sk = sold_date_sk  group by d_week_seq)  select d_week_seq1        ,round(sun_sales1/sun_sales2,2)        ,round(mon_sales1/mon_sales2,2)        ,round(tue_sales1/tue_sales2,2)        ,round(wed_sales1/wed_sales2,2)        ,round(thu_sales1/thu_sales2,2)        ,round(fri_sales1/fri_sales2,2)        ,round(sat_sales1/sat_sales2,2)  from  (select wswscs.d_week_seq d_week_seq1         ,sun_sales sun_sales1         ,mon_sales mon_sales1         ,tue_sales tue_sales1         ,wed_sales wed_sales1         ,thu_sales thu_sales1         ,fri_sales fri_sales1         ,sat_sales sat_sales1   from wswscs,date_dim    where date_dim.d_week_seq = wswscs.d_week_seq and         d_year = 2000) y,  (select wswscs.d_week_seq d_week_seq2         ,sun_sales sun_sales2         ,mon_sales mon_sales2         ,tue_sales tue_sales2         ,wed_sales wed_sales2         ,thu_sales thu_sales2         ,fri_sales fri_sales2         ,sat_sales sat_sales2   from wswscs       ,date_dim    where date_dim.d_week_seq = wswscs.d_week_seq and         d_year = 2000+1) z  where d_week_seq1=d_week_seq2-53  order by d_week_seq1;", "predicates": {"date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_week_seq", "d_day_name"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 3, "query_string": " select top (100) dt.d_year         ,item.i_brand_id brand_id         ,item.i_brand brand        ,sum(ss_sales_price) sum_agg  from  date_dim dt        ,store_sales       ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk    and store_sales.ss_item_sk = item.i_item_sk    and item.i_manufact_id = 322    and dt.d_moy=11  group by dt.d_year       ,item.i_brand       ,item.i_brand_id  order by dt.d_year          ,sum_agg desc          ,brand_id  ;", "predicates": {"date_dim": ["d_moy"], "item": ["i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"date_dim": ["d_year"], "item": ["i_brand_id"]}}
{"id": 4, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year  union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total        ,'c' sale_type  from customer      ,catalog_sales      ,date_dim  where c_customer_sk = cs_bill_customer_sk    and cs_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year          )   select top (100)                    t_s_secyear.customer_id                  ,t_s_secyear.customer_first_name                  ,t_s_secyear.customer_last_name                  ,t_s_secyear.customer_login  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_c_firstyear      ,year_total t_c_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id    and t_s_firstyear.customer_id = t_c_secyear.customer_id    and t_s_firstyear.customer_id = t_c_firstyear.customer_id    and t_s_firstyear.customer_id = t_w_firstyear.customer_id    and t_s_firstyear.customer_id = t_w_secyear.customer_id    and t_s_firstyear.sale_type = 's'    and t_c_firstyear.sale_type = 'c'    and t_w_firstyear.sale_type = 'w'    and t_s_secyear.sale_type = 's'    and t_c_secyear.sale_type = 'c'    and t_w_secyear.sale_type = 'w'    and t_s_firstyear.dyear =  2000    and t_s_secyear.dyear = 2000+1    and t_c_firstyear.dyear =  2000    and t_c_secyear.dyear =  2000+1    and t_w_firstyear.dyear = 2000    and t_w_secyear.dyear = 2000+1    and t_s_firstyear.year_total > 0    and t_c_firstyear.year_total > 0    and t_w_firstyear.year_total > 0    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end            > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end  order by t_s_secyear.customer_id          ,t_s_secyear.customer_first_name          ,t_s_secyear.customer_last_name          ,t_s_secyear.customer_login;", "predicates": {"date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_ext_list_price", "cs_ext_discount_amt", "cs_bill_customer_sk", "cs_ext_sales_price", "cs_ext_wholesale_cost", "cs_sold_date_sk"], "customer": ["c_login", "c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id"], "date_dim": ["d_date_sk"], "store_sales": ["ss_ext_discount_amt", "ss_ext_sales_price", "ss_ext_wholesale_cost", "ss_customer_sk", "ss_ext_list_price", "ss_sold_date_sk"], "web_sales": ["ws_ext_discount_amt", "ws_ext_wholesale_cost", "ws_ext_list_price", "ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 5, "query_string": " with ssr as  (select s_store_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  ss_store_sk as store_sk,             ss_sold_date_sk  as date_sk,             ss_ext_sales_price as sales_price,             ss_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from store_sales     union all     select sr_store_sk as store_sk,            sr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            sr_return_amt as return_amt,            sr_net_loss as net_loss     from store_returns    ) salesreturns,      date_dim,      store  where date_sk = d_date_sk        and d_date between cast('2000-08-28' as date)                    and dateadd(day, 14, cast('2000-08-28' as date))        and store_sk = s_store_sk  group by s_store_id)  ,  csr as  (select cp_catalog_page_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  cs_catalog_page_sk as page_sk,             cs_sold_date_sk  as date_sk,             cs_ext_sales_price as sales_price,             cs_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from catalog_sales     union all     select cr_catalog_page_sk as page_sk,            cr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            cr_return_amount as return_amt,            cr_net_loss as net_loss     from catalog_returns    ) salesreturns,      date_dim,      catalog_page  where date_sk = d_date_sk        and d_date between cast('2000-08-28' as date)                   and dateadd(day, 14, cast('2000-08-28' as date))        and page_sk = cp_catalog_page_sk  group by cp_catalog_page_id)  ,  wsr as  (select web_site_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  ws_web_site_sk as wsr_web_site_sk,             ws_sold_date_sk  as date_sk,             ws_ext_sales_price as sales_price,             ws_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from web_sales     union all     select ws_web_site_sk as wsr_web_site_sk,            wr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            wr_return_amt as return_amt,            wr_net_loss as net_loss     from web_returns left outer join web_sales on          ( wr_item_sk = ws_item_sk            and wr_order_number = ws_order_number)    ) salesreturns,      date_dim,      web_site  where date_sk = d_date_sk        and d_date between cast('2000-08-28' as date)                   and dateadd(day, 14, cast('2000-08-28' as date))        and wsr_web_site_sk = web_site_sk  group by web_site_id)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , concat('store' , s_store_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from   ssr  union all  select 'catalog channel' as channel         , concat('catalog_page' , cp_catalog_page_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from  csr  union all  select 'web channel' as channel         , concat('web_site' , web_site_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from   wsr  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_page": ["cp_catalog_page_sk", "cp_catalog_page_id"], "catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_return_amount", "cr_catalog_page_sk"], "catalog_sales": ["cs_catalog_page_sk", "cs_net_profit", "cs_sold_date_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_net_loss"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit", "ss_ext_sales_price"], "web_returns": ["wr_returned_date_sk", "wr_return_amt", "wr_net_loss", "wr_item_sk", "wr_order_number"], "web_sales": ["ws_net_profit", "ws_ext_sales_price", "ws_sold_date_sk", "ws_web_site_sk"], "web_site": ["web_site_id", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 6, "query_string": " select top (100) a.ca_state state, count(*) cnt  from customer_address a      ,customer c      ,store_sales s      ,date_dim d      ,item i  where       a.ca_address_sk = c.c_current_addr_sk  \tand c.c_customer_sk = s.ss_customer_sk  \tand s.ss_sold_date_sk = d.d_date_sk  \tand s.ss_item_sk = i.i_item_sk  \tand d.d_month_seq =   \t     (select distinct (d_month_seq)  \t      from date_dim                where d_year = 2000  \t        and d_moy = 5 )  \tand i.i_current_price > 1.2 *               (select avg(j.i_current_price)   \t     from item j   \t     where j.i_category = i.i_category)  group by a.ca_state  having count(*) >= 10  order by cnt, a.ca_state   ;", "predicates": {"date_dim": ["d_month_seq", "d_moy", "d_year"], "item": ["i_category", "i_current_price"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk", "d_month_seq"], "item": ["i_item_sk", "i_category", "i_current_price"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_item_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_state"]}}
{"id": 7, "query_string": " select top (100) i_item_id,          avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4   from store_sales, customer_demographics, date_dim, item, promotion  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_cdemo_sk = cd_demo_sk and        ss_promo_sk = p_promo_sk and        cd_gender = 'M' and         cd_marital_status = 'U' and        cd_education_status = 'Secondary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 1998   group by i_item_id  order by i_item_id  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "promotion": ["p_channel_event", "p_channel_email"]}, "payload": {"customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"], "promotion": ["p_promo_sk"], "store_sales": ["ss_promo_sk", "ss_item_sk", "ss_cdemo_sk", "ss_list_price", "ss_quantity", "ss_sales_price", "ss_coupon_amt", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 8, "query_string": " select top (100) s_store_name       ,sum(ss_net_profit)  from store_sales      ,date_dim      ,store,      (select ca_zip      from (       SELECT substring(ca_zip,1,5) ca_zip       FROM customer_address       WHERE substring(ca_zip,1,5) IN (                           '43849','53604','91686','78328','88509','26941',                           '55884','68681','66980','52943','74881',                           '93635','92987','99487','52939','47400',                           '81757','43060','45308','36449','32711',                           '96874','68294','78030','97121','47088',                           '36448','31961','90682','21237','91552',                           '21308','82080','30690','86403','41347',                           '52918','37336','54295','32248','34257',                           '96062','31740','23760','78887','21502',                           '17565','31376','74146','75242','52509',                           '89421','41366','62608','89859','26539',                           '29587','43393','10598','34782','90888',                           '60258','64603','84122','11867','40400',                           '35296','35361','25134','11642','51261',                           '51878','93656','28534','65583','47913',                           '51725','90393','32359','66159','58705',                           '94821','47743','31719','55986','67839',                           '85048','37798','85599','45582','80561',                           '47207','38297','35629','33703','58169',                           '58505','92071','48699','39631','24770',                           '99627','69216','83600','55314','80600',                           '26354','56119','51127','58697','68107',                           '58778','46144','64194','74545','82892',                           '77993','84997','67612','27672','38254',                           '18644','15175','19807','64315','39007',                           '98309','19767','15222','69977','58235',                           '90335','67109','22920','43940','81173',                           '25942','33513','99251','61333','67221',                           '43374','72531','23018','64747','67461',                           '90193','39705','87791','27403','59913',                           '76453','51701','65436','93524','12390',                           '83705','79935','45788','19558','35916',                           '54003','37756','40166','30706','39000',                           '53216','50141','57082','63014','91415',                           '98457','97840','93544','13998','41569',                           '83015','50622','42852','20122','15587',                           '52562','25855','41282','69654','18596',                           '66356','17678','54039','21073','31387',                           '92993','94833','28772','15903','97855',                           '64458','85736','83569','34676','12891',                           '39965','57088','72152','32801','90715',                           '45806','25897','83097','41102','55850',                           '37385','80777','39816','57652','83725',                           '51891','26086','47955','91485','75112',                           '84586','95003','23385','19753','48348',                           '52379','38672','57567','34121','84357',                           '61494','38313','25414','45000','91070',                           '14777','57098','79639','54793','29310',                           '47014','28153','23482','16430','85116',                           '27394','91011','94341','93841','31206',                           '46636','55727','64428','47137','96472',                           '31786','65209','60894','15490','68085',                           '53064','73174','86006','83710','95554',                           '65469','67883','39368','76812','73364',                           '28995','28719','76688','95165','95771',                           '85158','78872','67503','89439','54535',                           '51951','97401','71395','54614','74741',                           '39063','48388','76724','19959','52268',                           '11361','20825','72692','47279','40619',                           '70537','91304','96159','96134','69303',                           '27256','93135','43186','61975','55640',                           '65064','34128','78211','83369','11106',                           '25774','61249','82169','11203','19705',                           '41439','58959','78427','35438','52157',                           '34550','35626','58712','40466','92950',                           '86364','33254','51078','24957','41530',                           '76135','84372','34882','69054','50655',                           '53906','86034','44019','16055','36560',                           '85694','67125','39234','94593','37639',                           '78500','62678','82363','39499','44392',                           '48775','97287','61787','50800','20183',                           '95558','22975','59594','40203','65481',                           '70378','96933','76406','42260','41399',                           '14651','60259','97156','52605','20046',                           '79941','30710','58954','77070','40851',                           '38106','13774','72994','11526','26715',                           '31454','18510','99146','70438','98816',                           '81327','56302','94928','14515','39256',                           '77837','69562','79803','30343','17800',                           '16015','55472','49750','36548')      intersect       select ca_zip       from (SELECT substring(ca_zip,1,5) ca_zip,count(*) cnt             FROM customer_address, customer             WHERE ca_address_sk = c_current_addr_sk and                   c_preferred_cust_flag='Y'             group by ca_zip             having count(*) > 10)A1)A2) V1  where ss_store_sk = s_store_sk   and ss_sold_date_sk = d_date_sk   and d_qoy = 1 and d_year = 2002   and (substring(s_zip,1,2) = substring(V1.ca_zip,1,2))  group by s_store_name  order by s_store_name  ;", "predicates": {"customer": ["c_preferred_cust_flag"], "date_dim": ["d_qoy", "d_year"]}, "payload": {"customer": ["c_current_addr_sk"], "customer_address": ["ca_address_sk", "ca_zip"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 9, "query_string": " select case when (select count(*)                    from store_sales                    where ss_quantity between 1 and 20) > 14719             then (select avg(ss_ext_list_price)                    from store_sales                    where ss_quantity between 1 and 20)              else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 1 and 20) end bucket1 ,        case when (select count(*)                   from store_sales                   where ss_quantity between 21 and 40) > 22027             then (select avg(ss_ext_list_price)                   from store_sales                   where ss_quantity between 21 and 40)              else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 21 and 40) end bucket2,        case when (select count(*)                   from store_sales                   where ss_quantity between 41 and 60) > 33651             then (select avg(ss_ext_list_price)                   from store_sales                   where ss_quantity between 41 and 60)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 41 and 60) end bucket3,        case when (select count(*)                   from store_sales                   where ss_quantity between 61 and 80) > 26842             then (select avg(ss_ext_list_price)                   from store_sales                   where ss_quantity between 61 and 80)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 61 and 80) end bucket4,        case when (select count(*)                   from store_sales                   where ss_quantity between 81 and 100) > 14671             then (select avg(ss_ext_list_price)                   from store_sales                   where ss_quantity between 81 and 100)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 81 and 100) end bucket5 from reason where r_reason_sk = 1;", "predicates": {"store_sales": ["ss_quantity"]}, "payload": {"store_sales": ["ss_ext_tax", "ss_net_paid_inc_tax"]}, "group_by": {}, "order_by": {}}
{"id": 10, "query_string": " select top (100)    cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3,   cd_dep_count,   count(*) cnt4,   cd_dep_employed_count,   count(*) cnt5,   cd_dep_college_count,   count(*) cnt6  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_county in ('Butte County','Grayson County','McPherson County','Lincoln County','Clark County') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2000 and                 d_moy between 2 and 2+3) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2000 and                   d_moy between 2 ANd 2+3) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2000 and                   d_moy between 2 and 2+3))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count;", "predicates": {"customer_address": ["ca_county"], "date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 11, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag           ,c_birth_country          ,c_login          ,c_email_address          ,d_year   union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag           ,c_birth_country          ,c_login          ,c_email_address          ,d_year          )   select top (100)                    t_s_secyear.customer_id                  ,t_s_secyear.customer_first_name                  ,t_s_secyear.customer_last_name                  ,t_s_secyear.customer_login  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id          and t_s_firstyear.customer_id = t_w_secyear.customer_id          and t_s_firstyear.customer_id = t_w_firstyear.customer_id          and t_s_firstyear.sale_type = 's'          and t_w_firstyear.sale_type = 'w'          and t_s_secyear.sale_type = 's'          and t_w_secyear.sale_type = 'w'          and t_s_firstyear.dyear = 2000          and t_s_secyear.dyear = 2000+1          and t_w_firstyear.dyear = 2000          and t_w_secyear.dyear = 2000+1          and t_s_firstyear.year_total > 0          and t_w_firstyear.year_total > 0          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end              > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end  order by t_s_secyear.customer_id          ,t_s_secyear.customer_first_name          ,t_s_secyear.customer_last_name          ,t_s_secyear.customer_login;", "predicates": {"date_dim": ["d_year"]}, "payload": {"customer": ["c_login", "c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_ext_list_price", "ss_ext_discount_amt"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_discount_amt", "ws_ext_list_price"]}, "group_by": {}, "order_by": {}}
{"id": 12, "query_string": " select top (100) i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from\t \tweb_sales     \t,item      \t,date_dim where  \tws_item_sk = i_item_sk    \tand i_category in ('Shoes', 'Books', 'Electronics')   \tand ws_sold_date_sk = d_date_sk \tand d_date between cast('2001-06-25' as date)  \t\t\t\tand dateadd(day, 30, cast('2001-06-25' as date)) group by  \ti_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  \ti_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_desc", "i_class", "i_item_id", "i_category"]}}
{"id": 13, "query_string": " select avg(ss_quantity)        ,avg(ss_ext_sales_price)        ,avg(ss_ext_wholesale_cost)        ,sum(ss_ext_wholesale_cost)  from store_sales      ,store      ,customer_demographics      ,household_demographics      ,customer_address      ,date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2001  and((ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'D'   and cd_education_status = 'Unknown'   and ss_sales_price between 100.00 and 150.00   and hd_dep_count = 3         )or      (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'W'   and cd_education_status = 'Advanced Degree'   and ss_sales_price between 50.00 and 100.00      and hd_dep_count = 1      ) or       (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'U'   and cd_education_status = '2 yr Degree'   and ss_sales_price between 150.00 and 200.00    and hd_dep_count = 1        ))  and((ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('LA', 'WA', 'AL')   and ss_net_profit between 100 and 200        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('OK', 'OH', 'NY')   and ss_net_profit between 150 and 300        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('TX', 'MN', 'MT')   and ss_net_profit between 50 and 250        ));", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "household_demographics": ["hd_dep_count"], "store_sales": ["ss_sales_price", "ss_net_profit"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_dep_count", "hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_ext_sales_price", "ss_cdemo_sk", "ss_addr_sk", "ss_quantity", "ss_sales_price", "ss_ext_wholesale_cost", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 14, "query_string": " with  cross_items as  (select i_item_sk ss_item_sk  from item,  (select iss.i_brand_id brand_id      ,iss.i_class_id class_id      ,iss.i_category_id category_id  from store_sales      ,item iss      ,date_dim d1  where ss_item_sk = iss.i_item_sk    and ss_sold_date_sk = d1.d_date_sk    and d1.d_year between 1998 AND 1998 + 2  intersect   select ics.i_brand_id      ,ics.i_class_id      ,ics.i_category_id  from catalog_sales      ,item ics      ,date_dim d2  where cs_item_sk = ics.i_item_sk    and cs_sold_date_sk = d2.d_date_sk    and d2.d_year between 1998 AND 1998 + 2  intersect  select iws.i_brand_id      ,iws.i_class_id      ,iws.i_category_id  from web_sales      ,item iws      ,date_dim d3  where ws_item_sk = iws.i_item_sk    and ws_sold_date_sk = d3.d_date_sk    and d3.d_year between 1998 AND 1998 + 2) a  where i_brand_id = brand_id       and i_class_id = class_id       and i_category_id = category_id ),  avg_sales as  (select avg(quantity*list_price) average_sales   from (select ss_quantity quantity              ,ss_list_price list_price        from store_sales            ,date_dim        where ss_sold_date_sk = d_date_sk          and d_year between 1998 and 1998 + 2        union all         select cs_quantity quantity               ,cs_list_price list_price        from catalog_sales            ,date_dim        where cs_sold_date_sk = d_date_sk          and d_year between 1998 and 1998 + 2         union all        select ws_quantity quantity              ,ws_list_price list_price        from web_sales            ,date_dim        where ws_sold_date_sk = d_date_sk          and d_year between 1998 and 1998 + 2) x)   select top (100) channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)  from(        select 'store' channel, i_brand_id,i_class_id              ,i_category_id,sum(ss_quantity*ss_list_price) sales              , count(*) number_sales        from store_sales            ,item            ,date_dim        where ss_item_sk in (select ss_item_sk from cross_items)          and ss_item_sk = i_item_sk          and ss_sold_date_sk = d_date_sk          and d_year = 1998+2           and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)        union all        select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales        from catalog_sales            ,item            ,date_dim        where cs_item_sk in (select ss_item_sk from cross_items)          and cs_item_sk = i_item_sk          and cs_sold_date_sk = d_date_sk          and d_year = 1998+2           and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)        union all        select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales        from web_sales            ,item            ,date_dim        where ws_item_sk in (select ss_item_sk from cross_items)          and ws_item_sk = i_item_sk          and ws_sold_date_sk = d_date_sk          and d_year = 1998+2          and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)  ) y  group by rollup (channel, i_brand_id,i_class_id,i_category_id)  order by channel,i_brand_id,i_class_id,i_category_id  ; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_list_price", "cs_quantity"], "date_dim": ["d_date_sk"], "item": ["i_category_id", "i_class_id", "i_item_sk", "i_brand_id"], "store_sales": ["ss_sold_date_sk", "ss_list_price", "ss_quantity", "ss_item_sk"], "web_sales": ["ws_list_price", "ws_sold_date_sk", "ws_item_sk", "ws_quantity"]}, "group_by": {}, "order_by": {}}
{"id": 15, "query_string": " select top (100) ca_zip        ,sum(cs_sales_price)  from catalog_sales      ,customer      ,customer_address      ,date_dim  where cs_bill_customer_sk = c_customer_sk  \tand c_current_addr_sk = ca_address_sk   \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',                                    '85392', '85460', '80348', '81792')  \t      or ca_state in ('CA','WA','GA')  \t      or cs_sales_price > 500)  \tand cs_sold_date_sk = d_date_sk  \tand d_qoy = 1 and d_year = 2000  group by ca_zip  order by ca_zip  ;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"catalog_sales": ["cs_sales_price", "cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip", "ca_state"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_zip"]}}
{"id": 16, "query_string": " select top (100)     count(distinct cs_order_number) as \"order count\"   ,sum(cs_ext_ship_cost) as \"total shipping cost\"   ,sum(cs_net_profit) as \"total net profit\" from    catalog_sales cs1   ,date_dim   ,customer_address   ,call_center where     d_date between '1999-5-01' and             dateadd(day, 60, cast('1999-5-01' as date)) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'IA' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County',                   'Williamson County' ) and exists (select *             from catalog_sales cs2             where cs1.cs_order_number = cs2.cs_order_number               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select *                from catalog_returns cr1                where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number);", "predicates": {"call_center": ["cc_county"], "customer_address": ["ca_state"], "date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_order_number"], "catalog_sales": ["cs_order_number", "cs_warehouse_sk", "cs_ext_ship_cost", "cs_ship_addr_sk", "cs_net_profit", "cs_call_center_sk", "cs_ship_date_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 17, "query_string": " select top (100) i_item_id        ,i_item_desc        ,s_state        ,count(ss_quantity) as store_sales_quantitycount        ,avg(ss_quantity) as store_sales_quantityave        ,stdev(ss_quantity) as store_sales_quantitystdev        ,stdev(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov        ,count(sr_return_quantity) as store_returns_quantitycount        ,avg(sr_return_quantity) as store_returns_quantityave        ,stdev(sr_return_quantity) as store_returns_quantitystdev        ,stdev(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov        ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave        ,stdev(cs_quantity) as catalog_sales_quantitystdev        ,stdev(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov  from store_sales      ,store_returns      ,catalog_sales      ,date_dim d1      ,date_dim d2      ,date_dim d3      ,store      ,item  where d1.d_quarter_name = '1998Q1'    and d1.d_date_sk = ss_sold_date_sk    and i_item_sk = ss_item_sk    and s_store_sk = ss_store_sk    and ss_customer_sk = sr_customer_sk    and ss_item_sk = sr_item_sk    and ss_ticket_number = sr_ticket_number    and sr_returned_date_sk = d2.d_date_sk    and d2.d_quarter_name in ('1998Q1','1998Q2','1998Q3')    and sr_customer_sk = cs_bill_customer_sk    and sr_item_sk = cs_item_sk    and cs_sold_date_sk = d3.d_date_sk    and d3.d_quarter_name in ('1998Q1','1998Q2','1998Q3')  group by i_item_id          ,i_item_desc          ,s_state  order by i_item_id          ,i_item_desc          ,s_state;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_quarter_name"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_state", "s_store_sk"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_return_quantity", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 18, "query_string": " select top (100) i_item_id,         ca_country,         ca_state,          ca_county,         avg( cast(cs_quantity as decimal(12,2))) agg1,         avg( cast(cs_list_price as decimal(12,2))) agg2,         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,         avg( cast(cs_sales_price as decimal(12,2))) agg4,         avg( cast(cs_net_profit as decimal(12,2))) agg5,         avg( cast(c_birth_year as decimal(12,2))) agg6,         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7  from catalog_sales, customer_demographics cd1,        customer_demographics cd2, customer, customer_address, date_dim, item  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd1.cd_demo_sk and        cs_bill_customer_sk = c_customer_sk and        cd1.cd_gender = 'F' and         cd1.cd_education_status = 'College' and        c_current_cdemo_sk = cd2.cd_demo_sk and        c_current_addr_sk = ca_address_sk and        c_birth_month in (4,2,10,7,11,9) and        d_year = 2001 and        ca_state in ('KS','CA','WI'                    ,'IL','NM','AR','PA')  group by rollup (i_item_id, ca_country, ca_state, ca_county)  order by ca_country,         ca_state,          ca_county, \ti_item_id  ;", "predicates": {"customer": ["c_birth_month"], "customer_address": ["ca_state"], "customer_demographics": ["cd_education_status", "cd_gender"], "date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_quantity", "cs_sales_price", "cs_bill_customer_sk", "cs_item_sk", "cs_net_profit", "cs_list_price", "cs_coupon_amt", "cs_sold_date_sk", "cs_bill_cdemo_sk"], "customer": ["c_birth_year", "c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_county", "ca_country", "ca_state"], "customer_demographics": ["cd_demo_sk", "cd_dep_count"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_state", "ca_county", "ca_country"], "item": ["i_item_id"]}}
{"id": 19, "query_string": " select top (100) i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,  \tsum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item,customer,customer_address,store  where d_date_sk = ss_sold_date_sk    and ss_item_sk = i_item_sk    and i_manager_id=54    and d_moy=12    and d_year=2001    and ss_customer_sk = c_customer_sk     and c_current_addr_sk = ca_address_sk    and substring(ca_zip,1,5) <> substring(s_zip,1,5)     and ss_store_sk = s_store_sk   group by i_brand       ,i_brand_id       ,i_manufact_id       ,i_manufact  order by ext_price desc          ,i_brand          ,i_brand_id          ,i_manufact_id          ,i_manufact  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip"], "date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_brand_id", "i_manufact_id", "i_brand", "i_manufact"], "store": ["s_zip", "s_store_sk"]}, "group_by": {}, "order_by": {"item": ["i_brand", "i_manufact", "i_brand_id", "i_manufact_id"]}}
{"id": 20, "query_string": " select top (100) i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from\tcatalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Shoes', 'Books', 'Electronics')    and cs_sold_date_sk = d_date_sk  and d_date between cast('2001-06-25' as date)   \t\t\t\tand dateadd(day, 30, cast('2001-06-25' as date))  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"]}, "group_by": {}, "order_by": {"item": ["i_item_desc", "i_class", "i_item_id", "i_category"]}}
{"id": 21, "query_string": " select top (100) *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-25' as date)) \t                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between dateadd(day, -30, cast ('2000-02-25' as date))                     and dateadd(day, 30, cast ('2000-02-25' as date))    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  ;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"]}, "payload": {"date_dim": ["d_date_sk", "d_date"], "item": ["i_item_id", "i_item_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 22, "query_string": " select top (100) i_product_name              ,i_brand              ,i_class              ,i_category              ,avg(inv_quantity_on_hand) qoh        from inventory            ,date_dim            ,item        where inv_date_sk=d_date_sk               and inv_item_sk=i_item_sk               and d_month_seq between 1214 and 1214 + 11        group by rollup(i_product_name                        ,i_brand                        ,i_class                        ,i_category) order by qoh, i_product_name, i_brand, i_class, i_category;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_brand", "i_product_name", "i_category", "i_class"]}, "group_by": {}, "order_by": {"item": ["i_product_name", "i_class", "i_brand", "i_category"]}}
{"id": 23, "query_string": " with frequent_ss_items as   (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt   from store_sales       ,date_dim        ,item   where ss_sold_date_sk = d_date_sk     and ss_item_sk = i_item_sk      and d_year in (1998,1998+1,1998+2,1998+3)   group by substring(i_item_desc,1,30),i_item_sk,d_date   having count(*) >4),  max_store_sales as  (select max(csales) tpcds_cmax    from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales         from store_sales             ,customer             ,date_dim          where ss_customer_sk = c_customer_sk          and ss_sold_date_sk = d_date_sk          and d_year in (1998,1998+1,1998+2,1998+3)          group by c_customer_sk) a),  best_ss_customer as  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales   from store_sales       ,customer   where ss_customer_sk = c_customer_sk   group by c_customer_sk   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select   * from  max_store_sales))   select top (100) sum(sales)  from (select cs_quantity*cs_list_price sales        from catalog_sales            ,date_dim         where d_year = 1998           and d_moy = 4           and cs_sold_date_sk = d_date_sk           and cs_item_sk in (select item_sk from frequent_ss_items)          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)       union all       select ws_quantity*ws_list_price sales        from web_sales             ,date_dim         where d_year = 1998           and d_moy = 4           and ws_sold_date_sk = d_date_sk           and ws_item_sk in (select item_sk from frequent_ss_items)          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) b  ; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"customer": ["c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "item": ["i_item_sk", "i_item_desc"], "store_sales": ["ss_item_sk", "ss_sales_price", "ss_customer_sk", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 24, "query_string": " with ssales as (select c_last_name       ,c_first_name       ,s_store_name       ,ca_state       ,s_state       ,i_color       ,i_current_price       ,i_manager_id       ,i_units       ,i_size       ,sum(ss_ext_sales_price) netpaid from store_sales     ,store_returns     ,store     ,item     ,customer     ,customer_address where ss_ticket_number = sr_ticket_number   and ss_item_sk = sr_item_sk   and ss_customer_sk = c_customer_sk   and ss_item_sk = i_item_sk   and ss_store_sk = s_store_sk   and c_current_addr_sk = ca_address_sk   and c_birth_country <> upper(ca_country)   and s_zip = ca_zip and s_market_id=7 group by c_last_name         ,c_first_name         ,s_store_name         ,ca_state         ,s_state         ,i_color         ,i_current_price         ,i_manager_id         ,i_units         ,i_size) select c_last_name       ,c_first_name       ,s_store_name       ,sum(netpaid) paid from ssales where i_color = 'hot' group by c_last_name         ,c_first_name         ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid)                                  from ssales) order by c_last_name         ,c_first_name         ,s_store_name; ", "predicates": {"item": ["i_color"], "store": ["s_market_id"]}, "payload": {"customer": ["c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_current_addr_sk"], "customer_address": ["ca_address_sk", "ca_country", "ca_zip", "ca_state"], "item": ["i_item_sk", "i_units", "i_manager_id", "i_current_price", "i_size"], "store": ["s_zip", "s_store_name", "s_state", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_net_paid_inc_tax"]}, "group_by": {}, "order_by": {}}
{"id": 25, "query_string": " select top (100)   i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  ,max(ss_net_profit) as store_sales_profit  ,max(sr_net_loss) as store_returns_loss  ,max(cs_net_profit) as catalog_sales_profit  from  store_sales  ,store_returns  ,catalog_sales  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,item  where  d1.d_moy = 4  and d1.d_year = 2000  and d1.d_date_sk = ss_sold_date_sk  and i_item_sk = ss_item_sk  and s_store_sk = ss_store_sk  and ss_customer_sk = sr_customer_sk  and ss_item_sk = sr_item_sk  and ss_ticket_number = sr_ticket_number  and sr_returned_date_sk = d2.d_date_sk  and d2.d_moy               between 4 and  10  and d2.d_year              = 2000  and sr_customer_sk = cs_bill_customer_sk  and sr_item_sk = cs_item_sk  and cs_sold_date_sk = d3.d_date_sk  and d3.d_moy               between 4 and  10   and d3.d_year              = 2000  group by  i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  order by  i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  ;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_store_name", "s_store_sk", "s_store_id"], "store_returns": ["sr_returned_date_sk", "sr_net_loss", "sr_customer_sk", "sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 26, "query_string": " select top (100) i_item_id,          avg(cs_quantity) agg1,         avg(cs_list_price) agg2,         avg(cs_coupon_amt) agg3,         avg(cs_sales_price) agg4   from catalog_sales, customer_demographics, date_dim, item, promotion  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd_demo_sk and        cs_promo_sk = p_promo_sk and        cd_gender = 'M' and         cd_marital_status = 'U' and        cd_education_status = 'Secondary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 1998   group by i_item_id  order by i_item_id  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "promotion": ["p_channel_event", "p_channel_email"]}, "payload": {"item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 27, "query_string": " select top (100) i_item_id,         s_state, grouping(s_state) g_state,         avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4  from store_sales, customer_demographics, date_dim, store, item  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_store_sk = s_store_sk and        ss_cdemo_sk = cd_demo_sk and        cd_gender = 'M' and        cd_marital_status = 'W' and        cd_education_status = 'College' and        d_year = 1998 and        s_state in ('TN','TN', 'TN', 'TN', 'TN', 'TN')  group by rollup (i_item_id, s_state)  order by i_item_id          ,s_state  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "store": ["s_state"]}, "payload": {"customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"], "store": ["s_state", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_cdemo_sk", "ss_list_price", "ss_quantity", "ss_sales_price", "ss_coupon_amt", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_id"], "store": ["s_state"]}}
{"id": 28, "query_string": " select top (100) * from (select avg(ss_list_price) B1_LP             ,count(ss_list_price) B1_CNT             ,count(distinct ss_list_price) B1_CNTD       from store_sales       where ss_quantity between 0 and 5         and (ss_list_price between 125 and 125+10               or ss_coupon_amt between 12688 and 12688+1000              or ss_wholesale_cost between 21 and 21+20)) B1,      (select avg(ss_list_price) B2_LP             ,count(ss_list_price) B2_CNT             ,count(distinct ss_list_price) B2_CNTD       from store_sales       where ss_quantity between 6 and 10         and (ss_list_price between 104 and 104+10           or ss_coupon_amt between 11287 and 11287+1000           or ss_wholesale_cost between 65 and 65+20)) B2,      (select avg(ss_list_price) B3_LP             ,count(ss_list_price) B3_CNT             ,count(distinct ss_list_price) B3_CNTD       from store_sales       where ss_quantity between 11 and 15         and (ss_list_price between 0 and 0+10           or ss_coupon_amt between 1345 and 1345+1000           or ss_wholesale_cost between 55 and 55+20)) B3,      (select avg(ss_list_price) B4_LP             ,count(ss_list_price) B4_CNT             ,count(distinct ss_list_price) B4_CNTD       from store_sales       where ss_quantity between 16 and 20         and (ss_list_price between 107 and 107+10           or ss_coupon_amt between 12076 and 12076+1000           or ss_wholesale_cost between 5 and 5+20)) B4,      (select avg(ss_list_price) B5_LP             ,count(ss_list_price) B5_CNT             ,count(distinct ss_list_price) B5_CNTD       from store_sales       where ss_quantity between 21 and 25         and (ss_list_price between 169 and 169+10           or ss_coupon_amt between 2994 and 2994+1000           or ss_wholesale_cost between 48 and 48+20)) B5,      (select avg(ss_list_price) B6_LP             ,count(ss_list_price) B6_CNT             ,count(distinct ss_list_price) B6_CNTD       from store_sales       where ss_quantity between 26 and 30         and (ss_list_price between 95 and 95+10           or ss_coupon_amt between 4984 and 4984+1000           or ss_wholesale_cost between 14 and 14+20)) B6;", "predicates": {"store_sales": ["ss_list_price", "ss_coupon_amt", "ss_quantity", "ss_wholesale_cost"]}, "payload": {"store_sales": ["ss_list_price"]}, "group_by": {}, "order_by": {}}
{"id": 29, "query_string": " select top (100)        i_item_id     ,i_item_desc     ,s_store_id     ,s_store_name     ,min(ss_quantity)        as store_sales_quantity     ,min(sr_return_quantity) as store_returns_quantity     ,min(cs_quantity)        as catalog_sales_quantity  from     store_sales    ,store_returns    ,catalog_sales    ,date_dim             d1    ,date_dim             d2    ,date_dim             d3    ,store    ,item  where      d1.d_moy               = 4   and d1.d_year              = 1998  and d1.d_date_sk           = ss_sold_date_sk  and i_item_sk              = ss_item_sk  and s_store_sk             = ss_store_sk  and ss_customer_sk         = sr_customer_sk  and ss_item_sk             = sr_item_sk  and ss_ticket_number       = sr_ticket_number  and sr_returned_date_sk    = d2.d_date_sk  and d2.d_moy               between 4 and  4 + 3   and d2.d_year              = 1998  and sr_customer_sk         = cs_bill_customer_sk  and sr_item_sk             = cs_item_sk  and cs_sold_date_sk        = d3.d_date_sk       and d3.d_year              in (1998,1998+1,1998+2)  group by     i_item_id    ,i_item_desc    ,s_store_id    ,s_store_name  order by     i_item_id     ,i_item_desc    ,s_store_id    ,s_store_name  ;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_store_name", "s_store_sk", "s_store_id"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_return_quantity", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 30, "query_string": " with customer_total_return as  (select wr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   \tsum(wr_return_amt) as ctr_total_return  from web_returns      ,date_dim      ,customer_address  where wr_returned_date_sk = d_date_sk     and d_year =2001    and wr_returning_addr_sk = ca_address_sk   group by wr_returning_customer_sk          ,ca_state)   select top (100) c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag        ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address        ,c_last_review_date,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  \t\t\t  from customer_total_return ctr2                    \t  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'MO'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag                   ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address                   ,c_last_review_date,ctr_total_return;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_year"]}, "payload": {"customer": ["c_birth_year", "c_login", "c_customer_sk", "c_birth_month", "c_salutation", "c_birth_day", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_current_addr_sk", "c_email_address", "c_customer_id", "c_last_review_date"], "customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "web_returns": ["wr_return_amt", "wr_returning_addr_sk", "wr_returned_date_sk", "wr_returning_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_birth_year", "c_login", "c_birth_month", "c_birth_country", "c_salutation", "c_birth_day", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id", "c_last_review_date"]}}
{"id": 31, "query_string": " with ss as  (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales  from store_sales,date_dim,customer_address  where ss_sold_date_sk = d_date_sk   and ss_addr_sk=ca_address_sk  group by ca_county,d_qoy, d_year),  ws as  (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales  from web_sales,date_dim,customer_address  where ws_sold_date_sk = d_date_sk   and ws_bill_addr_sk=ca_address_sk  group by ca_county,d_qoy, d_year)  select          ss1.ca_county        ,ss1.d_year        ,ws2.web_sales/ws1.web_sales web_q1_q2_increase        ,ss2.store_sales/ss1.store_sales store_q1_q2_increase        ,ws3.web_sales/ws2.web_sales web_q2_q3_increase        ,ss3.store_sales/ss2.store_sales store_q2_q3_increase  from         ss ss1        ,ss ss2        ,ss ss3        ,ws ws1        ,ws ws2        ,ws ws3  where     ss1.d_qoy = 1     and ss1.d_year = 2000     and ss1.ca_county = ss2.ca_county     and ss2.d_qoy = 2     and ss2.d_year = 2000  and ss2.ca_county = ss3.ca_county     and ss3.d_qoy = 3     and ss3.d_year = 2000     and ss1.ca_county = ws1.ca_county     and ws1.d_qoy = 1     and ws1.d_year = 2000     and ws1.ca_county = ws2.ca_county     and ws2.d_qoy = 2     and ws2.d_year = 2000     and ws1.ca_county = ws3.ca_county     and ws3.d_qoy = 3     and ws3.d_year =2000     and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end         > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end     and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end        > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end  order by web_q2_q3_increase;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"customer_address": ["ca_address_sk", "ca_county"], "date_dim": ["d_date_sk", "d_year"], "store_sales": ["ss_sold_date_sk", "ss_addr_sk", "ss_ext_sales_price"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_bill_addr_sk"]}, "group_by": {}, "order_by": {}}
{"id": 32, "query_string": " select top (100) sum(cs_ext_discount_amt)  as \"excess discount amount\"  from     catalog_sales     ,item     ,date_dim where i_manufact_id = 226 and i_item_sk = cs_item_sk  and d_date between '1999-02-08' and          dateadd(day, 90, cast('1999-02-08' as date)) and d_date_sk = cs_sold_date_sk  and cs_ext_discount_amt        > (           select              1.3 * avg(cs_ext_discount_amt)           from              catalog_sales             ,date_dim          where                cs_item_sk = i_item_sk            and d_date between '1999-02-08' and                              dateadd(day, 90, cast('1999-02-08' as date))           and d_date_sk = cs_sold_date_sk        ) ;", "predicates": {"catalog_sales": ["cs_ext_discount_amt"], "date_dim": ["d_date"], "item": ["i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 33, "query_string": " with ss as (  select           i_manufact_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id in (select   i_manufact_id from  item where i_category in ('Books'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 4  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  cs as (  select           i_manufact_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Books'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 4  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  ws as (  select           i_manufact_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Books'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 4  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_manufact_id)   select top (100) i_manufact_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_manufact_id  order by total_sales;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_category"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_addr_sk", "cs_item_sk", "cs_ext_sales_price"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_manufact_id"], "store_sales": ["ss_sold_date_sk", "ss_addr_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk", "ws_bill_addr_sk"]}, "group_by": {}, "order_by": {}}
{"id": 34, "query_string": " select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '1001-5000' or          household_demographics.hd_buy_potential = '5001-10000')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  \tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  \telse null  \tend)  > 1.2     and date_dim.d_year in (2000,2000+1,2000+2)     and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',                            'Williamson County','Williamson County','Williamson County','Williamson County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;", "predicates": {"date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count", "hd_buy_potential"], "store": ["s_county"]}, "payload": {"customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_preferred_cust_flag"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 35, "query_string": " select top (100)     ca_state,   cd_gender,   cd_marital_status,   cd_dep_count,   count(*) cnt1,   stdev(cd_dep_count),   max(cd_dep_count),   sum(cd_dep_count),   cd_dep_employed_count,   count(*) cnt2,   stdev(cd_dep_employed_count),   max(cd_dep_employed_count),   sum(cd_dep_employed_count),   cd_dep_college_count,   count(*) cnt3,   stdev(cd_dep_college_count),   max(cd_dep_college_count),   sum(cd_dep_college_count)  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 1999 and                 d_qoy < 4) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 1999 and                   d_qoy < 4) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 1999 and                   d_qoy < 4))  group by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  ;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_state"], "customer_demographics": ["cd_dep_college_count", "cd_gender", "cd_demo_sk", "cd_dep_employed_count", "cd_dep_count", "cd_marital_status"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 36, "query_string": " select top (100)      sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  \tpartition by grouping(i_category)+grouping(i_class),  \tcase when grouping(i_class) = 0 then i_category end   \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent  from     store_sales    ,date_dim       d1    ,item    ,store  where     d1.d_year = 2000   and d1.d_date_sk = ss_sold_date_sk  and i_item_sk  = ss_item_sk   and s_store_sk  = ss_store_sk  and s_state in ('TN','TN','TN','TN',                  'TN','TN','TN','TN')  group by rollup(i_category,i_class)  order by    lochierarchy desc   ,case when (grouping(i_category)+grouping(i_class)) = 0 then i_category end   ,rank_within_parent   ;", "predicates": {"date_dim": ["d_year"], "store": ["s_state"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_class", "i_item_sk", "i_category"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_ext_sales_price", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 37, "query_string": " select top (100) i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 50 and 50 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2000-04-13' as date) and dateadd(day, 60, cast('2000-04-13' as date))  and i_manufact_id in (850,706,962,757)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  ;", "predicates": {"date_dim": ["d_date"], "inventory": ["inv_quantity_on_hand"], "item": ["i_current_price", "i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc", "i_current_price"]}, "group_by": {}, "order_by": {}}
{"id": 38, "query_string": " select top (100) count(*) from (     select distinct c_last_name, c_first_name, d_date     from store_sales, date_dim, customer           where store_sales.ss_sold_date_sk = date_dim.d_date_sk       and store_sales.ss_customer_sk = customer.c_customer_sk       and d_month_seq between 1214 and 1214 + 11   intersect     select distinct c_last_name, c_first_name, d_date     from catalog_sales, date_dim, customer           where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk       and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk       and d_month_seq between 1214 and 1214 + 11   intersect     select distinct c_last_name, c_first_name, d_date     from web_sales, date_dim, customer           where web_sales.ws_sold_date_sk = date_dim.d_date_sk       and web_sales.ws_bill_customer_sk = customer.c_customer_sk       and d_month_seq between 1214 and 1214 + 11 ) hot_cust;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk", "ws_item_sk", "ws_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 39, "query_string": " with inv as (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy        ,stdev,mean, case mean when 0 then null else stdev/mean end cov  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy             ,stdev(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean       from inventory           ,item           ,warehouse           ,date_dim       where inv_item_sk = i_item_sk         and inv_warehouse_sk = w_warehouse_sk         and inv_date_sk = d_date_sk         and d_year =2000       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo  where case mean when 0 then 0 else stdev/mean end > 1) select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov from inv inv1,inv inv2 where inv1.i_item_sk = inv2.i_item_sk   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk   and inv1.d_moy=3   and inv2.d_moy=3+1 order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov         ,inv2.d_moy,inv2.mean, inv2.cov; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_item_sk"], "warehouse": ["w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 40, "query_string": " select top (100)     w_state   ,i_item_id   ,sum(case when (cast(d_date as date) < cast ('2000-02-25' as date))   \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before   ,sum(case when (cast(d_date as date) >= cast ('2000-02-25' as date))   \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after  from    catalog_sales left outer join catalog_returns on        (cs_order_number = cr_order_number          and cs_item_sk = cr_item_sk)   ,warehouse    ,item   ,date_dim  where      i_current_price between 0.99 and 1.49  and i_item_sk          = cs_item_sk  and cs_warehouse_sk    = w_warehouse_sk   and cs_sold_date_sk    = d_date_sk  and d_date between dateadd(day, -30, cast ('2000-02-25' as date))                 and dateadd(day, 30, cast ('2000-02-25' as date))   group by     w_state,i_item_id  order by w_state,i_item_id;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_refunded_cash"], "date_dim": ["d_date_sk", "d_date"], "item": ["i_item_id", "i_item_sk"], "warehouse": ["w_state", "w_warehouse_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_id"], "warehouse": ["w_state"]}}
{"id": 41, "query_string": " select distinct top (100) i_product_name  from item i1  where i_manufact_id between 857 and 857+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'brown' or i_color = 'plum') and          (i_units = 'Tsp' or i_units = 'Bunch') and         (i_size = 'N/A' or i_size = 'large')         ) or         (i_category = 'Women' and         (i_color = 'cornflower' or i_color = 'pink') and         (i_units = 'Ton' or i_units = 'Box') and         (i_size = 'petite' or i_size = 'extra large')         ) or         (i_category = 'Men' and         (i_color = 'beige' or i_color = 'orange') and         (i_units = 'Lb' or i_units = 'Dozen') and         (i_size = 'economy' or i_size = 'small')         ) or         (i_category = 'Men' and         (i_color = 'antique' or i_color = 'burnished') and         (i_units = 'Ounce' or i_units = 'Pound') and         (i_size = 'N/A' or i_size = 'large')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'purple' or i_color = 'blue') and          (i_units = 'Carton' or i_units = 'Gross') and         (i_size = 'N/A' or i_size = 'large')         ) or         (i_category = 'Women' and         (i_color = 'aquamarine' or i_color = 'metallic') and         (i_units = 'N/A' or i_units = 'Pallet') and         (i_size = 'petite' or i_size = 'extra large')         ) or         (i_category = 'Men' and         (i_color = 'orchid' or i_color = 'medium') and         (i_units = 'Unknown' or i_units = 'Cup') and         (i_size = 'economy' or i_size = 'small')         ) or         (i_category = 'Men' and         (i_color = 'misty' or i_color = 'thistle') and         (i_units = 'Oz' or i_units = 'Tbl') and         (i_size = 'N/A' or i_size = 'large')         )))) > 0  order by i_product_name  ;", "predicates": {"item": ["i_color", "i_units", "i_manufact_id", "i_category", "i_size", "i_manufact"]}, "payload": {"item": ["i_color", "i_units", "i_product_name", "i_category", "i_size", "i_manufact"]}, "group_by": {}, "order_by": {}}
{"id": 42, "query_string": " select top (100) dt.d_year  \t,item.i_category_id  \t,item.i_category  \t,sum(ss_ext_sales_price)  from \tdate_dim dt  \t,store_sales  \t,item  where dt.d_date_sk = store_sales.ss_sold_date_sk  \tand store_sales.ss_item_sk = item.i_item_sk  \tand item.i_manager_id = 1  \t  \tand dt.d_moy=11  \tand dt.d_year=2000  group by \tdt.d_year  \t\t,item.i_category_id  \t\t,item.i_category  order by       sum(ss_ext_sales_price) desc,dt.d_year  \t\t,item.i_category_id  \t\t,item.i_category  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_item_sk", "i_category", "i_category_id"]}, "group_by": {}, "order_by": {"item": ["i_category", "i_category_id"]}}
{"id": 43, "query_string": " select top (100) s_store_name, s_store_id,         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales  from date_dim, store_sales, store  where d_date_sk = ss_sold_date_sk and        s_store_sk = ss_store_sk and        s_gmt_offset = -5 and        d_year = 2000   group by s_store_name, s_store_id  order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales  ;", "predicates": {"date_dim": ["d_year"], "store": ["s_gmt_offset"]}, "payload": {"date_dim": ["d_date_sk", "d_day_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 44, "query_string": " select top (100) asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing from(select *      from (select item_sk,rank() over (order by rank_col asc) rnk            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col                   from store_sales ss1                  where ss_store_sk = 5                  group by ss_item_sk                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col                                                   from store_sales                                                   where ss_store_sk = 5                                                     and ss_hdemo_sk is null                                                   group by ss_store_sk))V1)V11      where rnk  < 11) asceding,     (select *      from (select item_sk,rank() over (order by rank_col desc) rnk            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col                  from store_sales ss1                  where ss_store_sk = 5                  group by ss_item_sk                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col                                                   from store_sales                                                   where ss_store_sk = 5                                                     and ss_hdemo_sk is null                                                   group by ss_store_sk))V2)V21      where rnk  < 11) descending, item i1, item i2 where asceding.rnk = descending.rnk    and i1.i_item_sk=asceding.item_sk   and i2.i_item_sk=descending.item_sk order by asceding.rnk;", "predicates": {"store_sales": ["ss_store_sk", "ss_customer_sk"]}, "payload": {"store_sales": ["ss_net_profit", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 45, "query_string": " select top (100) ca_zip, ca_city, sum(ws_sales_price)  from web_sales, customer, customer_address, date_dim, item  where ws_bill_customer_sk = c_customer_sk  \tand c_current_addr_sk = ca_address_sk   \tand ws_item_sk = i_item_sk   \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')  \t      or   \t      i_item_id in (select i_item_id                              from item                              where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)                              )  \t    )  \tand ws_sold_date_sk = d_date_sk  \tand d_qoy = 2 and d_year = 1998  group by ca_zip, ca_city  order by ca_zip, ca_city  ;", "predicates": {"customer_address": ["ca_zip"], "date_dim": ["d_qoy", "d_year"], "item": ["i_item_id"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip", "ca_city"], "date_dim": ["d_date_sk"], "web_sales": ["ws_sales_price", "ws_sold_date_sk", "ws_bill_customer_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 46, "query_string": " select top (100) c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,ca_city bought_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics,customer_address      where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and (household_demographics.hd_dep_count = 0 or          household_demographics.hd_vehicle_count= 3)     and date_dim.d_dow in (6,0)     and date_dim.d_year in (1999,1999+1,1999+2)      and store.s_city in ('Fairview','Midway','Midway','Fairview','Fairview')      group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr     where ss_customer_sk = c_customer_sk       and customer.c_current_addr_sk = current_addr.ca_address_sk       and current_addr.ca_city <> bought_city   order by c_last_name           ,c_first_name           ,ca_city           ,bought_city           ,ss_ticket_number   ;", "predicates": {"date_dim": ["d_dow", "d_year"], "household_demographics": ["hd_vehicle_count", "hd_dep_count"], "store": ["s_city"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk", "c_first_name", "c_last_name"], "customer_address": ["ca_city", "ca_address_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_addr_sk", "ss_coupon_amt", "ss_customer_sk", "ss_hdemo_sk", "ss_net_profit", "ss_sold_date_sk", "ss_store_sk", "ss_ticket_number"]}, "group_by": {}, "order_by": {}}
{"id": 47, "query_string": " with v1 as(  select i_category, i_brand,         s_store_name, s_company_name,         d_year, d_moy,         sum(ss_sales_price) sum_sales,         avg(sum(ss_sales_price)) over           (partition by i_category, i_brand,                      s_store_name, s_company_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      s_store_name, s_company_name            order by d_year, d_moy) rn  from item, store_sales, date_dim, store  where ss_item_sk = i_item_sk and        ss_sold_date_sk = d_date_sk and        ss_store_sk = s_store_sk and        (          d_year = 1999 or          ( d_year = 1999-1 and d_moy =12) or          ( d_year = 1999+1 and d_moy =1)        )  group by i_category, i_brand,           s_store_name, s_company_name,           d_year, d_moy),  v2 as(  select v1.s_store_name         ,v1.d_year         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1.s_store_name = v1_lag.s_store_name and        v1.s_store_name = v1_lead.s_store_name and        v1.s_company_name = v1_lag.s_company_name and        v1.s_company_name = v1_lead.s_company_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select top (100) *  from v2  where  d_year = 1999 and             avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, nsum  ;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk", "d_moy", "d_year"], "item": ["i_brand", "i_item_sk", "i_category"], "store": ["s_store_name", "s_store_sk", "s_company_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 48, "query_string": " select sum (ss_quantity)  from store_sales, store, customer_demographics, customer_address, date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2000  and    (   (    cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'U'    and     cd_education_status = '2 yr Degree'    and     ss_sales_price between 100.00 and 150.00      )  or   (   cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'S'    and     cd_education_status = 'Primary'    and     ss_sales_price between 50.00 and 100.00      )  or   (   cd_demo_sk = ss_cdemo_sk   and     cd_marital_status = 'M'    and     cd_education_status = '4 yr Degree'    and     ss_sales_price between 150.00 and 200.00    )  )  and  (   (   ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('MI', 'MO', 'ID')   and ss_net_profit between 0 and 2000     )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('PA', 'NE', 'NV')   and ss_net_profit between 150 and 3000    )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('OK', 'VA', 'GA')   and ss_net_profit between 50 and 25000    )  );", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "store_sales": ["ss_sales_price", "ss_net_profit"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_cdemo_sk", "ss_addr_sk", "ss_quantity", "ss_sales_price", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 49, "query_string": " select top (100) channel, item, return_ratio, return_rank, currency_rank from  (select  'web' as channel  ,web.item  ,web.return_ratio  ,web.return_rank  ,web.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect ws.ws_item_sk as item  \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\t web_sales ws left outer join web_returns wr   \t\t\ton (ws.ws_order_number = wr.wr_order_number and   \t\t\tws.ws_item_sk = wr.wr_item_sk)                  ,date_dim  \t\twhere   \t\t\twr.wr_return_amt > 10000   \t\t\tand ws.ws_net_profit > 1                          and ws.ws_net_paid > 0                          and ws.ws_quantity > 0                          and ws_sold_date_sk = d_date_sk                          and d_year = 2000                          and d_moy = 11  \t\tgroup by ws.ws_item_sk  \t) in_web  ) web  where   (  web.return_rank <= 10  or  web.currency_rank <= 10  )  union  select   'catalog' as channel  ,catalog.item  ,catalog.return_ratio  ,catalog.return_rank  ,catalog.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect   \t\tcs.cs_item_sk as item  \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\tcatalog_sales cs left outer join catalog_returns cr  \t\t\ton (cs.cs_order_number = cr.cr_order_number and   \t\t\tcs.cs_item_sk = cr.cr_item_sk)                 ,date_dim  \t\twhere   \t\t\tcr.cr_return_amount > 10000   \t\t\tand cs.cs_net_profit > 1                          and cs.cs_net_paid > 0                          and cs.cs_quantity > 0                          and cs_sold_date_sk = d_date_sk                          and d_year = 2000                          and d_moy = 11                  group by cs.cs_item_sk  \t) in_cat  ) catalog  where   (  catalog.return_rank <= 10  or  catalog.currency_rank <=10  )  union  select   'store' as channel  ,store.item  ,store.return_ratio  ,store.return_rank  ,store.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect sts.ss_item_sk as item  \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\tstore_sales sts left outer join store_returns sr  \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)                 ,date_dim  \t\twhere   \t\t\tsr.sr_return_amt > 10000   \t\t\tand sts.ss_net_profit > 1                          and sts.ss_net_paid > 0                           and sts.ss_quantity > 0                          and ss_sold_date_sk = d_date_sk                          and d_year = 2000                          and d_moy = 11  \t\tgroup by sts.ss_item_sk  \t) in_store  ) store  where  (  store.return_rank <= 10  or   store.currency_rank <= 10  )  ) a  order by 1,4,5,2  ;", "predicates": {"catalog_returns": ["cr_return_amount"], "catalog_sales": ["cs_net_paid", "cs_net_profit", "cs_quantity"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_return_amt"], "store_sales": ["ss_net_paid", "ss_quantity", "ss_net_profit"], "web_returns": ["wr_return_amt"], "web_sales": ["ws_net_profit", "ws_net_paid", "ws_quantity"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_quantity", "cr_return_amount"], "store_returns": ["sr_return_amt", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_return_amt", "wr_return_quantity", "wr_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 50, "query_string": " select top (100)     s_store_name   ,s_company_id   ,s_street_number   ,s_street_name   ,s_street_type   ,s_suite_number   ,s_city   ,s_county   ,s_state   ,s_zip   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and                   (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and                   (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and                  (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    store_sales   ,store_returns   ,store   ,date_dim d1   ,date_dim d2 where     d2.d_year = 2000 and d2.d_moy  = 9 and ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_sold_date_sk   = d1.d_date_sk and sr_returned_date_sk   = d2.d_date_sk and ss_customer_sk = sr_customer_sk and ss_store_sk = s_store_sk group by    s_store_name   ,s_company_id   ,s_street_number   ,s_street_name   ,s_street_type   ,s_suite_number   ,s_city   ,s_county   ,s_state   ,s_zip order by s_store_name         ,s_company_id         ,s_street_number         ,s_street_name         ,s_street_type         ,s_suite_number         ,s_city         ,s_county         ,s_state         ,s_zip;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 51, "query_string": " WITH web_v1 as ( select   ws_item_sk item_sk, d_date,   sum(sum(ws_sales_price))       over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from web_sales     ,date_dim where ws_sold_date_sk=d_date_sk   and d_month_seq between 1214 and 1214+11   and ws_item_sk is not NULL group by ws_item_sk, d_date), store_v1 as ( select   ss_item_sk item_sk, d_date,   sum(sum(ss_sales_price))       over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from store_sales     ,date_dim where ss_sold_date_sk=d_date_sk   and d_month_seq between 1214 and 1214+11   and ss_item_sk is not NULL group by ss_item_sk, d_date)  select top (100) * from (select item_sk      ,d_date      ,web_sales      ,store_sales      ,max(web_sales)          over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative      ,max(store_sales)          over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative      from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk                  ,case when web.d_date is not null then web.d_date else store.d_date end d_date                  ,web.cume_sales web_sales                  ,store.cume_sales store_sales            from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk                                                           and web.d_date = store.d_date)           )x )y where web_cumulative > store_cumulative order by item_sk         ,d_date;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_sales_price", "ss_item_sk"], "web_sales": ["ws_sold_date_sk", "ws_sales_price", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 52, "query_string": " select top (100) dt.d_year  \t,item.i_brand_id brand_id  \t,item.i_brand brand  \t,sum(ss_ext_sales_price) ext_price  from date_dim dt      ,store_sales      ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=11     and dt.d_year=2000  group by dt.d_year  \t,item.i_brand  \t,item.i_brand_id  order by dt.d_year  \t,ext_price desc  \t,brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"item": ["i_brand_id"]}}
{"id": 53, "query_string": " select top (100) * from  (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1214,1214+1,1214+2,1214+3,1214+4,1214+5,1214+6,1214+7,1214+8,1214+9,1214+10,1214+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', \t\t'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', \t\t'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0  \tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales  \telse null end > 0.1 order by avg_quarterly_sales, \t sum_sales, \t i_manufact_id;", "predicates": {"date_dim": ["d_month_seq"], "item": ["i_brand", "i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_qoy"], "item": ["i_item_sk", "i_manufact_id", "i_brand", "i_category", "i_class"], "store": ["s_store_sk"]}, "group_by": {}, "order_by": {}}
{"id": 54, "query_string": " with my_customers as (  select distinct c_customer_sk         , c_current_addr_sk  from            ( select cs_sold_date_sk sold_date_sk,                  cs_bill_customer_sk customer_sk,                  cs_item_sk item_sk           from   catalog_sales           union all           select ws_sold_date_sk sold_date_sk,                  ws_bill_customer_sk customer_sk,                  ws_item_sk item_sk           from   web_sales          ) cs_or_ws_sales,          item,          date_dim,          customer  where   sold_date_sk = d_date_sk          and item_sk = i_item_sk          and i_category = 'Jewelry'          and i_class = 'pendants'          and c_customer_sk = cs_or_ws_sales.customer_sk          and d_moy = 4          and d_year = 2001  )  , my_revenue as (  select c_customer_sk,         sum(ss_ext_sales_price) as revenue  from   my_customers,         store_sales,         customer_address,         store,         date_dim  where  c_current_addr_sk = ca_address_sk         and ca_county = s_county         and ca_state = s_state         and ss_sold_date_sk = d_date_sk         and c_customer_sk = ss_customer_sk         and d_month_seq between (select distinct d_month_seq+1                                  from   date_dim where d_year = 2001 and d_moy = 4)                            and  (select distinct d_month_seq+3                                  from   date_dim where d_year = 2001 and d_moy = 4)  group by c_customer_sk  )  , segments as  (select cast((revenue/50) as int) as segment   from   my_revenue  )   select top (100) segment, count(*) as num_customers, segment*50 as segment_base  from segments  group by segment  order by segment, num_customers  ;", "predicates": {"date_dim": ["d_month_seq", "d_moy", "d_year"], "item": ["i_class", "i_category"]}, "payload": {"customer_address": ["ca_address_sk", "ca_county", "ca_state"], "date_dim": ["d_date_sk", "d_month_seq"], "item": ["i_item_sk"], "store": ["s_state", "s_county"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_ext_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 55, "query_string": " select top (100) i_brand_id brand_id, i_brand brand,  \tsum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item  where d_date_sk = ss_sold_date_sk  \tand ss_item_sk = i_item_sk  \tand i_manager_id=22  \tand d_moy=11  \tand d_year=1998  group by i_brand, i_brand_id  order by ext_price desc, i_brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"item": ["i_brand_id"]}}
{"id": 56, "query_string": " with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('ivory','medium','floral'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 5  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('ivory','medium','floral'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 5  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('ivory','medium','floral'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 5  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_item_id)   select top (100) i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  ;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_color"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 57, "query_string": " with v1 as(  select i_category, i_brand,         cc_name,         d_year, d_moy,         sum(cs_sales_price) sum_sales,         avg(sum(cs_sales_price)) over           (partition by i_category, i_brand,                      cc_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      cc_name            order by d_year, d_moy) rn  from item, catalog_sales, date_dim, call_center  where cs_item_sk = i_item_sk and        cs_sold_date_sk = d_date_sk and        cc_call_center_sk= cs_call_center_sk and        (          d_year = 1999 or          ( d_year = 1999-1 and d_moy =12) or          ( d_year = 1999+1 and d_moy =1)        )  group by i_category, i_brand,           cc_name , d_year, d_moy),  v2 as(  select v1.i_category, v1.i_brand, v1.cc_name         ,v1.d_year         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1. cc_name = v1_lag. cc_name and        v1. cc_name = v1_lead. cc_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select top (100) *  from v2  where  d_year = 1999 and         avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, nsum  ;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"call_center": ["cc_name", "cc_call_center_sk"], "catalog_sales": ["cs_sales_price", "cs_sold_date_sk", "cs_call_center_sk", "cs_item_sk"], "date_dim": ["d_date_sk", "d_moy", "d_year"], "item": ["i_brand", "i_item_sk", "i_category"]}, "group_by": {}, "order_by": {}}
{"id": 58, "query_string": " with ss_items as  (select i_item_id item_id         ,sum(ss_ext_sales_price) ss_item_rev   from store_sales      ,item      ,date_dim  where ss_item_sk = i_item_sk    and d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2000-07-06'))    and ss_sold_date_sk   = d_date_sk  group by i_item_id),  cs_items as  (select i_item_id item_id         ,sum(cs_ext_sales_price) cs_item_rev   from catalog_sales       ,item       ,date_dim  where cs_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2000-07-06'))   and  cs_sold_date_sk = d_date_sk  group by i_item_id),  ws_items as  (select i_item_id item_id         ,sum(ws_ext_sales_price) ws_item_rev   from web_sales       ,item       ,date_dim  where ws_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq =(select d_week_seq                                       from date_dim                                      where d_date = '2000-07-06'))   and ws_sold_date_sk   = d_date_sk  group by i_item_id)   select top (100) ss_items.item_id        ,ss_item_rev        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev        ,cs_item_rev        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev        ,ws_item_rev        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average  from ss_items,cs_items,ws_items  where ss_items.item_id=cs_items.item_id    and ss_items.item_id=ws_items.item_id     and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  order by item_id          ,ss_item_rev  ;", "predicates": {"date_dim": ["d_week_seq", "d_date"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_item_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "item": ["i_item_id", "i_item_sk"], "store_sales": ["ss_sold_date_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 59, "query_string": " with wss as   (select d_week_seq,         ss_store_sk,         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales  from store_sales,date_dim  where d_date_sk = ss_sold_date_sk  group by d_week_seq,ss_store_sk  )   select top (100) s_store_name1,s_store_id1,d_week_seq1        ,sun_sales1/sun_sales2,mon_sales1/mon_sales2        ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2        ,fri_sales1/fri_sales2,sat_sales1/sat_sales2  from  (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1         ,s_store_id s_store_id1,sun_sales sun_sales1         ,mon_sales mon_sales1,tue_sales tue_sales1         ,wed_sales wed_sales1,thu_sales thu_sales1         ,fri_sales fri_sales1,sat_sales sat_sales1   from wss,store,date_dim d   where d.d_week_seq = wss.d_week_seq and         ss_store_sk = s_store_sk and          d_month_seq between 1209 and 1209 + 11) y,  (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2         ,s_store_id s_store_id2,sun_sales sun_sales2         ,mon_sales mon_sales2,tue_sales tue_sales2         ,wed_sales wed_sales2,thu_sales thu_sales2         ,fri_sales fri_sales2,sat_sales sat_sales2   from wss,store,date_dim d   where d.d_week_seq = wss.d_week_seq and         ss_store_sk = s_store_sk and          d_month_seq between 1209+ 12 and 1209 + 23) x  where s_store_id1=s_store_id2    and d_week_seq1=d_week_seq2-52  order by s_store_name1,s_store_id1,d_week_seq1;", "predicates": {"date_dim": ["d_month_seq"], "store": ["s_store_id"]}, "payload": {"date_dim": ["d_date_sk", "d_week_seq", "d_day_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 60, "query_string": " with ss as (  select           i_item_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where          i_item_id in (select   i_item_id from  item where i_category in ('Children'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 10  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  cs as (  select           i_item_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Children'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 10  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  ws as (  select           i_item_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Children'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 10  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_item_id)   select top (100)     i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by i_item_id       ,total_sales  ;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_item_id", "i_category"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 61, "query_string": " select top (100) promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from   (select sum(ss_ext_sales_price) promotions    from  store_sales         ,store         ,promotion         ,date_dim         ,customer         ,customer_address          ,item    where ss_sold_date_sk = d_date_sk    and   ss_store_sk = s_store_sk    and   ss_promo_sk = p_promo_sk    and   ss_customer_sk= c_customer_sk    and   ca_address_sk = c_current_addr_sk    and   ss_item_sk = i_item_sk     and   ca_gmt_offset = -6    and   i_category = 'Books'    and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')    and   s_gmt_offset = -6    and   d_year = 2001    and   d_moy  = 12) promotional_sales,   (select sum(ss_ext_sales_price) total    from  store_sales         ,store         ,date_dim         ,customer         ,customer_address         ,item    where ss_sold_date_sk = d_date_sk    and   ss_store_sk = s_store_sk    and   ss_customer_sk= c_customer_sk    and   ca_address_sk = c_current_addr_sk    and   ss_item_sk = i_item_sk    and   ca_gmt_offset = -6    and   i_category = 'Books'    and   s_gmt_offset = -6    and   d_year = 2001    and   d_moy  = 12) all_sales order by promotions, total;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_category"], "promotion": ["p_channel_dmail", "p_channel_email", "p_channel_tv"], "store": ["s_gmt_offset"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_promo_sk", "ss_item_sk", "ss_ext_sales_price", "ss_customer_sk", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 62, "query_string": " select top (100)     substring(w_warehouse_name,1,20)   ,sm_type   ,web_name   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and                   (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and                   (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and                  (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    web_sales   ,warehouse   ,ship_mode   ,web_site   ,date_dim where     d_month_seq between 1214 and 1214 + 11 and ws_ship_date_sk   = d_date_sk and ws_warehouse_sk   = w_warehouse_sk and ws_ship_mode_sk   = sm_ship_mode_sk and ws_web_site_sk    = web_site_sk group by    substring(w_warehouse_name,1,20)   ,sm_type   ,web_name order by substring(w_warehouse_name,1,20)         ,sm_type        ,web_name;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "ship_mode": ["sm_type", "sm_ship_mode_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"], "web_sales": ["ws_ship_date_sk", "ws_ship_mode_sk", "ws_sold_date_sk", "ws_warehouse_sk", "ws_web_site_sk"], "web_site": ["web_name", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 63, "query_string": " select top (100) *  from (select i_manager_id              ,sum(ss_sales_price) sum_sales              ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales       from item           ,store_sales           ,date_dim           ,store       where ss_item_sk = i_item_sk         and ss_sold_date_sk = d_date_sk         and ss_store_sk = s_store_sk         and d_month_seq in (1214,1214+1,1214+2,1214+3,1214+4,1214+5,1214+6,1214+7,1214+8,1214+9,1214+10,1214+11)         and ((    i_category in ('Books','Children','Electronics')               and i_class in ('personal','portable','reference','self-help')               and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', \t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))            or(    i_category in ('Women','Music','Men')               and i_class in ('accessories','classical','fragrances','pants')               and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', \t\t                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id         ,avg_monthly_sales         ,sum_sales;", "predicates": {"date_dim": ["d_month_seq"], "item": ["i_brand", "i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_item_sk", "i_manager_id", "i_brand", "i_category", "i_class"], "store": ["s_store_sk"]}, "group_by": {}, "order_by": {"item": ["i_manager_id"]}}
{"id": 64, "query_string": " with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cream','ivory','dodger','khaki','navy','blue') and          i_current_price between 48 and 48 + 10 and          i_current_price between 48 + 1 and 48 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;", "predicates": {"customer_demographics": ["cd_marital_status"], "date_dim": ["d_year"], "item": ["i_color", "i_current_price"], "store": ["s_zip", "s_store_name"]}, "payload": {"household_demographics": ["hd_income_band_sk", "hd_demo_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 65, "query_string": " select top (100) \ts_store_name, \ti_item_desc, \tsc.revenue, \ti_current_price, \ti_wholesale_cost, \ti_brand  from store, item,      (select ss_store_sk, avg(revenue) as ave  \tfrom  \t    (select  ss_store_sk, ss_item_sk,   \t\t     sum(ss_sales_price) as revenue  \t\tfrom store_sales, date_dim  \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1214 and 1214+11  \t\tgroup by ss_store_sk, ss_item_sk) sa  \tgroup by ss_store_sk) sb,      (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue  \tfrom store_sales, date_dim  \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1214 and 1214+11  \tgroup by ss_store_sk, ss_item_sk) sc  where sb.ss_store_sk = sc.ss_store_sk and         sc.revenue <= 0.1 * sb.ave and        s_store_sk = sc.ss_store_sk and        i_item_sk = sc.ss_item_sk  order by s_store_name, i_item_desc;", "predicates": {"date_dim": ["d_month_seq"], "store_sales": ["ss_store_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_brand", "i_wholesale_cost", "i_item_desc"], "store": ["s_store_name", "s_store_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price", "ss_item_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_desc"], "store": ["s_store_name"]}}
{"id": 66, "query_string": " select top (100)            w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country         ,ship_carriers         ,year  \t,sum(jan_sales) as jan_sales  \t,sum(feb_sales) as feb_sales  \t,sum(mar_sales) as mar_sales  \t,sum(apr_sales) as apr_sales  \t,sum(may_sales) as may_sales  \t,sum(jun_sales) as jun_sales  \t,sum(jul_sales) as jul_sales  \t,sum(aug_sales) as aug_sales  \t,sum(sep_sales) as sep_sales  \t,sum(oct_sales) as oct_sales  \t,sum(nov_sales) as nov_sales  \t,sum(dec_sales) as dec_sales  \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot  \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot  \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot  \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot  \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot  \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot  \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot  \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot  \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot  \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot  \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot  \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot  \t,sum(jan_net) as jan_net  \t,sum(feb_net) as feb_net  \t,sum(mar_net) as mar_net  \t,sum(apr_net) as apr_net  \t,sum(may_net) as may_net  \t,sum(jun_net) as jun_net  \t,sum(jul_net) as jul_net  \t,sum(aug_net) as aug_net  \t,sum(sep_net) as sep_net  \t,sum(oct_net) as oct_net  \t,sum(nov_net) as nov_net  \t,sum(dec_net) as dec_net  from (      select   \tw_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,concat('ORIENTAL' , ',' , 'FEDEX') as ship_carriers        ,d_year as year  \t,sum(case when d_moy = 1   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as jan_sales  \t,sum(case when d_moy = 2   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as feb_sales  \t,sum(case when d_moy = 3   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as mar_sales  \t,sum(case when d_moy = 4   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as apr_sales  \t,sum(case when d_moy = 5   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as may_sales  \t,sum(case when d_moy = 6   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as jun_sales  \t,sum(case when d_moy = 7   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as jul_sales  \t,sum(case when d_moy = 8   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as aug_sales  \t,sum(case when d_moy = 9   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as sep_sales  \t,sum(case when d_moy = 10   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as oct_sales  \t,sum(case when d_moy = 11  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as nov_sales  \t,sum(case when d_moy = 12  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as dec_sales  \t,sum(case when d_moy = 1   \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jan_net  \t,sum(case when d_moy = 2  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as feb_net  \t,sum(case when d_moy = 3   \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as mar_net  \t,sum(case when d_moy = 4   \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as apr_net  \t,sum(case when d_moy = 5   \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as may_net  \t,sum(case when d_moy = 6   \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jun_net  \t,sum(case when d_moy = 7   \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jul_net  \t,sum(case when d_moy = 8   \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as aug_net  \t,sum(case when d_moy = 9   \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as sep_net  \t,sum(case when d_moy = 10   \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as oct_net  \t,sum(case when d_moy = 11  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as nov_net  \t,sum(case when d_moy = 12  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as dec_net      from           web_sales          ,warehouse          ,date_dim          ,time_dim  \t  ,ship_mode      where             ws_warehouse_sk =  w_warehouse_sk         and ws_sold_date_sk = d_date_sk         and ws_sold_time_sk = t_time_sk  \tand ws_ship_mode_sk = sm_ship_mode_sk         and d_year = 1999  \tand t_time between 54797 and 54797+28800   \tand sm_carrier in ('ORIENTAL','FEDEX')      group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country        ,d_year  union all      select   \tw_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,concat('ORIENTAL', ',', 'FEDEX') as ship_carriers        ,d_year as year  \t,sum(case when d_moy = 1   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jan_sales  \t,sum(case when d_moy = 2   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as feb_sales  \t,sum(case when d_moy = 3   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as mar_sales  \t,sum(case when d_moy = 4   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as apr_sales  \t,sum(case when d_moy = 5   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as may_sales  \t,sum(case when d_moy = 6   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jun_sales  \t,sum(case when d_moy = 7   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jul_sales  \t,sum(case when d_moy = 8   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as aug_sales  \t,sum(case when d_moy = 9   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as sep_sales  \t,sum(case when d_moy = 10   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as oct_sales  \t,sum(case when d_moy = 11  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as nov_sales  \t,sum(case when d_moy = 12  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as dec_sales  \t,sum(case when d_moy = 1   \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as jan_net  \t,sum(case when d_moy = 2   \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as feb_net  \t,sum(case when d_moy = 3   \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as mar_net  \t,sum(case when d_moy = 4   \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as apr_net  \t,sum(case when d_moy = 5   \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as may_net  \t,sum(case when d_moy = 6   \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as jun_net  \t,sum(case when d_moy = 7   \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as jul_net  \t,sum(case when d_moy = 8   \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as aug_net  \t,sum(case when d_moy = 9   \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as sep_net  \t,sum(case when d_moy = 10   \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as oct_net  \t,sum(case when d_moy = 11  \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as nov_net  \t,sum(case when d_moy = 12  \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as dec_net      from           catalog_sales          ,warehouse          ,date_dim          ,time_dim  \t ,ship_mode      where             cs_warehouse_sk =  w_warehouse_sk         and cs_sold_date_sk = d_date_sk         and cs_sold_time_sk = t_time_sk  \tand cs_ship_mode_sk = sm_ship_mode_sk         and d_year = 1999  \tand t_time between 54797 AND 54797+28800   \tand sm_carrier in ('ORIENTAL','FEDEX')      group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country        ,d_year  ) x  group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,ship_carriers        ,year  order by w_warehouse_name  ;", "predicates": {"date_dim": ["d_year"], "ship_mode": ["sm_carrier"], "time_dim": ["t_time"]}, "payload": {"catalog_sales": ["cs_warehouse_sk", "cs_ext_list_price", "cs_quantity", "cs_net_paid_inc_tax", "cs_ship_mode_sk", "cs_sold_date_sk", "cs_sold_time_sk"], "date_dim": ["d_date_sk", "d_moy", "d_year"], "ship_mode": ["sm_ship_mode_sk"], "time_dim": ["t_time_sk"], "web_sales": ["ws_ship_mode_sk", "ws_ext_list_price", "ws_sold_date_sk", "ws_quantity", "ws_sold_time_sk", "ws_warehouse_sk", "ws_net_paid"]}, "group_by": {}, "order_by": {}}
{"id": 67, "query_string": " select top (100) * from (select i_category             ,i_class             ,i_brand             ,i_product_name             ,d_year             ,d_qoy             ,d_moy             ,s_store_id             ,sumsales             ,rank() over (partition by i_category order by sumsales desc) rk       from (select i_category                   ,i_class                   ,i_brand                   ,i_product_name                   ,d_year                   ,d_qoy                   ,d_moy                   ,s_store_id                   ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales             from store_sales                 ,date_dim                 ,store                 ,item        where  ss_sold_date_sk=d_date_sk           and ss_item_sk=i_item_sk           and ss_store_sk = s_store_sk           and d_month_seq between 1214 and 1214+11        group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 order by i_category         ,i_class         ,i_brand         ,i_product_name         ,d_year         ,d_qoy         ,d_moy         ,s_store_id         ,sumsales         ,rk;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk", "d_moy", "d_qoy", "d_year"], "item": ["i_item_sk", "i_brand", "i_product_name", "i_category", "i_class"], "store": ["s_store_sk", "s_store_id"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_sales_price", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {"date_dim": ["d_moy", "d_qoy", "d_year"], "item": ["i_brand", "i_class", "i_product_name", "i_category"], "store": ["s_store_id"]}}
{"id": 68, "query_string": " select top (100) c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,extended_price        ,extended_tax        ,list_price  from (select ss_ticket_number              ,ss_customer_sk              ,ca_city bought_city              ,sum(ss_ext_sales_price) extended_price               ,sum(ss_ext_list_price) list_price              ,sum(ss_ext_tax) extended_tax         from store_sales            ,date_dim            ,store            ,household_demographics            ,customer_address         where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_store_sk = store.s_store_sk           and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk         and store_sales.ss_addr_sk = customer_address.ca_address_sk         and date_dim.d_dom between 1 and 2          and (household_demographics.hd_dep_count = 5 or              household_demographics.hd_vehicle_count= -1)         and date_dim.d_year in (2000,2000+1,2000+2)         and store.s_city in ('Fairview','Midway')        group by ss_ticket_number                ,ss_customer_sk                ,ss_addr_sk,ca_city) dn       ,customer       ,customer_address current_addr  where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name          ,ss_ticket_number  ;", "predicates": {"customer_address": ["ca_city"], "date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_city"]}, "payload": {"customer": ["c_current_addr_sk", "c_first_name", "c_last_name", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_city"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_ext_sales_price", "ss_addr_sk", "ss_customer_sk", "ss_ticket_number", "ss_ext_list_price", "ss_ext_tax", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 69, "query_string": " select top (100)    cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_state in ('PA','MO','WV') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2004 and                 d_moy between 4 and 4+2) and    (not exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2004 and                   d_moy between 4 and 4+2) and     not exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2004 and                   d_moy between 4 and 4+2))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  ;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 70, "query_string": " select top (100)      sum(ss_net_profit) as total_sum    ,s_state    ,s_county    ,grouping(s_state)+grouping(s_county) as lochierarchy    ,rank() over (  \tpartition by grouping(s_state)+grouping(s_county),  \tcase when grouping(s_county) = 0 then s_state end   \torder by sum(ss_net_profit) desc) as rank_within_parent  from     store_sales    ,date_dim       d1    ,store  where     d1.d_month_seq between 1214 and 1214+11  and d1.d_date_sk = ss_sold_date_sk  and s_store_sk  = ss_store_sk  and s_state in              ( select s_state                from  (select s_state as s_state,  \t\t\t    rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking                       from   store_sales, store, date_dim                       where  d_month_seq between 1214 and 1214+11  \t\t\t    and d_date_sk = ss_sold_date_sk  \t\t\t    and s_store_sk  = ss_store_sk                       group by s_state                      ) tmp1                 where ranking <= 5              )  group by rollup(s_state,s_county)  order by    lochierarchy desc   ,case when (grouping(s_state)+grouping(s_county)) = 0 then s_state end   ,rank_within_parent  ;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 71, "query_string": " select i_brand_id brand_id, i_brand brand,t_hour,t_minute,  \tsum(ext_price) ext_price  from item, (select ws_ext_sales_price as ext_price,                          ws_sold_date_sk as sold_date_sk,                         ws_item_sk as sold_item_sk,                         ws_sold_time_sk as time_sk                    from web_sales,date_dim                  where d_date_sk = ws_sold_date_sk                    and d_moy=11                    and d_year=2000                  union all                  select cs_ext_sales_price as ext_price,                         cs_sold_date_sk as sold_date_sk,                         cs_item_sk as sold_item_sk,                         cs_sold_time_sk as time_sk                  from catalog_sales,date_dim                  where d_date_sk = cs_sold_date_sk                    and d_moy=11                    and d_year=2000                  union all                  select ss_ext_sales_price as ext_price,                         ss_sold_date_sk as sold_date_sk,                         ss_item_sk as sold_item_sk,                         ss_sold_time_sk as time_sk                  from store_sales,date_dim                  where d_date_sk = ss_sold_date_sk                    and d_moy=11                    and d_year=2000                  ) tmp,time_dim  where    sold_item_sk = i_item_sk    and i_manager_id=1    and time_sk = t_time_sk    and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')  group by i_brand, i_brand_id,t_hour,t_minute  order by ext_price desc, i_brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"], "time_dim": ["t_meal_time"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_brand", "i_item_sk", "i_brand_id"], "time_dim": ["t_hour", "t_minute", "t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 72, "query_string": " select top (100) i_item_desc       ,w_warehouse_name       ,d1.d_week_seq       ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo       ,sum(case when p_promo_sk is not null then 1 else 0 end) promo       ,count(*) total_cnt from catalog_sales join inventory on (cs_item_sk = inv_item_sk) join warehouse on (w_warehouse_sk=inv_warehouse_sk) join item on (i_item_sk = cs_item_sk) join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk) join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk) join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk) join date_dim d2 on (inv_date_sk = d2.d_date_sk) join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk) left outer join promotion on (cs_promo_sk=p_promo_sk) left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number) where d1.d_week_seq = d2.d_week_seq   and inv_quantity_on_hand < cs_quantity    and d3.d_date > dateadd(day, 5, d1.d_date)   and hd_buy_potential = '>10000'   and d1.d_year = 1998   and cd_marital_status = 'S' group by i_item_desc,w_warehouse_name,d1.d_week_seq order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq;", "predicates": {"customer_demographics": ["cd_marital_status"], "date_dim": ["d_date", "d_year"], "household_demographics": ["hd_buy_potential"], "inventory": ["inv_warehouse_sk"], "warehouse": ["w_warehouse_sk"]}, "payload": {"catalog_sales": ["cs_quantity", "cs_promo_sk", "cs_item_sk", "cs_ship_date_sk", "cs_bill_cdemo_sk", "cs_sold_date_sk", "cs_bill_hdemo_sk"], "customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "household_demographics": ["hd_demo_sk"], "item": ["i_item_sk", "i_item_desc"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {"date_dim": ["d_week_seq"], "item": ["i_item_desc"], "warehouse": ["w_warehouse_name"]}}
{"id": 73, "query_string": " select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '1001-5000' or          household_demographics.hd_buy_potential = '5001-10000')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (2000,2000+1,2000+2)     and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;", "predicates": {"date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count", "hd_buy_potential"], "store": ["s_county"]}, "payload": {"customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_preferred_cust_flag"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 74, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,d_year as year        ,stdev(ss_net_paid) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk    and d_year in (1999,1999+1)  group by c_customer_id          ,c_first_name          ,c_last_name          ,d_year  union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,d_year as year        ,stdev(ws_net_paid) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk    and d_year in (1999,1999+1)  group by c_customer_id          ,c_first_name          ,c_last_name          ,d_year          )   select top (100)         t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id          and t_s_firstyear.customer_id = t_w_secyear.customer_id          and t_s_firstyear.customer_id = t_w_firstyear.customer_id          and t_s_firstyear.sale_type = 's'          and t_w_firstyear.sale_type = 'w'          and t_s_secyear.sale_type = 's'          and t_w_secyear.sale_type = 'w'          and t_s_firstyear.year = 1999          and t_s_secyear.year = 1999+1          and t_w_firstyear.year = 1999          and t_w_secyear.year = 1999+1          and t_s_firstyear.year_total > 0          and t_w_firstyear.year_total > 0          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end  order by 2,3,1;", "predicates": {"date_dim": ["d_year"]}, "payload": {"customer": ["c_customer_id", "c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_net_paid"], "web_sales": ["ws_net_paid", "ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_customer_id", "c_last_name", "c_first_name"]}}
{"id": 75, "query_string": " WITH all_sales AS (  SELECT d_year        ,i_brand_id        ,i_class_id        ,i_category_id        ,i_manufact_id        ,SUM(sales_cnt) AS sales_cnt        ,SUM(sales_amt) AS sales_amt  FROM (SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt              ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt        FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk                           JOIN date_dim ON d_date_sk=cs_sold_date_sk                           LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number                                                      AND cs_item_sk=cr_item_sk)        WHERE i_category='Children'        UNION        SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt              ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt        FROM store_sales JOIN item ON i_item_sk=ss_item_sk                         JOIN date_dim ON d_date_sk=ss_sold_date_sk                         LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number                                                  AND ss_item_sk=sr_item_sk)        WHERE i_category='Children'        UNION        SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt              ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt        FROM web_sales JOIN item ON i_item_sk=ws_item_sk                       JOIN date_dim ON d_date_sk=ws_sold_date_sk                       LEFT JOIN web_returns ON (ws_order_number=wr_order_number                                              AND ws_item_sk=wr_item_sk)        WHERE i_category='Children') sales_detail  GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)  SELECT top (100) prev_yr.d_year AS prev_year                           ,curr_yr.d_year AS year                           ,curr_yr.i_brand_id                           ,curr_yr.i_class_id                           ,curr_yr.i_category_id                           ,curr_yr.i_manufact_id                           ,prev_yr.sales_cnt AS prev_yr_cnt                           ,curr_yr.sales_cnt AS curr_yr_cnt                           ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff                           ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff  FROM all_sales curr_yr, all_sales prev_yr  WHERE curr_yr.i_brand_id=prev_yr.i_brand_id    AND curr_yr.i_class_id=prev_yr.i_class_id    AND curr_yr.i_category_id=prev_yr.i_category_id    AND curr_yr.i_manufact_id=prev_yr.i_manufact_id    AND curr_yr.d_year=2001    AND prev_yr.d_year=2001-1    AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9  ORDER BY sales_cnt_diff,sales_amt_diff  ;", "predicates": {"date_dim": ["d_year"], "item": ["i_category"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_quantity", "cr_return_amount"], "date_dim": ["d_date_sk", "d_year"], "item": ["i_class_id", "i_item_sk", "i_category_id", "i_brand_id", "i_manufact_id"], "store_returns": ["sr_return_amt", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_return_amt", "wr_return_quantity", "wr_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 76, "query_string": " select top (100) channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (         SELECT 'store' as channel, 'ss_store_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price          FROM store_sales, item, date_dim          WHERE ss_store_sk IS NULL            AND ss_sold_date_sk=d_date_sk            AND ss_item_sk=i_item_sk         UNION ALL         SELECT 'web' as channel, 'ws_ship_mode_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price          FROM web_sales, item, date_dim          WHERE ws_ship_mode_sk IS NULL            AND ws_sold_date_sk=d_date_sk            AND ws_item_sk=i_item_sk         UNION ALL         SELECT 'catalog' as channel, 'cs_ship_hdemo_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price          FROM catalog_sales, item, date_dim          WHERE cs_ship_hdemo_sk IS NULL            AND cs_sold_date_sk=d_date_sk            AND cs_item_sk=i_item_sk) foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category;", "predicates": {"catalog_sales": ["cs_ship_addr_sk"], "store_sales": ["ss_promo_sk"], "web_sales": ["ws_promo_sk"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_item_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_qoy", "d_year"], "item": ["i_item_sk", "i_category"], "store_sales": ["ss_sold_date_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 77, "query_string": " with ss as  (select s_store_sk,          sum(ss_ext_sales_price) as sales,          sum(ss_net_profit) as profit  from store_sales,       date_dim,       store  where ss_sold_date_sk = d_date_sk        and d_date between cast('2000-08-28' as date)                    and dateadd(day, 30, cast('2000-08-28' as date))         and ss_store_sk = s_store_sk  group by s_store_sk)  ,  sr as  (select s_store_sk,          sum(sr_return_amt) as returns,          sum(sr_net_loss) as profit_loss  from store_returns,       date_dim,       store  where sr_returned_date_sk = d_date_sk        and d_date between cast('2000-08-28' as date)                   and dateadd(day, 30, cast('2000-08-28' as date))        and sr_store_sk = s_store_sk  group by s_store_sk),   cs as  (select cs_call_center_sk,         sum(cs_ext_sales_price) as sales,         sum(cs_net_profit) as profit  from catalog_sales,       date_dim  where cs_sold_date_sk = d_date_sk        and d_date between cast('2000-08-28' as date)                   and dateadd(day, 30, cast('2000-08-28' as date))  group by cs_call_center_sk   ),   cr as  (select cr_call_center_sk,          sum(cr_return_amount) as returns,          sum(cr_net_loss) as profit_loss  from catalog_returns,       date_dim  where cr_returned_date_sk = d_date_sk        and d_date between cast('2000-08-28' as date)                   and dateadd(day, 30, cast('2000-08-28' as date))  group by cr_call_center_sk  ),   ws as  ( select wp_web_page_sk,         sum(ws_ext_sales_price) as sales,         sum(ws_net_profit) as profit  from web_sales,       date_dim,       web_page  where ws_sold_date_sk = d_date_sk        and d_date between cast('2000-08-28' as date)                   and dateadd(day, 30, cast('2000-08-28' as date))        and ws_web_page_sk = wp_web_page_sk  group by wp_web_page_sk),   wr as  (select wp_web_page_sk,         sum(wr_return_amt) as returns,         sum(wr_net_loss) as profit_loss  from web_returns,       date_dim,       web_page  where wr_returned_date_sk = d_date_sk        and d_date between cast('2000-08-28' as date)                   and dateadd(day, 30, cast('2000-08-28' as date))        and wr_web_page_sk = wp_web_page_sk  group by wp_web_page_sk)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , ss.s_store_sk as id         , sales         , coalesce(returns, 0) as returns         , (profit - coalesce(profit_loss,0)) as profit  from   ss left join sr         on  ss.s_store_sk = sr.s_store_sk  union all  select 'catalog channel' as channel         , cs_call_center_sk as id         , sales         , returns         , (profit - profit_loss) as profit  from  cs        , cr  union all  select 'web channel' as channel         , ws.wp_web_page_sk as id         , sales         , coalesce(returns, 0) returns         , (profit - coalesce(profit_loss,0)) as profit  from   ws left join wr         on  ws.wp_web_page_sk = wr.wp_web_page_sk  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_return_amount", "cr_call_center_sk"], "catalog_sales": ["cs_net_profit", "cs_sold_date_sk", "cs_call_center_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_net_loss"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit", "ss_ext_sales_price"], "web_page": ["wp_web_page_sk"], "web_returns": ["wr_web_page_sk", "wr_returned_date_sk", "wr_return_amt", "wr_net_loss"], "web_sales": ["ws_net_profit", "ws_ext_sales_price", "ws_web_page_sk", "ws_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 78, "query_string": " with ws as   (select d_year AS ws_sold_year, ws_item_sk,     ws_bill_customer_sk ws_customer_sk,     sum(ws_quantity) ws_qty,     sum(ws_wholesale_cost) ws_wc,     sum(ws_sales_price) ws_sp    from web_sales    left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk    join date_dim on ws_sold_date_sk = d_date_sk    where wr_order_number is null    group by d_year, ws_item_sk, ws_bill_customer_sk    ), cs as   (select d_year AS cs_sold_year, cs_item_sk,     cs_bill_customer_sk cs_customer_sk,     sum(cs_quantity) cs_qty,     sum(cs_wholesale_cost) cs_wc,     sum(cs_sales_price) cs_sp    from catalog_sales    left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk    join date_dim on cs_sold_date_sk = d_date_sk    where cr_order_number is null    group by d_year, cs_item_sk, cs_bill_customer_sk    ), ss as   (select d_year AS ss_sold_year, ss_item_sk,     ss_customer_sk,     sum(ss_quantity) ss_qty,     sum(ss_wholesale_cost) ss_wc,     sum(ss_sales_price) ss_sp    from store_sales    left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk    join date_dim on ss_sold_date_sk = d_date_sk    where sr_ticket_number is null    group by d_year, ss_item_sk, ss_customer_sk    )  select top (100) ss_customer_sk, round(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk) where (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2000 order by    ss_customer_sk,   ss_qty desc, ss_wc desc, ss_sp desc,   other_chan_qty,   other_chan_wholesale_cost,   other_chan_sales_price,   ratio;", "predicates": {"catalog_returns": ["cr_order_number"], "catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_year"], "store_returns": ["sr_ticket_number"], "store_sales": ["ss_customer_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_bill_customer_sk"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "store_returns": ["sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_item_sk", "ss_sales_price", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_wholesale_cost", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 79, "query_string": " select top (100)   c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,store.s_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (household_demographics.hd_dep_count = 5 or household_demographics.hd_vehicle_count > 2)     and date_dim.d_dow = 1     and date_dim.d_year in (1999,1999+1,1999+2)      and store.s_number_employees between 200 and 295     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer     where ss_customer_sk = c_customer_sk  order by c_last_name,c_first_name,substring(s_city,1,30), profit;", "predicates": {"date_dim": ["d_dow", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_number_employees"]}, "payload": {"customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_city", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_addr_sk", "ss_customer_sk", "ss_ticket_number", "ss_coupon_amt", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {"customer": ["c_last_name", "c_first_name"]}}
{"id": 80, "query_string": " with ssr as  (select  s_store_id as store_id,           sum(ss_ext_sales_price) as sales,           sum(coalesce(sr_return_amt, 0)) as returns,           sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit   from store_sales left outer join store_returns on          (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),      date_dim,      store,      item,      promotion  where ss_sold_date_sk = d_date_sk        and d_date between cast('2000-08-28' as date)                    and dateadd(day, 30, cast('2000-08-28' as date))        and ss_store_sk = s_store_sk        and ss_item_sk = i_item_sk        and i_current_price > 50        and ss_promo_sk = p_promo_sk        and p_channel_tv = 'N'  group by s_store_id)  ,  csr as  (select  cp_catalog_page_id as catalog_page_id,           sum(cs_ext_sales_price) as sales,           sum(coalesce(cr_return_amount, 0)) as returns,           sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit   from catalog_sales left outer join catalog_returns on          (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),      date_dim,      catalog_page,      item,      promotion  where cs_sold_date_sk = d_date_sk        and d_date between cast('2000-08-28' as date)                   and dateadd(day, 30, cast('2000-08-28' as date))         and cs_catalog_page_sk = cp_catalog_page_sk        and cs_item_sk = i_item_sk        and i_current_price > 50        and cs_promo_sk = p_promo_sk        and p_channel_tv = 'N' group by cp_catalog_page_id)  ,  wsr as  (select  web_site_id,           sum(ws_ext_sales_price) as sales,           sum(coalesce(wr_return_amt, 0)) as returns,           sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit   from web_sales left outer join web_returns on          (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),      date_dim,      web_site,      item,      promotion  where ws_sold_date_sk = d_date_sk        and d_date between cast('2000-08-28' as date)                   and dateadd(day, 30, cast('2000-08-28' as date))         and ws_web_site_sk = web_site_sk        and ws_item_sk = i_item_sk        and i_current_price > 50        and ws_promo_sk = p_promo_sk        and p_channel_tv = 'N' group by web_site_id)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , concat('store' , store_id) as id         , sales         , returns         , profit  from   ssr  union all  select 'catalog channel' as channel         , concat('catalog_page' , catalog_page_id) as id         , sales         , returns         , profit  from  csr  union all  select 'web channel' as channel         , concat('web_site' , web_site_id) as id         , sales         , returns         , profit  from   wsr  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"], "promotion": ["p_channel_tv"]}, "payload": {"catalog_page": ["cp_catalog_page_sk", "cp_catalog_page_id"], "catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_amount", "cr_net_loss"], "date_dim": ["d_date_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"], "store": ["s_store_sk", "s_store_id"], "store_returns": ["sr_return_amt", "sr_net_loss", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_net_loss", "wr_return_amt", "wr_order_number"], "web_site": ["web_site_id", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 81, "query_string": " with customer_total_return as  (select cr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   \tsum(cr_return_amt_inc_tax) as ctr_total_return  from catalog_returns      ,date_dim      ,customer_address  where cr_returned_date_sk = d_date_sk     and d_year =2000    and cr_returning_addr_sk = ca_address_sk   group by cr_returning_customer_sk          ,ca_state )   select top (100) c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  \t\t\t  from customer_total_return ctr2                    \t  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'MO'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  ;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_year"]}, "payload": {"catalog_returns": ["cr_returned_date_sk", "cr_returning_customer_sk", "cr_return_amt_inc_tax", "cr_returning_addr_sk"], "customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_current_addr_sk", "c_customer_id"], "customer_address": ["ca_street_type", "ca_county", "ca_street_name", "ca_zip", "ca_street_number", "ca_city", "ca_state", "ca_gmt_offset", "ca_location_type", "ca_address_sk", "ca_suite_number", "ca_country"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer": ["c_salutation", "c_customer_id", "c_last_name", "c_first_name"], "customer_address": ["ca_street_type", "ca_county", "ca_street_name", "ca_zip", "ca_street_number", "ca_city", "ca_gmt_offset", "ca_location_type", "ca_suite_number", "ca_country"]}}
{"id": 82, "query_string": " select top (100) i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, store_sales  where i_current_price between 73 and 73+30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('1998-04-23' as date) and dateadd(day, 60, cast('1998-04-23' as date))  and i_manufact_id in (45,436,814,203)  and inv_quantity_on_hand between 100 and 500  and ss_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  ;", "predicates": {"date_dim": ["d_date"], "inventory": ["inv_quantity_on_hand"], "item": ["i_current_price", "i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc", "i_current_price"]}, "group_by": {}, "order_by": {}}
{"id": 83, "query_string": " with sr_items as  (select i_item_id item_id,         sum(sr_return_quantity) sr_item_qty  from store_returns,       item,       date_dim  where sr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t  where d_date in ('1998-01-12','1998-08-26','1998-11-02')))  and   sr_returned_date_sk   = d_date_sk  group by i_item_id),  cr_items as  (select i_item_id item_id,         sum(cr_return_quantity) cr_item_qty  from catalog_returns,       item,       date_dim  where cr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t  where d_date in ('1998-01-12','1998-08-26','1998-11-02')))  and   cr_returned_date_sk   = d_date_sk  group by i_item_id),  wr_items as  (select i_item_id item_id,         sum(wr_return_quantity) wr_item_qty  from web_returns,       item,       date_dim  where wr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t\twhere d_date in ('1998-01-12','1998-08-26','1998-11-02')))  and   wr_returned_date_sk   = d_date_sk  group by i_item_id)   select top (100) sr_items.item_id        ,sr_item_qty        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev        ,cr_item_qty        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev        ,wr_item_qty        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average  from sr_items      ,cr_items      ,wr_items  where sr_items.item_id=cr_items.item_id    and sr_items.item_id=wr_items.item_id   order by sr_items.item_id          ,sr_item_qty  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_returned_date_sk", "cr_order_number", "cr_return_quantity"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "item": ["i_item_id", "i_item_sk"], "store_returns": ["sr_returned_date_sk", "sr_return_quantity", "sr_item_sk"], "web_returns": ["wr_item_sk", "wr_returned_date_sk", "wr_return_quantity"]}, "group_by": {}, "order_by": {}}
{"id": 84, "query_string": " select top (100) c_customer_id as customer_id        , concat(coalesce(c_last_name,'') , ', ' , coalesce(c_first_name,'')) as customername  from customer      ,customer_address      ,customer_demographics      ,household_demographics      ,income_band      ,store_returns  where ca_city\t        =  'Oak Grove'    and c_current_addr_sk = ca_address_sk    and ib_lower_bound   >=  48615    and ib_upper_bound   <=  48615 + 50000    and ib_income_band_sk = hd_income_band_sk    and cd_demo_sk = c_current_cdemo_sk    and hd_demo_sk = c_current_hdemo_sk    and sr_cdemo_sk = cd_demo_sk  order by c_customer_id  ;", "predicates": {"customer": ["c_current_cdemo_sk"], "customer_address": ["ca_city"], "income_band": ["ib_upper_bound", "ib_lower_bound"]}, "payload": {"customer": ["c_last_name", "c_first_name", "c_current_cdemo_sk", "c_current_addr_sk", "c_customer_id", "c_current_hdemo_sk"], "customer_address": ["ca_address_sk"], "household_demographics": ["hd_income_band_sk", "hd_demo_sk"], "income_band": ["ib_income_band_sk"], "store_returns": ["sr_cdemo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 85, "query_string": " select top (100) substring(r_reason_desc,1,20)        ,avg(ws_quantity)        ,avg(wr_refunded_cash)        ,avg(wr_fee)  from web_sales, web_returns, web_page, customer_demographics cd1,       customer_demographics cd2, customer_address, date_dim, reason   where ws_web_page_sk = wp_web_page_sk    and ws_item_sk = wr_item_sk    and ws_order_number = wr_order_number    and ws_sold_date_sk = d_date_sk and d_year = 2000    and cd1.cd_demo_sk = wr_refunded_cdemo_sk     and cd2.cd_demo_sk = wr_returning_cdemo_sk    and ca_address_sk = wr_refunded_addr_sk    and r_reason_sk = wr_reason_sk    and    (     (      cd1.cd_marital_status = 'U'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = '2 yr Degree'      and       cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 100.00 and 150.00     )    or     (      cd1.cd_marital_status = 'S'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Primary'       and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 50.00 and 100.00     )    or     (      cd1.cd_marital_status = 'M'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = '4 yr Degree'      and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 150.00 and 200.00     )    )    and    (     (      ca_country = 'United States'      and      ca_state in ('MI', 'MO', 'ID')      and ws_net_profit between 100 and 200       )     or     (      ca_country = 'United States'      and      ca_state in ('PA', 'NE', 'NV')      and ws_net_profit between 150 and 300       )     or     (      ca_country = 'United States'      and      ca_state in ('OK', 'VA', 'GA')      and ws_net_profit between 50 and 250       )    ) group by r_reason_desc order by substring(r_reason_desc,1,20)         ,avg(ws_quantity)         ,avg(wr_refunded_cash)         ,avg(wr_fee);", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "web_sales": ["ws_net_profit", "ws_sales_price"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "reason": ["r_reason_desc", "r_reason_sk"], "web_page": ["wp_web_page_sk"], "web_returns": ["wr_returning_cdemo_sk", "wr_refunded_cdemo_sk", "wr_reason_sk", "wr_item_sk", "wr_refunded_cash", "wr_refunded_addr_sk", "wr_fee", "wr_order_number"], "web_sales": ["ws_net_profit", "ws_item_sk", "ws_sales_price", "ws_quantity", "ws_sold_date_sk", "ws_web_page_sk", "ws_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 86, "query_string": " select top (100)       sum(ws_net_paid) as total_sum    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  \tpartition by grouping(i_category)+grouping(i_class),  \tcase when grouping(i_class) = 0 then i_category end   \torder by sum(ws_net_paid) desc) as rank_within_parent  from     web_sales    ,date_dim       d1    ,item  where     d1.d_month_seq between 1214 and 1214+11  and d1.d_date_sk = ws_sold_date_sk  and i_item_sk  = ws_item_sk  group by rollup(i_category,i_class)  order by    lochierarchy desc,    case when (grouping(i_category)+grouping(i_class)) = 0 then i_category end,    rank_within_parent  ;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_class", "i_item_sk", "i_category"], "web_sales": ["ws_net_paid", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 87, "query_string": " select count(*)  from ((select distinct c_last_name, c_first_name, d_date        from store_sales, date_dim, customer        where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_customer_sk = customer.c_customer_sk          and d_month_seq between 1214 and 1214+11)        except       (select distinct c_last_name, c_first_name, d_date        from catalog_sales, date_dim, customer        where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk          and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk          and d_month_seq between 1214 and 1214+11)        except       (select distinct c_last_name, c_first_name, d_date        from web_sales, date_dim, customer        where web_sales.ws_sold_date_sk = date_dim.d_date_sk          and web_sales.ws_bill_customer_sk = customer.c_customer_sk          and d_month_seq between 1214 and 1214+11) ) cool_cust;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 88, "query_string": " select  * from  (select count(*) h8_30_to_9  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk         and ss_hdemo_sk = household_demographics.hd_demo_sk       and ss_store_sk = s_store_sk      and time_dim.t_hour = 8      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))       and store.s_store_name = 'ese') s1,  (select count(*) h9_to_9_30   from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk       and time_dim.t_hour = 9       and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))      and store.s_store_name = 'ese') s2,  (select count(*) h9_30_to_10   from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 9      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))      and store.s_store_name = 'ese') s3,  (select count(*) h10_to_10_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 10       and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))      and store.s_store_name = 'ese') s4,  (select count(*) h10_30_to_11  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 10       and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))      and store.s_store_name = 'ese') s5,  (select count(*) h11_to_11_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk       and time_dim.t_hour = 11      and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))      and store.s_store_name = 'ese') s6,  (select count(*) h11_30_to_12  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 11      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))      and store.s_store_name = 'ese') s7,  (select count(*) h12_to_12_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 12      and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))      and store.s_store_name = 'ese') s8;", "predicates": {"household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_store_name"], "time_dim": ["t_hour", "t_minute"]}, "payload": {"household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_sold_time_sk"], "time_dim": ["t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 89, "query_string": " select top (100) * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (1999) and         ((i_category in ('Women','Jewelry','Music') and           i_class in ('maternity','bracelets','pop')          )       or (i_category in ('Home','Children','Books') and           i_class in ('rugs','infants','romance')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name;", "predicates": {"date_dim": ["d_year"], "item": ["i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_brand", "i_class", "i_item_sk", "i_category"], "store": ["s_store_name", "s_store_sk", "s_company_name"]}, "group_by": {}, "order_by": {"store": ["s_store_name"]}}
{"id": 90, "query_string": " select top (100) cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio  from ( select count(*) amc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 9 and 9+1          and household_demographics.hd_dep_count = 5          and web_page.wp_char_count between 5000 and 5200) at,       ( select count(*) pmc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 19 and 19+1          and household_demographics.hd_dep_count = 5          and web_page.wp_char_count between 5000 and 5200) pt  order by am_pm_ratio  ;", "predicates": {"household_demographics": ["hd_dep_count"], "time_dim": ["t_hour"], "web_page": ["wp_char_count"]}, "payload": {"household_demographics": ["hd_demo_sk"], "time_dim": ["t_time_sk"], "web_page": ["wp_web_page_sk"], "web_sales": ["ws_sold_time_sk", "ws_web_page_sk", "ws_ship_hdemo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 91, "query_string": " select           cc_call_center_id Call_Center,         cc_name Call_Center_Name,         cc_manager Manager,         sum(cr_net_loss) Returns_Loss from         call_center,         catalog_returns,         date_dim,         customer,         customer_address,         customer_demographics,         household_demographics where         cr_call_center_sk       = cc_call_center_sk and     cr_returned_date_sk     = d_date_sk and     cr_returning_customer_sk= c_customer_sk and     cd_demo_sk              = c_current_cdemo_sk and     hd_demo_sk              = c_current_hdemo_sk and     ca_address_sk           = c_current_addr_sk and     d_year                  = 2001  and     d_moy                   = 12 and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')         or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree')) and     hd_buy_potential like '501-1000%' and     ca_gmt_offset           = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc;", "predicates": {"customer_address": ["ca_gmt_offset"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_moy", "d_year"], "household_demographics": ["hd_buy_potential"]}, "payload": {"call_center": ["cc_name", "cc_call_center_id", "cc_manager", "cc_call_center_sk"], "catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_returning_customer_sk", "cr_call_center_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk", "c_current_hdemo_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 92, "query_string": " select top (100)     sum(ws_ext_discount_amt)  as \"Excess Discount Amount\"  from      web_sales     ,item     ,date_dim where i_manufact_id = 226 and i_item_sk = ws_item_sk  and d_date between '1999-02-08' and          dateadd(day, 90, cast('1999-02-08' as date)) and d_date_sk = ws_sold_date_sk  and ws_ext_discount_amt        > (           SELECT              1.3 * avg(ws_ext_discount_amt)           FROM              web_sales             ,date_dim          WHERE                ws_item_sk = i_item_sk            and d_date between '1999-02-08' and                              dateadd(day, 90, cast('1999-02-08' as date))           and d_date_sk = ws_sold_date_sk        )  order by sum(ws_ext_discount_amt);", "predicates": {"date_dim": ["d_date"], "item": ["i_manufact_id"], "web_sales": ["ws_ext_discount_amt"]}, "payload": {"item": ["i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 93, "query_string": " select top (100) ss_customer_sk             ,sum(act_sales) sumsales       from (select ss_item_sk                   ,ss_ticket_number                   ,ss_customer_sk                   ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price                                                             else (ss_quantity*ss_sales_price) end act_sales             from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk                                                                and sr_ticket_number = ss_ticket_number)                 ,reason             where sr_reason_sk = r_reason_sk               and r_reason_desc = 'reason 66') t       group by ss_customer_sk       order by sumsales, ss_customer_sk;", "predicates": {"reason": ["r_reason_desc"]}, "payload": {"reason": ["r_reason_sk"], "store_returns": ["sr_reason_sk", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"]}, "group_by": {}, "order_by": {"store_sales": ["ss_customer_sk"]}}
{"id": 94, "query_string": " select top (100)     count(distinct ws_order_number) as \"order count\"   ,sum(ws_ext_ship_cost) as \"total shipping cost\"   ,sum(ws_net_profit) as \"total net profit\" from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2000-2-01' and             dateadd(day, 60, cast('2000-2-01' as date)) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'ND' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number);", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_date"], "web_site": ["web_company_name"]}, "payload": {"customer_address": ["ca_address_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_net_profit", "ws_ship_date_sk", "ws_ship_addr_sk", "ws_ext_ship_cost", "ws_warehouse_sk", "ws_order_number", "ws_web_site_sk"], "web_site": ["web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 95, "query_string": " with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select top (100)     count(distinct ws_order_number) as \"order count\"   ,sum(ws_ext_ship_cost) as \"total shipping cost\"   ,sum(ws_net_profit) as \"total net profit\" from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2000-2-01' and             dateadd(day, 60, cast('2000-2-01' as date)) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'ND' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number);", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_date"], "web_site": ["web_company_name"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_net_profit", "ws_ship_date_sk", "ws_item_sk", "ws_ship_addr_sk", "ws_ext_ship_cost", "ws_warehouse_sk", "ws_order_number", "ws_web_site_sk"], "web_site": ["web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 96, "query_string": " select top (100) count(*)  from store_sales     ,household_demographics      ,time_dim, store where ss_sold_time_sk = time_dim.t_time_sk        and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk     and time_dim.t_hour = 16     and time_dim.t_minute >= 30     and household_demographics.hd_dep_count = 2     and store.s_store_name = 'ese' order by count(*);", "predicates": {"household_demographics": ["hd_dep_count"], "store": ["s_store_name"], "time_dim": ["t_hour", "t_minute"]}, "payload": {"household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_sold_time_sk"], "time_dim": ["t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 97, "query_string": " with ssci as ( select ss_customer_sk customer_sk       ,ss_item_sk item_sk from store_sales,date_dim where ss_sold_date_sk = d_date_sk   and d_month_seq between 1214 and 1214 + 11 group by ss_customer_sk         ,ss_item_sk), csci as(  select cs_bill_customer_sk customer_sk       ,cs_item_sk item_sk from catalog_sales,date_dim where cs_sold_date_sk = d_date_sk   and d_month_seq between 1214 and 1214 + 11 group by cs_bill_customer_sk         ,cs_item_sk)  select top (100) sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only       ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only       ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk                                and ssci.item_sk = csci.item_sk);", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk", "cs_item_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 98, "query_string": " select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from\t \tstore_sales     \t,item      \t,date_dim where  \tss_item_sk = i_item_sk    \tand i_category in ('Shoes', 'Books', 'Electronics')   \tand ss_sold_date_sk = d_date_sk \tand d_date between cast('2001-06-25' as date)  \t\t\t\tand dateadd(day, 30, cast('2001-06-25' as date)) group by  \ti_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  \ti_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"]}, "group_by": {}, "order_by": {}}
{"id": 99, "query_string": " select top (100)     substring(w_warehouse_name,1,20)   ,sm_type   ,cc_name   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and                   (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and                   (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and                  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    catalog_sales   ,warehouse   ,ship_mode   ,call_center   ,date_dim where     d_month_seq between 1214 and 1214 + 11 and cs_ship_date_sk   = d_date_sk and cs_warehouse_sk   = w_warehouse_sk and cs_ship_mode_sk   = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by    substring(w_warehouse_name,1,20)   ,sm_type   ,cc_name order by substring(w_warehouse_name,1,20)         ,sm_type         ,cc_name;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"call_center": ["cc_name", "cc_call_center_sk"], "catalog_sales": ["cs_warehouse_sk", "cs_call_center_sk", "cs_ship_date_sk", "cs_ship_mode_sk", "cs_sold_date_sk"], "date_dim": ["d_date_sk"], "ship_mode": ["sm_type", "sm_ship_mode_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 1, "query_string": " with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2001 group by sr_customer_sk ,sr_store_sk)  select top (100) c_customer_id from customer_total_return ctr1 ,store ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'TN' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id;", "predicates": {"date_dim": ["d_year"], "store": ["s_state"], "store_returns": ["sr_store_sk"]}, "payload": {"customer": ["c_customer_id", "c_customer_sk"], "date_dim": ["d_date_sk"], "store": ["s_store_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_customer_id"]}}
{"id": 2, "query_string": " with wscs as  (select sold_date_sk         ,sales_price   from (select ws_sold_date_sk sold_date_sk               ,ws_ext_sales_price sales_price         from web_sales          union all         select cs_sold_date_sk sold_date_sk               ,cs_ext_sales_price sales_price         from catalog_sales) a),  wswscs as   (select d_week_seq,         sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales  from wscs      ,date_dim  where d_date_sk = sold_date_sk  group by d_week_seq)  select d_week_seq1        ,round(sun_sales1/sun_sales2,2)        ,round(mon_sales1/mon_sales2,2)        ,round(tue_sales1/tue_sales2,2)        ,round(wed_sales1/wed_sales2,2)        ,round(thu_sales1/thu_sales2,2)        ,round(fri_sales1/fri_sales2,2)        ,round(sat_sales1/sat_sales2,2)  from  (select wswscs.d_week_seq d_week_seq1         ,sun_sales sun_sales1         ,mon_sales mon_sales1         ,tue_sales tue_sales1         ,wed_sales wed_sales1         ,thu_sales thu_sales1         ,fri_sales fri_sales1         ,sat_sales sat_sales1   from wswscs,date_dim    where date_dim.d_week_seq = wswscs.d_week_seq and         d_year = 2000) y,  (select wswscs.d_week_seq d_week_seq2         ,sun_sales sun_sales2         ,mon_sales mon_sales2         ,tue_sales tue_sales2         ,wed_sales wed_sales2         ,thu_sales thu_sales2         ,fri_sales fri_sales2         ,sat_sales sat_sales2   from wswscs       ,date_dim    where date_dim.d_week_seq = wswscs.d_week_seq and         d_year = 2000+1) z  where d_week_seq1=d_week_seq2-53  order by d_week_seq1;", "predicates": {"date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_week_seq", "d_day_name"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 3, "query_string": " select top (100) dt.d_year         ,item.i_brand_id brand_id         ,item.i_brand brand        ,sum(ss_ext_sales_price) sum_agg  from  date_dim dt        ,store_sales       ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk    and store_sales.ss_item_sk = item.i_item_sk    and item.i_manufact_id = 440    and dt.d_moy=11  group by dt.d_year       ,item.i_brand       ,item.i_brand_id  order by dt.d_year          ,sum_agg desc          ,brand_id  ;", "predicates": {"date_dim": ["d_moy"], "item": ["i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"date_dim": ["d_year"], "item": ["i_brand_id"]}}
{"id": 4, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year  union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total        ,'c' sale_type  from customer      ,catalog_sales      ,date_dim  where c_customer_sk = cs_bill_customer_sk    and cs_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year          )   select top (100)                    t_s_secyear.customer_id                  ,t_s_secyear.customer_first_name                  ,t_s_secyear.customer_last_name                  ,t_s_secyear.customer_login  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_c_firstyear      ,year_total t_c_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id    and t_s_firstyear.customer_id = t_c_secyear.customer_id    and t_s_firstyear.customer_id = t_c_firstyear.customer_id    and t_s_firstyear.customer_id = t_w_firstyear.customer_id    and t_s_firstyear.customer_id = t_w_secyear.customer_id    and t_s_firstyear.sale_type = 's'    and t_c_firstyear.sale_type = 'c'    and t_w_firstyear.sale_type = 'w'    and t_s_secyear.sale_type = 's'    and t_c_secyear.sale_type = 'c'    and t_w_secyear.sale_type = 'w'    and t_s_firstyear.dyear =  1998    and t_s_secyear.dyear = 1998+1    and t_c_firstyear.dyear =  1998    and t_c_secyear.dyear =  1998+1    and t_w_firstyear.dyear = 1998    and t_w_secyear.dyear = 1998+1    and t_s_firstyear.year_total > 0    and t_c_firstyear.year_total > 0    and t_w_firstyear.year_total > 0    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end            > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end  order by t_s_secyear.customer_id          ,t_s_secyear.customer_first_name          ,t_s_secyear.customer_last_name          ,t_s_secyear.customer_login;", "predicates": {"date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_ext_list_price", "cs_ext_discount_amt", "cs_bill_customer_sk", "cs_ext_sales_price", "cs_ext_wholesale_cost", "cs_sold_date_sk"], "customer": ["c_login", "c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id"], "date_dim": ["d_date_sk"], "store_sales": ["ss_ext_discount_amt", "ss_ext_sales_price", "ss_ext_wholesale_cost", "ss_customer_sk", "ss_ext_list_price", "ss_sold_date_sk"], "web_sales": ["ws_ext_discount_amt", "ws_ext_wholesale_cost", "ws_ext_list_price", "ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 5, "query_string": " with ssr as  (select s_store_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  ss_store_sk as store_sk,             ss_sold_date_sk  as date_sk,             ss_ext_sales_price as sales_price,             ss_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from store_sales     union all     select sr_store_sk as store_sk,            sr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            sr_return_amt as return_amt,            sr_net_loss as net_loss     from store_returns    ) salesreturns,      date_dim,      store  where date_sk = d_date_sk        and d_date between cast('2002-08-05' as date)                    and dateadd(day, 14, cast('2002-08-05' as date))        and store_sk = s_store_sk  group by s_store_id)  ,  csr as  (select cp_catalog_page_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  cs_catalog_page_sk as page_sk,             cs_sold_date_sk  as date_sk,             cs_ext_sales_price as sales_price,             cs_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from catalog_sales     union all     select cr_catalog_page_sk as page_sk,            cr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            cr_return_amount as return_amt,            cr_net_loss as net_loss     from catalog_returns    ) salesreturns,      date_dim,      catalog_page  where date_sk = d_date_sk        and d_date between cast('2002-08-05' as date)                   and dateadd(day, 14, cast('2002-08-05' as date))        and page_sk = cp_catalog_page_sk  group by cp_catalog_page_id)  ,  wsr as  (select web_site_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  ws_web_site_sk as wsr_web_site_sk,             ws_sold_date_sk  as date_sk,             ws_ext_sales_price as sales_price,             ws_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from web_sales     union all     select ws_web_site_sk as wsr_web_site_sk,            wr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            wr_return_amt as return_amt,            wr_net_loss as net_loss     from web_returns left outer join web_sales on          ( wr_item_sk = ws_item_sk            and wr_order_number = ws_order_number)    ) salesreturns,      date_dim,      web_site  where date_sk = d_date_sk        and d_date between cast('2002-08-05' as date)                   and dateadd(day, 14, cast('2002-08-05' as date))        and wsr_web_site_sk = web_site_sk  group by web_site_id)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , concat('store' , s_store_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from   ssr  union all  select 'catalog channel' as channel         , concat('catalog_page' , cp_catalog_page_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from  csr  union all  select 'web channel' as channel         , concat('web_site' , web_site_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from   wsr  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_page": ["cp_catalog_page_sk", "cp_catalog_page_id"], "catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_return_amount", "cr_catalog_page_sk"], "catalog_sales": ["cs_catalog_page_sk", "cs_net_profit", "cs_sold_date_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_net_loss"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit", "ss_ext_sales_price"], "web_returns": ["wr_returned_date_sk", "wr_return_amt", "wr_net_loss", "wr_item_sk", "wr_order_number"], "web_sales": ["ws_net_profit", "ws_ext_sales_price", "ws_sold_date_sk", "ws_web_site_sk"], "web_site": ["web_site_id", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 6, "query_string": " select top (100) a.ca_state state, count(*) cnt  from customer_address a      ,customer c      ,store_sales s      ,date_dim d      ,item i  where       a.ca_address_sk = c.c_current_addr_sk  \tand c.c_customer_sk = s.ss_customer_sk  \tand s.ss_sold_date_sk = d.d_date_sk  \tand s.ss_item_sk = i.i_item_sk  \tand d.d_month_seq =   \t     (select distinct (d_month_seq)  \t      from date_dim                where d_year = 1998  \t        and d_moy = 2 )  \tand i.i_current_price > 1.2 *               (select avg(j.i_current_price)   \t     from item j   \t     where j.i_category = i.i_category)  group by a.ca_state  having count(*) >= 10  order by cnt, a.ca_state   ;", "predicates": {"date_dim": ["d_month_seq", "d_moy", "d_year"], "item": ["i_category", "i_current_price"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk", "d_month_seq"], "item": ["i_item_sk", "i_category", "i_current_price"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_item_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_state"]}}
{"id": 7, "query_string": " select top (100) i_item_id,          avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4   from store_sales, customer_demographics, date_dim, item, promotion  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_cdemo_sk = cd_demo_sk and        ss_promo_sk = p_promo_sk and        cd_gender = 'M' and         cd_marital_status = 'U' and        cd_education_status = 'Secondary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 1999   group by i_item_id  order by i_item_id  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "promotion": ["p_channel_event", "p_channel_email"]}, "payload": {"customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"], "promotion": ["p_promo_sk"], "store_sales": ["ss_promo_sk", "ss_item_sk", "ss_cdemo_sk", "ss_list_price", "ss_quantity", "ss_sales_price", "ss_coupon_amt", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 8, "query_string": " select top (100) s_store_name       ,sum(ss_net_profit)  from store_sales      ,date_dim      ,store,      (select ca_zip      from (       SELECT substring(ca_zip,1,5) ca_zip       FROM customer_address       WHERE substring(ca_zip,1,5) IN (                           '39735','43460','81522','79276','14145','25051',                           '73357','44543','50461','28039','61786',                           '53738','24011','68616','27218','34058',                           '75994','28971','38508','41896','15851',                           '49894','63932','29012','82750','85339',                           '56345','86905','34699','72089','99773',                           '45795','78782','13302','21011','88087',                           '10781','18107','11933','84914','18566',                           '16800','62259','91031','55961','80420',                           '10757','31501','18989','10893','75608',                           '80756','41180','26911','43148','12053',                           '65135','67611','19074','21850','42035',                           '80413','68530','13401','81839','71160',                           '84818','31890','51774','96235','22585',                           '92573','14276','98392','98507','32496',                           '97604','49541','56493','45054','11606',                           '80104','80031','83202','20977','77569',                           '91731','72355','22984','66693','57780',                           '24033','78924','22430','28222','55628',                           '81421','82705','65227','78945','72911',                           '52192','55753','73621','24466','14006',                           '73490','88303','39319','16348','78839',                           '16272','58668','12697','85211','75848',                           '83211','12064','30403','88980','48704',                           '19010','59541','83859','39491','76388',                           '78477','68015','19666','57218','87620',                           '12030','53876','27111','41251','22152',                           '60643','80874','71566','36942','63955',                           '11274','86689','37936','93006','47190',                           '27022','94313','83367','63250','81265',                           '80284','55699','61656','93880','93916',                           '62588','91442','44727','48745','23361',                           '64272','95935','56929','40523','96871',                           '95448','75850','50814','72482','23256',                           '79110','99792','46982','75812','32801',                           '57526','55364','62970','11536','20735',                           '89768','65785','66244','54194','88140',                           '56406','51072','80306','82751','17933',                           '89325','26527','42636','77932','72361',                           '14156','93115','87038','72987','95283',                           '69722','77668','66671','15706','34035',                           '30173','75826','48068','58058','92708',                           '57938','14075','27361','77695','55148',                           '33625','88727','11378','83253','60007',                           '38184','90920','88905','54757','12843',                           '38462','50329','50317','27435','69153',                           '80487','64028','16914','97753','34906',                           '55540','57182','12018','52125','11918',                           '93383','47648','44890','14055','83138',                           '27115','58483','78058','91769','57274',                           '56756','68948','68850','86145','57483',                           '49976','50901','54055','65160','94534',                           '53914','27523','92595','71674','19240',                           '38242','54138','42478','52627','83369',                           '54254','79492','75674','92681','28690',                           '74586','18479','50024','21863','55799',                           '38528','54803','53144','26289','86330',                           '31226','73748','28025','17350','76844',                           '74775','77545','11571','27322','31188',                           '33970','99166','77940','68879','93782',                           '28160','71217','61860','92194','52355',                           '79203','71658','99181','60603','89611',                           '57301','27993','75279','79586','74634',                           '60820','49252','30503','72556','30432',                           '91477','69640','17765','88347','20624',                           '39614','40099','16735','45864','71262',                           '58941','22391','85645','13146','77554',                           '86569','26329','15295','32638','87909',                           '58303','23606','78544','73090','20891',                           '90252','53178','64896','87846','48672',                           '69308','25582','63907','62131','61719',                           '60324','19849','35609','79530','67963',                           '25332','29044','31842','43263','46896',                           '59011','43333','23716','43386','94671',                           '44417','40030','17277','18055','40177',                           '25864','74751','90710','26652','95531',                           '14997','19956','14375','96692','87028',                           '39878','99844','18289','13295','83426',                           '86896','19678','21926','99850','88810',                           '39006','91012','88560','34245')      intersect       select ca_zip       from (SELECT substring(ca_zip,1,5) ca_zip,count(*) cnt             FROM customer_address, customer             WHERE ca_address_sk = c_current_addr_sk and                   c_preferred_cust_flag='Y'             group by ca_zip             having count(*) > 10)A1)A2) V1  where ss_store_sk = s_store_sk   and ss_sold_date_sk = d_date_sk   and d_qoy = 1 and d_year = 2000   and (substring(s_zip,1,2) = substring(V1.ca_zip,1,2))  group by s_store_name  order by s_store_name  ;", "predicates": {"customer": ["c_preferred_cust_flag"], "date_dim": ["d_qoy", "d_year"]}, "payload": {"customer": ["c_current_addr_sk"], "customer_address": ["ca_address_sk", "ca_zip"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 9, "query_string": " select case when (select count(*)                    from store_sales                    where ss_quantity between 1 and 20) > 26241             then (select avg(ss_ext_sales_price)                    from store_sales                    where ss_quantity between 1 and 20)              else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 1 and 20) end bucket1 ,        case when (select count(*)                   from store_sales                   where ss_quantity between 21 and 40) > 37843             then (select avg(ss_ext_sales_price)                   from store_sales                   where ss_quantity between 21 and 40)              else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 21 and 40) end bucket2,        case when (select count(*)                   from store_sales                   where ss_quantity between 41 and 60) > 1281             then (select avg(ss_ext_sales_price)                   from store_sales                   where ss_quantity between 41 and 60)             else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 41 and 60) end bucket3,        case when (select count(*)                   from store_sales                   where ss_quantity between 61 and 80) > 46348             then (select avg(ss_ext_sales_price)                   from store_sales                   where ss_quantity between 61 and 80)             else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 61 and 80) end bucket4,        case when (select count(*)                   from store_sales                   where ss_quantity between 81 and 100) > 18611             then (select avg(ss_ext_sales_price)                   from store_sales                   where ss_quantity between 81 and 100)             else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 81 and 100) end bucket5 from reason where r_reason_sk = 1;", "predicates": {"store_sales": ["ss_quantity"]}, "payload": {"store_sales": ["ss_ext_tax", "ss_net_paid_inc_tax"]}, "group_by": {}, "order_by": {}}
{"id": 10, "query_string": " select top (100)    cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3,   cd_dep_count,   count(*) cnt4,   cd_dep_employed_count,   count(*) cnt5,   cd_dep_college_count,   count(*) cnt6  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_county in ('Palo Pinto County','Nome Census Area','Rolette County','Tunica County','Box Butte County') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 1999 and                 d_moy between 3 and 3+3) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 1999 and                   d_moy between 3 ANd 3+3) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 1999 and                   d_moy between 3 and 3+3))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count;", "predicates": {"customer_address": ["ca_county"], "date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 11, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag           ,c_birth_country          ,c_login          ,c_email_address          ,d_year   union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag           ,c_birth_country          ,c_login          ,c_email_address          ,d_year          )   select top (100)                    t_s_secyear.customer_id                  ,t_s_secyear.customer_first_name                  ,t_s_secyear.customer_last_name                  ,t_s_secyear.customer_login  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id          and t_s_firstyear.customer_id = t_w_secyear.customer_id          and t_s_firstyear.customer_id = t_w_firstyear.customer_id          and t_s_firstyear.sale_type = 's'          and t_w_firstyear.sale_type = 'w'          and t_s_secyear.sale_type = 's'          and t_w_secyear.sale_type = 'w'          and t_s_firstyear.dyear = 1998          and t_s_secyear.dyear = 1998+1          and t_w_firstyear.dyear = 1998          and t_w_secyear.dyear = 1998+1          and t_s_firstyear.year_total > 0          and t_w_firstyear.year_total > 0          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end              > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end  order by t_s_secyear.customer_id          ,t_s_secyear.customer_first_name          ,t_s_secyear.customer_last_name          ,t_s_secyear.customer_login;", "predicates": {"date_dim": ["d_year"]}, "payload": {"customer": ["c_login", "c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_ext_list_price", "ss_ext_discount_amt"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_discount_amt", "ws_ext_list_price"]}, "group_by": {}, "order_by": {}}
{"id": 12, "query_string": " select top (100) i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from\t \tweb_sales     \t,item      \t,date_dim where  \tws_item_sk = i_item_sk    \tand i_category in ('Shoes', 'Women', 'Music')   \tand ws_sold_date_sk = d_date_sk \tand d_date between cast('2000-06-23' as date)  \t\t\t\tand dateadd(day, 30, cast('2000-06-23' as date)) group by  \ti_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  \ti_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_desc", "i_class", "i_item_id", "i_category"]}}
{"id": 13, "query_string": " select avg(ss_quantity)        ,avg(ss_ext_sales_price)        ,avg(ss_ext_wholesale_cost)        ,sum(ss_ext_wholesale_cost)  from store_sales      ,store      ,customer_demographics      ,household_demographics      ,customer_address      ,date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2001  and((ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'W'   and cd_education_status = 'Advanced Degree'   and ss_sales_price between 100.00 and 150.00   and hd_dep_count = 3         )or      (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'D'   and cd_education_status = 'College'   and ss_sales_price between 50.00 and 100.00      and hd_dep_count = 1      ) or       (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'U'   and cd_education_status = 'Secondary'   and ss_sales_price between 150.00 and 200.00    and hd_dep_count = 1        ))  and((ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('WA', 'IL', 'CA')   and ss_net_profit between 100 and 200        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('TX', 'TN', 'MA')   and ss_net_profit between 150 and 300        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('LA', 'PA', 'WY')   and ss_net_profit between 50 and 250        ));", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "household_demographics": ["hd_dep_count"], "store_sales": ["ss_sales_price", "ss_net_profit"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_dep_count", "hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_ext_sales_price", "ss_cdemo_sk", "ss_addr_sk", "ss_quantity", "ss_sales_price", "ss_ext_wholesale_cost", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 14, "query_string": " with  cross_items as  (select i_item_sk ss_item_sk  from item,  (select iss.i_brand_id brand_id      ,iss.i_class_id class_id      ,iss.i_category_id category_id  from store_sales      ,item iss      ,date_dim d1  where ss_item_sk = iss.i_item_sk    and ss_sold_date_sk = d1.d_date_sk    and d1.d_year between 1998 AND 1998 + 2  intersect   select ics.i_brand_id      ,ics.i_class_id      ,ics.i_category_id  from catalog_sales      ,item ics      ,date_dim d2  where cs_item_sk = ics.i_item_sk    and cs_sold_date_sk = d2.d_date_sk    and d2.d_year between 1998 AND 1998 + 2  intersect  select iws.i_brand_id      ,iws.i_class_id      ,iws.i_category_id  from web_sales      ,item iws      ,date_dim d3  where ws_item_sk = iws.i_item_sk    and ws_sold_date_sk = d3.d_date_sk    and d3.d_year between 1998 AND 1998 + 2) a  where i_brand_id = brand_id       and i_class_id = class_id       and i_category_id = category_id ),  avg_sales as  (select avg(quantity*list_price) average_sales   from (select ss_quantity quantity              ,ss_list_price list_price        from store_sales            ,date_dim        where ss_sold_date_sk = d_date_sk          and d_year between 1998 and 1998 + 2        union all         select cs_quantity quantity               ,cs_list_price list_price        from catalog_sales            ,date_dim        where cs_sold_date_sk = d_date_sk          and d_year between 1998 and 1998 + 2         union all        select ws_quantity quantity              ,ws_list_price list_price        from web_sales            ,date_dim        where ws_sold_date_sk = d_date_sk          and d_year between 1998 and 1998 + 2) x)   select top (100) channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)  from(        select 'store' channel, i_brand_id,i_class_id              ,i_category_id,sum(ss_quantity*ss_list_price) sales              , count(*) number_sales        from store_sales            ,item            ,date_dim        where ss_item_sk in (select ss_item_sk from cross_items)          and ss_item_sk = i_item_sk          and ss_sold_date_sk = d_date_sk          and d_year = 1998+2           and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)        union all        select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales        from catalog_sales            ,item            ,date_dim        where cs_item_sk in (select ss_item_sk from cross_items)          and cs_item_sk = i_item_sk          and cs_sold_date_sk = d_date_sk          and d_year = 1998+2           and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)        union all        select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales        from web_sales            ,item            ,date_dim        where ws_item_sk in (select ss_item_sk from cross_items)          and ws_item_sk = i_item_sk          and ws_sold_date_sk = d_date_sk          and d_year = 1998+2          and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)  ) y  group by rollup (channel, i_brand_id,i_class_id,i_category_id)  order by channel,i_brand_id,i_class_id,i_category_id  ; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_list_price", "cs_quantity"], "date_dim": ["d_date_sk"], "item": ["i_category_id", "i_class_id", "i_item_sk", "i_brand_id"], "store_sales": ["ss_sold_date_sk", "ss_list_price", "ss_quantity", "ss_item_sk"], "web_sales": ["ws_list_price", "ws_sold_date_sk", "ws_item_sk", "ws_quantity"]}, "group_by": {}, "order_by": {}}
{"id": 15, "query_string": " select top (100) ca_zip        ,sum(cs_sales_price)  from catalog_sales      ,customer      ,customer_address      ,date_dim  where cs_bill_customer_sk = c_customer_sk  \tand c_current_addr_sk = ca_address_sk   \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',                                    '85392', '85460', '80348', '81792')  \t      or ca_state in ('CA','WA','GA')  \t      or cs_sales_price > 500)  \tand cs_sold_date_sk = d_date_sk  \tand d_qoy = 1 and d_year = 1998  group by ca_zip  order by ca_zip  ;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"catalog_sales": ["cs_sales_price", "cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip", "ca_state"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_zip"]}}
{"id": 16, "query_string": " select top (100)     count(distinct cs_order_number) as \"order count\"   ,sum(cs_ext_ship_cost) as \"total shipping cost\"   ,sum(cs_net_profit) as \"total net profit\" from    catalog_sales cs1   ,date_dim   ,customer_address   ,call_center where     d_date between '2000-3-01' and             dateadd(day, 60, cast('2000-3-01' as date)) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'SC' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County',                   'Williamson County' ) and exists (select *             from catalog_sales cs2             where cs1.cs_order_number = cs2.cs_order_number               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select *                from catalog_returns cr1                where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number);", "predicates": {"call_center": ["cc_county"], "customer_address": ["ca_state"], "date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_order_number"], "catalog_sales": ["cs_order_number", "cs_warehouse_sk", "cs_ext_ship_cost", "cs_ship_addr_sk", "cs_net_profit", "cs_call_center_sk", "cs_ship_date_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 17, "query_string": " select top (100) i_item_id        ,i_item_desc        ,s_state        ,count(ss_quantity) as store_sales_quantitycount        ,avg(ss_quantity) as store_sales_quantityave        ,stdev(ss_quantity) as store_sales_quantitystdev        ,stdev(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov        ,count(sr_return_quantity) as store_returns_quantitycount        ,avg(sr_return_quantity) as store_returns_quantityave        ,stdev(sr_return_quantity) as store_returns_quantitystdev        ,stdev(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov        ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave        ,stdev(cs_quantity) as catalog_sales_quantitystdev        ,stdev(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov  from store_sales      ,store_returns      ,catalog_sales      ,date_dim d1      ,date_dim d2      ,date_dim d3      ,store      ,item  where d1.d_quarter_name = '2001Q1'    and d1.d_date_sk = ss_sold_date_sk    and i_item_sk = ss_item_sk    and s_store_sk = ss_store_sk    and ss_customer_sk = sr_customer_sk    and ss_item_sk = sr_item_sk    and ss_ticket_number = sr_ticket_number    and sr_returned_date_sk = d2.d_date_sk    and d2.d_quarter_name in ('2001Q1','2001Q2','2001Q3')    and sr_customer_sk = cs_bill_customer_sk    and sr_item_sk = cs_item_sk    and cs_sold_date_sk = d3.d_date_sk    and d3.d_quarter_name in ('2001Q1','2001Q2','2001Q3')  group by i_item_id          ,i_item_desc          ,s_state  order by i_item_id          ,i_item_desc          ,s_state;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_quarter_name"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_state", "s_store_sk"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_return_quantity", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 18, "query_string": " select top (100) i_item_id,         ca_country,         ca_state,          ca_county,         avg( cast(cs_quantity as decimal(12,2))) agg1,         avg( cast(cs_list_price as decimal(12,2))) agg2,         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,         avg( cast(cs_sales_price as decimal(12,2))) agg4,         avg( cast(cs_net_profit as decimal(12,2))) agg5,         avg( cast(c_birth_year as decimal(12,2))) agg6,         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7  from catalog_sales, customer_demographics cd1,        customer_demographics cd2, customer, customer_address, date_dim, item  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd1.cd_demo_sk and        cs_bill_customer_sk = c_customer_sk and        cd1.cd_gender = 'M' and         cd1.cd_education_status = 'Secondary' and        c_current_cdemo_sk = cd2.cd_demo_sk and        c_current_addr_sk = ca_address_sk and        c_birth_month in (3,9,5,6,12,2) and        d_year = 1999 and        ca_state in ('VA','MI','ND'                    ,'NE','OH','SC','OK')  group by rollup (i_item_id, ca_country, ca_state, ca_county)  order by ca_country,         ca_state,          ca_county, \ti_item_id  ;", "predicates": {"customer": ["c_birth_month"], "customer_address": ["ca_state"], "customer_demographics": ["cd_education_status", "cd_gender"], "date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_quantity", "cs_sales_price", "cs_bill_customer_sk", "cs_item_sk", "cs_net_profit", "cs_list_price", "cs_coupon_amt", "cs_sold_date_sk", "cs_bill_cdemo_sk"], "customer": ["c_birth_year", "c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_county", "ca_country", "ca_state"], "customer_demographics": ["cd_demo_sk", "cd_dep_count"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_state", "ca_county", "ca_country"], "item": ["i_item_id"]}}
{"id": 19, "query_string": " select top (100) i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,  \tsum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item,customer,customer_address,store  where d_date_sk = ss_sold_date_sk    and ss_item_sk = i_item_sk    and i_manager_id=21    and d_moy=12    and d_year=2001    and ss_customer_sk = c_customer_sk     and c_current_addr_sk = ca_address_sk    and substring(ca_zip,1,5) <> substring(s_zip,1,5)     and ss_store_sk = s_store_sk   group by i_brand       ,i_brand_id       ,i_manufact_id       ,i_manufact  order by ext_price desc          ,i_brand          ,i_brand_id          ,i_manufact_id          ,i_manufact  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip"], "date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_brand_id", "i_manufact_id", "i_brand", "i_manufact"], "store": ["s_zip", "s_store_sk"]}, "group_by": {}, "order_by": {"item": ["i_brand", "i_manufact", "i_brand_id", "i_manufact_id"]}}
{"id": 20, "query_string": " select top (100) i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from\tcatalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Shoes', 'Women', 'Music')    and cs_sold_date_sk = d_date_sk  and d_date between cast('2000-06-23' as date)   \t\t\t\tand dateadd(day, 30, cast('2000-06-23' as date))  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"]}, "group_by": {}, "order_by": {"item": ["i_item_desc", "i_class", "i_item_id", "i_category"]}}
{"id": 21, "query_string": " select top (100) *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-10' as date)) \t                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between dateadd(day, -30, cast ('2002-02-10' as date))                     and dateadd(day, 30, cast ('2002-02-10' as date))    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  ;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"]}, "payload": {"date_dim": ["d_date_sk", "d_date"], "item": ["i_item_id", "i_item_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 22, "query_string": " select top (100) i_product_name              ,i_brand              ,i_class              ,i_category              ,avg(inv_quantity_on_hand) qoh        from inventory            ,date_dim            ,item        where inv_date_sk=d_date_sk               and inv_item_sk=i_item_sk               and d_month_seq between 1220 and 1220 + 11        group by rollup(i_product_name                        ,i_brand                        ,i_class                        ,i_category) order by qoh, i_product_name, i_brand, i_class, i_category;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_brand", "i_product_name", "i_category", "i_class"]}, "group_by": {}, "order_by": {"item": ["i_product_name", "i_class", "i_brand", "i_category"]}}
{"id": 23, "query_string": " with frequent_ss_items as   (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt   from store_sales       ,date_dim        ,item   where ss_sold_date_sk = d_date_sk     and ss_item_sk = i_item_sk      and d_year in (1999,1999+1,1999+2,1999+3)   group by substring(i_item_desc,1,30),i_item_sk,d_date   having count(*) >4),  max_store_sales as  (select max(csales) tpcds_cmax    from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales         from store_sales             ,customer             ,date_dim          where ss_customer_sk = c_customer_sk          and ss_sold_date_sk = d_date_sk          and d_year in (1999,1999+1,1999+2,1999+3)          group by c_customer_sk) a),  best_ss_customer as  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales   from store_sales       ,customer   where ss_customer_sk = c_customer_sk   group by c_customer_sk   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select   * from  max_store_sales))   select top (100) sum(sales)  from (select cs_quantity*cs_list_price sales        from catalog_sales            ,date_dim         where d_year = 1999           and d_moy = 4           and cs_sold_date_sk = d_date_sk           and cs_item_sk in (select item_sk from frequent_ss_items)          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)       union all       select ws_quantity*ws_list_price sales        from web_sales             ,date_dim         where d_year = 1999           and d_moy = 4           and ws_sold_date_sk = d_date_sk           and ws_item_sk in (select item_sk from frequent_ss_items)          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) b  ; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"customer": ["c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "item": ["i_item_sk", "i_item_desc"], "store_sales": ["ss_item_sk", "ss_sales_price", "ss_customer_sk", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 24, "query_string": " with ssales as (select c_last_name       ,c_first_name       ,s_store_name       ,ca_state       ,s_state       ,i_color       ,i_current_price       ,i_manager_id       ,i_units       ,i_size       ,sum(ss_ext_sales_price) netpaid from store_sales     ,store_returns     ,store     ,item     ,customer     ,customer_address where ss_ticket_number = sr_ticket_number   and ss_item_sk = sr_item_sk   and ss_customer_sk = c_customer_sk   and ss_item_sk = i_item_sk   and ss_store_sk = s_store_sk   and c_current_addr_sk = ca_address_sk   and c_birth_country <> upper(ca_country)   and s_zip = ca_zip and s_market_id=6 group by c_last_name         ,c_first_name         ,s_store_name         ,ca_state         ,s_state         ,i_color         ,i_current_price         ,i_manager_id         ,i_units         ,i_size) select c_last_name       ,c_first_name       ,s_store_name       ,sum(netpaid) paid from ssales where i_color = 'linen' group by c_last_name         ,c_first_name         ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid)                                  from ssales) order by c_last_name         ,c_first_name         ,s_store_name; ", "predicates": {"item": ["i_color"], "store": ["s_market_id"]}, "payload": {"customer": ["c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_current_addr_sk"], "customer_address": ["ca_address_sk", "ca_country", "ca_zip", "ca_state"], "item": ["i_item_sk", "i_units", "i_manager_id", "i_current_price", "i_size"], "store": ["s_zip", "s_store_name", "s_state", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_net_paid_inc_tax"]}, "group_by": {}, "order_by": {}}
{"id": 25, "query_string": " select top (100)   i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  ,stdev(ss_net_profit) as store_sales_profit  ,stdev(sr_net_loss) as store_returns_loss  ,stdev(cs_net_profit) as catalog_sales_profit  from  store_sales  ,store_returns  ,catalog_sales  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,item  where  d1.d_moy = 4  and d1.d_year = 1998  and d1.d_date_sk = ss_sold_date_sk  and i_item_sk = ss_item_sk  and s_store_sk = ss_store_sk  and ss_customer_sk = sr_customer_sk  and ss_item_sk = sr_item_sk  and ss_ticket_number = sr_ticket_number  and sr_returned_date_sk = d2.d_date_sk  and d2.d_moy               between 4 and  10  and d2.d_year              = 1998  and sr_customer_sk = cs_bill_customer_sk  and sr_item_sk = cs_item_sk  and cs_sold_date_sk = d3.d_date_sk  and d3.d_moy               between 4 and  10   and d3.d_year              = 1998  group by  i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  order by  i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  ;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_store_name", "s_store_sk", "s_store_id"], "store_returns": ["sr_returned_date_sk", "sr_net_loss", "sr_customer_sk", "sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 26, "query_string": " select top (100) i_item_id,          avg(cs_quantity) agg1,         avg(cs_list_price) agg2,         avg(cs_coupon_amt) agg3,         avg(cs_sales_price) agg4   from catalog_sales, customer_demographics, date_dim, item, promotion  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd_demo_sk and        cs_promo_sk = p_promo_sk and        cd_gender = 'M' and         cd_marital_status = 'U' and        cd_education_status = 'Secondary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 1999   group by i_item_id  order by i_item_id  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "promotion": ["p_channel_event", "p_channel_email"]}, "payload": {"item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 27, "query_string": " select top (100) i_item_id,         s_state, grouping(s_state) g_state,         avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4  from store_sales, customer_demographics, date_dim, store, item  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_store_sk = s_store_sk and        ss_cdemo_sk = cd_demo_sk and        cd_gender = 'M' and        cd_marital_status = 'S' and        cd_education_status = '2 yr Degree' and        d_year = 2001 and        s_state in ('TN','TN', 'TN', 'TN', 'TN', 'TN')  group by rollup (i_item_id, s_state)  order by i_item_id          ,s_state  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "store": ["s_state"]}, "payload": {"customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"], "store": ["s_state", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_cdemo_sk", "ss_list_price", "ss_quantity", "ss_sales_price", "ss_coupon_amt", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_id"], "store": ["s_state"]}}
{"id": 28, "query_string": " select top (100) * from (select avg(ss_list_price) B1_LP             ,count(ss_list_price) B1_CNT             ,count(distinct ss_list_price) B1_CNTD       from store_sales       where ss_quantity between 0 and 5         and (ss_list_price between 160 and 160+10               or ss_coupon_amt between 14877 and 14877+1000              or ss_wholesale_cost between 16 and 16+20)) B1,      (select avg(ss_list_price) B2_LP             ,count(ss_list_price) B2_CNT             ,count(distinct ss_list_price) B2_CNTD       from store_sales       where ss_quantity between 6 and 10         and (ss_list_price between 177 and 177+10           or ss_coupon_amt between 10510 and 10510+1000           or ss_wholesale_cost between 11 and 11+20)) B2,      (select avg(ss_list_price) B3_LP             ,count(ss_list_price) B3_CNT             ,count(distinct ss_list_price) B3_CNTD       from store_sales       where ss_quantity between 11 and 15         and (ss_list_price between 64 and 64+10           or ss_coupon_amt between 12278 and 12278+1000           or ss_wholesale_cost between 49 and 49+20)) B3,      (select avg(ss_list_price) B4_LP             ,count(ss_list_price) B4_CNT             ,count(distinct ss_list_price) B4_CNTD       from store_sales       where ss_quantity between 16 and 20         and (ss_list_price between 110 and 110+10           or ss_coupon_amt between 9429 and 9429+1000           or ss_wholesale_cost between 18 and 18+20)) B4,      (select avg(ss_list_price) B5_LP             ,count(ss_list_price) B5_CNT             ,count(distinct ss_list_price) B5_CNTD       from store_sales       where ss_quantity between 21 and 25         and (ss_list_price between 107 and 107+10           or ss_coupon_amt between 3559 and 3559+1000           or ss_wholesale_cost between 45 and 45+20)) B5,      (select avg(ss_list_price) B6_LP             ,count(ss_list_price) B6_CNT             ,count(distinct ss_list_price) B6_CNTD       from store_sales       where ss_quantity between 26 and 30         and (ss_list_price between 114 and 114+10           or ss_coupon_amt between 6433 and 6433+1000           or ss_wholesale_cost between 32 and 32+20)) B6;", "predicates": {"store_sales": ["ss_list_price", "ss_coupon_amt", "ss_quantity", "ss_wholesale_cost"]}, "payload": {"store_sales": ["ss_list_price"]}, "group_by": {}, "order_by": {}}
{"id": 29, "query_string": " select top (100)        i_item_id     ,i_item_desc     ,s_store_id     ,s_store_name     ,stdev(ss_quantity)        as store_sales_quantity     ,stdev(sr_return_quantity) as store_returns_quantity     ,stdev(cs_quantity)        as catalog_sales_quantity  from     store_sales    ,store_returns    ,catalog_sales    ,date_dim             d1    ,date_dim             d2    ,date_dim             d3    ,store    ,item  where      d1.d_moy               = 4   and d1.d_year              = 1999  and d1.d_date_sk           = ss_sold_date_sk  and i_item_sk              = ss_item_sk  and s_store_sk             = ss_store_sk  and ss_customer_sk         = sr_customer_sk  and ss_item_sk             = sr_item_sk  and ss_ticket_number       = sr_ticket_number  and sr_returned_date_sk    = d2.d_date_sk  and d2.d_moy               between 4 and  4 + 3   and d2.d_year              = 1999  and sr_customer_sk         = cs_bill_customer_sk  and sr_item_sk             = cs_item_sk  and cs_sold_date_sk        = d3.d_date_sk       and d3.d_year              in (1999,1999+1,1999+2)  group by     i_item_id    ,i_item_desc    ,s_store_id    ,s_store_name  order by     i_item_id     ,i_item_desc    ,s_store_id    ,s_store_name  ;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_store_name", "s_store_sk", "s_store_id"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_return_quantity", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 30, "query_string": " with customer_total_return as  (select wr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   \tsum(wr_return_amt) as ctr_total_return  from web_returns      ,date_dim      ,customer_address  where wr_returned_date_sk = d_date_sk     and d_year =2001    and wr_returning_addr_sk = ca_address_sk   group by wr_returning_customer_sk          ,ca_state)   select top (100) c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag        ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address        ,c_last_review_date,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  \t\t\t  from customer_total_return ctr2                    \t  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'VA'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag                   ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address                   ,c_last_review_date,ctr_total_return;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_year"]}, "payload": {"customer": ["c_birth_year", "c_login", "c_customer_sk", "c_birth_month", "c_salutation", "c_birth_day", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_current_addr_sk", "c_email_address", "c_customer_id", "c_last_review_date"], "customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "web_returns": ["wr_return_amt", "wr_returning_addr_sk", "wr_returned_date_sk", "wr_returning_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_birth_year", "c_login", "c_birth_month", "c_birth_country", "c_salutation", "c_birth_day", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id", "c_last_review_date"]}}
{"id": 31, "query_string": " with ss as  (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales  from store_sales,date_dim,customer_address  where ss_sold_date_sk = d_date_sk   and ss_addr_sk=ca_address_sk  group by ca_county,d_qoy, d_year),  ws as  (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales  from web_sales,date_dim,customer_address  where ws_sold_date_sk = d_date_sk   and ws_bill_addr_sk=ca_address_sk  group by ca_county,d_qoy, d_year)  select          ss1.ca_county        ,ss1.d_year        ,ws2.web_sales/ws1.web_sales web_q1_q2_increase        ,ss2.store_sales/ss1.store_sales store_q1_q2_increase        ,ws3.web_sales/ws2.web_sales web_q2_q3_increase        ,ss3.store_sales/ss2.store_sales store_q2_q3_increase  from         ss ss1        ,ss ss2        ,ss ss3        ,ws ws1        ,ws ws2        ,ws ws3  where     ss1.d_qoy = 1     and ss1.d_year = 1998     and ss1.ca_county = ss2.ca_county     and ss2.d_qoy = 2     and ss2.d_year = 1998  and ss2.ca_county = ss3.ca_county     and ss3.d_qoy = 3     and ss3.d_year = 1998     and ss1.ca_county = ws1.ca_county     and ws1.d_qoy = 1     and ws1.d_year = 1998     and ws1.ca_county = ws2.ca_county     and ws2.d_qoy = 2     and ws2.d_year = 1998     and ws1.ca_county = ws3.ca_county     and ws3.d_qoy = 3     and ws3.d_year =1998     and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end         > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end     and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end        > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end  order by web_q1_q2_increase;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"customer_address": ["ca_address_sk", "ca_county"], "date_dim": ["d_date_sk", "d_year"], "store_sales": ["ss_sold_date_sk", "ss_addr_sk", "ss_ext_sales_price"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_bill_addr_sk"]}, "group_by": {}, "order_by": {}}
{"id": 32, "query_string": " select top (100) sum(cs_ext_discount_amt)  as \"excess discount amount\"  from     catalog_sales     ,item     ,date_dim where i_manufact_id = 821 and i_item_sk = cs_item_sk  and d_date between '2002-01-24' and          dateadd(day, 90, cast('2002-01-24' as date)) and d_date_sk = cs_sold_date_sk  and cs_ext_discount_amt        > (           select              1.3 * avg(cs_ext_discount_amt)           from              catalog_sales             ,date_dim          where                cs_item_sk = i_item_sk            and d_date between '2002-01-24' and                              dateadd(day, 90, cast('2002-01-24' as date))           and d_date_sk = cs_sold_date_sk        ) ;", "predicates": {"catalog_sales": ["cs_ext_discount_amt"], "date_dim": ["d_date"], "item": ["i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 33, "query_string": " with ss as (  select           i_manufact_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id in (select   i_manufact_id from  item where i_category in ('Home'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 3  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  cs as (  select           i_manufact_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Home'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 3  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  ws as (  select           i_manufact_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Home'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 3  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_manufact_id)   select top (100) i_manufact_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_manufact_id  order by total_sales;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_category"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_addr_sk", "cs_item_sk", "cs_ext_sales_price"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_manufact_id"], "store_sales": ["ss_sold_date_sk", "ss_addr_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk", "ws_bill_addr_sk"]}, "group_by": {}, "order_by": {}}
{"id": 34, "query_string": " select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = '0-500')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  \tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  \telse null  \tend)  > 1.2     and date_dim.d_year in (2000,2000+1,2000+2)     and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',                            'Williamson County','Williamson County','Williamson County','Williamson County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;", "predicates": {"date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count", "hd_buy_potential"], "store": ["s_county"]}, "payload": {"customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_preferred_cust_flag"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 35, "query_string": " select top (100)     ca_state,   cd_gender,   cd_marital_status,   cd_dep_count,   count(*) cnt1,   stdev(cd_dep_count),   avg(cd_dep_count),   min(cd_dep_count),   cd_dep_employed_count,   count(*) cnt2,   stdev(cd_dep_employed_count),   avg(cd_dep_employed_count),   min(cd_dep_employed_count),   cd_dep_college_count,   count(*) cnt3,   stdev(cd_dep_college_count),   avg(cd_dep_college_count),   min(cd_dep_college_count)  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2000 and                 d_qoy < 4) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2000 and                   d_qoy < 4) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2000 and                   d_qoy < 4))  group by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  ;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_state"], "customer_demographics": ["cd_dep_college_count", "cd_gender", "cd_demo_sk", "cd_dep_employed_count", "cd_dep_count", "cd_marital_status"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 36, "query_string": " select top (100)      sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  \tpartition by grouping(i_category)+grouping(i_class),  \tcase when grouping(i_class) = 0 then i_category end   \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent  from     store_sales    ,date_dim       d1    ,item    ,store  where     d1.d_year = 1998   and d1.d_date_sk = ss_sold_date_sk  and i_item_sk  = ss_item_sk   and s_store_sk  = ss_store_sk  and s_state in ('TN','TN','TN','TN',                  'TN','TN','TN','TN')  group by rollup(i_category,i_class)  order by    lochierarchy desc   ,case when (grouping(i_category)+grouping(i_class)) = 0 then i_category end   ,rank_within_parent   ;", "predicates": {"date_dim": ["d_year"], "store": ["s_state"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_class", "i_item_sk", "i_category"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_ext_sales_price", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 37, "query_string": " select top (100) i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 19 and 19 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2001-03-01' as date) and dateadd(day, 60, cast('2001-03-01' as date))  and i_manufact_id in (722,880,695,710)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  ;", "predicates": {"date_dim": ["d_date"], "inventory": ["inv_quantity_on_hand"], "item": ["i_current_price", "i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc", "i_current_price"]}, "group_by": {}, "order_by": {}}
{"id": 38, "query_string": " select top (100) count(*) from (     select distinct c_last_name, c_first_name, d_date     from store_sales, date_dim, customer           where store_sales.ss_sold_date_sk = date_dim.d_date_sk       and store_sales.ss_customer_sk = customer.c_customer_sk       and d_month_seq between 1220 and 1220 + 11   intersect     select distinct c_last_name, c_first_name, d_date     from catalog_sales, date_dim, customer           where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk       and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk       and d_month_seq between 1220 and 1220 + 11   intersect     select distinct c_last_name, c_first_name, d_date     from web_sales, date_dim, customer           where web_sales.ws_sold_date_sk = date_dim.d_date_sk       and web_sales.ws_bill_customer_sk = customer.c_customer_sk       and d_month_seq between 1220 and 1220 + 11 ) hot_cust;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk", "ws_item_sk", "ws_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 39, "query_string": " with inv as (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy        ,stdev,mean, case mean when 0 then null else stdev/mean end cov  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy             ,stdev(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean       from inventory           ,item           ,warehouse           ,date_dim       where inv_item_sk = i_item_sk         and inv_warehouse_sk = w_warehouse_sk         and inv_date_sk = d_date_sk         and d_year =2002       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo  where case mean when 0 then 0 else stdev/mean end > 1) select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov from inv inv1,inv inv2 where inv1.i_item_sk = inv2.i_item_sk   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk   and inv1.d_moy=1   and inv2.d_moy=1+1 order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov         ,inv2.d_moy,inv2.mean, inv2.cov; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_item_sk"], "warehouse": ["w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 40, "query_string": " select top (100)     w_state   ,i_item_id   ,sum(case when (cast(d_date as date) < cast ('2002-02-10' as date))   \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before   ,sum(case when (cast(d_date as date) >= cast ('2002-02-10' as date))   \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after  from    catalog_sales left outer join catalog_returns on        (cs_order_number = cr_order_number          and cs_item_sk = cr_item_sk)   ,warehouse    ,item   ,date_dim  where      i_current_price between 0.99 and 1.49  and i_item_sk          = cs_item_sk  and cs_warehouse_sk    = w_warehouse_sk   and cs_sold_date_sk    = d_date_sk  and d_date between dateadd(day, -30, cast ('2002-02-10' as date))                 and dateadd(day, 30, cast ('2002-02-10' as date))   group by     w_state,i_item_id  order by w_state,i_item_id;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_refunded_cash"], "date_dim": ["d_date_sk", "d_date"], "item": ["i_item_id", "i_item_sk"], "warehouse": ["w_state", "w_warehouse_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_id"], "warehouse": ["w_state"]}}
{"id": 41, "query_string": " select distinct top (100) i_product_name  from item i1  where i_manufact_id between 929 and 929+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'powder' or i_color = 'orange') and          (i_units = 'Each' or i_units = 'Dozen') and         (i_size = 'large' or i_size = 'extra large')         ) or         (i_category = 'Women' and         (i_color = 'violet' or i_color = 'mint') and         (i_units = 'Tsp' or i_units = 'Ounce') and         (i_size = 'small' or i_size = 'N/A')         ) or         (i_category = 'Men' and         (i_color = 'chiffon' or i_color = 'thistle') and         (i_units = 'Box' or i_units = 'Cup') and         (i_size = 'medium' or i_size = 'petite')         ) or         (i_category = 'Men' and         (i_color = 'goldenrod' or i_color = 'misty') and         (i_units = 'Unknown' or i_units = 'Dram') and         (i_size = 'large' or i_size = 'extra large')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'coral' or i_color = 'yellow') and          (i_units = 'Carton' or i_units = 'Lb') and         (i_size = 'large' or i_size = 'extra large')         ) or         (i_category = 'Women' and         (i_color = 'lavender' or i_color = 'midnight') and         (i_units = 'Oz' or i_units = 'Ton') and         (i_size = 'small' or i_size = 'N/A')         ) or         (i_category = 'Men' and         (i_color = 'seashell' or i_color = 'royal') and         (i_units = 'Gram' or i_units = 'Pallet') and         (i_size = 'medium' or i_size = 'petite')         ) or         (i_category = 'Men' and         (i_color = 'light' or i_color = 'purple') and         (i_units = 'Pound' or i_units = 'Bundle') and         (i_size = 'large' or i_size = 'extra large')         )))) > 0  order by i_product_name  ;", "predicates": {"item": ["i_color", "i_units", "i_manufact_id", "i_category", "i_size", "i_manufact"]}, "payload": {"item": ["i_color", "i_units", "i_product_name", "i_category", "i_size", "i_manufact"]}, "group_by": {}, "order_by": {}}
{"id": 42, "query_string": " select top (100) dt.d_year  \t,item.i_category_id  \t,item.i_category  \t,sum(ss_ext_sales_price)  from \tdate_dim dt  \t,store_sales  \t,item  where dt.d_date_sk = store_sales.ss_sold_date_sk  \tand store_sales.ss_item_sk = item.i_item_sk  \tand item.i_manager_id = 1  \t  \tand dt.d_moy=11  \tand dt.d_year=2002  group by \tdt.d_year  \t\t,item.i_category_id  \t\t,item.i_category  order by       sum(ss_ext_sales_price) desc,dt.d_year  \t\t,item.i_category_id  \t\t,item.i_category  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_item_sk", "i_category", "i_category_id"]}, "group_by": {}, "order_by": {"item": ["i_category", "i_category_id"]}}
{"id": 43, "query_string": " select top (100) s_store_name, s_store_id,         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales  from date_dim, store_sales, store  where d_date_sk = ss_sold_date_sk and        s_store_sk = ss_store_sk and        s_gmt_offset = -5 and        d_year = 2002   group by s_store_name, s_store_id  order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales  ;", "predicates": {"date_dim": ["d_year"], "store": ["s_gmt_offset"]}, "payload": {"date_dim": ["d_date_sk", "d_day_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 44, "query_string": " select top (100) asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing from(select *      from (select item_sk,rank() over (order by rank_col asc) rnk            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col                   from store_sales ss1                  where ss_store_sk = 3                  group by ss_item_sk                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col                                                   from store_sales                                                   where ss_store_sk = 3                                                     and ss_customer_sk is null                                                   group by ss_store_sk))V1)V11      where rnk  < 11) asceding,     (select *      from (select item_sk,rank() over (order by rank_col desc) rnk            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col                  from store_sales ss1                  where ss_store_sk = 3                  group by ss_item_sk                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col                                                   from store_sales                                                   where ss_store_sk = 3                                                     and ss_customer_sk is null                                                   group by ss_store_sk))V2)V21      where rnk  < 11) descending, item i1, item i2 where asceding.rnk = descending.rnk    and i1.i_item_sk=asceding.item_sk   and i2.i_item_sk=descending.item_sk order by asceding.rnk;", "predicates": {"store_sales": ["ss_store_sk", "ss_customer_sk"]}, "payload": {"store_sales": ["ss_net_profit", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 45, "query_string": " select top (100) ca_zip, ca_county, sum(ws_sales_price)  from web_sales, customer, customer_address, date_dim, item  where ws_bill_customer_sk = c_customer_sk  \tand c_current_addr_sk = ca_address_sk   \tand ws_item_sk = i_item_sk   \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')  \t      or   \t      i_item_id in (select i_item_id                              from item                              where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)                              )  \t    )  \tand ws_sold_date_sk = d_date_sk  \tand d_qoy = 2 and d_year = 2001  group by ca_zip, ca_county  order by ca_zip, ca_county  ;", "predicates": {"customer_address": ["ca_zip"], "date_dim": ["d_qoy", "d_year"], "item": ["i_item_id"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip", "ca_city"], "date_dim": ["d_date_sk"], "web_sales": ["ws_sales_price", "ws_sold_date_sk", "ws_bill_customer_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 46, "query_string": " select top (100) c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,ca_city bought_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics,customer_address      where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and (household_demographics.hd_dep_count = 3 or          household_demographics.hd_vehicle_count= 3)     and date_dim.d_dow in (6,0)     and date_dim.d_year in (1998,1998+1,1998+2)      and store.s_city in ('Fairview','Midway','Midway','Fairview','Fairview')      group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr     where ss_customer_sk = c_customer_sk       and customer.c_current_addr_sk = current_addr.ca_address_sk       and current_addr.ca_city <> bought_city   order by c_last_name           ,c_first_name           ,ca_city           ,bought_city           ,ss_ticket_number   ;", "predicates": {"date_dim": ["d_dow", "d_year"], "household_demographics": ["hd_vehicle_count", "hd_dep_count"], "store": ["s_city"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk", "c_first_name", "c_last_name"], "customer_address": ["ca_city", "ca_address_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_addr_sk", "ss_coupon_amt", "ss_customer_sk", "ss_hdemo_sk", "ss_net_profit", "ss_sold_date_sk", "ss_store_sk", "ss_ticket_number"]}, "group_by": {}, "order_by": {}}
{"id": 47, "query_string": " with v1 as(  select i_category, i_brand,         s_store_name, s_company_name,         d_year, d_moy,         sum(ss_sales_price) sum_sales,         avg(sum(ss_sales_price)) over           (partition by i_category, i_brand,                      s_store_name, s_company_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      s_store_name, s_company_name            order by d_year, d_moy) rn  from item, store_sales, date_dim, store  where ss_item_sk = i_item_sk and        ss_sold_date_sk = d_date_sk and        ss_store_sk = s_store_sk and        (          d_year = 2000 or          ( d_year = 2000-1 and d_moy =12) or          ( d_year = 2000+1 and d_moy =1)        )  group by i_category, i_brand,           s_store_name, s_company_name,           d_year, d_moy),  v2 as(  select v1.i_category, v1.i_brand         ,v1.d_year, v1.d_moy         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1.s_store_name = v1_lag.s_store_name and        v1.s_store_name = v1_lead.s_store_name and        v1.s_company_name = v1_lag.s_company_name and        v1.s_company_name = v1_lead.s_company_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select top (100) *  from v2  where  d_year = 2000 and             avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, avg_monthly_sales  ;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk", "d_moy", "d_year"], "item": ["i_brand", "i_item_sk", "i_category"], "store": ["s_store_name", "s_store_sk", "s_company_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 48, "query_string": " select sum (ss_quantity)  from store_sales, store, customer_demographics, customer_address, date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2000  and    (   (    cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'D'    and     cd_education_status = 'Secondary'    and     ss_sales_price between 100.00 and 150.00      )  or   (   cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'W'    and     cd_education_status = 'Primary'    and     ss_sales_price between 50.00 and 100.00      )  or   (   cd_demo_sk = ss_cdemo_sk   and     cd_marital_status = 'U'    and     cd_education_status = '2 yr Degree'    and     ss_sales_price between 150.00 and 200.00    )  )  and  (   (   ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('KS', 'CA', 'IL')   and ss_net_profit between 0 and 2000     )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('AR', 'MO', 'TX')   and ss_net_profit between 150 and 3000    )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('MS', 'CO', 'MT')   and ss_net_profit between 50 and 25000    )  );", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "store_sales": ["ss_sales_price", "ss_net_profit"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_cdemo_sk", "ss_addr_sk", "ss_quantity", "ss_sales_price", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 49, "query_string": " select top (100) channel, item, return_ratio, return_rank, currency_rank from  (select  'web' as channel  ,web.item  ,web.return_ratio  ,web.return_rank  ,web.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect ws.ws_item_sk as item  \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\t web_sales ws left outer join web_returns wr   \t\t\ton (ws.ws_order_number = wr.wr_order_number and   \t\t\tws.ws_item_sk = wr.wr_item_sk)                  ,date_dim  \t\twhere   \t\t\twr.wr_return_amt > 10000   \t\t\tand ws.ws_net_profit > 1                          and ws.ws_net_paid > 0                          and ws.ws_quantity > 0                          and ws_sold_date_sk = d_date_sk                          and d_year = 1998                          and d_moy = 11  \t\tgroup by ws.ws_item_sk  \t) in_web  ) web  where   (  web.return_rank <= 10  or  web.currency_rank <= 10  )  union  select   'catalog' as channel  ,catalog.item  ,catalog.return_ratio  ,catalog.return_rank  ,catalog.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect   \t\tcs.cs_item_sk as item  \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\tcatalog_sales cs left outer join catalog_returns cr  \t\t\ton (cs.cs_order_number = cr.cr_order_number and   \t\t\tcs.cs_item_sk = cr.cr_item_sk)                 ,date_dim  \t\twhere   \t\t\tcr.cr_return_amount > 10000   \t\t\tand cs.cs_net_profit > 1                          and cs.cs_net_paid > 0                          and cs.cs_quantity > 0                          and cs_sold_date_sk = d_date_sk                          and d_year = 1998                          and d_moy = 11                  group by cs.cs_item_sk  \t) in_cat  ) catalog  where   (  catalog.return_rank <= 10  or  catalog.currency_rank <=10  )  union  select   'store' as channel  ,store.item  ,store.return_ratio  ,store.return_rank  ,store.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect sts.ss_item_sk as item  \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\tstore_sales sts left outer join store_returns sr  \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)                 ,date_dim  \t\twhere   \t\t\tsr.sr_return_amt > 10000   \t\t\tand sts.ss_net_profit > 1                          and sts.ss_net_paid > 0                           and sts.ss_quantity > 0                          and ss_sold_date_sk = d_date_sk                          and d_year = 1998                          and d_moy = 11  \t\tgroup by sts.ss_item_sk  \t) in_store  ) store  where  (  store.return_rank <= 10  or   store.currency_rank <= 10  )  ) a  order by 1,4,5,2  ;", "predicates": {"catalog_returns": ["cr_return_amount"], "catalog_sales": ["cs_net_paid", "cs_net_profit", "cs_quantity"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_return_amt"], "store_sales": ["ss_net_paid", "ss_quantity", "ss_net_profit"], "web_returns": ["wr_return_amt"], "web_sales": ["ws_net_profit", "ws_net_paid", "ws_quantity"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_quantity", "cr_return_amount"], "store_returns": ["sr_return_amt", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_return_amt", "wr_return_quantity", "wr_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 50, "query_string": " select top (100)     s_store_name   ,s_company_id   ,s_street_number   ,s_street_name   ,s_street_type   ,s_suite_number   ,s_city   ,s_county   ,s_state   ,s_zip   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and                   (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and                   (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and                  (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    store_sales   ,store_returns   ,store   ,date_dim d1   ,date_dim d2 where     d2.d_year = 1998 and d2.d_moy  = 10 and ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_sold_date_sk   = d1.d_date_sk and sr_returned_date_sk   = d2.d_date_sk and ss_customer_sk = sr_customer_sk and ss_store_sk = s_store_sk group by    s_store_name   ,s_company_id   ,s_street_number   ,s_street_name   ,s_street_type   ,s_suite_number   ,s_city   ,s_county   ,s_state   ,s_zip order by s_store_name         ,s_company_id         ,s_street_number         ,s_street_name         ,s_street_type         ,s_suite_number         ,s_city         ,s_county         ,s_state         ,s_zip;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 51, "query_string": " WITH web_v1 as ( select   ws_item_sk item_sk, d_date,   sum(sum(ws_sales_price))       over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from web_sales     ,date_dim where ws_sold_date_sk=d_date_sk   and d_month_seq between 1220 and 1220+11   and ws_item_sk is not NULL group by ws_item_sk, d_date), store_v1 as ( select   ss_item_sk item_sk, d_date,   sum(sum(ss_sales_price))       over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from store_sales     ,date_dim where ss_sold_date_sk=d_date_sk   and d_month_seq between 1220 and 1220+11   and ss_item_sk is not NULL group by ss_item_sk, d_date)  select top (100) * from (select item_sk      ,d_date      ,web_sales      ,store_sales      ,max(web_sales)          over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative      ,max(store_sales)          over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative      from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk                  ,case when web.d_date is not null then web.d_date else store.d_date end d_date                  ,web.cume_sales web_sales                  ,store.cume_sales store_sales            from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk                                                           and web.d_date = store.d_date)           )x )y where web_cumulative > store_cumulative order by item_sk         ,d_date;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_sales_price", "ss_item_sk"], "web_sales": ["ws_sold_date_sk", "ws_sales_price", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 52, "query_string": " select top (100) dt.d_year  \t,item.i_brand_id brand_id  \t,item.i_brand brand  \t,sum(ss_ext_sales_price) ext_price  from date_dim dt      ,store_sales      ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=11     and dt.d_year=2002  group by dt.d_year  \t,item.i_brand  \t,item.i_brand_id  order by dt.d_year  \t,ext_price desc  \t,brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"item": ["i_brand_id"]}}
{"id": 53, "query_string": " select top (100) * from  (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1220,1220+1,1220+2,1220+3,1220+4,1220+5,1220+6,1220+7,1220+8,1220+9,1220+10,1220+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', \t\t'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', \t\t'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0  \tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales  \telse null end > 0.1 order by avg_quarterly_sales, \t sum_sales, \t i_manufact_id;", "predicates": {"date_dim": ["d_month_seq"], "item": ["i_brand", "i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_qoy"], "item": ["i_item_sk", "i_manufact_id", "i_brand", "i_category", "i_class"], "store": ["s_store_sk"]}, "group_by": {}, "order_by": {}}
{"id": 54, "query_string": " with my_customers as (  select distinct c_customer_sk         , c_current_addr_sk  from            ( select cs_sold_date_sk sold_date_sk,                  cs_bill_customer_sk customer_sk,                  cs_item_sk item_sk           from   catalog_sales           union all           select ws_sold_date_sk sold_date_sk,                  ws_bill_customer_sk customer_sk,                  ws_item_sk item_sk           from   web_sales          ) cs_or_ws_sales,          item,          date_dim,          customer  where   sold_date_sk = d_date_sk          and item_sk = i_item_sk          and i_category = 'Home'          and i_class = 'glassware'          and c_customer_sk = cs_or_ws_sales.customer_sk          and d_moy = 3          and d_year = 2001  )  , my_revenue as (  select c_customer_sk,         sum(ss_ext_sales_price) as revenue  from   my_customers,         store_sales,         customer_address,         store,         date_dim  where  c_current_addr_sk = ca_address_sk         and ca_county = s_county         and ca_state = s_state         and ss_sold_date_sk = d_date_sk         and c_customer_sk = ss_customer_sk         and d_month_seq between (select distinct d_month_seq+1                                  from   date_dim where d_year = 2001 and d_moy = 3)                            and  (select distinct d_month_seq+3                                  from   date_dim where d_year = 2001 and d_moy = 3)  group by c_customer_sk  )  , segments as  (select cast((revenue/50) as int) as segment   from   my_revenue  )   select top (100) segment, count(*) as num_customers, segment*50 as segment_base  from segments  group by segment  order by segment, num_customers  ;", "predicates": {"date_dim": ["d_month_seq", "d_moy", "d_year"], "item": ["i_class", "i_category"]}, "payload": {"customer_address": ["ca_address_sk", "ca_county", "ca_state"], "date_dim": ["d_date_sk", "d_month_seq"], "item": ["i_item_sk"], "store": ["s_state", "s_county"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_ext_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 55, "query_string": " select top (100) i_brand_id brand_id, i_brand brand,  \tsum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item  where d_date_sk = ss_sold_date_sk  \tand ss_item_sk = i_item_sk  \tand i_manager_id=40  \tand d_moy=11  \tand d_year=1998  group by i_brand, i_brand_id  order by ext_price desc, i_brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"item": ["i_brand_id"]}}
{"id": 56, "query_string": " with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('olive','cream','lace'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 6  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('olive','cream','lace'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 6  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('olive','cream','lace'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 6  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_item_id)   select top (100) i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  ;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_color"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 57, "query_string": " with v1 as(  select i_category, i_brand,         cc_name,         d_year, d_moy,         sum(cs_sales_price) sum_sales,         avg(sum(cs_sales_price)) over           (partition by i_category, i_brand,                      cc_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      cc_name            order by d_year, d_moy) rn  from item, catalog_sales, date_dim, call_center  where cs_item_sk = i_item_sk and        cs_sold_date_sk = d_date_sk and        cc_call_center_sk= cs_call_center_sk and        (          d_year = 2000 or          ( d_year = 2000-1 and d_moy =12) or          ( d_year = 2000+1 and d_moy =1)        )  group by i_category, i_brand,           cc_name , d_year, d_moy),  v2 as(  select v1.i_category, v1.i_brand, v1.cc_name         ,v1.d_year, v1.d_moy         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1. cc_name = v1_lag. cc_name and        v1. cc_name = v1_lead. cc_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select top (100) *  from v2  where  d_year = 2000 and         avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, avg_monthly_sales  ;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"call_center": ["cc_name", "cc_call_center_sk"], "catalog_sales": ["cs_sales_price", "cs_sold_date_sk", "cs_call_center_sk", "cs_item_sk"], "date_dim": ["d_date_sk", "d_moy", "d_year"], "item": ["i_brand", "i_item_sk", "i_category"]}, "group_by": {}, "order_by": {}}
{"id": 58, "query_string": " with ss_items as  (select i_item_id item_id         ,sum(ss_ext_sales_price) ss_item_rev   from store_sales      ,item      ,date_dim  where ss_item_sk = i_item_sk    and d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2002-02-10'))    and ss_sold_date_sk   = d_date_sk  group by i_item_id),  cs_items as  (select i_item_id item_id         ,sum(cs_ext_sales_price) cs_item_rev   from catalog_sales       ,item       ,date_dim  where cs_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2002-02-10'))   and  cs_sold_date_sk = d_date_sk  group by i_item_id),  ws_items as  (select i_item_id item_id         ,sum(ws_ext_sales_price) ws_item_rev   from web_sales       ,item       ,date_dim  where ws_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq =(select d_week_seq                                       from date_dim                                      where d_date = '2002-02-10'))   and ws_sold_date_sk   = d_date_sk  group by i_item_id)   select top (100) ss_items.item_id        ,ss_item_rev        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev        ,cs_item_rev        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev        ,ws_item_rev        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average  from ss_items,cs_items,ws_items  where ss_items.item_id=cs_items.item_id    and ss_items.item_id=ws_items.item_id     and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  order by item_id          ,ss_item_rev  ;", "predicates": {"date_dim": ["d_week_seq", "d_date"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_item_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "item": ["i_item_id", "i_item_sk"], "store_sales": ["ss_sold_date_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 59, "query_string": " with wss as   (select d_week_seq,         ss_store_sk,         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales  from store_sales,date_dim  where d_date_sk = ss_sold_date_sk  group by d_week_seq,ss_store_sk  )   select top (100) s_store_name1,s_store_id1,d_week_seq1        ,sun_sales1/sun_sales2,mon_sales1/mon_sales2        ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2        ,fri_sales1/fri_sales2,sat_sales1/sat_sales2  from  (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1         ,s_store_id s_store_id1,sun_sales sun_sales1         ,mon_sales mon_sales1,tue_sales tue_sales1         ,wed_sales wed_sales1,thu_sales thu_sales1         ,fri_sales fri_sales1,sat_sales sat_sales1   from wss,store,date_dim d   where d.d_week_seq = wss.d_week_seq and         ss_store_sk = s_store_sk and          d_month_seq between 1182 and 1182 + 11) y,  (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2         ,s_store_id s_store_id2,sun_sales sun_sales2         ,mon_sales mon_sales2,tue_sales tue_sales2         ,wed_sales wed_sales2,thu_sales thu_sales2         ,fri_sales fri_sales2,sat_sales sat_sales2   from wss,store,date_dim d   where d.d_week_seq = wss.d_week_seq and         ss_store_sk = s_store_sk and          d_month_seq between 1182+ 12 and 1182 + 23) x  where s_store_id1=s_store_id2    and d_week_seq1=d_week_seq2-52  order by s_store_name1,s_store_id1,d_week_seq1;", "predicates": {"date_dim": ["d_month_seq"], "store": ["s_store_id"]}, "payload": {"date_dim": ["d_date_sk", "d_week_seq", "d_day_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 60, "query_string": " with ss as (  select           i_item_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where          i_item_id in (select   i_item_id from  item where i_category in ('Men'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 8  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  cs as (  select           i_item_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Men'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 8  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  ws as (  select           i_item_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Men'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 8  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_item_id)   select top (100)     i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by i_item_id       ,total_sales  ;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_item_id", "i_category"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 61, "query_string": " select top (100) promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from   (select sum(ss_ext_sales_price) promotions    from  store_sales         ,store         ,promotion         ,date_dim         ,customer         ,customer_address          ,item    where ss_sold_date_sk = d_date_sk    and   ss_store_sk = s_store_sk    and   ss_promo_sk = p_promo_sk    and   ss_customer_sk= c_customer_sk    and   ca_address_sk = c_current_addr_sk    and   ss_item_sk = i_item_sk     and   ca_gmt_offset = -7    and   i_category = 'Home'    and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')    and   s_gmt_offset = -7    and   d_year = 2001    and   d_moy  = 12) promotional_sales,   (select sum(ss_ext_sales_price) total    from  store_sales         ,store         ,date_dim         ,customer         ,customer_address         ,item    where ss_sold_date_sk = d_date_sk    and   ss_store_sk = s_store_sk    and   ss_customer_sk= c_customer_sk    and   ca_address_sk = c_current_addr_sk    and   ss_item_sk = i_item_sk    and   ca_gmt_offset = -7    and   i_category = 'Home'    and   s_gmt_offset = -7    and   d_year = 2001    and   d_moy  = 12) all_sales order by promotions, total;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_category"], "promotion": ["p_channel_dmail", "p_channel_email", "p_channel_tv"], "store": ["s_gmt_offset"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_promo_sk", "ss_item_sk", "ss_ext_sales_price", "ss_customer_sk", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 62, "query_string": " select top (100)     substring(w_warehouse_name,1,20)   ,sm_type   ,web_name   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and                   (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and                   (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and                  (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    web_sales   ,warehouse   ,ship_mode   ,web_site   ,date_dim where     d_month_seq between 1220 and 1220 + 11 and ws_ship_date_sk   = d_date_sk and ws_warehouse_sk   = w_warehouse_sk and ws_ship_mode_sk   = sm_ship_mode_sk and ws_web_site_sk    = web_site_sk group by    substring(w_warehouse_name,1,20)   ,sm_type   ,web_name order by substring(w_warehouse_name,1,20)         ,sm_type        ,web_name;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "ship_mode": ["sm_type", "sm_ship_mode_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"], "web_sales": ["ws_ship_date_sk", "ws_ship_mode_sk", "ws_sold_date_sk", "ws_warehouse_sk", "ws_web_site_sk"], "web_site": ["web_name", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 63, "query_string": " select top (100) *  from (select i_manager_id              ,sum(ss_sales_price) sum_sales              ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales       from item           ,store_sales           ,date_dim           ,store       where ss_item_sk = i_item_sk         and ss_sold_date_sk = d_date_sk         and ss_store_sk = s_store_sk         and d_month_seq in (1220,1220+1,1220+2,1220+3,1220+4,1220+5,1220+6,1220+7,1220+8,1220+9,1220+10,1220+11)         and ((    i_category in ('Books','Children','Electronics')               and i_class in ('personal','portable','reference','self-help')               and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', \t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))            or(    i_category in ('Women','Music','Men')               and i_class in ('accessories','classical','fragrances','pants')               and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', \t\t                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id         ,avg_monthly_sales         ,sum_sales;", "predicates": {"date_dim": ["d_month_seq"], "item": ["i_brand", "i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_item_sk", "i_manager_id", "i_brand", "i_category", "i_class"], "store": ["s_store_sk"]}, "group_by": {}, "order_by": {"item": ["i_manager_id"]}}
{"id": 64, "query_string": " with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('tomato','blush','pink','sky','yellow','black') and          i_current_price between 34 and 34 + 10 and          i_current_price between 34 + 1 and 34 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;", "predicates": {"customer_demographics": ["cd_marital_status"], "date_dim": ["d_year"], "item": ["i_color", "i_current_price"], "store": ["s_zip", "s_store_name"]}, "payload": {"household_demographics": ["hd_income_band_sk", "hd_demo_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 65, "query_string": " select top (100) \ts_store_name, \ti_item_desc, \tsc.revenue, \ti_current_price, \ti_wholesale_cost, \ti_brand  from store, item,      (select ss_store_sk, avg(revenue) as ave  \tfrom  \t    (select  ss_store_sk, ss_item_sk,   \t\t     sum(ss_sales_price) as revenue  \t\tfrom store_sales, date_dim  \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1220 and 1220+11  \t\tgroup by ss_store_sk, ss_item_sk) sa  \tgroup by ss_store_sk) sb,      (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue  \tfrom store_sales, date_dim  \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1220 and 1220+11  \tgroup by ss_store_sk, ss_item_sk) sc  where sb.ss_store_sk = sc.ss_store_sk and         sc.revenue <= 0.1 * sb.ave and        s_store_sk = sc.ss_store_sk and        i_item_sk = sc.ss_item_sk  order by s_store_name, i_item_desc;", "predicates": {"date_dim": ["d_month_seq"], "store_sales": ["ss_store_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_brand", "i_wholesale_cost", "i_item_desc"], "store": ["s_store_name", "s_store_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price", "ss_item_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_desc"], "store": ["s_store_name"]}}
{"id": 66, "query_string": " select top (100)            w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country         ,ship_carriers         ,year  \t,sum(jan_sales) as jan_sales  \t,sum(feb_sales) as feb_sales  \t,sum(mar_sales) as mar_sales  \t,sum(apr_sales) as apr_sales  \t,sum(may_sales) as may_sales  \t,sum(jun_sales) as jun_sales  \t,sum(jul_sales) as jul_sales  \t,sum(aug_sales) as aug_sales  \t,sum(sep_sales) as sep_sales  \t,sum(oct_sales) as oct_sales  \t,sum(nov_sales) as nov_sales  \t,sum(dec_sales) as dec_sales  \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot  \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot  \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot  \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot  \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot  \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot  \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot  \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot  \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot  \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot  \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot  \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot  \t,sum(jan_net) as jan_net  \t,sum(feb_net) as feb_net  \t,sum(mar_net) as mar_net  \t,sum(apr_net) as apr_net  \t,sum(may_net) as may_net  \t,sum(jun_net) as jun_net  \t,sum(jul_net) as jul_net  \t,sum(aug_net) as aug_net  \t,sum(sep_net) as sep_net  \t,sum(oct_net) as oct_net  \t,sum(nov_net) as nov_net  \t,sum(dec_net) as dec_net  from (      select   \tw_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,concat('HARMSTORF' , ',' , 'GERMA') as ship_carriers        ,d_year as year  \t,sum(case when d_moy = 1   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jan_sales  \t,sum(case when d_moy = 2   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as feb_sales  \t,sum(case when d_moy = 3   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as mar_sales  \t,sum(case when d_moy = 4   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as apr_sales  \t,sum(case when d_moy = 5   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as may_sales  \t,sum(case when d_moy = 6   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jun_sales  \t,sum(case when d_moy = 7   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jul_sales  \t,sum(case when d_moy = 8   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as aug_sales  \t,sum(case when d_moy = 9   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as sep_sales  \t,sum(case when d_moy = 10   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as oct_sales  \t,sum(case when d_moy = 11  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as nov_sales  \t,sum(case when d_moy = 12  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as dec_sales  \t,sum(case when d_moy = 1   \t\tthen ws_net_profit * ws_quantity else 0 end) as jan_net  \t,sum(case when d_moy = 2  \t\tthen ws_net_profit * ws_quantity else 0 end) as feb_net  \t,sum(case when d_moy = 3   \t\tthen ws_net_profit * ws_quantity else 0 end) as mar_net  \t,sum(case when d_moy = 4   \t\tthen ws_net_profit * ws_quantity else 0 end) as apr_net  \t,sum(case when d_moy = 5   \t\tthen ws_net_profit * ws_quantity else 0 end) as may_net  \t,sum(case when d_moy = 6   \t\tthen ws_net_profit * ws_quantity else 0 end) as jun_net  \t,sum(case when d_moy = 7   \t\tthen ws_net_profit * ws_quantity else 0 end) as jul_net  \t,sum(case when d_moy = 8   \t\tthen ws_net_profit * ws_quantity else 0 end) as aug_net  \t,sum(case when d_moy = 9   \t\tthen ws_net_profit * ws_quantity else 0 end) as sep_net  \t,sum(case when d_moy = 10   \t\tthen ws_net_profit * ws_quantity else 0 end) as oct_net  \t,sum(case when d_moy = 11  \t\tthen ws_net_profit * ws_quantity else 0 end) as nov_net  \t,sum(case when d_moy = 12  \t\tthen ws_net_profit * ws_quantity else 0 end) as dec_net      from           web_sales          ,warehouse          ,date_dim          ,time_dim  \t  ,ship_mode      where             ws_warehouse_sk =  w_warehouse_sk         and ws_sold_date_sk = d_date_sk         and ws_sold_time_sk = t_time_sk  \tand ws_ship_mode_sk = sm_ship_mode_sk         and d_year = 2001  \tand t_time between 19268 and 19268+28800   \tand sm_carrier in ('HARMSTORF','GERMA')      group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country        ,d_year  union all      select   \tw_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,concat('HARMSTORF', ',', 'GERMA') as ship_carriers        ,d_year as year  \t,sum(case when d_moy = 1   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jan_sales  \t,sum(case when d_moy = 2   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as feb_sales  \t,sum(case when d_moy = 3   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as mar_sales  \t,sum(case when d_moy = 4   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as apr_sales  \t,sum(case when d_moy = 5   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as may_sales  \t,sum(case when d_moy = 6   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jun_sales  \t,sum(case when d_moy = 7   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jul_sales  \t,sum(case when d_moy = 8   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as aug_sales  \t,sum(case when d_moy = 9   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as sep_sales  \t,sum(case when d_moy = 10   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as oct_sales  \t,sum(case when d_moy = 11  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as nov_sales  \t,sum(case when d_moy = 12  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as dec_sales  \t,sum(case when d_moy = 1   \t\tthen cs_net_profit * cs_quantity else 0 end) as jan_net  \t,sum(case when d_moy = 2   \t\tthen cs_net_profit * cs_quantity else 0 end) as feb_net  \t,sum(case when d_moy = 3   \t\tthen cs_net_profit * cs_quantity else 0 end) as mar_net  \t,sum(case when d_moy = 4   \t\tthen cs_net_profit * cs_quantity else 0 end) as apr_net  \t,sum(case when d_moy = 5   \t\tthen cs_net_profit * cs_quantity else 0 end) as may_net  \t,sum(case when d_moy = 6   \t\tthen cs_net_profit * cs_quantity else 0 end) as jun_net  \t,sum(case when d_moy = 7   \t\tthen cs_net_profit * cs_quantity else 0 end) as jul_net  \t,sum(case when d_moy = 8   \t\tthen cs_net_profit * cs_quantity else 0 end) as aug_net  \t,sum(case when d_moy = 9   \t\tthen cs_net_profit * cs_quantity else 0 end) as sep_net  \t,sum(case when d_moy = 10   \t\tthen cs_net_profit * cs_quantity else 0 end) as oct_net  \t,sum(case when d_moy = 11  \t\tthen cs_net_profit * cs_quantity else 0 end) as nov_net  \t,sum(case when d_moy = 12  \t\tthen cs_net_profit * cs_quantity else 0 end) as dec_net      from           catalog_sales          ,warehouse          ,date_dim          ,time_dim  \t ,ship_mode      where             cs_warehouse_sk =  w_warehouse_sk         and cs_sold_date_sk = d_date_sk         and cs_sold_time_sk = t_time_sk  \tand cs_ship_mode_sk = sm_ship_mode_sk         and d_year = 2001  \tand t_time between 19268 AND 19268+28800   \tand sm_carrier in ('HARMSTORF','GERMA')      group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country        ,d_year  ) x  group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,ship_carriers        ,year  order by w_warehouse_name  ;", "predicates": {"date_dim": ["d_year"], "ship_mode": ["sm_carrier"], "time_dim": ["t_time"]}, "payload": {"catalog_sales": ["cs_warehouse_sk", "cs_ext_list_price", "cs_quantity", "cs_net_paid_inc_tax", "cs_ship_mode_sk", "cs_sold_date_sk", "cs_sold_time_sk"], "date_dim": ["d_date_sk", "d_moy", "d_year"], "ship_mode": ["sm_ship_mode_sk"], "time_dim": ["t_time_sk"], "web_sales": ["ws_ship_mode_sk", "ws_ext_list_price", "ws_sold_date_sk", "ws_quantity", "ws_sold_time_sk", "ws_warehouse_sk", "ws_net_paid"]}, "group_by": {}, "order_by": {}}
{"id": 67, "query_string": " select top (100) * from (select i_category             ,i_class             ,i_brand             ,i_product_name             ,d_year             ,d_qoy             ,d_moy             ,s_store_id             ,sumsales             ,rank() over (partition by i_category order by sumsales desc) rk       from (select i_category                   ,i_class                   ,i_brand                   ,i_product_name                   ,d_year                   ,d_qoy                   ,d_moy                   ,s_store_id                   ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales             from store_sales                 ,date_dim                 ,store                 ,item        where  ss_sold_date_sk=d_date_sk           and ss_item_sk=i_item_sk           and ss_store_sk = s_store_sk           and d_month_seq between 1220 and 1220+11        group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 order by i_category         ,i_class         ,i_brand         ,i_product_name         ,d_year         ,d_qoy         ,d_moy         ,s_store_id         ,sumsales         ,rk;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk", "d_moy", "d_qoy", "d_year"], "item": ["i_item_sk", "i_brand", "i_product_name", "i_category", "i_class"], "store": ["s_store_sk", "s_store_id"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_sales_price", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {"date_dim": ["d_moy", "d_qoy", "d_year"], "item": ["i_brand", "i_class", "i_product_name", "i_category"], "store": ["s_store_id"]}}
{"id": 68, "query_string": " select top (100) c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,extended_price        ,extended_tax        ,list_price  from (select ss_ticket_number              ,ss_customer_sk              ,ca_city bought_city              ,sum(ss_ext_sales_price) extended_price               ,sum(ss_ext_list_price) list_price              ,sum(ss_ext_tax) extended_tax         from store_sales            ,date_dim            ,store            ,household_demographics            ,customer_address         where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_store_sk = store.s_store_sk           and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk         and store_sales.ss_addr_sk = customer_address.ca_address_sk         and date_dim.d_dom between 1 and 2          and (household_demographics.hd_dep_count = 3 or              household_demographics.hd_vehicle_count= -1)         and date_dim.d_year in (1998,1998+1,1998+2)         and store.s_city in ('Fairview','Midway')        group by ss_ticket_number                ,ss_customer_sk                ,ss_addr_sk,ca_city) dn       ,customer       ,customer_address current_addr  where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name          ,ss_ticket_number  ;", "predicates": {"customer_address": ["ca_city"], "date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_city"]}, "payload": {"customer": ["c_current_addr_sk", "c_first_name", "c_last_name", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_city"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_ext_sales_price", "ss_addr_sk", "ss_customer_sk", "ss_ticket_number", "ss_ext_list_price", "ss_ext_tax", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 69, "query_string": " select top (100)    cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_state in ('AL','WI','SC') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2000 and                 d_moy between 4 and 4+2) and    (not exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2000 and                   d_moy between 4 and 4+2) and     not exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2000 and                   d_moy between 4 and 4+2))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  ;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 70, "query_string": " select top (100)      sum(ss_net_profit) as total_sum    ,s_state    ,s_county    ,grouping(s_state)+grouping(s_county) as lochierarchy    ,rank() over (  \tpartition by grouping(s_state)+grouping(s_county),  \tcase when grouping(s_county) = 0 then s_state end   \torder by sum(ss_net_profit) desc) as rank_within_parent  from     store_sales    ,date_dim       d1    ,store  where     d1.d_month_seq between 1220 and 1220+11  and d1.d_date_sk = ss_sold_date_sk  and s_store_sk  = ss_store_sk  and s_state in              ( select s_state                from  (select s_state as s_state,  \t\t\t    rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking                       from   store_sales, store, date_dim                       where  d_month_seq between 1220 and 1220+11  \t\t\t    and d_date_sk = ss_sold_date_sk  \t\t\t    and s_store_sk  = ss_store_sk                       group by s_state                      ) tmp1                 where ranking <= 5              )  group by rollup(s_state,s_county)  order by    lochierarchy desc   ,case when (grouping(s_state)+grouping(s_county)) = 0 then s_state end   ,rank_within_parent  ;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 71, "query_string": " select i_brand_id brand_id, i_brand brand,t_hour,t_minute,  \tsum(ext_price) ext_price  from item, (select ws_ext_sales_price as ext_price,                          ws_sold_date_sk as sold_date_sk,                         ws_item_sk as sold_item_sk,                         ws_sold_time_sk as time_sk                    from web_sales,date_dim                  where d_date_sk = ws_sold_date_sk                    and d_moy=11                    and d_year=1998                  union all                  select cs_ext_sales_price as ext_price,                         cs_sold_date_sk as sold_date_sk,                         cs_item_sk as sold_item_sk,                         cs_sold_time_sk as time_sk                  from catalog_sales,date_dim                  where d_date_sk = cs_sold_date_sk                    and d_moy=11                    and d_year=1998                  union all                  select ss_ext_sales_price as ext_price,                         ss_sold_date_sk as sold_date_sk,                         ss_item_sk as sold_item_sk,                         ss_sold_time_sk as time_sk                  from store_sales,date_dim                  where d_date_sk = ss_sold_date_sk                    and d_moy=11                    and d_year=1998                  ) tmp,time_dim  where    sold_item_sk = i_item_sk    and i_manager_id=1    and time_sk = t_time_sk    and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')  group by i_brand, i_brand_id,t_hour,t_minute  order by ext_price desc, i_brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"], "time_dim": ["t_meal_time"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_brand", "i_item_sk", "i_brand_id"], "time_dim": ["t_hour", "t_minute", "t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 72, "query_string": " select top (100) i_item_desc       ,w_warehouse_name       ,d1.d_week_seq       ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo       ,sum(case when p_promo_sk is not null then 1 else 0 end) promo       ,count(*) total_cnt from catalog_sales join inventory on (cs_item_sk = inv_item_sk) join warehouse on (w_warehouse_sk=inv_warehouse_sk) join item on (i_item_sk = cs_item_sk) join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk) join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk) join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk) join date_dim d2 on (inv_date_sk = d2.d_date_sk) join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk) left outer join promotion on (cs_promo_sk=p_promo_sk) left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number) where d1.d_week_seq = d2.d_week_seq   and inv_quantity_on_hand < cs_quantity    and d3.d_date > dateadd(day, 5, d1.d_date)   and hd_buy_potential = '1001-5000'   and d1.d_year = 1998   and cd_marital_status = 'U' group by i_item_desc,w_warehouse_name,d1.d_week_seq order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq;", "predicates": {"customer_demographics": ["cd_marital_status"], "date_dim": ["d_date", "d_year"], "household_demographics": ["hd_buy_potential"], "inventory": ["inv_warehouse_sk"], "warehouse": ["w_warehouse_sk"]}, "payload": {"catalog_sales": ["cs_quantity", "cs_promo_sk", "cs_item_sk", "cs_ship_date_sk", "cs_bill_cdemo_sk", "cs_sold_date_sk", "cs_bill_hdemo_sk"], "customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "household_demographics": ["hd_demo_sk"], "item": ["i_item_sk", "i_item_desc"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {"date_dim": ["d_week_seq"], "item": ["i_item_desc"], "warehouse": ["w_warehouse_name"]}}
{"id": 73, "query_string": " select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = '0-500')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (2000,2000+1,2000+2)     and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;", "predicates": {"date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count", "hd_buy_potential"], "store": ["s_county"]}, "payload": {"customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_preferred_cust_flag"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 74, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,d_year as year        ,avg(ss_net_paid) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk    and d_year in (2001,2001+1)  group by c_customer_id          ,c_first_name          ,c_last_name          ,d_year  union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,d_year as year        ,avg(ws_net_paid) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk    and d_year in (2001,2001+1)  group by c_customer_id          ,c_first_name          ,c_last_name          ,d_year          )   select top (100)         t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id          and t_s_firstyear.customer_id = t_w_secyear.customer_id          and t_s_firstyear.customer_id = t_w_firstyear.customer_id          and t_s_firstyear.sale_type = 's'          and t_w_firstyear.sale_type = 'w'          and t_s_secyear.sale_type = 's'          and t_w_secyear.sale_type = 'w'          and t_s_firstyear.year = 2001          and t_s_secyear.year = 2001+1          and t_w_firstyear.year = 2001          and t_w_secyear.year = 2001+1          and t_s_firstyear.year_total > 0          and t_w_firstyear.year_total > 0          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end  order by 2,1,3;", "predicates": {"date_dim": ["d_year"]}, "payload": {"customer": ["c_customer_id", "c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_net_paid"], "web_sales": ["ws_net_paid", "ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_customer_id", "c_last_name", "c_first_name"]}}
{"id": 75, "query_string": " WITH all_sales AS (  SELECT d_year        ,i_brand_id        ,i_class_id        ,i_category_id        ,i_manufact_id        ,SUM(sales_cnt) AS sales_cnt        ,SUM(sales_amt) AS sales_amt  FROM (SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt              ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt        FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk                           JOIN date_dim ON d_date_sk=cs_sold_date_sk                           LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number                                                      AND cs_item_sk=cr_item_sk)        WHERE i_category='Women'        UNION        SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt              ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt        FROM store_sales JOIN item ON i_item_sk=ss_item_sk                         JOIN date_dim ON d_date_sk=ss_sold_date_sk                         LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number                                                  AND ss_item_sk=sr_item_sk)        WHERE i_category='Women'        UNION        SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt              ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt        FROM web_sales JOIN item ON i_item_sk=ws_item_sk                       JOIN date_dim ON d_date_sk=ws_sold_date_sk                       LEFT JOIN web_returns ON (ws_order_number=wr_order_number                                              AND ws_item_sk=wr_item_sk)        WHERE i_category='Women') sales_detail  GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)  SELECT top (100) prev_yr.d_year AS prev_year                           ,curr_yr.d_year AS year                           ,curr_yr.i_brand_id                           ,curr_yr.i_class_id                           ,curr_yr.i_category_id                           ,curr_yr.i_manufact_id                           ,prev_yr.sales_cnt AS prev_yr_cnt                           ,curr_yr.sales_cnt AS curr_yr_cnt                           ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff                           ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff  FROM all_sales curr_yr, all_sales prev_yr  WHERE curr_yr.i_brand_id=prev_yr.i_brand_id    AND curr_yr.i_class_id=prev_yr.i_class_id    AND curr_yr.i_category_id=prev_yr.i_category_id    AND curr_yr.i_manufact_id=prev_yr.i_manufact_id    AND curr_yr.d_year=2001    AND prev_yr.d_year=2001-1    AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9  ORDER BY sales_cnt_diff,sales_amt_diff  ;", "predicates": {"date_dim": ["d_year"], "item": ["i_category"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_quantity", "cr_return_amount"], "date_dim": ["d_date_sk", "d_year"], "item": ["i_class_id", "i_item_sk", "i_category_id", "i_brand_id", "i_manufact_id"], "store_returns": ["sr_return_amt", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_return_amt", "wr_return_quantity", "wr_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 76, "query_string": " select top (100) channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (         SELECT 'store' as channel, 'ss_customer_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price          FROM store_sales, item, date_dim          WHERE ss_customer_sk IS NULL            AND ss_sold_date_sk=d_date_sk            AND ss_item_sk=i_item_sk         UNION ALL         SELECT 'web' as channel, 'ws_promo_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price          FROM web_sales, item, date_dim          WHERE ws_promo_sk IS NULL            AND ws_sold_date_sk=d_date_sk            AND ws_item_sk=i_item_sk         UNION ALL         SELECT 'catalog' as channel, 'cs_bill_customer_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price          FROM catalog_sales, item, date_dim          WHERE cs_bill_customer_sk IS NULL            AND cs_sold_date_sk=d_date_sk            AND cs_item_sk=i_item_sk) foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category;", "predicates": {"catalog_sales": ["cs_ship_addr_sk"], "store_sales": ["ss_promo_sk"], "web_sales": ["ws_promo_sk"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_item_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_qoy", "d_year"], "item": ["i_item_sk", "i_category"], "store_sales": ["ss_sold_date_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 77, "query_string": " with ss as  (select s_store_sk,          sum(ss_ext_sales_price) as sales,          sum(ss_net_profit) as profit  from store_sales,       date_dim,       store  where ss_sold_date_sk = d_date_sk        and d_date between cast('2002-08-05' as date)                    and dateadd(day, 30, cast('2002-08-05' as date))         and ss_store_sk = s_store_sk  group by s_store_sk)  ,  sr as  (select s_store_sk,          sum(sr_return_amt) as returns,          sum(sr_net_loss) as profit_loss  from store_returns,       date_dim,       store  where sr_returned_date_sk = d_date_sk        and d_date between cast('2002-08-05' as date)                   and dateadd(day, 30, cast('2002-08-05' as date))        and sr_store_sk = s_store_sk  group by s_store_sk),   cs as  (select cs_call_center_sk,         sum(cs_ext_sales_price) as sales,         sum(cs_net_profit) as profit  from catalog_sales,       date_dim  where cs_sold_date_sk = d_date_sk        and d_date between cast('2002-08-05' as date)                   and dateadd(day, 30, cast('2002-08-05' as date))  group by cs_call_center_sk   ),   cr as  (select cr_call_center_sk,          sum(cr_return_amount) as returns,          sum(cr_net_loss) as profit_loss  from catalog_returns,       date_dim  where cr_returned_date_sk = d_date_sk        and d_date between cast('2002-08-05' as date)                   and dateadd(day, 30, cast('2002-08-05' as date))  group by cr_call_center_sk  ),   ws as  ( select wp_web_page_sk,         sum(ws_ext_sales_price) as sales,         sum(ws_net_profit) as profit  from web_sales,       date_dim,       web_page  where ws_sold_date_sk = d_date_sk        and d_date between cast('2002-08-05' as date)                   and dateadd(day, 30, cast('2002-08-05' as date))        and ws_web_page_sk = wp_web_page_sk  group by wp_web_page_sk),   wr as  (select wp_web_page_sk,         sum(wr_return_amt) as returns,         sum(wr_net_loss) as profit_loss  from web_returns,       date_dim,       web_page  where wr_returned_date_sk = d_date_sk        and d_date between cast('2002-08-05' as date)                   and dateadd(day, 30, cast('2002-08-05' as date))        and wr_web_page_sk = wp_web_page_sk  group by wp_web_page_sk)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , ss.s_store_sk as id         , sales         , coalesce(returns, 0) as returns         , (profit - coalesce(profit_loss,0)) as profit  from   ss left join sr         on  ss.s_store_sk = sr.s_store_sk  union all  select 'catalog channel' as channel         , cs_call_center_sk as id         , sales         , returns         , (profit - profit_loss) as profit  from  cs        , cr  union all  select 'web channel' as channel         , ws.wp_web_page_sk as id         , sales         , coalesce(returns, 0) returns         , (profit - coalesce(profit_loss,0)) as profit  from   ws left join wr         on  ws.wp_web_page_sk = wr.wp_web_page_sk  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_return_amount", "cr_call_center_sk"], "catalog_sales": ["cs_net_profit", "cs_sold_date_sk", "cs_call_center_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_net_loss"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit", "ss_ext_sales_price"], "web_page": ["wp_web_page_sk"], "web_returns": ["wr_web_page_sk", "wr_returned_date_sk", "wr_return_amt", "wr_net_loss"], "web_sales": ["ws_net_profit", "ws_ext_sales_price", "ws_web_page_sk", "ws_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 78, "query_string": " with ws as   (select d_year AS ws_sold_year, ws_item_sk,     ws_bill_customer_sk ws_customer_sk,     sum(ws_quantity) ws_qty,     sum(ws_wholesale_cost) ws_wc,     sum(ws_sales_price) ws_sp    from web_sales    left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk    join date_dim on ws_sold_date_sk = d_date_sk    where wr_order_number is null    group by d_year, ws_item_sk, ws_bill_customer_sk    ), cs as   (select d_year AS cs_sold_year, cs_item_sk,     cs_bill_customer_sk cs_customer_sk,     sum(cs_quantity) cs_qty,     sum(cs_wholesale_cost) cs_wc,     sum(cs_sales_price) cs_sp    from catalog_sales    left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk    join date_dim on cs_sold_date_sk = d_date_sk    where cr_order_number is null    group by d_year, cs_item_sk, cs_bill_customer_sk    ), ss as   (select d_year AS ss_sold_year, ss_item_sk,     ss_customer_sk,     sum(ss_quantity) ss_qty,     sum(ss_wholesale_cost) ss_wc,     sum(ss_sales_price) ss_sp    from store_sales    left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk    join date_dim on ss_sold_date_sk = d_date_sk    where sr_ticket_number is null    group by d_year, ss_item_sk, ss_customer_sk    )  select top (100) ss_customer_sk, round(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk) where (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=1998 order by    ss_customer_sk,   ss_qty desc, ss_wc desc, ss_sp desc,   other_chan_qty,   other_chan_wholesale_cost,   other_chan_sales_price,   ratio;", "predicates": {"catalog_returns": ["cr_order_number"], "catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_year"], "store_returns": ["sr_ticket_number"], "store_sales": ["ss_customer_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_bill_customer_sk"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "store_returns": ["sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_item_sk", "ss_sales_price", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_wholesale_cost", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 79, "query_string": " select top (100)   c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,store.s_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 4)     and date_dim.d_dow = 1     and date_dim.d_year in (1998,1998+1,1998+2)      and store.s_number_employees between 200 and 295     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer     where ss_customer_sk = c_customer_sk  order by c_last_name,c_first_name,substring(s_city,1,30), profit;", "predicates": {"date_dim": ["d_dow", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_number_employees"]}, "payload": {"customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_city", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_addr_sk", "ss_customer_sk", "ss_ticket_number", "ss_coupon_amt", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {"customer": ["c_last_name", "c_first_name"]}}
{"id": 80, "query_string": " with ssr as  (select  s_store_id as store_id,           sum(ss_ext_sales_price) as sales,           sum(coalesce(sr_return_amt, 0)) as returns,           sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit   from store_sales left outer join store_returns on          (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),      date_dim,      store,      item,      promotion  where ss_sold_date_sk = d_date_sk        and d_date between cast('2002-08-05' as date)                    and dateadd(day, 30, cast('2002-08-05' as date))        and ss_store_sk = s_store_sk        and ss_item_sk = i_item_sk        and i_current_price > 50        and ss_promo_sk = p_promo_sk        and p_channel_tv = 'N'  group by s_store_id)  ,  csr as  (select  cp_catalog_page_id as catalog_page_id,           sum(cs_ext_sales_price) as sales,           sum(coalesce(cr_return_amount, 0)) as returns,           sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit   from catalog_sales left outer join catalog_returns on          (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),      date_dim,      catalog_page,      item,      promotion  where cs_sold_date_sk = d_date_sk        and d_date between cast('2002-08-05' as date)                   and dateadd(day, 30, cast('2002-08-05' as date))         and cs_catalog_page_sk = cp_catalog_page_sk        and cs_item_sk = i_item_sk        and i_current_price > 50        and cs_promo_sk = p_promo_sk        and p_channel_tv = 'N' group by cp_catalog_page_id)  ,  wsr as  (select  web_site_id,           sum(ws_ext_sales_price) as sales,           sum(coalesce(wr_return_amt, 0)) as returns,           sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit   from web_sales left outer join web_returns on          (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),      date_dim,      web_site,      item,      promotion  where ws_sold_date_sk = d_date_sk        and d_date between cast('2002-08-05' as date)                   and dateadd(day, 30, cast('2002-08-05' as date))         and ws_web_site_sk = web_site_sk        and ws_item_sk = i_item_sk        and i_current_price > 50        and ws_promo_sk = p_promo_sk        and p_channel_tv = 'N' group by web_site_id)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , concat('store' , store_id) as id         , sales         , returns         , profit  from   ssr  union all  select 'catalog channel' as channel         , concat('catalog_page' , catalog_page_id) as id         , sales         , returns         , profit  from  csr  union all  select 'web channel' as channel         , concat('web_site' , web_site_id) as id         , sales         , returns         , profit  from   wsr  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"], "promotion": ["p_channel_tv"]}, "payload": {"catalog_page": ["cp_catalog_page_sk", "cp_catalog_page_id"], "catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_amount", "cr_net_loss"], "date_dim": ["d_date_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"], "store": ["s_store_sk", "s_store_id"], "store_returns": ["sr_return_amt", "sr_net_loss", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_net_loss", "wr_return_amt", "wr_order_number"], "web_site": ["web_site_id", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 81, "query_string": " with customer_total_return as  (select cr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   \tsum(cr_return_amt_inc_tax) as ctr_total_return  from catalog_returns      ,date_dim      ,customer_address  where cr_returned_date_sk = d_date_sk     and d_year =2002    and cr_returning_addr_sk = ca_address_sk   group by cr_returning_customer_sk          ,ca_state )   select top (100) c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  \t\t\t  from customer_total_return ctr2                    \t  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'VA'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  ;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_year"]}, "payload": {"catalog_returns": ["cr_returned_date_sk", "cr_returning_customer_sk", "cr_return_amt_inc_tax", "cr_returning_addr_sk"], "customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_current_addr_sk", "c_customer_id"], "customer_address": ["ca_street_type", "ca_county", "ca_street_name", "ca_zip", "ca_street_number", "ca_city", "ca_state", "ca_gmt_offset", "ca_location_type", "ca_address_sk", "ca_suite_number", "ca_country"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer": ["c_salutation", "c_customer_id", "c_last_name", "c_first_name"], "customer_address": ["ca_street_type", "ca_county", "ca_street_name", "ca_zip", "ca_street_number", "ca_city", "ca_gmt_offset", "ca_location_type", "ca_suite_number", "ca_country"]}}
{"id": 82, "query_string": " select top (100) i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, store_sales  where i_current_price between 15 and 15+30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2000-02-29' as date) and dateadd(day, 60, cast('2000-02-29' as date))  and i_manufact_id in (547,743,224,856)  and inv_quantity_on_hand between 100 and 500  and ss_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  ;", "predicates": {"date_dim": ["d_date"], "inventory": ["inv_quantity_on_hand"], "item": ["i_current_price", "i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc", "i_current_price"]}, "group_by": {}, "order_by": {}}
{"id": 83, "query_string": " with sr_items as  (select i_item_id item_id,         sum(sr_return_quantity) sr_item_qty  from store_returns,       item,       date_dim  where sr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t  where d_date in ('1999-04-02','1999-08-04','1999-11-19')))  and   sr_returned_date_sk   = d_date_sk  group by i_item_id),  cr_items as  (select i_item_id item_id,         sum(cr_return_quantity) cr_item_qty  from catalog_returns,       item,       date_dim  where cr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t  where d_date in ('1999-04-02','1999-08-04','1999-11-19')))  and   cr_returned_date_sk   = d_date_sk  group by i_item_id),  wr_items as  (select i_item_id item_id,         sum(wr_return_quantity) wr_item_qty  from web_returns,       item,       date_dim  where wr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t\twhere d_date in ('1999-04-02','1999-08-04','1999-11-19')))  and   wr_returned_date_sk   = d_date_sk  group by i_item_id)   select top (100) sr_items.item_id        ,sr_item_qty        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev        ,cr_item_qty        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev        ,wr_item_qty        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average  from sr_items      ,cr_items      ,wr_items  where sr_items.item_id=cr_items.item_id    and sr_items.item_id=wr_items.item_id   order by sr_items.item_id          ,sr_item_qty  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_returned_date_sk", "cr_order_number", "cr_return_quantity"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "item": ["i_item_id", "i_item_sk"], "store_returns": ["sr_returned_date_sk", "sr_return_quantity", "sr_item_sk"], "web_returns": ["wr_item_sk", "wr_returned_date_sk", "wr_return_quantity"]}, "group_by": {}, "order_by": {}}
{"id": 84, "query_string": " select top (100) c_customer_id as customer_id        , concat(coalesce(c_last_name,'') , ', ' , coalesce(c_first_name,'')) as customername  from customer      ,customer_address      ,customer_demographics      ,household_demographics      ,income_band      ,store_returns  where ca_city\t        =  'Lincoln'    and c_current_addr_sk = ca_address_sk    and ib_lower_bound   >=  19278    and ib_upper_bound   <=  19278 + 50000    and ib_income_band_sk = hd_income_band_sk    and cd_demo_sk = c_current_cdemo_sk    and hd_demo_sk = c_current_hdemo_sk    and sr_cdemo_sk = cd_demo_sk  order by c_customer_id  ;", "predicates": {"customer": ["c_current_cdemo_sk"], "customer_address": ["ca_city"], "income_band": ["ib_upper_bound", "ib_lower_bound"]}, "payload": {"customer": ["c_last_name", "c_first_name", "c_current_cdemo_sk", "c_current_addr_sk", "c_customer_id", "c_current_hdemo_sk"], "customer_address": ["ca_address_sk"], "household_demographics": ["hd_income_band_sk", "hd_demo_sk"], "income_band": ["ib_income_band_sk"], "store_returns": ["sr_cdemo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 85, "query_string": " select top (100) substring(r_reason_desc,1,20)        ,avg(ws_quantity)        ,avg(wr_refunded_cash)        ,avg(wr_fee)  from web_sales, web_returns, web_page, customer_demographics cd1,       customer_demographics cd2, customer_address, date_dim, reason   where ws_web_page_sk = wp_web_page_sk    and ws_item_sk = wr_item_sk    and ws_order_number = wr_order_number    and ws_sold_date_sk = d_date_sk and d_year = 2000    and cd1.cd_demo_sk = wr_refunded_cdemo_sk     and cd2.cd_demo_sk = wr_returning_cdemo_sk    and ca_address_sk = wr_refunded_addr_sk    and r_reason_sk = wr_reason_sk    and    (     (      cd1.cd_marital_status = 'D'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Secondary'      and       cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 100.00 and 150.00     )    or     (      cd1.cd_marital_status = 'W'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Primary'       and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 50.00 and 100.00     )    or     (      cd1.cd_marital_status = 'U'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = '2 yr Degree'      and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 150.00 and 200.00     )    )    and    (     (      ca_country = 'United States'      and      ca_state in ('KS', 'CA', 'IL')      and ws_net_profit between 100 and 200       )     or     (      ca_country = 'United States'      and      ca_state in ('AR', 'MO', 'TX')      and ws_net_profit between 150 and 300       )     or     (      ca_country = 'United States'      and      ca_state in ('MS', 'CO', 'MT')      and ws_net_profit between 50 and 250       )    ) group by r_reason_desc order by substring(r_reason_desc,1,20)         ,avg(ws_quantity)         ,avg(wr_refunded_cash)         ,avg(wr_fee);", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "web_sales": ["ws_net_profit", "ws_sales_price"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "reason": ["r_reason_desc", "r_reason_sk"], "web_page": ["wp_web_page_sk"], "web_returns": ["wr_returning_cdemo_sk", "wr_refunded_cdemo_sk", "wr_reason_sk", "wr_item_sk", "wr_refunded_cash", "wr_refunded_addr_sk", "wr_fee", "wr_order_number"], "web_sales": ["ws_net_profit", "ws_item_sk", "ws_sales_price", "ws_quantity", "ws_sold_date_sk", "ws_web_page_sk", "ws_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 86, "query_string": " select top (100)       sum(ws_net_paid) as total_sum    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  \tpartition by grouping(i_category)+grouping(i_class),  \tcase when grouping(i_class) = 0 then i_category end   \torder by sum(ws_net_paid) desc) as rank_within_parent  from     web_sales    ,date_dim       d1    ,item  where     d1.d_month_seq between 1220 and 1220+11  and d1.d_date_sk = ws_sold_date_sk  and i_item_sk  = ws_item_sk  group by rollup(i_category,i_class)  order by    lochierarchy desc,    case when (grouping(i_category)+grouping(i_class)) = 0 then i_category end,    rank_within_parent  ;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_class", "i_item_sk", "i_category"], "web_sales": ["ws_net_paid", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 87, "query_string": " select count(*)  from ((select distinct c_last_name, c_first_name, d_date        from store_sales, date_dim, customer        where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_customer_sk = customer.c_customer_sk          and d_month_seq between 1220 and 1220+11)        except       (select distinct c_last_name, c_first_name, d_date        from catalog_sales, date_dim, customer        where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk          and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk          and d_month_seq between 1220 and 1220+11)        except       (select distinct c_last_name, c_first_name, d_date        from web_sales, date_dim, customer        where web_sales.ws_sold_date_sk = date_dim.d_date_sk          and web_sales.ws_bill_customer_sk = customer.c_customer_sk          and d_month_seq between 1220 and 1220+11) ) cool_cust;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 88, "query_string": " select  * from  (select count(*) h8_30_to_9  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk         and ss_hdemo_sk = household_demographics.hd_demo_sk       and ss_store_sk = s_store_sk      and time_dim.t_hour = 8      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))       and store.s_store_name = 'ese') s1,  (select count(*) h9_to_9_30   from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk       and time_dim.t_hour = 9       and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))      and store.s_store_name = 'ese') s2,  (select count(*) h9_30_to_10   from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 9      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))      and store.s_store_name = 'ese') s3,  (select count(*) h10_to_10_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 10       and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))      and store.s_store_name = 'ese') s4,  (select count(*) h10_30_to_11  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 10       and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))      and store.s_store_name = 'ese') s5,  (select count(*) h11_to_11_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk       and time_dim.t_hour = 11      and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))      and store.s_store_name = 'ese') s6,  (select count(*) h11_30_to_12  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 11      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))      and store.s_store_name = 'ese') s7,  (select count(*) h12_to_12_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 12      and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))      and store.s_store_name = 'ese') s8;", "predicates": {"household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_store_name"], "time_dim": ["t_hour", "t_minute"]}, "payload": {"household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_sold_time_sk"], "time_dim": ["t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 89, "query_string": " select top (100) * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (1998) and         ((i_category in ('Electronics','Shoes','Music') and           i_class in ('camcorders','mens','rock')          )       or (i_category in ('Men','Jewelry','Sports') and           i_class in ('sports-apparel','semi-precious','outdoor')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name;", "predicates": {"date_dim": ["d_year"], "item": ["i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_brand", "i_class", "i_item_sk", "i_category"], "store": ["s_store_name", "s_store_sk", "s_company_name"]}, "group_by": {}, "order_by": {"store": ["s_store_name"]}}
{"id": 90, "query_string": " select top (100) cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio  from ( select count(*) amc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 9 and 9+1          and household_demographics.hd_dep_count = 0          and web_page.wp_char_count between 5000 and 5200) at,       ( select count(*) pmc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 18 and 18+1          and household_demographics.hd_dep_count = 0          and web_page.wp_char_count between 5000 and 5200) pt  order by am_pm_ratio  ;", "predicates": {"household_demographics": ["hd_dep_count"], "time_dim": ["t_hour"], "web_page": ["wp_char_count"]}, "payload": {"household_demographics": ["hd_demo_sk"], "time_dim": ["t_time_sk"], "web_page": ["wp_web_page_sk"], "web_sales": ["ws_sold_time_sk", "ws_web_page_sk", "ws_ship_hdemo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 91, "query_string": " select           cc_call_center_id Call_Center,         cc_name Call_Center_Name,         cc_manager Manager,         sum(cr_net_loss) Returns_Loss from         call_center,         catalog_returns,         date_dim,         customer,         customer_address,         customer_demographics,         household_demographics where         cr_call_center_sk       = cc_call_center_sk and     cr_returned_date_sk     = d_date_sk and     cr_returning_customer_sk= c_customer_sk and     cd_demo_sk              = c_current_cdemo_sk and     hd_demo_sk              = c_current_hdemo_sk and     ca_address_sk           = c_current_addr_sk and     d_year                  = 2001  and     d_moy                   = 12 and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')         or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree')) and     hd_buy_potential like '5001-10000%' and     ca_gmt_offset           = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc;", "predicates": {"customer_address": ["ca_gmt_offset"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_moy", "d_year"], "household_demographics": ["hd_buy_potential"]}, "payload": {"call_center": ["cc_name", "cc_call_center_id", "cc_manager", "cc_call_center_sk"], "catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_returning_customer_sk", "cr_call_center_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk", "c_current_hdemo_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 92, "query_string": " select top (100)     sum(ws_ext_discount_amt)  as \"Excess Discount Amount\"  from      web_sales     ,item     ,date_dim where i_manufact_id = 821 and i_item_sk = ws_item_sk  and d_date between '2002-01-24' and          dateadd(day, 90, cast('2002-01-24' as date)) and d_date_sk = ws_sold_date_sk  and ws_ext_discount_amt        > (           SELECT              1.3 * avg(ws_ext_discount_amt)           FROM              web_sales             ,date_dim          WHERE                ws_item_sk = i_item_sk            and d_date between '2002-01-24' and                              dateadd(day, 90, cast('2002-01-24' as date))           and d_date_sk = ws_sold_date_sk        )  order by sum(ws_ext_discount_amt);", "predicates": {"date_dim": ["d_date"], "item": ["i_manufact_id"], "web_sales": ["ws_ext_discount_amt"]}, "payload": {"item": ["i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 93, "query_string": " select top (100) ss_customer_sk             ,sum(act_sales) sumsales       from (select ss_item_sk                   ,ss_ticket_number                   ,ss_customer_sk                   ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price                                                             else (ss_quantity*ss_sales_price) end act_sales             from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk                                                                and sr_ticket_number = ss_ticket_number)                 ,reason             where sr_reason_sk = r_reason_sk               and r_reason_desc = 'reason 34') t       group by ss_customer_sk       order by sumsales, ss_customer_sk;", "predicates": {"reason": ["r_reason_desc"]}, "payload": {"reason": ["r_reason_sk"], "store_returns": ["sr_reason_sk", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"]}, "group_by": {}, "order_by": {"store_sales": ["ss_customer_sk"]}}
{"id": 94, "query_string": " select top (100)     count(distinct ws_order_number) as \"order count\"   ,sum(ws_ext_ship_cost) as \"total shipping cost\"   ,sum(ws_net_profit) as \"total net profit\" from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '1999-2-01' and             dateadd(day, 60, cast('1999-2-01' as date)) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'KY' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number);", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_date"], "web_site": ["web_company_name"]}, "payload": {"customer_address": ["ca_address_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_net_profit", "ws_ship_date_sk", "ws_ship_addr_sk", "ws_ext_ship_cost", "ws_warehouse_sk", "ws_order_number", "ws_web_site_sk"], "web_site": ["web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 95, "query_string": " with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select top (100)     count(distinct ws_order_number) as \"order count\"   ,sum(ws_ext_ship_cost) as \"total shipping cost\"   ,sum(ws_net_profit) as \"total net profit\" from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '1999-2-01' and             dateadd(day, 60, cast('1999-2-01' as date)) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'KY' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number);", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_date"], "web_site": ["web_company_name"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_net_profit", "ws_ship_date_sk", "ws_item_sk", "ws_ship_addr_sk", "ws_ext_ship_cost", "ws_warehouse_sk", "ws_order_number", "ws_web_site_sk"], "web_site": ["web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 96, "query_string": " select top (100) count(*)  from store_sales     ,household_demographics      ,time_dim, store where ss_sold_time_sk = time_dim.t_time_sk        and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk     and time_dim.t_hour = 20     and time_dim.t_minute >= 30     and household_demographics.hd_dep_count = 4     and store.s_store_name = 'ese' order by count(*);", "predicates": {"household_demographics": ["hd_dep_count"], "store": ["s_store_name"], "time_dim": ["t_hour", "t_minute"]}, "payload": {"household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_sold_time_sk"], "time_dim": ["t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 97, "query_string": " with ssci as ( select ss_customer_sk customer_sk       ,ss_item_sk item_sk from store_sales,date_dim where ss_sold_date_sk = d_date_sk   and d_month_seq between 1220 and 1220 + 11 group by ss_customer_sk         ,ss_item_sk), csci as(  select cs_bill_customer_sk customer_sk       ,cs_item_sk item_sk from catalog_sales,date_dim where cs_sold_date_sk = d_date_sk   and d_month_seq between 1220 and 1220 + 11 group by cs_bill_customer_sk         ,cs_item_sk)  select top (100) sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only       ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only       ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk                                and ssci.item_sk = csci.item_sk);", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk", "cs_item_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 98, "query_string": " select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from\t \tstore_sales     \t,item      \t,date_dim where  \tss_item_sk = i_item_sk    \tand i_category in ('Shoes', 'Women', 'Music')   \tand ss_sold_date_sk = d_date_sk \tand d_date between cast('2000-06-23' as date)  \t\t\t\tand dateadd(day, 30, cast('2000-06-23' as date)) group by  \ti_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  \ti_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"]}, "group_by": {}, "order_by": {}}
{"id": 99, "query_string": " select top (100)     substring(w_warehouse_name,1,20)   ,sm_type   ,cc_name   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and                   (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and                   (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and                  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    catalog_sales   ,warehouse   ,ship_mode   ,call_center   ,date_dim where     d_month_seq between 1220 and 1220 + 11 and cs_ship_date_sk   = d_date_sk and cs_warehouse_sk   = w_warehouse_sk and cs_ship_mode_sk   = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by    substring(w_warehouse_name,1,20)   ,sm_type   ,cc_name order by substring(w_warehouse_name,1,20)         ,sm_type         ,cc_name;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"call_center": ["cc_name", "cc_call_center_sk"], "catalog_sales": ["cs_warehouse_sk", "cs_call_center_sk", "cs_ship_date_sk", "cs_ship_mode_sk", "cs_sold_date_sk"], "date_dim": ["d_date_sk"], "ship_mode": ["sm_type", "sm_ship_mode_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 1, "query_string": " with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sum(SR_RETURN_AMT) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1999 group by sr_customer_sk ,sr_store_sk)  select top (100) c_customer_id from customer_total_return ctr1 ,store ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'TN' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id;", "predicates": {"date_dim": ["d_year"], "store": ["s_state"], "store_returns": ["sr_store_sk"]}, "payload": {"customer": ["c_customer_id", "c_customer_sk"], "date_dim": ["d_date_sk"], "store": ["s_store_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_customer_id"]}}
{"id": 2, "query_string": " with wscs as  (select sold_date_sk         ,sales_price   from (select ws_sold_date_sk sold_date_sk               ,ws_ext_sales_price sales_price         from web_sales          union all         select cs_sold_date_sk sold_date_sk               ,cs_ext_sales_price sales_price         from catalog_sales) a),  wswscs as   (select d_week_seq,         sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales  from wscs      ,date_dim  where d_date_sk = sold_date_sk  group by d_week_seq)  select d_week_seq1        ,round(sun_sales1/sun_sales2,2)        ,round(mon_sales1/mon_sales2,2)        ,round(tue_sales1/tue_sales2,2)        ,round(wed_sales1/wed_sales2,2)        ,round(thu_sales1/thu_sales2,2)        ,round(fri_sales1/fri_sales2,2)        ,round(sat_sales1/sat_sales2,2)  from  (select wswscs.d_week_seq d_week_seq1         ,sun_sales sun_sales1         ,mon_sales mon_sales1         ,tue_sales tue_sales1         ,wed_sales wed_sales1         ,thu_sales thu_sales1         ,fri_sales fri_sales1         ,sat_sales sat_sales1   from wswscs,date_dim    where date_dim.d_week_seq = wswscs.d_week_seq and         d_year = 2001) y,  (select wswscs.d_week_seq d_week_seq2         ,sun_sales sun_sales2         ,mon_sales mon_sales2         ,tue_sales tue_sales2         ,wed_sales wed_sales2         ,thu_sales thu_sales2         ,fri_sales fri_sales2         ,sat_sales sat_sales2   from wswscs       ,date_dim    where date_dim.d_week_seq = wswscs.d_week_seq and         d_year = 2001+1) z  where d_week_seq1=d_week_seq2-53  order by d_week_seq1;", "predicates": {"date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_week_seq", "d_day_name"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 3, "query_string": " select top (100) dt.d_year         ,item.i_brand_id brand_id         ,item.i_brand brand        ,sum(ss_net_profit) sum_agg  from  date_dim dt        ,store_sales       ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk    and store_sales.ss_item_sk = item.i_item_sk    and item.i_manufact_id = 379    and dt.d_moy=11  group by dt.d_year       ,item.i_brand       ,item.i_brand_id  order by dt.d_year          ,sum_agg desc          ,brand_id  ;", "predicates": {"date_dim": ["d_moy"], "item": ["i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"date_dim": ["d_year"], "item": ["i_brand_id"]}}
{"id": 4, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year  union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total        ,'c' sale_type  from customer      ,catalog_sales      ,date_dim  where c_customer_sk = cs_bill_customer_sk    and cs_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year          )   select top (100)                    t_s_secyear.customer_id                  ,t_s_secyear.customer_first_name                  ,t_s_secyear.customer_last_name                  ,t_s_secyear.customer_preferred_cust_flag  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_c_firstyear      ,year_total t_c_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id    and t_s_firstyear.customer_id = t_c_secyear.customer_id    and t_s_firstyear.customer_id = t_c_firstyear.customer_id    and t_s_firstyear.customer_id = t_w_firstyear.customer_id    and t_s_firstyear.customer_id = t_w_secyear.customer_id    and t_s_firstyear.sale_type = 's'    and t_c_firstyear.sale_type = 'c'    and t_w_firstyear.sale_type = 'w'    and t_s_secyear.sale_type = 's'    and t_c_secyear.sale_type = 'c'    and t_w_secyear.sale_type = 'w'    and t_s_firstyear.dyear =  2000    and t_s_secyear.dyear = 2000+1    and t_c_firstyear.dyear =  2000    and t_c_secyear.dyear =  2000+1    and t_w_firstyear.dyear = 2000    and t_w_secyear.dyear = 2000+1    and t_s_firstyear.year_total > 0    and t_c_firstyear.year_total > 0    and t_w_firstyear.year_total > 0    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end            > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end  order by t_s_secyear.customer_id          ,t_s_secyear.customer_first_name          ,t_s_secyear.customer_last_name          ,t_s_secyear.customer_preferred_cust_flag;", "predicates": {"date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_ext_list_price", "cs_ext_discount_amt", "cs_bill_customer_sk", "cs_ext_sales_price", "cs_ext_wholesale_cost", "cs_sold_date_sk"], "customer": ["c_login", "c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id"], "date_dim": ["d_date_sk"], "store_sales": ["ss_ext_discount_amt", "ss_ext_sales_price", "ss_ext_wholesale_cost", "ss_customer_sk", "ss_ext_list_price", "ss_sold_date_sk"], "web_sales": ["ws_ext_discount_amt", "ws_ext_wholesale_cost", "ws_ext_list_price", "ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 5, "query_string": " with ssr as  (select s_store_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  ss_store_sk as store_sk,             ss_sold_date_sk  as date_sk,             ss_ext_sales_price as sales_price,             ss_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from store_sales     union all     select sr_store_sk as store_sk,            sr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            sr_return_amt as return_amt,            sr_net_loss as net_loss     from store_returns    ) salesreturns,      date_dim,      store  where date_sk = d_date_sk        and d_date between cast('2001-08-05' as date)                    and dateadd(day, 14, cast('2001-08-05' as date))        and store_sk = s_store_sk  group by s_store_id)  ,  csr as  (select cp_catalog_page_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  cs_catalog_page_sk as page_sk,             cs_sold_date_sk  as date_sk,             cs_ext_sales_price as sales_price,             cs_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from catalog_sales     union all     select cr_catalog_page_sk as page_sk,            cr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            cr_return_amount as return_amt,            cr_net_loss as net_loss     from catalog_returns    ) salesreturns,      date_dim,      catalog_page  where date_sk = d_date_sk        and d_date between cast('2001-08-05' as date)                   and dateadd(day, 14, cast('2001-08-05' as date))        and page_sk = cp_catalog_page_sk  group by cp_catalog_page_id)  ,  wsr as  (select web_site_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  ws_web_site_sk as wsr_web_site_sk,             ws_sold_date_sk  as date_sk,             ws_ext_sales_price as sales_price,             ws_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from web_sales     union all     select ws_web_site_sk as wsr_web_site_sk,            wr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            wr_return_amt as return_amt,            wr_net_loss as net_loss     from web_returns left outer join web_sales on          ( wr_item_sk = ws_item_sk            and wr_order_number = ws_order_number)    ) salesreturns,      date_dim,      web_site  where date_sk = d_date_sk        and d_date between cast('2001-08-05' as date)                   and dateadd(day, 14, cast('2001-08-05' as date))        and wsr_web_site_sk = web_site_sk  group by web_site_id)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , concat('store' , s_store_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from   ssr  union all  select 'catalog channel' as channel         , concat('catalog_page' , cp_catalog_page_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from  csr  union all  select 'web channel' as channel         , concat('web_site' , web_site_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from   wsr  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_page": ["cp_catalog_page_sk", "cp_catalog_page_id"], "catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_return_amount", "cr_catalog_page_sk"], "catalog_sales": ["cs_catalog_page_sk", "cs_net_profit", "cs_sold_date_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_net_loss"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit", "ss_ext_sales_price"], "web_returns": ["wr_returned_date_sk", "wr_return_amt", "wr_net_loss", "wr_item_sk", "wr_order_number"], "web_sales": ["ws_net_profit", "ws_ext_sales_price", "ws_sold_date_sk", "ws_web_site_sk"], "web_site": ["web_site_id", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 6, "query_string": " select top (100) a.ca_state state, count(*) cnt  from customer_address a      ,customer c      ,store_sales s      ,date_dim d      ,item i  where       a.ca_address_sk = c.c_current_addr_sk  \tand c.c_customer_sk = s.ss_customer_sk  \tand s.ss_sold_date_sk = d.d_date_sk  \tand s.ss_item_sk = i.i_item_sk  \tand d.d_month_seq =   \t     (select distinct (d_month_seq)  \t      from date_dim                where d_year = 2002  \t        and d_moy = 4 )  \tand i.i_current_price > 1.2 *               (select avg(j.i_current_price)   \t     from item j   \t     where j.i_category = i.i_category)  group by a.ca_state  having count(*) >= 10  order by cnt, a.ca_state   ;", "predicates": {"date_dim": ["d_month_seq", "d_moy", "d_year"], "item": ["i_category", "i_current_price"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk", "d_month_seq"], "item": ["i_item_sk", "i_category", "i_current_price"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_item_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_state"]}}
{"id": 7, "query_string": " select top (100) i_item_id,          avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4   from store_sales, customer_demographics, date_dim, item, promotion  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_cdemo_sk = cd_demo_sk and        ss_promo_sk = p_promo_sk and        cd_gender = 'F' and         cd_marital_status = 'W' and        cd_education_status = 'College' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 2002   group by i_item_id  order by i_item_id  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "promotion": ["p_channel_event", "p_channel_email"]}, "payload": {"customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"], "promotion": ["p_promo_sk"], "store_sales": ["ss_promo_sk", "ss_item_sk", "ss_cdemo_sk", "ss_list_price", "ss_quantity", "ss_sales_price", "ss_coupon_amt", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 8, "query_string": " select top (100) s_store_name       ,sum(ss_net_profit)  from store_sales      ,date_dim      ,store,      (select ca_zip      from (       SELECT substring(ca_zip,1,5) ca_zip       FROM customer_address       WHERE substring(ca_zip,1,5) IN (                           '91084','22681','19326','12889','61456','12441',                           '77440','97237','13253','40570','22246',                           '33366','72751','30980','63708','37342',                           '50965','70310','90994','56807','37729',                           '13936','28139','46610','73860','62569',                           '47135','40224','19712','36790','66903',                           '90814','33805','67782','87818','62499',                           '27760','83698','99146','95582','82554',                           '66537','31687','79265','39143','56639',                           '55088','45438','72433','94025','59888',                           '60902','82961','96374','72472','38170',                           '12023','97963','29339','19657','25977',                           '39992','89807','17252','11817','44999',                           '55029','42162','94178','77231','74573',                           '93497','97526','60489','18716','75260',                           '74602','37084','33216','18071','57849',                           '51452','45237','42302','21331','55104',                           '39471','48732','20034','40935','91369',                           '25965','43510','36456','32243','62511',                           '47994','85473','97191','81152','72989',                           '64239','51507','12313','16529','69623',                           '16681','60307','19851','76149','53079',                           '94716','57538','35229','30394','55453',                           '54984','44668','10741','29593','73203',                           '43493','14801','70634','16791','30740',                           '99606','77506','34414','22619','98353',                           '77265','48142','17632','95302','83347',                           '31864','74390','56185','30107','58000',                           '61510','18427','98162','59758','47171',                           '54930','27792','97175','55347','89351',                           '15086','27459','47855','90244','54668',                           '16022','40099','15801','79144','59901',                           '54217','99345','96704','54116','11495',                           '19956','59333','34699','76262','40588',                           '44479','83726','97173','59773','88032',                           '78060','70124','36701','89402','13462',                           '32416','74135','36179','31402','67406',                           '30009','98823','14744','63063','83563',                           '42093','52319','53458','44464','45860',                           '37382','69804','93487','32608','33618',                           '56869','41435','77394','93159','42602',                           '13207','51747','35609','12526','66759',                           '28979','65366','56577','75914','37744',                           '90493','62611','86156','32860','96553',                           '89837','81964','12010','28983','14586',                           '80225','25721','99815','89946','64111',                           '45479','53167','67127','83405','88042',                           '72133','42504','55355','13243','81443',                           '72935','85997','65587','33699','34855',                           '69479','33491','82774','11592','44872',                           '48430','72880','63755','11502','55013',                           '19412','22374','84188','58291','13854',                           '39668','73562','66517','42199','15688',                           '18777','36327','12008','98060','35262',                           '12676','62236','61966','31796','42583',                           '32687','66841','87301','85814','53792',                           '31283','89564','16303','82855','41187',                           '46401','41443','44465','85522','84988',                           '17184','21556','84686','40578','46510',                           '90951','29549','24583','47823','43061',                           '33583','47789','83804','52225','28055',                           '11108','90119','31321','19841','31634',                           '94311','36452','94304','27314','25903',                           '47147','55780','84912','40234','75558',                           '33821','73235','93024','18942','98420',                           '44642','74118','94796','53762','66624',                           '71865','14461','20726','61149','44148',                           '87705','54743','92840','49710','23990',                           '85181','34053','34868','46838','12082',                           '60213','20947','45973','40993','61470',                           '62020','33586','16949','86387','73552',                           '76838','52471','38709','94140','97509',                           '40203','11497','49455','66887','53922',                           '36076','91549','83691','16091','70486',                           '49739','30412','89829','54246','95164',                           '24346','48392','87590','82514','57540',                           '93732','15539','76143','21456','19955',                           '90577','79564','89812','42366','79161',                           '33467','69842','46752','69607','39235',                           '37825','91548','31570','28964')      intersect       select ca_zip       from (SELECT substring(ca_zip,1,5) ca_zip,count(*) cnt             FROM customer_address, customer             WHERE ca_address_sk = c_current_addr_sk and                   c_preferred_cust_flag='Y'             group by ca_zip             having count(*) > 10)A1)A2) V1  where ss_store_sk = s_store_sk   and ss_sold_date_sk = d_date_sk   and d_qoy = 1 and d_year = 2002   and (substring(s_zip,1,2) = substring(V1.ca_zip,1,2))  group by s_store_name  order by s_store_name  ;", "predicates": {"customer": ["c_preferred_cust_flag"], "date_dim": ["d_qoy", "d_year"]}, "payload": {"customer": ["c_current_addr_sk"], "customer_address": ["ca_address_sk", "ca_zip"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 9, "query_string": " select case when (select count(*)                    from store_sales                    where ss_quantity between 1 and 20) > 18408             then (select avg(ss_ext_tax)                    from store_sales                    where ss_quantity between 1 and 20)              else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 1 and 20) end bucket1 ,        case when (select count(*)                   from store_sales                   where ss_quantity between 21 and 40) > 4743             then (select avg(ss_ext_tax)                   from store_sales                   where ss_quantity between 21 and 40)              else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 21 and 40) end bucket2,        case when (select count(*)                   from store_sales                   where ss_quantity between 41 and 60) > 11600             then (select avg(ss_ext_tax)                   from store_sales                   where ss_quantity between 41 and 60)             else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 41 and 60) end bucket3,        case when (select count(*)                   from store_sales                   where ss_quantity between 61 and 80) > 18355             then (select avg(ss_ext_tax)                   from store_sales                   where ss_quantity between 61 and 80)             else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 61 and 80) end bucket4,        case when (select count(*)                   from store_sales                   where ss_quantity between 81 and 100) > 5069             then (select avg(ss_ext_tax)                   from store_sales                   where ss_quantity between 81 and 100)             else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 81 and 100) end bucket5 from reason where r_reason_sk = 1;", "predicates": {"store_sales": ["ss_quantity"]}, "payload": {"store_sales": ["ss_ext_tax", "ss_net_paid_inc_tax"]}, "group_by": {}, "order_by": {}}
{"id": 10, "query_string": " select top (100)    cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3,   cd_dep_count,   count(*) cnt4,   cd_dep_employed_count,   count(*) cnt5,   cd_dep_college_count,   count(*) cnt6  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_county in ('Ferry County','Sweet Grass County','Webster County','Butte County','Montgomery County') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 1999 and                 d_moy between 2 and 2+3) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 1999 and                   d_moy between 2 ANd 2+3) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 1999 and                   d_moy between 2 and 2+3))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count;", "predicates": {"customer_address": ["ca_county"], "date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 11, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag           ,c_birth_country          ,c_login          ,c_email_address          ,d_year   union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag           ,c_birth_country          ,c_login          ,c_email_address          ,d_year          )   select top (100)                    t_s_secyear.customer_id                  ,t_s_secyear.customer_first_name                  ,t_s_secyear.customer_last_name                  ,t_s_secyear.customer_preferred_cust_flag  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id          and t_s_firstyear.customer_id = t_w_secyear.customer_id          and t_s_firstyear.customer_id = t_w_firstyear.customer_id          and t_s_firstyear.sale_type = 's'          and t_w_firstyear.sale_type = 'w'          and t_s_secyear.sale_type = 's'          and t_w_secyear.sale_type = 'w'          and t_s_firstyear.dyear = 2000          and t_s_secyear.dyear = 2000+1          and t_w_firstyear.dyear = 2000          and t_w_secyear.dyear = 2000+1          and t_s_firstyear.year_total > 0          and t_w_firstyear.year_total > 0          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end              > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end  order by t_s_secyear.customer_id          ,t_s_secyear.customer_first_name          ,t_s_secyear.customer_last_name          ,t_s_secyear.customer_preferred_cust_flag;", "predicates": {"date_dim": ["d_year"]}, "payload": {"customer": ["c_login", "c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_ext_list_price", "ss_ext_discount_amt"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_discount_amt", "ws_ext_list_price"]}, "group_by": {}, "order_by": {}}
{"id": 12, "query_string": " select top (100) i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from\t \tweb_sales     \t,item      \t,date_dim where  \tws_item_sk = i_item_sk    \tand i_category in ('Music', 'Sports', 'Shoes')   \tand ws_sold_date_sk = d_date_sk \tand d_date between cast('2000-01-15' as date)  \t\t\t\tand dateadd(day, 30, cast('2000-01-15' as date)) group by  \ti_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  \ti_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_desc", "i_class", "i_item_id", "i_category"]}}
{"id": 13, "query_string": " select avg(ss_quantity)        ,avg(ss_ext_sales_price)        ,avg(ss_ext_wholesale_cost)        ,sum(ss_ext_wholesale_cost)  from store_sales      ,store      ,customer_demographics      ,household_demographics      ,customer_address      ,date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2001  and((ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'S'   and cd_education_status = 'Advanced Degree'   and ss_sales_price between 100.00 and 150.00   and hd_dep_count = 3         )or      (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'W'   and cd_education_status = 'College'   and ss_sales_price between 50.00 and 100.00      and hd_dep_count = 1      ) or       (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'M'   and cd_education_status = 'Unknown'   and ss_sales_price between 150.00 and 200.00    and hd_dep_count = 1        ))  and((ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('TN', 'TX', 'OH')   and ss_net_profit between 100 and 200        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('OR', 'IA', 'OK')   and ss_net_profit between 150 and 300        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('ND', 'MN', 'MS')   and ss_net_profit between 50 and 250        ));", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "household_demographics": ["hd_dep_count"], "store_sales": ["ss_sales_price", "ss_net_profit"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_dep_count", "hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_ext_sales_price", "ss_cdemo_sk", "ss_addr_sk", "ss_quantity", "ss_sales_price", "ss_ext_wholesale_cost", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 14, "query_string": " with  cross_items as  (select i_item_sk ss_item_sk  from item,  (select iss.i_brand_id brand_id      ,iss.i_class_id class_id      ,iss.i_category_id category_id  from store_sales      ,item iss      ,date_dim d1  where ss_item_sk = iss.i_item_sk    and ss_sold_date_sk = d1.d_date_sk    and d1.d_year between 1998 AND 1998 + 2  intersect   select ics.i_brand_id      ,ics.i_class_id      ,ics.i_category_id  from catalog_sales      ,item ics      ,date_dim d2  where cs_item_sk = ics.i_item_sk    and cs_sold_date_sk = d2.d_date_sk    and d2.d_year between 1998 AND 1998 + 2  intersect  select iws.i_brand_id      ,iws.i_class_id      ,iws.i_category_id  from web_sales      ,item iws      ,date_dim d3  where ws_item_sk = iws.i_item_sk    and ws_sold_date_sk = d3.d_date_sk    and d3.d_year between 1998 AND 1998 + 2) a  where i_brand_id = brand_id       and i_class_id = class_id       and i_category_id = category_id ),  avg_sales as  (select avg(quantity*list_price) average_sales   from (select ss_quantity quantity              ,ss_list_price list_price        from store_sales            ,date_dim        where ss_sold_date_sk = d_date_sk          and d_year between 1998 and 1998 + 2        union all         select cs_quantity quantity               ,cs_list_price list_price        from catalog_sales            ,date_dim        where cs_sold_date_sk = d_date_sk          and d_year between 1998 and 1998 + 2         union all        select ws_quantity quantity              ,ws_list_price list_price        from web_sales            ,date_dim        where ws_sold_date_sk = d_date_sk          and d_year between 1998 and 1998 + 2) x)   select top (100) channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)  from(        select 'store' channel, i_brand_id,i_class_id              ,i_category_id,sum(ss_quantity*ss_list_price) sales              , count(*) number_sales        from store_sales            ,item            ,date_dim        where ss_item_sk in (select ss_item_sk from cross_items)          and ss_item_sk = i_item_sk          and ss_sold_date_sk = d_date_sk          and d_year = 1998+2           and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)        union all        select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales        from catalog_sales            ,item            ,date_dim        where cs_item_sk in (select ss_item_sk from cross_items)          and cs_item_sk = i_item_sk          and cs_sold_date_sk = d_date_sk          and d_year = 1998+2           and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)        union all        select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales        from web_sales            ,item            ,date_dim        where ws_item_sk in (select ss_item_sk from cross_items)          and ws_item_sk = i_item_sk          and ws_sold_date_sk = d_date_sk          and d_year = 1998+2          and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)  ) y  group by rollup (channel, i_brand_id,i_class_id,i_category_id)  order by channel,i_brand_id,i_class_id,i_category_id  ; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_list_price", "cs_quantity"], "date_dim": ["d_date_sk"], "item": ["i_category_id", "i_class_id", "i_item_sk", "i_brand_id"], "store_sales": ["ss_sold_date_sk", "ss_list_price", "ss_quantity", "ss_item_sk"], "web_sales": ["ws_list_price", "ws_sold_date_sk", "ws_item_sk", "ws_quantity"]}, "group_by": {}, "order_by": {}}
{"id": 15, "query_string": " select top (100) ca_zip        ,sum(cs_sales_price)  from catalog_sales      ,customer      ,customer_address      ,date_dim  where cs_bill_customer_sk = c_customer_sk  \tand c_current_addr_sk = ca_address_sk   \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',                                    '85392', '85460', '80348', '81792')  \t      or ca_state in ('CA','WA','GA')  \t      or cs_sales_price > 500)  \tand cs_sold_date_sk = d_date_sk  \tand d_qoy = 1 and d_year = 2002  group by ca_zip  order by ca_zip  ;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"catalog_sales": ["cs_sales_price", "cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip", "ca_state"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_zip"]}}
{"id": 16, "query_string": " select top (100)     count(distinct cs_order_number) as \"order count\"   ,sum(cs_ext_ship_cost) as \"total shipping cost\"   ,sum(cs_net_profit) as \"total net profit\" from    catalog_sales cs1   ,date_dim   ,customer_address   ,call_center where     d_date between '1999-2-01' and             dateadd(day, 60, cast('1999-2-01' as date)) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'KY' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County',                   'Williamson County' ) and exists (select *             from catalog_sales cs2             where cs1.cs_order_number = cs2.cs_order_number               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select *                from catalog_returns cr1                where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number);", "predicates": {"call_center": ["cc_county"], "customer_address": ["ca_state"], "date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_order_number"], "catalog_sales": ["cs_order_number", "cs_warehouse_sk", "cs_ext_ship_cost", "cs_ship_addr_sk", "cs_net_profit", "cs_call_center_sk", "cs_ship_date_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 17, "query_string": " select top (100) i_item_id        ,i_item_desc        ,s_state        ,count(ss_quantity) as store_sales_quantitycount        ,avg(ss_quantity) as store_sales_quantityave        ,stdev(ss_quantity) as store_sales_quantitystdev        ,stdev(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov        ,count(sr_return_quantity) as store_returns_quantitycount        ,avg(sr_return_quantity) as store_returns_quantityave        ,stdev(sr_return_quantity) as store_returns_quantitystdev        ,stdev(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov        ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave        ,stdev(cs_quantity) as catalog_sales_quantitystdev        ,stdev(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov  from store_sales      ,store_returns      ,catalog_sales      ,date_dim d1      ,date_dim d2      ,date_dim d3      ,store      ,item  where d1.d_quarter_name = '2002Q1'    and d1.d_date_sk = ss_sold_date_sk    and i_item_sk = ss_item_sk    and s_store_sk = ss_store_sk    and ss_customer_sk = sr_customer_sk    and ss_item_sk = sr_item_sk    and ss_ticket_number = sr_ticket_number    and sr_returned_date_sk = d2.d_date_sk    and d2.d_quarter_name in ('2002Q1','2002Q2','2002Q3')    and sr_customer_sk = cs_bill_customer_sk    and sr_item_sk = cs_item_sk    and cs_sold_date_sk = d3.d_date_sk    and d3.d_quarter_name in ('2002Q1','2002Q2','2002Q3')  group by i_item_id          ,i_item_desc          ,s_state  order by i_item_id          ,i_item_desc          ,s_state;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_quarter_name"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_state", "s_store_sk"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_return_quantity", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 18, "query_string": " select top (100) i_item_id,         ca_country,         ca_state,          ca_county,         avg( cast(cs_quantity as decimal(12,2))) agg1,         avg( cast(cs_list_price as decimal(12,2))) agg2,         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,         avg( cast(cs_sales_price as decimal(12,2))) agg4,         avg( cast(cs_net_profit as decimal(12,2))) agg5,         avg( cast(c_birth_year as decimal(12,2))) agg6,         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7  from catalog_sales, customer_demographics cd1,        customer_demographics cd2, customer, customer_address, date_dim, item  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd1.cd_demo_sk and        cs_bill_customer_sk = c_customer_sk and        cd1.cd_gender = 'F' and         cd1.cd_education_status = 'College' and        c_current_cdemo_sk = cd2.cd_demo_sk and        c_current_addr_sk = ca_address_sk and        c_birth_month in (3,12,7,4,10,11) and        d_year = 1999 and        ca_state in ('MN','TX','TN'                    ,'PA','IN','CO','ME')  group by rollup (i_item_id, ca_country, ca_state, ca_county)  order by ca_country,         ca_state,          ca_county, \ti_item_id  ;", "predicates": {"customer": ["c_birth_month"], "customer_address": ["ca_state"], "customer_demographics": ["cd_education_status", "cd_gender"], "date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_quantity", "cs_sales_price", "cs_bill_customer_sk", "cs_item_sk", "cs_net_profit", "cs_list_price", "cs_coupon_amt", "cs_sold_date_sk", "cs_bill_cdemo_sk"], "customer": ["c_birth_year", "c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_county", "ca_country", "ca_state"], "customer_demographics": ["cd_demo_sk", "cd_dep_count"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_state", "ca_county", "ca_country"], "item": ["i_item_id"]}}
{"id": 19, "query_string": " select top (100) i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,  \tsum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item,customer,customer_address,store  where d_date_sk = ss_sold_date_sk    and ss_item_sk = i_item_sk    and i_manager_id=10    and d_moy=11    and d_year=2000    and ss_customer_sk = c_customer_sk     and c_current_addr_sk = ca_address_sk    and substring(ca_zip,1,5) <> substring(s_zip,1,5)     and ss_store_sk = s_store_sk   group by i_brand       ,i_brand_id       ,i_manufact_id       ,i_manufact  order by ext_price desc          ,i_brand          ,i_brand_id          ,i_manufact_id          ,i_manufact  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip"], "date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_brand_id", "i_manufact_id", "i_brand", "i_manufact"], "store": ["s_zip", "s_store_sk"]}, "group_by": {}, "order_by": {"item": ["i_brand", "i_manufact", "i_brand_id", "i_manufact_id"]}}
{"id": 20, "query_string": " select top (100) i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from\tcatalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Music', 'Sports', 'Shoes')    and cs_sold_date_sk = d_date_sk  and d_date between cast('2000-01-15' as date)   \t\t\t\tand dateadd(day, 30, cast('2000-01-15' as date))  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"]}, "group_by": {}, "order_by": {"item": ["i_item_desc", "i_class", "i_item_id", "i_category"]}}
{"id": 21, "query_string": " select top (100) *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-19' as date)) \t                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between dateadd(day, -30, cast ('2001-02-19' as date))                     and dateadd(day, 30, cast ('2001-02-19' as date))    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  ;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"]}, "payload": {"date_dim": ["d_date_sk", "d_date"], "item": ["i_item_id", "i_item_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 22, "query_string": " select top (100) i_product_name              ,i_brand              ,i_class              ,i_category              ,avg(inv_quantity_on_hand) qoh        from inventory            ,date_dim            ,item        where inv_date_sk=d_date_sk               and inv_item_sk=i_item_sk               and d_month_seq between 1197 and 1197 + 11        group by rollup(i_product_name                        ,i_brand                        ,i_class                        ,i_category) order by qoh, i_product_name, i_brand, i_class, i_category;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_brand", "i_product_name", "i_category", "i_class"]}, "group_by": {}, "order_by": {"item": ["i_product_name", "i_class", "i_brand", "i_category"]}}
{"id": 23, "query_string": " with frequent_ss_items as   (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt   from store_sales       ,date_dim        ,item   where ss_sold_date_sk = d_date_sk     and ss_item_sk = i_item_sk      and d_year in (1998,1998+1,1998+2,1998+3)   group by substring(i_item_desc,1,30),i_item_sk,d_date   having count(*) >4),  max_store_sales as  (select max(csales) tpcds_cmax    from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales         from store_sales             ,customer             ,date_dim          where ss_customer_sk = c_customer_sk          and ss_sold_date_sk = d_date_sk          and d_year in (1998,1998+1,1998+2,1998+3)          group by c_customer_sk) a),  best_ss_customer as  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales   from store_sales       ,customer   where ss_customer_sk = c_customer_sk   group by c_customer_sk   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select   * from  max_store_sales))   select top (100) sum(sales)  from (select cs_quantity*cs_list_price sales        from catalog_sales            ,date_dim         where d_year = 1998           and d_moy = 5           and cs_sold_date_sk = d_date_sk           and cs_item_sk in (select item_sk from frequent_ss_items)          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)       union all       select ws_quantity*ws_list_price sales        from web_sales             ,date_dim         where d_year = 1998           and d_moy = 5           and ws_sold_date_sk = d_date_sk           and ws_item_sk in (select item_sk from frequent_ss_items)          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) b  ; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"customer": ["c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "item": ["i_item_sk", "i_item_desc"], "store_sales": ["ss_item_sk", "ss_sales_price", "ss_customer_sk", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 24, "query_string": " with ssales as (select c_last_name       ,c_first_name       ,s_store_name       ,ca_state       ,s_state       ,i_color       ,i_current_price       ,i_manager_id       ,i_units       ,i_size       ,sum(ss_net_profit) netpaid from store_sales     ,store_returns     ,store     ,item     ,customer     ,customer_address where ss_ticket_number = sr_ticket_number   and ss_item_sk = sr_item_sk   and ss_customer_sk = c_customer_sk   and ss_item_sk = i_item_sk   and ss_store_sk = s_store_sk   and c_current_addr_sk = ca_address_sk   and c_birth_country <> upper(ca_country)   and s_zip = ca_zip and s_market_id=5 group by c_last_name         ,c_first_name         ,s_store_name         ,ca_state         ,s_state         ,i_color         ,i_current_price         ,i_manager_id         ,i_units         ,i_size) select c_last_name       ,c_first_name       ,s_store_name       ,sum(netpaid) paid from ssales where i_color = 'salmon' group by c_last_name         ,c_first_name         ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid)                                  from ssales) order by c_last_name         ,c_first_name         ,s_store_name; ", "predicates": {"item": ["i_color"], "store": ["s_market_id"]}, "payload": {"customer": ["c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_current_addr_sk"], "customer_address": ["ca_address_sk", "ca_country", "ca_zip", "ca_state"], "item": ["i_item_sk", "i_units", "i_manager_id", "i_current_price", "i_size"], "store": ["s_zip", "s_store_name", "s_state", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_net_paid_inc_tax"]}, "group_by": {}, "order_by": {}}
{"id": 25, "query_string": " select top (100)   i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  ,avg(ss_net_profit) as store_sales_profit  ,avg(sr_net_loss) as store_returns_loss  ,avg(cs_net_profit) as catalog_sales_profit  from  store_sales  ,store_returns  ,catalog_sales  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,item  where  d1.d_moy = 4  and d1.d_year = 2002  and d1.d_date_sk = ss_sold_date_sk  and i_item_sk = ss_item_sk  and s_store_sk = ss_store_sk  and ss_customer_sk = sr_customer_sk  and ss_item_sk = sr_item_sk  and ss_ticket_number = sr_ticket_number  and sr_returned_date_sk = d2.d_date_sk  and d2.d_moy               between 4 and  10  and d2.d_year              = 2002  and sr_customer_sk = cs_bill_customer_sk  and sr_item_sk = cs_item_sk  and cs_sold_date_sk = d3.d_date_sk  and d3.d_moy               between 4 and  10   and d3.d_year              = 2002  group by  i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  order by  i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  ;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_store_name", "s_store_sk", "s_store_id"], "store_returns": ["sr_returned_date_sk", "sr_net_loss", "sr_customer_sk", "sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 26, "query_string": " select top (100) i_item_id,          avg(cs_quantity) agg1,         avg(cs_list_price) agg2,         avg(cs_coupon_amt) agg3,         avg(cs_sales_price) agg4   from catalog_sales, customer_demographics, date_dim, item, promotion  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd_demo_sk and        cs_promo_sk = p_promo_sk and        cd_gender = 'F' and         cd_marital_status = 'W' and        cd_education_status = 'College' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 2002   group by i_item_id  order by i_item_id  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "promotion": ["p_channel_event", "p_channel_email"]}, "payload": {"item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 27, "query_string": " select top (100) i_item_id,         s_state, grouping(s_state) g_state,         avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4  from store_sales, customer_demographics, date_dim, store, item  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_store_sk = s_store_sk and        ss_cdemo_sk = cd_demo_sk and        cd_gender = 'F' and        cd_marital_status = 'U' and        cd_education_status = 'Advanced Degree' and        d_year = 1998 and        s_state in ('TN','TN', 'TN', 'TN', 'TN', 'TN')  group by rollup (i_item_id, s_state)  order by i_item_id          ,s_state  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "store": ["s_state"]}, "payload": {"customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"], "store": ["s_state", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_cdemo_sk", "ss_list_price", "ss_quantity", "ss_sales_price", "ss_coupon_amt", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_id"], "store": ["s_state"]}}
{"id": 28, "query_string": " select top (100) * from (select avg(ss_list_price) B1_LP             ,count(ss_list_price) B1_CNT             ,count(distinct ss_list_price) B1_CNTD       from store_sales       where ss_quantity between 0 and 5         and (ss_list_price between 144 and 144+10               or ss_coupon_amt between 12071 and 12071+1000              or ss_wholesale_cost between 47 and 47+20)) B1,      (select avg(ss_list_price) B2_LP             ,count(ss_list_price) B2_CNT             ,count(distinct ss_list_price) B2_CNTD       from store_sales       where ss_quantity between 6 and 10         and (ss_list_price between 89 and 89+10           or ss_coupon_amt between 13148 and 13148+1000           or ss_wholesale_cost between 68 and 68+20)) B2,      (select avg(ss_list_price) B3_LP             ,count(ss_list_price) B3_CNT             ,count(distinct ss_list_price) B3_CNTD       from store_sales       where ss_quantity between 11 and 15         and (ss_list_price between 148 and 148+10           or ss_coupon_amt between 15569 and 15569+1000           or ss_wholesale_cost between 66 and 66+20)) B3,      (select avg(ss_list_price) B4_LP             ,count(ss_list_price) B4_CNT             ,count(distinct ss_list_price) B4_CNTD       from store_sales       where ss_quantity between 16 and 20         and (ss_list_price between 165 and 165+10           or ss_coupon_amt between 8007 and 8007+1000           or ss_wholesale_cost between 71 and 71+20)) B4,      (select avg(ss_list_price) B5_LP             ,count(ss_list_price) B5_CNT             ,count(distinct ss_list_price) B5_CNTD       from store_sales       where ss_quantity between 21 and 25         and (ss_list_price between 189 and 189+10           or ss_coupon_amt between 10216 and 10216+1000           or ss_wholesale_cost between 64 and 64+20)) B5,      (select avg(ss_list_price) B6_LP             ,count(ss_list_price) B6_CNT             ,count(distinct ss_list_price) B6_CNTD       from store_sales       where ss_quantity between 26 and 30         and (ss_list_price between 181 and 181+10           or ss_coupon_amt between 10559 and 10559+1000           or ss_wholesale_cost between 75 and 75+20)) B6;", "predicates": {"store_sales": ["ss_list_price", "ss_coupon_amt", "ss_quantity", "ss_wholesale_cost"]}, "payload": {"store_sales": ["ss_list_price"]}, "group_by": {}, "order_by": {}}
{"id": 29, "query_string": " select top (100)        i_item_id     ,i_item_desc     ,s_store_id     ,s_store_name     ,avg(ss_quantity)        as store_sales_quantity     ,avg(sr_return_quantity) as store_returns_quantity     ,avg(cs_quantity)        as catalog_sales_quantity  from     store_sales    ,store_returns    ,catalog_sales    ,date_dim             d1    ,date_dim             d2    ,date_dim             d3    ,store    ,item  where      d1.d_moy               = 4   and d1.d_year              = 1998  and d1.d_date_sk           = ss_sold_date_sk  and i_item_sk              = ss_item_sk  and s_store_sk             = ss_store_sk  and ss_customer_sk         = sr_customer_sk  and ss_item_sk             = sr_item_sk  and ss_ticket_number       = sr_ticket_number  and sr_returned_date_sk    = d2.d_date_sk  and d2.d_moy               between 4 and  4 + 3   and d2.d_year              = 1998  and sr_customer_sk         = cs_bill_customer_sk  and sr_item_sk             = cs_item_sk  and cs_sold_date_sk        = d3.d_date_sk       and d3.d_year              in (1998,1998+1,1998+2)  group by     i_item_id    ,i_item_desc    ,s_store_id    ,s_store_name  order by     i_item_id     ,i_item_desc    ,s_store_id    ,s_store_name  ;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_store_name", "s_store_sk", "s_store_id"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_return_quantity", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 30, "query_string": " with customer_total_return as  (select wr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   \tsum(wr_return_amt) as ctr_total_return  from web_returns      ,date_dim      ,customer_address  where wr_returned_date_sk = d_date_sk     and d_year =1999    and wr_returning_addr_sk = ca_address_sk   group by wr_returning_customer_sk          ,ca_state)   select top (100) c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag        ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address        ,c_last_review_date,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  \t\t\t  from customer_total_return ctr2                    \t  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'LA'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag                   ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address                   ,c_last_review_date,ctr_total_return;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_year"]}, "payload": {"customer": ["c_birth_year", "c_login", "c_customer_sk", "c_birth_month", "c_salutation", "c_birth_day", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_current_addr_sk", "c_email_address", "c_customer_id", "c_last_review_date"], "customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "web_returns": ["wr_return_amt", "wr_returning_addr_sk", "wr_returned_date_sk", "wr_returning_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_birth_year", "c_login", "c_birth_month", "c_birth_country", "c_salutation", "c_birth_day", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id", "c_last_review_date"]}}
{"id": 31, "query_string": " with ss as  (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales  from store_sales,date_dim,customer_address  where ss_sold_date_sk = d_date_sk   and ss_addr_sk=ca_address_sk  group by ca_county,d_qoy, d_year),  ws as  (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales  from web_sales,date_dim,customer_address  where ws_sold_date_sk = d_date_sk   and ws_bill_addr_sk=ca_address_sk  group by ca_county,d_qoy, d_year)  select          ss1.ca_county        ,ss1.d_year        ,ws2.web_sales/ws1.web_sales web_q1_q2_increase        ,ss2.store_sales/ss1.store_sales store_q1_q2_increase        ,ws3.web_sales/ws2.web_sales web_q2_q3_increase        ,ss3.store_sales/ss2.store_sales store_q2_q3_increase  from         ss ss1        ,ss ss2        ,ss ss3        ,ws ws1        ,ws ws2        ,ws ws3  where     ss1.d_qoy = 1     and ss1.d_year = 2002     and ss1.ca_county = ss2.ca_county     and ss2.d_qoy = 2     and ss2.d_year = 2002  and ss2.ca_county = ss3.ca_county     and ss3.d_qoy = 3     and ss3.d_year = 2002     and ss1.ca_county = ws1.ca_county     and ws1.d_qoy = 1     and ws1.d_year = 2002     and ws1.ca_county = ws2.ca_county     and ws2.d_qoy = 2     and ws2.d_year = 2002     and ws1.ca_county = ws3.ca_county     and ws3.d_qoy = 3     and ws3.d_year =2002     and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end         > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end     and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end        > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end  order by web_q1_q2_increase;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"customer_address": ["ca_address_sk", "ca_county"], "date_dim": ["d_date_sk", "d_year"], "store_sales": ["ss_sold_date_sk", "ss_addr_sk", "ss_ext_sales_price"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_bill_addr_sk"]}, "group_by": {}, "order_by": {}}
{"id": 32, "query_string": " select top (100) sum(cs_ext_discount_amt)  as \"excess discount amount\"  from     catalog_sales     ,item     ,date_dim where i_manufact_id = 580 and i_item_sk = cs_item_sk  and d_date between '2001-02-21' and          dateadd(day, 90, cast('2001-02-21' as date)) and d_date_sk = cs_sold_date_sk  and cs_ext_discount_amt        > (           select              1.3 * avg(cs_ext_discount_amt)           from              catalog_sales             ,date_dim          where                cs_item_sk = i_item_sk            and d_date between '2001-02-21' and                              dateadd(day, 90, cast('2001-02-21' as date))           and d_date_sk = cs_sold_date_sk        ) ;", "predicates": {"catalog_sales": ["cs_ext_discount_amt"], "date_dim": ["d_date"], "item": ["i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 33, "query_string": " with ss as (  select           i_manufact_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id in (select   i_manufact_id from  item where i_category in ('Sports'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 2  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  cs as (  select           i_manufact_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Sports'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 2  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  ws as (  select           i_manufact_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Sports'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 2  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_manufact_id)   select top (100) i_manufact_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_manufact_id  order by total_sales;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_category"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_addr_sk", "cs_item_sk", "cs_ext_sales_price"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_manufact_id"], "store_sales": ["ss_sold_date_sk", "ss_addr_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk", "ws_bill_addr_sk"]}, "group_by": {}, "order_by": {}}
{"id": 34, "query_string": " select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '501-1000' or          household_demographics.hd_buy_potential = '0-500')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  \tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  \telse null  \tend)  > 1.2     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',                            'Williamson County','Williamson County','Williamson County','Williamson County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;", "predicates": {"date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count", "hd_buy_potential"], "store": ["s_county"]}, "payload": {"customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_preferred_cust_flag"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 35, "query_string": " select top (100)     ca_state,   cd_gender,   cd_marital_status,   cd_dep_count,   count(*) cnt1,   avg(cd_dep_count),   min(cd_dep_count),   stdev(cd_dep_count),   cd_dep_employed_count,   count(*) cnt2,   avg(cd_dep_employed_count),   min(cd_dep_employed_count),   stdev(cd_dep_employed_count),   cd_dep_college_count,   count(*) cnt3,   avg(cd_dep_college_count),   min(cd_dep_college_count),   stdev(cd_dep_college_count)  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 1999 and                 d_qoy < 4) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 1999 and                   d_qoy < 4) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 1999 and                   d_qoy < 4))  group by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  ;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_state"], "customer_demographics": ["cd_dep_college_count", "cd_gender", "cd_demo_sk", "cd_dep_employed_count", "cd_dep_count", "cd_marital_status"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 36, "query_string": " select top (100)      sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  \tpartition by grouping(i_category)+grouping(i_class),  \tcase when grouping(i_class) = 0 then i_category end   \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent  from     store_sales    ,date_dim       d1    ,item    ,store  where     d1.d_year = 2002   and d1.d_date_sk = ss_sold_date_sk  and i_item_sk  = ss_item_sk   and s_store_sk  = ss_store_sk  and s_state in ('TN','TN','TN','TN',                  'TN','TN','TN','TN')  group by rollup(i_category,i_class)  order by    lochierarchy desc   ,case when (grouping(i_category)+grouping(i_class)) = 0 then i_category end   ,rank_within_parent   ;", "predicates": {"date_dim": ["d_year"], "store": ["s_state"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_class", "i_item_sk", "i_category"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_ext_sales_price", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 37, "query_string": " select top (100) i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 49 and 49 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2002-01-10' as date) and dateadd(day, 60, cast('2002-01-10' as date))  and i_manufact_id in (795,874,705,718)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  ;", "predicates": {"date_dim": ["d_date"], "inventory": ["inv_quantity_on_hand"], "item": ["i_current_price", "i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc", "i_current_price"]}, "group_by": {}, "order_by": {}}
{"id": 38, "query_string": " select top (100) count(*) from (     select distinct c_last_name, c_first_name, d_date     from store_sales, date_dim, customer           where store_sales.ss_sold_date_sk = date_dim.d_date_sk       and store_sales.ss_customer_sk = customer.c_customer_sk       and d_month_seq between 1197 and 1197 + 11   intersect     select distinct c_last_name, c_first_name, d_date     from catalog_sales, date_dim, customer           where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk       and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk       and d_month_seq between 1197 and 1197 + 11   intersect     select distinct c_last_name, c_first_name, d_date     from web_sales, date_dim, customer           where web_sales.ws_sold_date_sk = date_dim.d_date_sk       and web_sales.ws_bill_customer_sk = customer.c_customer_sk       and d_month_seq between 1197 and 1197 + 11 ) hot_cust;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk", "ws_item_sk", "ws_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 39, "query_string": " with inv as (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy        ,stdev,mean, case mean when 0 then null else stdev/mean end cov  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy             ,stdev(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean       from inventory           ,item           ,warehouse           ,date_dim       where inv_item_sk = i_item_sk         and inv_warehouse_sk = w_warehouse_sk         and inv_date_sk = d_date_sk         and d_year =2001       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo  where case mean when 0 then 0 else stdev/mean end > 1) select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov from inv inv1,inv inv2 where inv1.i_item_sk = inv2.i_item_sk   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk   and inv1.d_moy=3   and inv2.d_moy=3+1 order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov         ,inv2.d_moy,inv2.mean, inv2.cov; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_item_sk"], "warehouse": ["w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 40, "query_string": " select top (100)     w_state   ,i_item_id   ,sum(case when (cast(d_date as date) < cast ('2001-02-19' as date))   \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before   ,sum(case when (cast(d_date as date) >= cast ('2001-02-19' as date))   \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after  from    catalog_sales left outer join catalog_returns on        (cs_order_number = cr_order_number          and cs_item_sk = cr_item_sk)   ,warehouse    ,item   ,date_dim  where      i_current_price between 0.99 and 1.49  and i_item_sk          = cs_item_sk  and cs_warehouse_sk    = w_warehouse_sk   and cs_sold_date_sk    = d_date_sk  and d_date between dateadd(day, -30, cast ('2001-02-19' as date))                 and dateadd(day, 30, cast ('2001-02-19' as date))   group by     w_state,i_item_id  order by w_state,i_item_id;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_refunded_cash"], "date_dim": ["d_date_sk", "d_date"], "item": ["i_item_id", "i_item_sk"], "warehouse": ["w_state", "w_warehouse_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_id"], "warehouse": ["w_state"]}}
{"id": 41, "query_string": " select distinct top (100) i_product_name  from item i1  where i_manufact_id between 818 and 818+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'orange' or i_color = 'blush') and          (i_units = 'Lb' or i_units = 'Tsp') and         (i_size = 'small' or i_size = 'petite')         ) or         (i_category = 'Women' and         (i_color = 'cornsilk' or i_color = 'tomato') and         (i_units = 'Oz' or i_units = 'Ton') and         (i_size = 'economy' or i_size = 'extra large')         ) or         (i_category = 'Men' and         (i_color = 'violet' or i_color = 'slate') and         (i_units = 'Ounce' or i_units = 'Pound') and         (i_size = 'large' or i_size = 'N/A')         ) or         (i_category = 'Men' and         (i_color = 'maroon' or i_color = 'peach') and         (i_units = 'Box' or i_units = 'Carton') and         (i_size = 'small' or i_size = 'petite')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'burlywood' or i_color = 'cornflower') and          (i_units = 'Each' or i_units = 'Gram') and         (i_size = 'small' or i_size = 'petite')         ) or         (i_category = 'Women' and         (i_color = 'medium' or i_color = 'ghost') and         (i_units = 'Tbl' or i_units = 'Unknown') and         (i_size = 'economy' or i_size = 'extra large')         ) or         (i_category = 'Men' and         (i_color = 'floral' or i_color = 'coral') and         (i_units = 'Bunch' or i_units = 'Dozen') and         (i_size = 'large' or i_size = 'N/A')         ) or         (i_category = 'Men' and         (i_color = 'aquamarine' or i_color = 'sienna') and         (i_units = 'N/A' or i_units = 'Case') and         (i_size = 'small' or i_size = 'petite')         )))) > 0  order by i_product_name  ;", "predicates": {"item": ["i_color", "i_units", "i_manufact_id", "i_category", "i_size", "i_manufact"]}, "payload": {"item": ["i_color", "i_units", "i_product_name", "i_category", "i_size", "i_manufact"]}, "group_by": {}, "order_by": {}}
{"id": 42, "query_string": " select top (100) dt.d_year  \t,item.i_category_id  \t,item.i_category  \t,sum(ss_ext_sales_price)  from \tdate_dim dt  \t,store_sales  \t,item  where dt.d_date_sk = store_sales.ss_sold_date_sk  \tand store_sales.ss_item_sk = item.i_item_sk  \tand item.i_manager_id = 1  \t  \tand dt.d_moy=11  \tand dt.d_year=2001  group by \tdt.d_year  \t\t,item.i_category_id  \t\t,item.i_category  order by       sum(ss_ext_sales_price) desc,dt.d_year  \t\t,item.i_category_id  \t\t,item.i_category  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_item_sk", "i_category", "i_category_id"]}, "group_by": {}, "order_by": {"item": ["i_category", "i_category_id"]}}
{"id": 43, "query_string": " select top (100) s_store_name, s_store_id,         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales  from date_dim, store_sales, store  where d_date_sk = ss_sold_date_sk and        s_store_sk = ss_store_sk and        s_gmt_offset = -5 and        d_year = 2001   group by s_store_name, s_store_id  order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales  ;", "predicates": {"date_dim": ["d_year"], "store": ["s_gmt_offset"]}, "payload": {"date_dim": ["d_date_sk", "d_day_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 44, "query_string": " select top (100) asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing from(select *      from (select item_sk,rank() over (order by rank_col asc) rnk            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col                   from store_sales ss1                  where ss_store_sk = 3                  group by ss_item_sk                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col                                                   from store_sales                                                   where ss_store_sk = 3                                                     and ss_promo_sk is null                                                   group by ss_store_sk))V1)V11      where rnk  < 11) asceding,     (select *      from (select item_sk,rank() over (order by rank_col desc) rnk            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col                  from store_sales ss1                  where ss_store_sk = 3                  group by ss_item_sk                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col                                                   from store_sales                                                   where ss_store_sk = 3                                                     and ss_promo_sk is null                                                   group by ss_store_sk))V2)V21      where rnk  < 11) descending, item i1, item i2 where asceding.rnk = descending.rnk    and i1.i_item_sk=asceding.item_sk   and i2.i_item_sk=descending.item_sk order by asceding.rnk;", "predicates": {"store_sales": ["ss_store_sk", "ss_customer_sk"]}, "payload": {"store_sales": ["ss_net_profit", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 45, "query_string": " select top (100) ca_zip, ca_city, sum(ws_sales_price)  from web_sales, customer, customer_address, date_dim, item  where ws_bill_customer_sk = c_customer_sk  \tand c_current_addr_sk = ca_address_sk   \tand ws_item_sk = i_item_sk   \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')  \t      or   \t      i_item_id in (select i_item_id                              from item                              where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)                              )  \t    )  \tand ws_sold_date_sk = d_date_sk  \tand d_qoy = 1 and d_year = 1999  group by ca_zip, ca_city  order by ca_zip, ca_city  ;", "predicates": {"customer_address": ["ca_zip"], "date_dim": ["d_qoy", "d_year"], "item": ["i_item_id"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip", "ca_city"], "date_dim": ["d_date_sk"], "web_sales": ["ws_sales_price", "ws_sold_date_sk", "ws_bill_customer_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 46, "query_string": " select top (100) c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,ca_city bought_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics,customer_address      where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and (household_demographics.hd_dep_count = 9 or          household_demographics.hd_vehicle_count= -1)     and date_dim.d_dow in (6,0)     and date_dim.d_year in (2000,2000+1,2000+2)      and store.s_city in ('Fairview','Midway','Midway','Fairview','Fairview')      group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr     where ss_customer_sk = c_customer_sk       and customer.c_current_addr_sk = current_addr.ca_address_sk       and current_addr.ca_city <> bought_city   order by c_last_name           ,c_first_name           ,ca_city           ,bought_city           ,ss_ticket_number   ;", "predicates": {"date_dim": ["d_dow", "d_year"], "household_demographics": ["hd_vehicle_count", "hd_dep_count"], "store": ["s_city"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk", "c_first_name", "c_last_name"], "customer_address": ["ca_city", "ca_address_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_addr_sk", "ss_coupon_amt", "ss_customer_sk", "ss_hdemo_sk", "ss_net_profit", "ss_sold_date_sk", "ss_store_sk", "ss_ticket_number"]}, "group_by": {}, "order_by": {}}
{"id": 47, "query_string": " with v1 as(  select i_category, i_brand,         s_store_name, s_company_name,         d_year, d_moy,         sum(ss_sales_price) sum_sales,         avg(sum(ss_sales_price)) over           (partition by i_category, i_brand,                      s_store_name, s_company_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      s_store_name, s_company_name            order by d_year, d_moy) rn  from item, store_sales, date_dim, store  where ss_item_sk = i_item_sk and        ss_sold_date_sk = d_date_sk and        ss_store_sk = s_store_sk and        (          d_year = 2001 or          ( d_year = 2001-1 and d_moy =12) or          ( d_year = 2001+1 and d_moy =1)        )  group by i_category, i_brand,           s_store_name, s_company_name,           d_year, d_moy),  v2 as(  select v1.i_brand         ,v1.d_year         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1.s_store_name = v1_lag.s_store_name and        v1.s_store_name = v1_lead.s_store_name and        v1.s_company_name = v1_lag.s_company_name and        v1.s_company_name = v1_lead.s_company_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select top (100) *  from v2  where  d_year = 2001 and             avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, nsum  ;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk", "d_moy", "d_year"], "item": ["i_brand", "i_item_sk", "i_category"], "store": ["s_store_name", "s_store_sk", "s_company_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 48, "query_string": " select sum (ss_quantity)  from store_sales, store, customer_demographics, customer_address, date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2001  and    (   (    cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'M'    and     cd_education_status = 'Secondary'    and     ss_sales_price between 100.00 and 150.00      )  or   (   cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'D'    and     cd_education_status = '2 yr Degree'    and     ss_sales_price between 50.00 and 100.00      )  or   (   cd_demo_sk = ss_cdemo_sk   and     cd_marital_status = 'U'    and     cd_education_status = '4 yr Degree'    and     ss_sales_price between 150.00 and 200.00    )  )  and  (   (   ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('LA', 'TX', 'VA')   and ss_net_profit between 0 and 2000     )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('NY', 'MO', 'RI')   and ss_net_profit between 150 and 3000    )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('NC', 'OK', 'WI')   and ss_net_profit between 50 and 25000    )  );", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "store_sales": ["ss_sales_price", "ss_net_profit"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_cdemo_sk", "ss_addr_sk", "ss_quantity", "ss_sales_price", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 49, "query_string": " select top (100) channel, item, return_ratio, return_rank, currency_rank from  (select  'web' as channel  ,web.item  ,web.return_ratio  ,web.return_rank  ,web.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect ws.ws_item_sk as item  \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\t web_sales ws left outer join web_returns wr   \t\t\ton (ws.ws_order_number = wr.wr_order_number and   \t\t\tws.ws_item_sk = wr.wr_item_sk)                  ,date_dim  \t\twhere   \t\t\twr.wr_return_amt > 10000   \t\t\tand ws.ws_net_profit > 1                          and ws.ws_net_paid > 0                          and ws.ws_quantity > 0                          and ws_sold_date_sk = d_date_sk                          and d_year = 2002                          and d_moy = 11  \t\tgroup by ws.ws_item_sk  \t) in_web  ) web  where   (  web.return_rank <= 10  or  web.currency_rank <= 10  )  union  select   'catalog' as channel  ,catalog.item  ,catalog.return_ratio  ,catalog.return_rank  ,catalog.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect   \t\tcs.cs_item_sk as item  \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\tcatalog_sales cs left outer join catalog_returns cr  \t\t\ton (cs.cs_order_number = cr.cr_order_number and   \t\t\tcs.cs_item_sk = cr.cr_item_sk)                 ,date_dim  \t\twhere   \t\t\tcr.cr_return_amount > 10000   \t\t\tand cs.cs_net_profit > 1                          and cs.cs_net_paid > 0                          and cs.cs_quantity > 0                          and cs_sold_date_sk = d_date_sk                          and d_year = 2002                          and d_moy = 11                  group by cs.cs_item_sk  \t) in_cat  ) catalog  where   (  catalog.return_rank <= 10  or  catalog.currency_rank <=10  )  union  select   'store' as channel  ,store.item  ,store.return_ratio  ,store.return_rank  ,store.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect sts.ss_item_sk as item  \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\tstore_sales sts left outer join store_returns sr  \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)                 ,date_dim  \t\twhere   \t\t\tsr.sr_return_amt > 10000   \t\t\tand sts.ss_net_profit > 1                          and sts.ss_net_paid > 0                           and sts.ss_quantity > 0                          and ss_sold_date_sk = d_date_sk                          and d_year = 2002                          and d_moy = 11  \t\tgroup by sts.ss_item_sk  \t) in_store  ) store  where  (  store.return_rank <= 10  or   store.currency_rank <= 10  )  ) a  order by 1,4,5,2  ;", "predicates": {"catalog_returns": ["cr_return_amount"], "catalog_sales": ["cs_net_paid", "cs_net_profit", "cs_quantity"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_return_amt"], "store_sales": ["ss_net_paid", "ss_quantity", "ss_net_profit"], "web_returns": ["wr_return_amt"], "web_sales": ["ws_net_profit", "ws_net_paid", "ws_quantity"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_quantity", "cr_return_amount"], "store_returns": ["sr_return_amt", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_return_amt", "wr_return_quantity", "wr_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 50, "query_string": " select top (100)     s_store_name   ,s_company_id   ,s_street_number   ,s_street_name   ,s_street_type   ,s_suite_number   ,s_city   ,s_county   ,s_state   ,s_zip   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and                   (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and                   (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and                  (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    store_sales   ,store_returns   ,store   ,date_dim d1   ,date_dim d2 where     d2.d_year = 2002 and d2.d_moy  = 10 and ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_sold_date_sk   = d1.d_date_sk and sr_returned_date_sk   = d2.d_date_sk and ss_customer_sk = sr_customer_sk and ss_store_sk = s_store_sk group by    s_store_name   ,s_company_id   ,s_street_number   ,s_street_name   ,s_street_type   ,s_suite_number   ,s_city   ,s_county   ,s_state   ,s_zip order by s_store_name         ,s_company_id         ,s_street_number         ,s_street_name         ,s_street_type         ,s_suite_number         ,s_city         ,s_county         ,s_state         ,s_zip;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 51, "query_string": " WITH web_v1 as ( select   ws_item_sk item_sk, d_date,   sum(sum(ws_sales_price))       over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from web_sales     ,date_dim where ws_sold_date_sk=d_date_sk   and d_month_seq between 1197 and 1197+11   and ws_item_sk is not NULL group by ws_item_sk, d_date), store_v1 as ( select   ss_item_sk item_sk, d_date,   sum(sum(ss_sales_price))       over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from store_sales     ,date_dim where ss_sold_date_sk=d_date_sk   and d_month_seq between 1197 and 1197+11   and ss_item_sk is not NULL group by ss_item_sk, d_date)  select top (100) * from (select item_sk      ,d_date      ,web_sales      ,store_sales      ,max(web_sales)          over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative      ,max(store_sales)          over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative      from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk                  ,case when web.d_date is not null then web.d_date else store.d_date end d_date                  ,web.cume_sales web_sales                  ,store.cume_sales store_sales            from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk                                                           and web.d_date = store.d_date)           )x )y where web_cumulative > store_cumulative order by item_sk         ,d_date;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_sales_price", "ss_item_sk"], "web_sales": ["ws_sold_date_sk", "ws_sales_price", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 52, "query_string": " select top (100) dt.d_year  \t,item.i_brand_id brand_id  \t,item.i_brand brand  \t,sum(ss_ext_sales_price) ext_price  from date_dim dt      ,store_sales      ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=11     and dt.d_year=2001  group by dt.d_year  \t,item.i_brand  \t,item.i_brand_id  order by dt.d_year  \t,ext_price desc  \t,brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"item": ["i_brand_id"]}}
{"id": 53, "query_string": " select top (100) * from  (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1197,1197+1,1197+2,1197+3,1197+4,1197+5,1197+6,1197+7,1197+8,1197+9,1197+10,1197+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', \t\t'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', \t\t'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0  \tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales  \telse null end > 0.1 order by avg_quarterly_sales, \t sum_sales, \t i_manufact_id;", "predicates": {"date_dim": ["d_month_seq"], "item": ["i_brand", "i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_qoy"], "item": ["i_item_sk", "i_manufact_id", "i_brand", "i_category", "i_class"], "store": ["s_store_sk"]}, "group_by": {}, "order_by": {}}
{"id": 54, "query_string": " with my_customers as (  select distinct c_customer_sk         , c_current_addr_sk  from            ( select cs_sold_date_sk sold_date_sk,                  cs_bill_customer_sk customer_sk,                  cs_item_sk item_sk           from   catalog_sales           union all           select ws_sold_date_sk sold_date_sk,                  ws_bill_customer_sk customer_sk,                  ws_item_sk item_sk           from   web_sales          ) cs_or_ws_sales,          item,          date_dim,          customer  where   sold_date_sk = d_date_sk          and item_sk = i_item_sk          and i_category = 'Electronics'          and i_class = 'portable'          and c_customer_sk = cs_or_ws_sales.customer_sk          and d_moy = 2          and d_year = 2000  )  , my_revenue as (  select c_customer_sk,         sum(ss_ext_sales_price) as revenue  from   my_customers,         store_sales,         customer_address,         store,         date_dim  where  c_current_addr_sk = ca_address_sk         and ca_county = s_county         and ca_state = s_state         and ss_sold_date_sk = d_date_sk         and c_customer_sk = ss_customer_sk         and d_month_seq between (select distinct d_month_seq+1                                  from   date_dim where d_year = 2000 and d_moy = 2)                            and  (select distinct d_month_seq+3                                  from   date_dim where d_year = 2000 and d_moy = 2)  group by c_customer_sk  )  , segments as  (select cast((revenue/50) as int) as segment   from   my_revenue  )   select top (100) segment, count(*) as num_customers, segment*50 as segment_base  from segments  group by segment  order by segment, num_customers  ;", "predicates": {"date_dim": ["d_month_seq", "d_moy", "d_year"], "item": ["i_class", "i_category"]}, "payload": {"customer_address": ["ca_address_sk", "ca_county", "ca_state"], "date_dim": ["d_date_sk", "d_month_seq"], "item": ["i_item_sk"], "store": ["s_state", "s_county"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_ext_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 55, "query_string": " select top (100) i_brand_id brand_id, i_brand brand,  \tsum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item  where d_date_sk = ss_sold_date_sk  \tand ss_item_sk = i_item_sk  \tand i_manager_id=79  \tand d_moy=11  \tand d_year=2002  group by i_brand, i_brand_id  order by ext_price desc, i_brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"item": ["i_brand_id"]}}
{"id": 56, "query_string": " with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('medium','orchid','midnight'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 3  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -7   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('medium','orchid','midnight'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 3  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -7   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('medium','orchid','midnight'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 3  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -7  group by i_item_id)   select top (100) i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  ;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_color"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 57, "query_string": " with v1 as(  select i_category, i_brand,         cc_name,         d_year, d_moy,         sum(cs_sales_price) sum_sales,         avg(sum(cs_sales_price)) over           (partition by i_category, i_brand,                      cc_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      cc_name            order by d_year, d_moy) rn  from item, catalog_sales, date_dim, call_center  where cs_item_sk = i_item_sk and        cs_sold_date_sk = d_date_sk and        cc_call_center_sk= cs_call_center_sk and        (          d_year = 2001 or          ( d_year = 2001-1 and d_moy =12) or          ( d_year = 2001+1 and d_moy =1)        )  group by i_category, i_brand,           cc_name , d_year, d_moy),  v2 as(  select v1.cc_name         ,v1.d_year         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1. cc_name = v1_lag. cc_name and        v1. cc_name = v1_lead. cc_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select top (100) *  from v2  where  d_year = 2001 and         avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, nsum  ;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"call_center": ["cc_name", "cc_call_center_sk"], "catalog_sales": ["cs_sales_price", "cs_sold_date_sk", "cs_call_center_sk", "cs_item_sk"], "date_dim": ["d_date_sk", "d_moy", "d_year"], "item": ["i_brand", "i_item_sk", "i_category"]}, "group_by": {}, "order_by": {}}
{"id": 58, "query_string": " with ss_items as  (select i_item_id item_id         ,sum(ss_ext_sales_price) ss_item_rev   from store_sales      ,item      ,date_dim  where ss_item_sk = i_item_sk    and d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2001-02-14'))    and ss_sold_date_sk   = d_date_sk  group by i_item_id),  cs_items as  (select i_item_id item_id         ,sum(cs_ext_sales_price) cs_item_rev   from catalog_sales       ,item       ,date_dim  where cs_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2001-02-14'))   and  cs_sold_date_sk = d_date_sk  group by i_item_id),  ws_items as  (select i_item_id item_id         ,sum(ws_ext_sales_price) ws_item_rev   from web_sales       ,item       ,date_dim  where ws_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq =(select d_week_seq                                       from date_dim                                      where d_date = '2001-02-14'))   and ws_sold_date_sk   = d_date_sk  group by i_item_id)   select top (100) ss_items.item_id        ,ss_item_rev        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev        ,cs_item_rev        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev        ,ws_item_rev        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average  from ss_items,cs_items,ws_items  where ss_items.item_id=cs_items.item_id    and ss_items.item_id=ws_items.item_id     and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  order by item_id          ,ss_item_rev  ;", "predicates": {"date_dim": ["d_week_seq", "d_date"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_item_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "item": ["i_item_id", "i_item_sk"], "store_sales": ["ss_sold_date_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 59, "query_string": " with wss as   (select d_week_seq,         ss_store_sk,         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales  from store_sales,date_dim  where d_date_sk = ss_sold_date_sk  group by d_week_seq,ss_store_sk  )   select top (100) s_store_name1,s_store_id1,d_week_seq1        ,sun_sales1/sun_sales2,mon_sales1/mon_sales2        ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2        ,fri_sales1/fri_sales2,sat_sales1/sat_sales2  from  (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1         ,s_store_id s_store_id1,sun_sales sun_sales1         ,mon_sales mon_sales1,tue_sales tue_sales1         ,wed_sales wed_sales1,thu_sales thu_sales1         ,fri_sales fri_sales1,sat_sales sat_sales1   from wss,store,date_dim d   where d.d_week_seq = wss.d_week_seq and         ss_store_sk = s_store_sk and          d_month_seq between 1202 and 1202 + 11) y,  (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2         ,s_store_id s_store_id2,sun_sales sun_sales2         ,mon_sales mon_sales2,tue_sales tue_sales2         ,wed_sales wed_sales2,thu_sales thu_sales2         ,fri_sales fri_sales2,sat_sales sat_sales2   from wss,store,date_dim d   where d.d_week_seq = wss.d_week_seq and         ss_store_sk = s_store_sk and          d_month_seq between 1202+ 12 and 1202 + 23) x  where s_store_id1=s_store_id2    and d_week_seq1=d_week_seq2-52  order by s_store_name1,s_store_id1,d_week_seq1;", "predicates": {"date_dim": ["d_month_seq"], "store": ["s_store_id"]}, "payload": {"date_dim": ["d_date_sk", "d_week_seq", "d_day_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 60, "query_string": " with ss as (  select           i_item_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where          i_item_id in (select   i_item_id from  item where i_category in ('Shoes'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 8  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  cs as (  select           i_item_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Shoes'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 8  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  ws as (  select           i_item_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Shoes'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 8  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_item_id)   select top (100)     i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by i_item_id       ,total_sales  ;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_item_id", "i_category"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 61, "query_string": " select top (100) promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from   (select sum(ss_ext_sales_price) promotions    from  store_sales         ,store         ,promotion         ,date_dim         ,customer         ,customer_address          ,item    where ss_sold_date_sk = d_date_sk    and   ss_store_sk = s_store_sk    and   ss_promo_sk = p_promo_sk    and   ss_customer_sk= c_customer_sk    and   ca_address_sk = c_current_addr_sk    and   ss_item_sk = i_item_sk     and   ca_gmt_offset = -6    and   i_category = 'Sports'    and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')    and   s_gmt_offset = -6    and   d_year = 2000    and   d_moy  = 11) promotional_sales,   (select sum(ss_ext_sales_price) total    from  store_sales         ,store         ,date_dim         ,customer         ,customer_address         ,item    where ss_sold_date_sk = d_date_sk    and   ss_store_sk = s_store_sk    and   ss_customer_sk= c_customer_sk    and   ca_address_sk = c_current_addr_sk    and   ss_item_sk = i_item_sk    and   ca_gmt_offset = -6    and   i_category = 'Sports'    and   s_gmt_offset = -6    and   d_year = 2000    and   d_moy  = 11) all_sales order by promotions, total;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_category"], "promotion": ["p_channel_dmail", "p_channel_email", "p_channel_tv"], "store": ["s_gmt_offset"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_promo_sk", "ss_item_sk", "ss_ext_sales_price", "ss_customer_sk", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 62, "query_string": " select top (100)     substring(w_warehouse_name,1,20)   ,sm_type   ,web_name   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and                   (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and                   (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and                  (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    web_sales   ,warehouse   ,ship_mode   ,web_site   ,date_dim where     d_month_seq between 1197 and 1197 + 11 and ws_ship_date_sk   = d_date_sk and ws_warehouse_sk   = w_warehouse_sk and ws_ship_mode_sk   = sm_ship_mode_sk and ws_web_site_sk    = web_site_sk group by    substring(w_warehouse_name,1,20)   ,sm_type   ,web_name order by substring(w_warehouse_name,1,20)         ,sm_type        ,web_name;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "ship_mode": ["sm_type", "sm_ship_mode_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"], "web_sales": ["ws_ship_date_sk", "ws_ship_mode_sk", "ws_sold_date_sk", "ws_warehouse_sk", "ws_web_site_sk"], "web_site": ["web_name", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 63, "query_string": " select top (100) *  from (select i_manager_id              ,sum(ss_sales_price) sum_sales              ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales       from item           ,store_sales           ,date_dim           ,store       where ss_item_sk = i_item_sk         and ss_sold_date_sk = d_date_sk         and ss_store_sk = s_store_sk         and d_month_seq in (1197,1197+1,1197+2,1197+3,1197+4,1197+5,1197+6,1197+7,1197+8,1197+9,1197+10,1197+11)         and ((    i_category in ('Books','Children','Electronics')               and i_class in ('personal','portable','reference','self-help')               and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', \t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))            or(    i_category in ('Women','Music','Men')               and i_class in ('accessories','classical','fragrances','pants')               and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', \t\t                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id         ,avg_monthly_sales         ,sum_sales;", "predicates": {"date_dim": ["d_month_seq"], "item": ["i_brand", "i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_item_sk", "i_manager_id", "i_brand", "i_category", "i_class"], "store": ["s_store_sk"]}, "group_by": {}, "order_by": {"item": ["i_manager_id"]}}
{"id": 64, "query_string": " with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('puff','dodger','grey','powder','orange','honeydew') and          i_current_price between 64 and 64 + 10 and          i_current_price between 64 + 1 and 64 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;", "predicates": {"customer_demographics": ["cd_marital_status"], "date_dim": ["d_year"], "item": ["i_color", "i_current_price"], "store": ["s_zip", "s_store_name"]}, "payload": {"household_demographics": ["hd_income_band_sk", "hd_demo_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 65, "query_string": " select top (100) \ts_store_name, \ti_item_desc, \tsc.revenue, \ti_current_price, \ti_wholesale_cost, \ti_brand  from store, item,      (select ss_store_sk, avg(revenue) as ave  \tfrom  \t    (select  ss_store_sk, ss_item_sk,   \t\t     sum(ss_sales_price) as revenue  \t\tfrom store_sales, date_dim  \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1197 and 1197+11  \t\tgroup by ss_store_sk, ss_item_sk) sa  \tgroup by ss_store_sk) sb,      (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue  \tfrom store_sales, date_dim  \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1197 and 1197+11  \tgroup by ss_store_sk, ss_item_sk) sc  where sb.ss_store_sk = sc.ss_store_sk and         sc.revenue <= 0.1 * sb.ave and        s_store_sk = sc.ss_store_sk and        i_item_sk = sc.ss_item_sk  order by s_store_name, i_item_desc;", "predicates": {"date_dim": ["d_month_seq"], "store_sales": ["ss_store_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_brand", "i_wholesale_cost", "i_item_desc"], "store": ["s_store_name", "s_store_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price", "ss_item_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_desc"], "store": ["s_store_name"]}}
{"id": 66, "query_string": " select top (100)            w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country         ,ship_carriers         ,year  \t,sum(jan_sales) as jan_sales  \t,sum(feb_sales) as feb_sales  \t,sum(mar_sales) as mar_sales  \t,sum(apr_sales) as apr_sales  \t,sum(may_sales) as may_sales  \t,sum(jun_sales) as jun_sales  \t,sum(jul_sales) as jul_sales  \t,sum(aug_sales) as aug_sales  \t,sum(sep_sales) as sep_sales  \t,sum(oct_sales) as oct_sales  \t,sum(nov_sales) as nov_sales  \t,sum(dec_sales) as dec_sales  \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot  \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot  \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot  \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot  \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot  \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot  \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot  \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot  \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot  \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot  \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot  \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot  \t,sum(jan_net) as jan_net  \t,sum(feb_net) as feb_net  \t,sum(mar_net) as mar_net  \t,sum(apr_net) as apr_net  \t,sum(may_net) as may_net  \t,sum(jun_net) as jun_net  \t,sum(jul_net) as jul_net  \t,sum(aug_net) as aug_net  \t,sum(sep_net) as sep_net  \t,sum(oct_net) as oct_net  \t,sum(nov_net) as nov_net  \t,sum(dec_net) as dec_net  from (      select   \tw_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,concat('MSC' , ',' , 'BOXBUNDLES') as ship_carriers        ,d_year as year  \t,sum(case when d_moy = 1   \t\tthen ws_sales_price* ws_quantity else 0 end) as jan_sales  \t,sum(case when d_moy = 2   \t\tthen ws_sales_price* ws_quantity else 0 end) as feb_sales  \t,sum(case when d_moy = 3   \t\tthen ws_sales_price* ws_quantity else 0 end) as mar_sales  \t,sum(case when d_moy = 4   \t\tthen ws_sales_price* ws_quantity else 0 end) as apr_sales  \t,sum(case when d_moy = 5   \t\tthen ws_sales_price* ws_quantity else 0 end) as may_sales  \t,sum(case when d_moy = 6   \t\tthen ws_sales_price* ws_quantity else 0 end) as jun_sales  \t,sum(case when d_moy = 7   \t\tthen ws_sales_price* ws_quantity else 0 end) as jul_sales  \t,sum(case when d_moy = 8   \t\tthen ws_sales_price* ws_quantity else 0 end) as aug_sales  \t,sum(case when d_moy = 9   \t\tthen ws_sales_price* ws_quantity else 0 end) as sep_sales  \t,sum(case when d_moy = 10   \t\tthen ws_sales_price* ws_quantity else 0 end) as oct_sales  \t,sum(case when d_moy = 11  \t\tthen ws_sales_price* ws_quantity else 0 end) as nov_sales  \t,sum(case when d_moy = 12  \t\tthen ws_sales_price* ws_quantity else 0 end) as dec_sales  \t,sum(case when d_moy = 1   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net  \t,sum(case when d_moy = 2  \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net  \t,sum(case when d_moy = 3   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net  \t,sum(case when d_moy = 4   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net  \t,sum(case when d_moy = 5   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net  \t,sum(case when d_moy = 6   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net  \t,sum(case when d_moy = 7   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net  \t,sum(case when d_moy = 8   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net  \t,sum(case when d_moy = 9   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net  \t,sum(case when d_moy = 10   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net  \t,sum(case when d_moy = 11  \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net  \t,sum(case when d_moy = 12  \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net      from           web_sales          ,warehouse          ,date_dim          ,time_dim  \t  ,ship_mode      where             ws_warehouse_sk =  w_warehouse_sk         and ws_sold_date_sk = d_date_sk         and ws_sold_time_sk = t_time_sk  \tand ws_ship_mode_sk = sm_ship_mode_sk         and d_year = 2001  \tand t_time between 14011 and 14011+28800   \tand sm_carrier in ('MSC','BOXBUNDLES')      group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country        ,d_year  union all      select   \tw_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,concat('MSC', ',', 'BOXBUNDLES') as ship_carriers        ,d_year as year  \t,sum(case when d_moy = 1   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jan_sales  \t,sum(case when d_moy = 2   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as feb_sales  \t,sum(case when d_moy = 3   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as mar_sales  \t,sum(case when d_moy = 4   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as apr_sales  \t,sum(case when d_moy = 5   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as may_sales  \t,sum(case when d_moy = 6   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jun_sales  \t,sum(case when d_moy = 7   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jul_sales  \t,sum(case when d_moy = 8   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as aug_sales  \t,sum(case when d_moy = 9   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as sep_sales  \t,sum(case when d_moy = 10   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as oct_sales  \t,sum(case when d_moy = 11  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as nov_sales  \t,sum(case when d_moy = 12  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as dec_sales  \t,sum(case when d_moy = 1   \t\tthen cs_net_profit * cs_quantity else 0 end) as jan_net  \t,sum(case when d_moy = 2   \t\tthen cs_net_profit * cs_quantity else 0 end) as feb_net  \t,sum(case when d_moy = 3   \t\tthen cs_net_profit * cs_quantity else 0 end) as mar_net  \t,sum(case when d_moy = 4   \t\tthen cs_net_profit * cs_quantity else 0 end) as apr_net  \t,sum(case when d_moy = 5   \t\tthen cs_net_profit * cs_quantity else 0 end) as may_net  \t,sum(case when d_moy = 6   \t\tthen cs_net_profit * cs_quantity else 0 end) as jun_net  \t,sum(case when d_moy = 7   \t\tthen cs_net_profit * cs_quantity else 0 end) as jul_net  \t,sum(case when d_moy = 8   \t\tthen cs_net_profit * cs_quantity else 0 end) as aug_net  \t,sum(case when d_moy = 9   \t\tthen cs_net_profit * cs_quantity else 0 end) as sep_net  \t,sum(case when d_moy = 10   \t\tthen cs_net_profit * cs_quantity else 0 end) as oct_net  \t,sum(case when d_moy = 11  \t\tthen cs_net_profit * cs_quantity else 0 end) as nov_net  \t,sum(case when d_moy = 12  \t\tthen cs_net_profit * cs_quantity else 0 end) as dec_net      from           catalog_sales          ,warehouse          ,date_dim          ,time_dim  \t ,ship_mode      where             cs_warehouse_sk =  w_warehouse_sk         and cs_sold_date_sk = d_date_sk         and cs_sold_time_sk = t_time_sk  \tand cs_ship_mode_sk = sm_ship_mode_sk         and d_year = 2001  \tand t_time between 14011 AND 14011+28800   \tand sm_carrier in ('MSC','BOXBUNDLES')      group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country        ,d_year  ) x  group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,ship_carriers        ,year  order by w_warehouse_name  ;", "predicates": {"date_dim": ["d_year"], "ship_mode": ["sm_carrier"], "time_dim": ["t_time"]}, "payload": {"catalog_sales": ["cs_warehouse_sk", "cs_ext_list_price", "cs_quantity", "cs_net_paid_inc_tax", "cs_ship_mode_sk", "cs_sold_date_sk", "cs_sold_time_sk"], "date_dim": ["d_date_sk", "d_moy", "d_year"], "ship_mode": ["sm_ship_mode_sk"], "time_dim": ["t_time_sk"], "web_sales": ["ws_ship_mode_sk", "ws_ext_list_price", "ws_sold_date_sk", "ws_quantity", "ws_sold_time_sk", "ws_warehouse_sk", "ws_net_paid"]}, "group_by": {}, "order_by": {}}
{"id": 67, "query_string": " select top (100) * from (select i_category             ,i_class             ,i_brand             ,i_product_name             ,d_year             ,d_qoy             ,d_moy             ,s_store_id             ,sumsales             ,rank() over (partition by i_category order by sumsales desc) rk       from (select i_category                   ,i_class                   ,i_brand                   ,i_product_name                   ,d_year                   ,d_qoy                   ,d_moy                   ,s_store_id                   ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales             from store_sales                 ,date_dim                 ,store                 ,item        where  ss_sold_date_sk=d_date_sk           and ss_item_sk=i_item_sk           and ss_store_sk = s_store_sk           and d_month_seq between 1197 and 1197+11        group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 order by i_category         ,i_class         ,i_brand         ,i_product_name         ,d_year         ,d_qoy         ,d_moy         ,s_store_id         ,sumsales         ,rk;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk", "d_moy", "d_qoy", "d_year"], "item": ["i_item_sk", "i_brand", "i_product_name", "i_category", "i_class"], "store": ["s_store_sk", "s_store_id"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_sales_price", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {"date_dim": ["d_moy", "d_qoy", "d_year"], "item": ["i_brand", "i_class", "i_product_name", "i_category"], "store": ["s_store_id"]}}
{"id": 68, "query_string": " select top (100) c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,extended_price        ,extended_tax        ,list_price  from (select ss_ticket_number              ,ss_customer_sk              ,ca_city bought_city              ,sum(ss_ext_sales_price) extended_price               ,sum(ss_ext_list_price) list_price              ,sum(ss_ext_tax) extended_tax         from store_sales            ,date_dim            ,store            ,household_demographics            ,customer_address         where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_store_sk = store.s_store_sk           and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk         and store_sales.ss_addr_sk = customer_address.ca_address_sk         and date_dim.d_dom between 1 and 2          and (household_demographics.hd_dep_count = 0 or              household_demographics.hd_vehicle_count= 0)         and date_dim.d_year in (1999,1999+1,1999+2)         and store.s_city in ('Midway','Fairview')        group by ss_ticket_number                ,ss_customer_sk                ,ss_addr_sk,ca_city) dn       ,customer       ,customer_address current_addr  where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name          ,ss_ticket_number  ;", "predicates": {"customer_address": ["ca_city"], "date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_city"]}, "payload": {"customer": ["c_current_addr_sk", "c_first_name", "c_last_name", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_city"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_ext_sales_price", "ss_addr_sk", "ss_customer_sk", "ss_ticket_number", "ss_ext_list_price", "ss_ext_tax", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 69, "query_string": " select top (100)    cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_state in ('CA','FL','ME') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2003 and                 d_moy between 2 and 2+2) and    (not exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2003 and                   d_moy between 2 and 2+2) and     not exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2003 and                   d_moy between 2 and 2+2))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  ;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 70, "query_string": " select top (100)      sum(ss_net_profit) as total_sum    ,s_state    ,s_county    ,grouping(s_state)+grouping(s_county) as lochierarchy    ,rank() over (  \tpartition by grouping(s_state)+grouping(s_county),  \tcase when grouping(s_county) = 0 then s_state end   \torder by sum(ss_net_profit) desc) as rank_within_parent  from     store_sales    ,date_dim       d1    ,store  where     d1.d_month_seq between 1197 and 1197+11  and d1.d_date_sk = ss_sold_date_sk  and s_store_sk  = ss_store_sk  and s_state in              ( select s_state                from  (select s_state as s_state,  \t\t\t    rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking                       from   store_sales, store, date_dim                       where  d_month_seq between 1197 and 1197+11  \t\t\t    and d_date_sk = ss_sold_date_sk  \t\t\t    and s_store_sk  = ss_store_sk                       group by s_state                      ) tmp1                 where ranking <= 5              )  group by rollup(s_state,s_county)  order by    lochierarchy desc   ,case when (grouping(s_state)+grouping(s_county)) = 0 then s_state end   ,rank_within_parent  ;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 71, "query_string": " select i_brand_id brand_id, i_brand brand,t_hour,t_minute,  \tsum(ext_price) ext_price  from item, (select ws_ext_sales_price as ext_price,                          ws_sold_date_sk as sold_date_sk,                         ws_item_sk as sold_item_sk,                         ws_sold_time_sk as time_sk                    from web_sales,date_dim                  where d_date_sk = ws_sold_date_sk                    and d_moy=11                    and d_year=2002                  union all                  select cs_ext_sales_price as ext_price,                         cs_sold_date_sk as sold_date_sk,                         cs_item_sk as sold_item_sk,                         cs_sold_time_sk as time_sk                  from catalog_sales,date_dim                  where d_date_sk = cs_sold_date_sk                    and d_moy=11                    and d_year=2002                  union all                  select ss_ext_sales_price as ext_price,                         ss_sold_date_sk as sold_date_sk,                         ss_item_sk as sold_item_sk,                         ss_sold_time_sk as time_sk                  from store_sales,date_dim                  where d_date_sk = ss_sold_date_sk                    and d_moy=11                    and d_year=2002                  ) tmp,time_dim  where    sold_item_sk = i_item_sk    and i_manager_id=1    and time_sk = t_time_sk    and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')  group by i_brand, i_brand_id,t_hour,t_minute  order by ext_price desc, i_brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"], "time_dim": ["t_meal_time"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_brand", "i_item_sk", "i_brand_id"], "time_dim": ["t_hour", "t_minute", "t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 72, "query_string": " select top (100) i_item_desc       ,w_warehouse_name       ,d1.d_week_seq       ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo       ,sum(case when p_promo_sk is not null then 1 else 0 end) promo       ,count(*) total_cnt from catalog_sales join inventory on (cs_item_sk = inv_item_sk) join warehouse on (w_warehouse_sk=inv_warehouse_sk) join item on (i_item_sk = cs_item_sk) join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk) join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk) join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk) join date_dim d2 on (inv_date_sk = d2.d_date_sk) join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk) left outer join promotion on (cs_promo_sk=p_promo_sk) left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number) where d1.d_week_seq = d2.d_week_seq   and inv_quantity_on_hand < cs_quantity    and d3.d_date > dateadd(day, 5, d1.d_date)   and hd_buy_potential = '>10000'   and d1.d_year = 2002   and cd_marital_status = 'W' group by i_item_desc,w_warehouse_name,d1.d_week_seq order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq;", "predicates": {"customer_demographics": ["cd_marital_status"], "date_dim": ["d_date", "d_year"], "household_demographics": ["hd_buy_potential"], "inventory": ["inv_warehouse_sk"], "warehouse": ["w_warehouse_sk"]}, "payload": {"catalog_sales": ["cs_quantity", "cs_promo_sk", "cs_item_sk", "cs_ship_date_sk", "cs_bill_cdemo_sk", "cs_sold_date_sk", "cs_bill_hdemo_sk"], "customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "household_demographics": ["hd_demo_sk"], "item": ["i_item_sk", "i_item_desc"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {"date_dim": ["d_week_seq"], "item": ["i_item_desc"], "warehouse": ["w_warehouse_name"]}}
{"id": 73, "query_string": " select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '501-1000' or          household_demographics.hd_buy_potential = '0-500')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;", "predicates": {"date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count", "hd_buy_potential"], "store": ["s_county"]}, "payload": {"customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_preferred_cust_flag"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 74, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,d_year as year        ,min(ss_net_paid) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk    and d_year in (2000,2000+1)  group by c_customer_id          ,c_first_name          ,c_last_name          ,d_year  union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,d_year as year        ,min(ws_net_paid) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk    and d_year in (2000,2000+1)  group by c_customer_id          ,c_first_name          ,c_last_name          ,d_year          )   select top (100)         t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id          and t_s_firstyear.customer_id = t_w_secyear.customer_id          and t_s_firstyear.customer_id = t_w_firstyear.customer_id          and t_s_firstyear.sale_type = 's'          and t_w_firstyear.sale_type = 'w'          and t_s_secyear.sale_type = 's'          and t_w_secyear.sale_type = 'w'          and t_s_firstyear.year = 2000          and t_s_secyear.year = 2000+1          and t_w_firstyear.year = 2000          and t_w_secyear.year = 2000+1          and t_s_firstyear.year_total > 0          and t_w_firstyear.year_total > 0          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end  order by 1,2,3;", "predicates": {"date_dim": ["d_year"]}, "payload": {"customer": ["c_customer_id", "c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_net_paid"], "web_sales": ["ws_net_paid", "ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_customer_id", "c_last_name", "c_first_name"]}}
{"id": 75, "query_string": " WITH all_sales AS (  SELECT d_year        ,i_brand_id        ,i_class_id        ,i_category_id        ,i_manufact_id        ,SUM(sales_cnt) AS sales_cnt        ,SUM(sales_amt) AS sales_amt  FROM (SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt              ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt        FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk                           JOIN date_dim ON d_date_sk=cs_sold_date_sk                           LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number                                                      AND cs_item_sk=cr_item_sk)        WHERE i_category='Music'        UNION        SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt              ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt        FROM store_sales JOIN item ON i_item_sk=ss_item_sk                         JOIN date_dim ON d_date_sk=ss_sold_date_sk                         LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number                                                  AND ss_item_sk=sr_item_sk)        WHERE i_category='Music'        UNION        SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt              ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt        FROM web_sales JOIN item ON i_item_sk=ws_item_sk                       JOIN date_dim ON d_date_sk=ws_sold_date_sk                       LEFT JOIN web_returns ON (ws_order_number=wr_order_number                                              AND ws_item_sk=wr_item_sk)        WHERE i_category='Music') sales_detail  GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)  SELECT top (100) prev_yr.d_year AS prev_year                           ,curr_yr.d_year AS year                           ,curr_yr.i_brand_id                           ,curr_yr.i_class_id                           ,curr_yr.i_category_id                           ,curr_yr.i_manufact_id                           ,prev_yr.sales_cnt AS prev_yr_cnt                           ,curr_yr.sales_cnt AS curr_yr_cnt                           ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff                           ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff  FROM all_sales curr_yr, all_sales prev_yr  WHERE curr_yr.i_brand_id=prev_yr.i_brand_id    AND curr_yr.i_class_id=prev_yr.i_class_id    AND curr_yr.i_category_id=prev_yr.i_category_id    AND curr_yr.i_manufact_id=prev_yr.i_manufact_id    AND curr_yr.d_year=1999    AND prev_yr.d_year=1999-1    AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9  ORDER BY sales_cnt_diff,sales_amt_diff  ;", "predicates": {"date_dim": ["d_year"], "item": ["i_category"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_quantity", "cr_return_amount"], "date_dim": ["d_date_sk", "d_year"], "item": ["i_class_id", "i_item_sk", "i_category_id", "i_brand_id", "i_manufact_id"], "store_returns": ["sr_return_amt", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_return_amt", "wr_return_quantity", "wr_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 76, "query_string": " select top (100) channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (         SELECT 'store' as channel, 'ss_store_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price          FROM store_sales, item, date_dim          WHERE ss_store_sk IS NULL            AND ss_sold_date_sk=d_date_sk            AND ss_item_sk=i_item_sk         UNION ALL         SELECT 'web' as channel, 'ws_bill_addr_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price          FROM web_sales, item, date_dim          WHERE ws_bill_addr_sk IS NULL            AND ws_sold_date_sk=d_date_sk            AND ws_item_sk=i_item_sk         UNION ALL         SELECT 'catalog' as channel, 'cs_promo_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price          FROM catalog_sales, item, date_dim          WHERE cs_promo_sk IS NULL            AND cs_sold_date_sk=d_date_sk            AND cs_item_sk=i_item_sk) foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category;", "predicates": {"catalog_sales": ["cs_ship_addr_sk"], "store_sales": ["ss_promo_sk"], "web_sales": ["ws_promo_sk"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_item_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_qoy", "d_year"], "item": ["i_item_sk", "i_category"], "store_sales": ["ss_sold_date_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 77, "query_string": " with ss as  (select s_store_sk,          sum(ss_ext_sales_price) as sales,          sum(ss_net_profit) as profit  from store_sales,       date_dim,       store  where ss_sold_date_sk = d_date_sk        and d_date between cast('2001-08-05' as date)                    and dateadd(day, 30, cast('2001-08-05' as date))         and ss_store_sk = s_store_sk  group by s_store_sk)  ,  sr as  (select s_store_sk,          sum(sr_return_amt) as returns,          sum(sr_net_loss) as profit_loss  from store_returns,       date_dim,       store  where sr_returned_date_sk = d_date_sk        and d_date between cast('2001-08-05' as date)                   and dateadd(day, 30, cast('2001-08-05' as date))        and sr_store_sk = s_store_sk  group by s_store_sk),   cs as  (select cs_call_center_sk,         sum(cs_ext_sales_price) as sales,         sum(cs_net_profit) as profit  from catalog_sales,       date_dim  where cs_sold_date_sk = d_date_sk        and d_date between cast('2001-08-05' as date)                   and dateadd(day, 30, cast('2001-08-05' as date))  group by cs_call_center_sk   ),   cr as  (select cr_call_center_sk,          sum(cr_return_amount) as returns,          sum(cr_net_loss) as profit_loss  from catalog_returns,       date_dim  where cr_returned_date_sk = d_date_sk        and d_date between cast('2001-08-05' as date)                   and dateadd(day, 30, cast('2001-08-05' as date))  group by cr_call_center_sk  ),   ws as  ( select wp_web_page_sk,         sum(ws_ext_sales_price) as sales,         sum(ws_net_profit) as profit  from web_sales,       date_dim,       web_page  where ws_sold_date_sk = d_date_sk        and d_date between cast('2001-08-05' as date)                   and dateadd(day, 30, cast('2001-08-05' as date))        and ws_web_page_sk = wp_web_page_sk  group by wp_web_page_sk),   wr as  (select wp_web_page_sk,         sum(wr_return_amt) as returns,         sum(wr_net_loss) as profit_loss  from web_returns,       date_dim,       web_page  where wr_returned_date_sk = d_date_sk        and d_date between cast('2001-08-05' as date)                   and dateadd(day, 30, cast('2001-08-05' as date))        and wr_web_page_sk = wp_web_page_sk  group by wp_web_page_sk)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , ss.s_store_sk as id         , sales         , coalesce(returns, 0) as returns         , (profit - coalesce(profit_loss,0)) as profit  from   ss left join sr         on  ss.s_store_sk = sr.s_store_sk  union all  select 'catalog channel' as channel         , cs_call_center_sk as id         , sales         , returns         , (profit - profit_loss) as profit  from  cs        , cr  union all  select 'web channel' as channel         , ws.wp_web_page_sk as id         , sales         , coalesce(returns, 0) returns         , (profit - coalesce(profit_loss,0)) as profit  from   ws left join wr         on  ws.wp_web_page_sk = wr.wp_web_page_sk  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_return_amount", "cr_call_center_sk"], "catalog_sales": ["cs_net_profit", "cs_sold_date_sk", "cs_call_center_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_net_loss"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit", "ss_ext_sales_price"], "web_page": ["wp_web_page_sk"], "web_returns": ["wr_web_page_sk", "wr_returned_date_sk", "wr_return_amt", "wr_net_loss"], "web_sales": ["ws_net_profit", "ws_ext_sales_price", "ws_web_page_sk", "ws_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 78, "query_string": " with ws as   (select d_year AS ws_sold_year, ws_item_sk,     ws_bill_customer_sk ws_customer_sk,     sum(ws_quantity) ws_qty,     sum(ws_wholesale_cost) ws_wc,     sum(ws_sales_price) ws_sp    from web_sales    left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk    join date_dim on ws_sold_date_sk = d_date_sk    where wr_order_number is null    group by d_year, ws_item_sk, ws_bill_customer_sk    ), cs as   (select d_year AS cs_sold_year, cs_item_sk,     cs_bill_customer_sk cs_customer_sk,     sum(cs_quantity) cs_qty,     sum(cs_wholesale_cost) cs_wc,     sum(cs_sales_price) cs_sp    from catalog_sales    left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk    join date_dim on cs_sold_date_sk = d_date_sk    where cr_order_number is null    group by d_year, cs_item_sk, cs_bill_customer_sk    ), ss as   (select d_year AS ss_sold_year, ss_item_sk,     ss_customer_sk,     sum(ss_quantity) ss_qty,     sum(ss_wholesale_cost) ss_wc,     sum(ss_sales_price) ss_sp    from store_sales    left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk    join date_dim on ss_sold_date_sk = d_date_sk    where sr_ticket_number is null    group by d_year, ss_item_sk, ss_customer_sk    )  select top (100) ss_sold_year, round(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk) where (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2002 order by    ss_sold_year,   ss_qty desc, ss_wc desc, ss_sp desc,   other_chan_qty,   other_chan_wholesale_cost,   other_chan_sales_price,   ratio;", "predicates": {"catalog_returns": ["cr_order_number"], "catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_year"], "store_returns": ["sr_ticket_number"], "store_sales": ["ss_customer_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_bill_customer_sk"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "store_returns": ["sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_item_sk", "ss_sales_price", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_wholesale_cost", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 79, "query_string": " select top (100)   c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,store.s_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (household_demographics.hd_dep_count = 9 or household_demographics.hd_vehicle_count > 1)     and date_dim.d_dow = 1     and date_dim.d_year in (1999,1999+1,1999+2)      and store.s_number_employees between 200 and 295     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer     where ss_customer_sk = c_customer_sk  order by c_last_name,c_first_name,substring(s_city,1,30), profit;", "predicates": {"date_dim": ["d_dow", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_number_employees"]}, "payload": {"customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_city", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_addr_sk", "ss_customer_sk", "ss_ticket_number", "ss_coupon_amt", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {"customer": ["c_last_name", "c_first_name"]}}
{"id": 80, "query_string": " with ssr as  (select  s_store_id as store_id,           sum(ss_ext_sales_price) as sales,           sum(coalesce(sr_return_amt, 0)) as returns,           sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit   from store_sales left outer join store_returns on          (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),      date_dim,      store,      item,      promotion  where ss_sold_date_sk = d_date_sk        and d_date between cast('2001-08-05' as date)                    and dateadd(day, 30, cast('2001-08-05' as date))        and ss_store_sk = s_store_sk        and ss_item_sk = i_item_sk        and i_current_price > 50        and ss_promo_sk = p_promo_sk        and p_channel_tv = 'N'  group by s_store_id)  ,  csr as  (select  cp_catalog_page_id as catalog_page_id,           sum(cs_ext_sales_price) as sales,           sum(coalesce(cr_return_amount, 0)) as returns,           sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit   from catalog_sales left outer join catalog_returns on          (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),      date_dim,      catalog_page,      item,      promotion  where cs_sold_date_sk = d_date_sk        and d_date between cast('2001-08-05' as date)                   and dateadd(day, 30, cast('2001-08-05' as date))         and cs_catalog_page_sk = cp_catalog_page_sk        and cs_item_sk = i_item_sk        and i_current_price > 50        and cs_promo_sk = p_promo_sk        and p_channel_tv = 'N' group by cp_catalog_page_id)  ,  wsr as  (select  web_site_id,           sum(ws_ext_sales_price) as sales,           sum(coalesce(wr_return_amt, 0)) as returns,           sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit   from web_sales left outer join web_returns on          (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),      date_dim,      web_site,      item,      promotion  where ws_sold_date_sk = d_date_sk        and d_date between cast('2001-08-05' as date)                   and dateadd(day, 30, cast('2001-08-05' as date))         and ws_web_site_sk = web_site_sk        and ws_item_sk = i_item_sk        and i_current_price > 50        and ws_promo_sk = p_promo_sk        and p_channel_tv = 'N' group by web_site_id)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , concat('store' , store_id) as id         , sales         , returns         , profit  from   ssr  union all  select 'catalog channel' as channel         , concat('catalog_page' , catalog_page_id) as id         , sales         , returns         , profit  from  csr  union all  select 'web channel' as channel         , concat('web_site' , web_site_id) as id         , sales         , returns         , profit  from   wsr  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"], "promotion": ["p_channel_tv"]}, "payload": {"catalog_page": ["cp_catalog_page_sk", "cp_catalog_page_id"], "catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_amount", "cr_net_loss"], "date_dim": ["d_date_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"], "store": ["s_store_sk", "s_store_id"], "store_returns": ["sr_return_amt", "sr_net_loss", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_net_loss", "wr_return_amt", "wr_order_number"], "web_site": ["web_site_id", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 81, "query_string": " with customer_total_return as  (select cr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   \tsum(cr_return_amt_inc_tax) as ctr_total_return  from catalog_returns      ,date_dim      ,customer_address  where cr_returned_date_sk = d_date_sk     and d_year =2001    and cr_returning_addr_sk = ca_address_sk   group by cr_returning_customer_sk          ,ca_state )   select top (100) c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  \t\t\t  from customer_total_return ctr2                    \t  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'LA'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  ;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_year"]}, "payload": {"catalog_returns": ["cr_returned_date_sk", "cr_returning_customer_sk", "cr_return_amt_inc_tax", "cr_returning_addr_sk"], "customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_current_addr_sk", "c_customer_id"], "customer_address": ["ca_street_type", "ca_county", "ca_street_name", "ca_zip", "ca_street_number", "ca_city", "ca_state", "ca_gmt_offset", "ca_location_type", "ca_address_sk", "ca_suite_number", "ca_country"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer": ["c_salutation", "c_customer_id", "c_last_name", "c_first_name"], "customer_address": ["ca_street_type", "ca_county", "ca_street_name", "ca_zip", "ca_street_number", "ca_city", "ca_gmt_offset", "ca_location_type", "ca_suite_number", "ca_country"]}}
{"id": 82, "query_string": " select top (100) i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, store_sales  where i_current_price between 27 and 27+30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('1998-02-19' as date) and dateadd(day, 60, cast('1998-02-19' as date))  and i_manufact_id in (398,604,900,231)  and inv_quantity_on_hand between 100 and 500  and ss_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  ;", "predicates": {"date_dim": ["d_date"], "inventory": ["inv_quantity_on_hand"], "item": ["i_current_price", "i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc", "i_current_price"]}, "group_by": {}, "order_by": {}}
{"id": 83, "query_string": " with sr_items as  (select i_item_id item_id,         sum(sr_return_quantity) sr_item_qty  from store_returns,       item,       date_dim  where sr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t  where d_date in ('2002-02-18','2002-09-28','2002-11-23')))  and   sr_returned_date_sk   = d_date_sk  group by i_item_id),  cr_items as  (select i_item_id item_id,         sum(cr_return_quantity) cr_item_qty  from catalog_returns,       item,       date_dim  where cr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t  where d_date in ('2002-02-18','2002-09-28','2002-11-23')))  and   cr_returned_date_sk   = d_date_sk  group by i_item_id),  wr_items as  (select i_item_id item_id,         sum(wr_return_quantity) wr_item_qty  from web_returns,       item,       date_dim  where wr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t\twhere d_date in ('2002-02-18','2002-09-28','2002-11-23')))  and   wr_returned_date_sk   = d_date_sk  group by i_item_id)   select top (100) sr_items.item_id        ,sr_item_qty        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev        ,cr_item_qty        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev        ,wr_item_qty        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average  from sr_items      ,cr_items      ,wr_items  where sr_items.item_id=cr_items.item_id    and sr_items.item_id=wr_items.item_id   order by sr_items.item_id          ,sr_item_qty  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_returned_date_sk", "cr_order_number", "cr_return_quantity"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "item": ["i_item_id", "i_item_sk"], "store_returns": ["sr_returned_date_sk", "sr_return_quantity", "sr_item_sk"], "web_returns": ["wr_item_sk", "wr_returned_date_sk", "wr_return_quantity"]}, "group_by": {}, "order_by": {}}
{"id": 84, "query_string": " select top (100) c_customer_id as customer_id        , concat(coalesce(c_last_name,'') , ', ' , coalesce(c_first_name,'')) as customername  from customer      ,customer_address      ,customer_demographics      ,household_demographics      ,income_band      ,store_returns  where ca_city\t        =  'Harmony'    and c_current_addr_sk = ca_address_sk    and ib_lower_bound   >=  54118    and ib_upper_bound   <=  54118 + 50000    and ib_income_band_sk = hd_income_band_sk    and cd_demo_sk = c_current_cdemo_sk    and hd_demo_sk = c_current_hdemo_sk    and sr_cdemo_sk = cd_demo_sk  order by c_customer_id  ;", "predicates": {"customer": ["c_current_cdemo_sk"], "customer_address": ["ca_city"], "income_band": ["ib_upper_bound", "ib_lower_bound"]}, "payload": {"customer": ["c_last_name", "c_first_name", "c_current_cdemo_sk", "c_current_addr_sk", "c_customer_id", "c_current_hdemo_sk"], "customer_address": ["ca_address_sk"], "household_demographics": ["hd_income_band_sk", "hd_demo_sk"], "income_band": ["ib_income_band_sk"], "store_returns": ["sr_cdemo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 85, "query_string": " select top (100) substring(r_reason_desc,1,20)        ,avg(ws_quantity)        ,avg(wr_refunded_cash)        ,avg(wr_fee)  from web_sales, web_returns, web_page, customer_demographics cd1,       customer_demographics cd2, customer_address, date_dim, reason   where ws_web_page_sk = wp_web_page_sk    and ws_item_sk = wr_item_sk    and ws_order_number = wr_order_number    and ws_sold_date_sk = d_date_sk and d_year = 2001    and cd1.cd_demo_sk = wr_refunded_cdemo_sk     and cd2.cd_demo_sk = wr_returning_cdemo_sk    and ca_address_sk = wr_refunded_addr_sk    and r_reason_sk = wr_reason_sk    and    (     (      cd1.cd_marital_status = 'M'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Secondary'      and       cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 100.00 and 150.00     )    or     (      cd1.cd_marital_status = 'D'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = '2 yr Degree'       and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 50.00 and 100.00     )    or     (      cd1.cd_marital_status = 'U'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = '4 yr Degree'      and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 150.00 and 200.00     )    )    and    (     (      ca_country = 'United States'      and      ca_state in ('LA', 'TX', 'VA')      and ws_net_profit between 100 and 200       )     or     (      ca_country = 'United States'      and      ca_state in ('NY', 'MO', 'RI')      and ws_net_profit between 150 and 300       )     or     (      ca_country = 'United States'      and      ca_state in ('NC', 'OK', 'WI')      and ws_net_profit between 50 and 250       )    ) group by r_reason_desc order by substring(r_reason_desc,1,20)         ,avg(ws_quantity)         ,avg(wr_refunded_cash)         ,avg(wr_fee);", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "web_sales": ["ws_net_profit", "ws_sales_price"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "reason": ["r_reason_desc", "r_reason_sk"], "web_page": ["wp_web_page_sk"], "web_returns": ["wr_returning_cdemo_sk", "wr_refunded_cdemo_sk", "wr_reason_sk", "wr_item_sk", "wr_refunded_cash", "wr_refunded_addr_sk", "wr_fee", "wr_order_number"], "web_sales": ["ws_net_profit", "ws_item_sk", "ws_sales_price", "ws_quantity", "ws_sold_date_sk", "ws_web_page_sk", "ws_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 86, "query_string": " select top (100)       sum(ws_net_paid) as total_sum    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  \tpartition by grouping(i_category)+grouping(i_class),  \tcase when grouping(i_class) = 0 then i_category end   \torder by sum(ws_net_paid) desc) as rank_within_parent  from     web_sales    ,date_dim       d1    ,item  where     d1.d_month_seq between 1197 and 1197+11  and d1.d_date_sk = ws_sold_date_sk  and i_item_sk  = ws_item_sk  group by rollup(i_category,i_class)  order by    lochierarchy desc,    case when (grouping(i_category)+grouping(i_class)) = 0 then i_category end,    rank_within_parent  ;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_class", "i_item_sk", "i_category"], "web_sales": ["ws_net_paid", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 87, "query_string": " select count(*)  from ((select distinct c_last_name, c_first_name, d_date        from store_sales, date_dim, customer        where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_customer_sk = customer.c_customer_sk          and d_month_seq between 1197 and 1197+11)        except       (select distinct c_last_name, c_first_name, d_date        from catalog_sales, date_dim, customer        where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk          and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk          and d_month_seq between 1197 and 1197+11)        except       (select distinct c_last_name, c_first_name, d_date        from web_sales, date_dim, customer        where web_sales.ws_sold_date_sk = date_dim.d_date_sk          and web_sales.ws_bill_customer_sk = customer.c_customer_sk          and d_month_seq between 1197 and 1197+11) ) cool_cust;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 88, "query_string": " select  * from  (select count(*) h8_30_to_9  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk         and ss_hdemo_sk = household_demographics.hd_demo_sk       and ss_store_sk = s_store_sk      and time_dim.t_hour = 8      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))       and store.s_store_name = 'ese') s1,  (select count(*) h9_to_9_30   from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk       and time_dim.t_hour = 9       and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))      and store.s_store_name = 'ese') s2,  (select count(*) h9_30_to_10   from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 9      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))      and store.s_store_name = 'ese') s3,  (select count(*) h10_to_10_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 10       and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))      and store.s_store_name = 'ese') s4,  (select count(*) h10_30_to_11  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 10       and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))      and store.s_store_name = 'ese') s5,  (select count(*) h11_to_11_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk       and time_dim.t_hour = 11      and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))      and store.s_store_name = 'ese') s6,  (select count(*) h11_30_to_12  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 11      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))      and store.s_store_name = 'ese') s7,  (select count(*) h12_to_12_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 12      and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))      and store.s_store_name = 'ese') s8;", "predicates": {"household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_store_name"], "time_dim": ["t_hour", "t_minute"]}, "payload": {"household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_sold_time_sk"], "time_dim": ["t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 89, "query_string": " select top (100) * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (2002) and         ((i_category in ('Home','Shoes','Children') and           i_class in ('curtains/drapes','mens','infants')          )       or (i_category in ('Electronics','Women','Men') and           i_class in ('scanners','maternity','accessories')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name;", "predicates": {"date_dim": ["d_year"], "item": ["i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_brand", "i_class", "i_item_sk", "i_category"], "store": ["s_store_name", "s_store_sk", "s_company_name"]}, "group_by": {}, "order_by": {"store": ["s_store_name"]}}
{"id": 90, "query_string": " select top (100) cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio  from ( select count(*) amc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 10 and 10+1          and household_demographics.hd_dep_count = 9          and web_page.wp_char_count between 5000 and 5200) at,       ( select count(*) pmc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 21 and 21+1          and household_demographics.hd_dep_count = 9          and web_page.wp_char_count between 5000 and 5200) pt  order by am_pm_ratio  ;", "predicates": {"household_demographics": ["hd_dep_count"], "time_dim": ["t_hour"], "web_page": ["wp_char_count"]}, "payload": {"household_demographics": ["hd_demo_sk"], "time_dim": ["t_time_sk"], "web_page": ["wp_web_page_sk"], "web_sales": ["ws_sold_time_sk", "ws_web_page_sk", "ws_ship_hdemo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 91, "query_string": " select           cc_call_center_id Call_Center,         cc_name Call_Center_Name,         cc_manager Manager,         sum(cr_net_loss) Returns_Loss from         call_center,         catalog_returns,         date_dim,         customer,         customer_address,         customer_demographics,         household_demographics where         cr_call_center_sk       = cc_call_center_sk and     cr_returned_date_sk     = d_date_sk and     cr_returning_customer_sk= c_customer_sk and     cd_demo_sk              = c_current_cdemo_sk and     hd_demo_sk              = c_current_hdemo_sk and     ca_address_sk           = c_current_addr_sk and     d_year                  = 2000  and     d_moy                   = 11 and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')         or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree')) and     hd_buy_potential like '1001-5000%' and     ca_gmt_offset           = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc;", "predicates": {"customer_address": ["ca_gmt_offset"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_moy", "d_year"], "household_demographics": ["hd_buy_potential"]}, "payload": {"call_center": ["cc_name", "cc_call_center_id", "cc_manager", "cc_call_center_sk"], "catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_returning_customer_sk", "cr_call_center_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk", "c_current_hdemo_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 92, "query_string": " select top (100)     sum(ws_ext_discount_amt)  as \"Excess Discount Amount\"  from      web_sales     ,item     ,date_dim where i_manufact_id = 580 and i_item_sk = ws_item_sk  and d_date between '2001-02-21' and          dateadd(day, 90, cast('2001-02-21' as date)) and d_date_sk = ws_sold_date_sk  and ws_ext_discount_amt        > (           SELECT              1.3 * avg(ws_ext_discount_amt)           FROM              web_sales             ,date_dim          WHERE                ws_item_sk = i_item_sk            and d_date between '2001-02-21' and                              dateadd(day, 90, cast('2001-02-21' as date))           and d_date_sk = ws_sold_date_sk        )  order by sum(ws_ext_discount_amt);", "predicates": {"date_dim": ["d_date"], "item": ["i_manufact_id"], "web_sales": ["ws_ext_discount_amt"]}, "payload": {"item": ["i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 93, "query_string": " select top (100) ss_customer_sk             ,sum(act_sales) sumsales       from (select ss_item_sk                   ,ss_ticket_number                   ,ss_customer_sk                   ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price                                                             else (ss_quantity*ss_sales_price) end act_sales             from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk                                                                and sr_ticket_number = ss_ticket_number)                 ,reason             where sr_reason_sk = r_reason_sk               and r_reason_desc = 'Parts missing') t       group by ss_customer_sk       order by sumsales, ss_customer_sk;", "predicates": {"reason": ["r_reason_desc"]}, "payload": {"reason": ["r_reason_sk"], "store_returns": ["sr_reason_sk", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"]}, "group_by": {}, "order_by": {"store_sales": ["ss_customer_sk"]}}
{"id": 94, "query_string": " select top (100)     count(distinct ws_order_number) as \"order count\"   ,sum(ws_ext_ship_cost) as \"total shipping cost\"   ,sum(ws_net_profit) as \"total net profit\" from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2002-2-01' and             dateadd(day, 60, cast('2002-2-01' as date)) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'MN' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number);", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_date"], "web_site": ["web_company_name"]}, "payload": {"customer_address": ["ca_address_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_net_profit", "ws_ship_date_sk", "ws_ship_addr_sk", "ws_ext_ship_cost", "ws_warehouse_sk", "ws_order_number", "ws_web_site_sk"], "web_site": ["web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 95, "query_string": " with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select top (100)     count(distinct ws_order_number) as \"order count\"   ,sum(ws_ext_ship_cost) as \"total shipping cost\"   ,sum(ws_net_profit) as \"total net profit\" from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2002-2-01' and             dateadd(day, 60, cast('2002-2-01' as date)) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'MN' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number);", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_date"], "web_site": ["web_company_name"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_net_profit", "ws_ship_date_sk", "ws_item_sk", "ws_ship_addr_sk", "ws_ext_ship_cost", "ws_warehouse_sk", "ws_order_number", "ws_web_site_sk"], "web_site": ["web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 96, "query_string": " select top (100) count(*)  from store_sales     ,household_demographics      ,time_dim, store where ss_sold_time_sk = time_dim.t_time_sk        and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk     and time_dim.t_hour = 16     and time_dim.t_minute >= 30     and household_demographics.hd_dep_count = 8     and store.s_store_name = 'ese' order by count(*);", "predicates": {"household_demographics": ["hd_dep_count"], "store": ["s_store_name"], "time_dim": ["t_hour", "t_minute"]}, "payload": {"household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_sold_time_sk"], "time_dim": ["t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 97, "query_string": " with ssci as ( select ss_customer_sk customer_sk       ,ss_item_sk item_sk from store_sales,date_dim where ss_sold_date_sk = d_date_sk   and d_month_seq between 1197 and 1197 + 11 group by ss_customer_sk         ,ss_item_sk), csci as(  select cs_bill_customer_sk customer_sk       ,cs_item_sk item_sk from catalog_sales,date_dim where cs_sold_date_sk = d_date_sk   and d_month_seq between 1197 and 1197 + 11 group by cs_bill_customer_sk         ,cs_item_sk)  select top (100) sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only       ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only       ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk                                and ssci.item_sk = csci.item_sk);", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk", "cs_item_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 98, "query_string": " select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from\t \tstore_sales     \t,item      \t,date_dim where  \tss_item_sk = i_item_sk    \tand i_category in ('Music', 'Sports', 'Shoes')   \tand ss_sold_date_sk = d_date_sk \tand d_date between cast('2000-01-15' as date)  \t\t\t\tand dateadd(day, 30, cast('2000-01-15' as date)) group by  \ti_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  \ti_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"]}, "group_by": {}, "order_by": {}}
{"id": 99, "query_string": " select top (100)     substring(w_warehouse_name,1,20)   ,sm_type   ,cc_name   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and                   (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and                   (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and                  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    catalog_sales   ,warehouse   ,ship_mode   ,call_center   ,date_dim where     d_month_seq between 1197 and 1197 + 11 and cs_ship_date_sk   = d_date_sk and cs_warehouse_sk   = w_warehouse_sk and cs_ship_mode_sk   = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by    substring(w_warehouse_name,1,20)   ,sm_type   ,cc_name order by substring(w_warehouse_name,1,20)         ,sm_type         ,cc_name;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"call_center": ["cc_name", "cc_call_center_sk"], "catalog_sales": ["cs_warehouse_sk", "cs_call_center_sk", "cs_ship_date_sk", "cs_ship_mode_sk", "cs_sold_date_sk"], "date_dim": ["d_date_sk"], "ship_mode": ["sm_type", "sm_ship_mode_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 1, "query_string": " with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sum(SR_RETURN_AMT) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 group by sr_customer_sk ,sr_store_sk)  select top (100) c_customer_id from customer_total_return ctr1 ,store ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'TN' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id;", "predicates": {"date_dim": ["d_year"], "store": ["s_state"], "store_returns": ["sr_store_sk"]}, "payload": {"customer": ["c_customer_id", "c_customer_sk"], "date_dim": ["d_date_sk"], "store": ["s_store_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_customer_id"]}}
{"id": 2, "query_string": " with wscs as  (select sold_date_sk         ,sales_price   from (select ws_sold_date_sk sold_date_sk               ,ws_ext_sales_price sales_price         from web_sales          union all         select cs_sold_date_sk sold_date_sk               ,cs_ext_sales_price sales_price         from catalog_sales) a),  wswscs as   (select d_week_seq,         sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales  from wscs      ,date_dim  where d_date_sk = sold_date_sk  group by d_week_seq)  select d_week_seq1        ,round(sun_sales1/sun_sales2,2)        ,round(mon_sales1/mon_sales2,2)        ,round(tue_sales1/tue_sales2,2)        ,round(wed_sales1/wed_sales2,2)        ,round(thu_sales1/thu_sales2,2)        ,round(fri_sales1/fri_sales2,2)        ,round(sat_sales1/sat_sales2,2)  from  (select wswscs.d_week_seq d_week_seq1         ,sun_sales sun_sales1         ,mon_sales mon_sales1         ,tue_sales tue_sales1         ,wed_sales wed_sales1         ,thu_sales thu_sales1         ,fri_sales fri_sales1         ,sat_sales sat_sales1   from wswscs,date_dim    where date_dim.d_week_seq = wswscs.d_week_seq and         d_year = 1998) y,  (select wswscs.d_week_seq d_week_seq2         ,sun_sales sun_sales2         ,mon_sales mon_sales2         ,tue_sales tue_sales2         ,wed_sales wed_sales2         ,thu_sales thu_sales2         ,fri_sales fri_sales2         ,sat_sales sat_sales2   from wswscs       ,date_dim    where date_dim.d_week_seq = wswscs.d_week_seq and         d_year = 1998+1) z  where d_week_seq1=d_week_seq2-53  order by d_week_seq1;", "predicates": {"date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_week_seq", "d_day_name"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 3, "query_string": " select top (100) dt.d_year         ,item.i_brand_id brand_id         ,item.i_brand brand        ,sum(ss_sales_price) sum_agg  from  date_dim dt        ,store_sales       ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk    and store_sales.ss_item_sk = item.i_item_sk    and item.i_manufact_id = 553    and dt.d_moy=11  group by dt.d_year       ,item.i_brand       ,item.i_brand_id  order by dt.d_year          ,sum_agg desc          ,brand_id  ;", "predicates": {"date_dim": ["d_moy"], "item": ["i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"date_dim": ["d_year"], "item": ["i_brand_id"]}}
{"id": 4, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year  union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total        ,'c' sale_type  from customer      ,catalog_sales      ,date_dim  where c_customer_sk = cs_bill_customer_sk    and cs_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year          )   select top (100)                    t_s_secyear.customer_id                  ,t_s_secyear.customer_first_name                  ,t_s_secyear.customer_last_name                  ,t_s_secyear.customer_preferred_cust_flag  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_c_firstyear      ,year_total t_c_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id    and t_s_firstyear.customer_id = t_c_secyear.customer_id    and t_s_firstyear.customer_id = t_c_firstyear.customer_id    and t_s_firstyear.customer_id = t_w_firstyear.customer_id    and t_s_firstyear.customer_id = t_w_secyear.customer_id    and t_s_firstyear.sale_type = 's'    and t_c_firstyear.sale_type = 'c'    and t_w_firstyear.sale_type = 'w'    and t_s_secyear.sale_type = 's'    and t_c_secyear.sale_type = 'c'    and t_w_secyear.sale_type = 'w'    and t_s_firstyear.dyear =  2000    and t_s_secyear.dyear = 2000+1    and t_c_firstyear.dyear =  2000    and t_c_secyear.dyear =  2000+1    and t_w_firstyear.dyear = 2000    and t_w_secyear.dyear = 2000+1    and t_s_firstyear.year_total > 0    and t_c_firstyear.year_total > 0    and t_w_firstyear.year_total > 0    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end            > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end  order by t_s_secyear.customer_id          ,t_s_secyear.customer_first_name          ,t_s_secyear.customer_last_name          ,t_s_secyear.customer_preferred_cust_flag;", "predicates": {"date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_ext_list_price", "cs_ext_discount_amt", "cs_bill_customer_sk", "cs_ext_sales_price", "cs_ext_wholesale_cost", "cs_sold_date_sk"], "customer": ["c_login", "c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id"], "date_dim": ["d_date_sk"], "store_sales": ["ss_ext_discount_amt", "ss_ext_sales_price", "ss_ext_wholesale_cost", "ss_customer_sk", "ss_ext_list_price", "ss_sold_date_sk"], "web_sales": ["ws_ext_discount_amt", "ws_ext_wholesale_cost", "ws_ext_list_price", "ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 5, "query_string": " with ssr as  (select s_store_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  ss_store_sk as store_sk,             ss_sold_date_sk  as date_sk,             ss_ext_sales_price as sales_price,             ss_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from store_sales     union all     select sr_store_sk as store_sk,            sr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            sr_return_amt as return_amt,            sr_net_loss as net_loss     from store_returns    ) salesreturns,      date_dim,      store  where date_sk = d_date_sk        and d_date between cast('2000-08-06' as date)                    and dateadd(day, 14, cast('2000-08-06' as date))        and store_sk = s_store_sk  group by s_store_id)  ,  csr as  (select cp_catalog_page_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  cs_catalog_page_sk as page_sk,             cs_sold_date_sk  as date_sk,             cs_ext_sales_price as sales_price,             cs_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from catalog_sales     union all     select cr_catalog_page_sk as page_sk,            cr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            cr_return_amount as return_amt,            cr_net_loss as net_loss     from catalog_returns    ) salesreturns,      date_dim,      catalog_page  where date_sk = d_date_sk        and d_date between cast('2000-08-06' as date)                   and dateadd(day, 14, cast('2000-08-06' as date))        and page_sk = cp_catalog_page_sk  group by cp_catalog_page_id)  ,  wsr as  (select web_site_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  ws_web_site_sk as wsr_web_site_sk,             ws_sold_date_sk  as date_sk,             ws_ext_sales_price as sales_price,             ws_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from web_sales     union all     select ws_web_site_sk as wsr_web_site_sk,            wr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            wr_return_amt as return_amt,            wr_net_loss as net_loss     from web_returns left outer join web_sales on          ( wr_item_sk = ws_item_sk            and wr_order_number = ws_order_number)    ) salesreturns,      date_dim,      web_site  where date_sk = d_date_sk        and d_date between cast('2000-08-06' as date)                   and dateadd(day, 14, cast('2000-08-06' as date))        and wsr_web_site_sk = web_site_sk  group by web_site_id)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , concat('store' , s_store_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from   ssr  union all  select 'catalog channel' as channel         , concat('catalog_page' , cp_catalog_page_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from  csr  union all  select 'web channel' as channel         , concat('web_site' , web_site_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from   wsr  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_page": ["cp_catalog_page_sk", "cp_catalog_page_id"], "catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_return_amount", "cr_catalog_page_sk"], "catalog_sales": ["cs_catalog_page_sk", "cs_net_profit", "cs_sold_date_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_net_loss"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit", "ss_ext_sales_price"], "web_returns": ["wr_returned_date_sk", "wr_return_amt", "wr_net_loss", "wr_item_sk", "wr_order_number"], "web_sales": ["ws_net_profit", "ws_ext_sales_price", "ws_sold_date_sk", "ws_web_site_sk"], "web_site": ["web_site_id", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 6, "query_string": " select top (100) a.ca_state state, count(*) cnt  from customer_address a      ,customer c      ,store_sales s      ,date_dim d      ,item i  where       a.ca_address_sk = c.c_current_addr_sk  \tand c.c_customer_sk = s.ss_customer_sk  \tand s.ss_sold_date_sk = d.d_date_sk  \tand s.ss_item_sk = i.i_item_sk  \tand d.d_month_seq =   \t     (select distinct (d_month_seq)  \t      from date_dim                where d_year = 1999  \t        and d_moy = 7 )  \tand i.i_current_price > 1.2 *               (select avg(j.i_current_price)   \t     from item j   \t     where j.i_category = i.i_category)  group by a.ca_state  having count(*) >= 10  order by cnt, a.ca_state   ;", "predicates": {"date_dim": ["d_month_seq", "d_moy", "d_year"], "item": ["i_category", "i_current_price"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk", "d_month_seq"], "item": ["i_item_sk", "i_category", "i_current_price"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_item_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_state"]}}
{"id": 7, "query_string": " select top (100) i_item_id,          avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4   from store_sales, customer_demographics, date_dim, item, promotion  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_cdemo_sk = cd_demo_sk and        ss_promo_sk = p_promo_sk and        cd_gender = 'M' and         cd_marital_status = 'S' and        cd_education_status = 'Unknown' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 1999   group by i_item_id  order by i_item_id  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "promotion": ["p_channel_event", "p_channel_email"]}, "payload": {"customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"], "promotion": ["p_promo_sk"], "store_sales": ["ss_promo_sk", "ss_item_sk", "ss_cdemo_sk", "ss_list_price", "ss_quantity", "ss_sales_price", "ss_coupon_amt", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 8, "query_string": " select top (100) s_store_name       ,sum(ss_net_profit)  from store_sales      ,date_dim      ,store,      (select ca_zip      from (       SELECT substring(ca_zip,1,5) ca_zip       FROM customer_address       WHERE substring(ca_zip,1,5) IN (                           '64496','87086','33601','52629','24312','76051',                           '88903','88497','68761','83964','73134',                           '11426','33441','38769','66642','72546',                           '17133','12580','64492','47147','79222',                           '66996','26143','41843','34434','17268',                           '43282','38954','13841','25702','17821',                           '15734','77243','83580','53664','11745',                           '99466','27713','82570','99715','41790',                           '38527','62789','63760','87593','63383',                           '87092','98303','31619','71962','94438',                           '91049','77305','52221','38712','49408',                           '80107','80210','61265','87589','80606',                           '95563','53129','89006','87078','61997',                           '27388','81546','98697','62922','32488',                           '11069','54803','51469','27182','19489',                           '79909','44920','25737','89806','54658',                           '40272','46396','72055','60254','78676',                           '47677','39183','94801','62949','46017',                           '48427','91923','96842','10211','33819',                           '16053','25010','78157','79856','11217',                           '66522','55333','10031','76107','31587',                           '69424','44625','77323','10459','44986',                           '52796','71843','25155','93376','87083',                           '71849','98777','65518','22887','72407',                           '78746','66899','10672','14116','97118',                           '10692','41806','95922','27685','32056',                           '54834','23078','30596','41003','64724',                           '92086','21069','57308','83289','59870',                           '50444','31958','89283','62294','94518',                           '75955','28854','54581','92521','91028',                           '21133','47904','38429','67475','59360',                           '37258','72843','63871','34659','46692',                           '19829','28299','35061','89352','74638',                           '73697','43933','92372','90622','54135',                           '50129','22598','95321','75039','63697',                           '48682','84997','26418','73744','45416',                           '47119','55124','83766','60556','13559',                           '83886','92368','80021','55861','55065',                           '78821','34503','10889','10933','38322',                           '36765','32434','68132','41483','92533',                           '20858','84717','19131','84094','83026',                           '49966','25567','70840','77758','53192',                           '94956','32459','79755','40279','49643',                           '46375','66189','12692','29914','49673',                           '94744','31034','12458','99074','93375',                           '15245','76342','59609','30617','96602',                           '69163','54388','36273','79339','30491',                           '59920','32361','79418','85409','67734',                           '83712','98590','25718','78638','90417',                           '21580','73745','16807','34701','26063',                           '18336','38079','12262','10986','98582',                           '13509','90358','37134','10663','27594',                           '25271','29423','32669','23044','52432',                           '29064','14531','23687','76224','58593',                           '89052','57534','88679','34637','76502',                           '89703','59820','69009','47369','80296',                           '21462','66198','45653','42544','77286',                           '69171','37008','57327','28419','93845',                           '54725','46625','77722','45408','89935',                           '51494','69586','15326','23487','48360',                           '54040','42973','32000','74524','66070',                           '39422','22893','74035','71024','34578',                           '37372','98910','34845','87763','25286',                           '16513','46474','48598','34295','66171',                           '12256','99338','97214','48567','17844',                           '81508','91905','90713','25047','94376',                           '61913','11519','28467','25929','42793',                           '89377','65076','85825','86497','99030',                           '35011','53463','70655','91000','46209',                           '34007','31328','78909','46069','89777',                           '20004','79223','89404','74045','19935',                           '16624','29990','24945','28571','11549',                           '14603','56694','56704','77674','20367',                           '76999','97043','28007','39324','58344',                           '38601','13451','72863','44030','88035',                           '25060','15260','95612','45825','16510',                           '81833','65139','43672','43326','47800',                           '31607','30469','62445','76149','85454',                           '70198','61454','94408','17028','34898',                           '75341','45882','52035','33219')      intersect       select ca_zip       from (SELECT substring(ca_zip,1,5) ca_zip,count(*) cnt             FROM customer_address, customer             WHERE ca_address_sk = c_current_addr_sk and                   c_preferred_cust_flag='Y'             group by ca_zip             having count(*) > 10)A1)A2) V1  where ss_store_sk = s_store_sk   and ss_sold_date_sk = d_date_sk   and d_qoy = 1 and d_year = 1999   and (substring(s_zip,1,2) = substring(V1.ca_zip,1,2))  group by s_store_name  order by s_store_name  ;", "predicates": {"customer": ["c_preferred_cust_flag"], "date_dim": ["d_qoy", "d_year"]}, "payload": {"customer": ["c_current_addr_sk"], "customer_address": ["ca_address_sk", "ca_zip"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 9, "query_string": " select case when (select count(*)                    from store_sales                    where ss_quantity between 1 and 20) > 31137             then (select avg(ss_ext_tax)                    from store_sales                    where ss_quantity between 1 and 20)              else (select avg(ss_net_paid)                   from store_sales                   where ss_quantity between 1 and 20) end bucket1 ,        case when (select count(*)                   from store_sales                   where ss_quantity between 21 and 40) > 33969             then (select avg(ss_ext_tax)                   from store_sales                   where ss_quantity between 21 and 40)              else (select avg(ss_net_paid)                   from store_sales                   where ss_quantity between 21 and 40) end bucket2,        case when (select count(*)                   from store_sales                   where ss_quantity between 41 and 60) > 5715             then (select avg(ss_ext_tax)                   from store_sales                   where ss_quantity between 41 and 60)             else (select avg(ss_net_paid)                   from store_sales                   where ss_quantity between 41 and 60) end bucket3,        case when (select count(*)                   from store_sales                   where ss_quantity between 61 and 80) > 12292             then (select avg(ss_ext_tax)                   from store_sales                   where ss_quantity between 61 and 80)             else (select avg(ss_net_paid)                   from store_sales                   where ss_quantity between 61 and 80) end bucket4,        case when (select count(*)                   from store_sales                   where ss_quantity between 81 and 100) > 38059             then (select avg(ss_ext_tax)                   from store_sales                   where ss_quantity between 81 and 100)             else (select avg(ss_net_paid)                   from store_sales                   where ss_quantity between 81 and 100) end bucket5 from reason where r_reason_sk = 1;", "predicates": {"store_sales": ["ss_quantity"]}, "payload": {"store_sales": ["ss_ext_tax", "ss_net_paid_inc_tax"]}, "group_by": {}, "order_by": {}}
{"id": 10, "query_string": " select top (100)    cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3,   cd_dep_count,   count(*) cnt4,   cd_dep_employed_count,   count(*) cnt5,   cd_dep_college_count,   count(*) cnt6  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_county in ('Hancock County','Robertson County','Stanislaus County','Glynn County','Walla Walla County') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2000 and                 d_moy between 4 and 4+3) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2000 and                   d_moy between 4 ANd 4+3) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2000 and                   d_moy between 4 and 4+3))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count;", "predicates": {"customer_address": ["ca_county"], "date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 11, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag           ,c_birth_country          ,c_login          ,c_email_address          ,d_year   union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag           ,c_birth_country          ,c_login          ,c_email_address          ,d_year          )   select top (100)                    t_s_secyear.customer_id                  ,t_s_secyear.customer_first_name                  ,t_s_secyear.customer_last_name                  ,t_s_secyear.customer_preferred_cust_flag  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id          and t_s_firstyear.customer_id = t_w_secyear.customer_id          and t_s_firstyear.customer_id = t_w_firstyear.customer_id          and t_s_firstyear.sale_type = 's'          and t_w_firstyear.sale_type = 'w'          and t_s_secyear.sale_type = 's'          and t_w_secyear.sale_type = 'w'          and t_s_firstyear.dyear = 2000          and t_s_secyear.dyear = 2000+1          and t_w_firstyear.dyear = 2000          and t_w_secyear.dyear = 2000+1          and t_s_firstyear.year_total > 0          and t_w_firstyear.year_total > 0          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end              > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end  order by t_s_secyear.customer_id          ,t_s_secyear.customer_first_name          ,t_s_secyear.customer_last_name          ,t_s_secyear.customer_preferred_cust_flag;", "predicates": {"date_dim": ["d_year"]}, "payload": {"customer": ["c_login", "c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_ext_list_price", "ss_ext_discount_amt"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_discount_amt", "ws_ext_list_price"]}, "group_by": {}, "order_by": {}}
{"id": 12, "query_string": " select top (100) i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from\t \tweb_sales     \t,item      \t,date_dim where  \tws_item_sk = i_item_sk    \tand i_category in ('Men', 'Jewelry', 'Shoes')   \tand ws_sold_date_sk = d_date_sk \tand d_date between cast('1998-03-03' as date)  \t\t\t\tand dateadd(day, 30, cast('1998-03-03' as date)) group by  \ti_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  \ti_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_desc", "i_class", "i_item_id", "i_category"]}}
{"id": 13, "query_string": " select avg(ss_quantity)        ,avg(ss_ext_sales_price)        ,avg(ss_ext_wholesale_cost)        ,sum(ss_ext_wholesale_cost)  from store_sales      ,store      ,customer_demographics      ,household_demographics      ,customer_address      ,date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2001  and((ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'U'   and cd_education_status = '2 yr Degree'   and ss_sales_price between 100.00 and 150.00   and hd_dep_count = 3         )or      (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'W'   and cd_education_status = 'Secondary'   and ss_sales_price between 50.00 and 100.00      and hd_dep_count = 1      ) or       (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'S'   and cd_education_status = 'Unknown'   and ss_sales_price between 150.00 and 200.00    and hd_dep_count = 1        ))  and((ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('OK', 'IN', 'KY')   and ss_net_profit between 100 and 200        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('ID', 'OH', 'TN')   and ss_net_profit between 150 and 300        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('FL', 'PA', 'TX')   and ss_net_profit between 50 and 250        ));", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "household_demographics": ["hd_dep_count"], "store_sales": ["ss_sales_price", "ss_net_profit"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_dep_count", "hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_ext_sales_price", "ss_cdemo_sk", "ss_addr_sk", "ss_quantity", "ss_sales_price", "ss_ext_wholesale_cost", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 14, "query_string": " with  cross_items as  (select i_item_sk ss_item_sk  from item,  (select iss.i_brand_id brand_id      ,iss.i_class_id class_id      ,iss.i_category_id category_id  from store_sales      ,item iss      ,date_dim d1  where ss_item_sk = iss.i_item_sk    and ss_sold_date_sk = d1.d_date_sk    and d1.d_year between 2000 AND 2000 + 2  intersect   select ics.i_brand_id      ,ics.i_class_id      ,ics.i_category_id  from catalog_sales      ,item ics      ,date_dim d2  where cs_item_sk = ics.i_item_sk    and cs_sold_date_sk = d2.d_date_sk    and d2.d_year between 2000 AND 2000 + 2  intersect  select iws.i_brand_id      ,iws.i_class_id      ,iws.i_category_id  from web_sales      ,item iws      ,date_dim d3  where ws_item_sk = iws.i_item_sk    and ws_sold_date_sk = d3.d_date_sk    and d3.d_year between 2000 AND 2000 + 2) a  where i_brand_id = brand_id       and i_class_id = class_id       and i_category_id = category_id ),  avg_sales as  (select avg(quantity*list_price) average_sales   from (select ss_quantity quantity              ,ss_list_price list_price        from store_sales            ,date_dim        where ss_sold_date_sk = d_date_sk          and d_year between 2000 and 2000 + 2        union all         select cs_quantity quantity               ,cs_list_price list_price        from catalog_sales            ,date_dim        where cs_sold_date_sk = d_date_sk          and d_year between 2000 and 2000 + 2         union all        select ws_quantity quantity              ,ws_list_price list_price        from web_sales            ,date_dim        where ws_sold_date_sk = d_date_sk          and d_year between 2000 and 2000 + 2) x)   select top (100) channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)  from(        select 'store' channel, i_brand_id,i_class_id              ,i_category_id,sum(ss_quantity*ss_list_price) sales              , count(*) number_sales        from store_sales            ,item            ,date_dim        where ss_item_sk in (select ss_item_sk from cross_items)          and ss_item_sk = i_item_sk          and ss_sold_date_sk = d_date_sk          and d_year = 2000+2           and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)        union all        select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales        from catalog_sales            ,item            ,date_dim        where cs_item_sk in (select ss_item_sk from cross_items)          and cs_item_sk = i_item_sk          and cs_sold_date_sk = d_date_sk          and d_year = 2000+2           and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)        union all        select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales        from web_sales            ,item            ,date_dim        where ws_item_sk in (select ss_item_sk from cross_items)          and ws_item_sk = i_item_sk          and ws_sold_date_sk = d_date_sk          and d_year = 2000+2          and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)  ) y  group by rollup (channel, i_brand_id,i_class_id,i_category_id)  order by channel,i_brand_id,i_class_id,i_category_id  ; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_list_price", "cs_quantity"], "date_dim": ["d_date_sk"], "item": ["i_category_id", "i_class_id", "i_item_sk", "i_brand_id"], "store_sales": ["ss_sold_date_sk", "ss_list_price", "ss_quantity", "ss_item_sk"], "web_sales": ["ws_list_price", "ws_sold_date_sk", "ws_item_sk", "ws_quantity"]}, "group_by": {}, "order_by": {}}
{"id": 15, "query_string": " select top (100) ca_zip        ,sum(cs_sales_price)  from catalog_sales      ,customer      ,customer_address      ,date_dim  where cs_bill_customer_sk = c_customer_sk  \tand c_current_addr_sk = ca_address_sk   \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',                                    '85392', '85460', '80348', '81792')  \t      or ca_state in ('CA','WA','GA')  \t      or cs_sales_price > 500)  \tand cs_sold_date_sk = d_date_sk  \tand d_qoy = 1 and d_year = 1999  group by ca_zip  order by ca_zip  ;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"catalog_sales": ["cs_sales_price", "cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip", "ca_state"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_zip"]}}
{"id": 16, "query_string": " select top (100)     count(distinct cs_order_number) as \"order count\"   ,sum(cs_ext_ship_cost) as \"total shipping cost\"   ,sum(cs_net_profit) as \"total net profit\" from    catalog_sales cs1   ,date_dim   ,customer_address   ,call_center where     d_date between '2001-5-01' and             dateadd(day, 60, cast('2001-5-01' as date)) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'IN' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County',                   'Williamson County' ) and exists (select *             from catalog_sales cs2             where cs1.cs_order_number = cs2.cs_order_number               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select *                from catalog_returns cr1                where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number);", "predicates": {"call_center": ["cc_county"], "customer_address": ["ca_state"], "date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_order_number"], "catalog_sales": ["cs_order_number", "cs_warehouse_sk", "cs_ext_ship_cost", "cs_ship_addr_sk", "cs_net_profit", "cs_call_center_sk", "cs_ship_date_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 17, "query_string": " select top (100) i_item_id        ,i_item_desc        ,s_state        ,count(ss_quantity) as store_sales_quantitycount        ,avg(ss_quantity) as store_sales_quantityave        ,stdev(ss_quantity) as store_sales_quantitystdev        ,stdev(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov        ,count(sr_return_quantity) as store_returns_quantitycount        ,avg(sr_return_quantity) as store_returns_quantityave        ,stdev(sr_return_quantity) as store_returns_quantitystdev        ,stdev(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov        ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave        ,stdev(cs_quantity) as catalog_sales_quantitystdev        ,stdev(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov  from store_sales      ,store_returns      ,catalog_sales      ,date_dim d1      ,date_dim d2      ,date_dim d3      ,store      ,item  where d1.d_quarter_name = '2001Q1'    and d1.d_date_sk = ss_sold_date_sk    and i_item_sk = ss_item_sk    and s_store_sk = ss_store_sk    and ss_customer_sk = sr_customer_sk    and ss_item_sk = sr_item_sk    and ss_ticket_number = sr_ticket_number    and sr_returned_date_sk = d2.d_date_sk    and d2.d_quarter_name in ('2001Q1','2001Q2','2001Q3')    and sr_customer_sk = cs_bill_customer_sk    and sr_item_sk = cs_item_sk    and cs_sold_date_sk = d3.d_date_sk    and d3.d_quarter_name in ('2001Q1','2001Q2','2001Q3')  group by i_item_id          ,i_item_desc          ,s_state  order by i_item_id          ,i_item_desc          ,s_state;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_quarter_name"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_state", "s_store_sk"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_return_quantity", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 18, "query_string": " select top (100) i_item_id,         ca_country,         ca_state,          ca_county,         avg( cast(cs_quantity as decimal(12,2))) agg1,         avg( cast(cs_list_price as decimal(12,2))) agg2,         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,         avg( cast(cs_sales_price as decimal(12,2))) agg4,         avg( cast(cs_net_profit as decimal(12,2))) agg5,         avg( cast(c_birth_year as decimal(12,2))) agg6,         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7  from catalog_sales, customer_demographics cd1,        customer_demographics cd2, customer, customer_address, date_dim, item  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd1.cd_demo_sk and        cs_bill_customer_sk = c_customer_sk and        cd1.cd_gender = 'F' and         cd1.cd_education_status = 'Advanced Degree' and        c_current_cdemo_sk = cd2.cd_demo_sk and        c_current_addr_sk = ca_address_sk and        c_birth_month in (5,9,7,10,6,2) and        d_year = 2001 and        ca_state in ('MT','MI','TN'                    ,'NC','GA','IA','WV')  group by rollup (i_item_id, ca_country, ca_state, ca_county)  order by ca_country,         ca_state,          ca_county, \ti_item_id  ;", "predicates": {"customer": ["c_birth_month"], "customer_address": ["ca_state"], "customer_demographics": ["cd_education_status", "cd_gender"], "date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_quantity", "cs_sales_price", "cs_bill_customer_sk", "cs_item_sk", "cs_net_profit", "cs_list_price", "cs_coupon_amt", "cs_sold_date_sk", "cs_bill_cdemo_sk"], "customer": ["c_birth_year", "c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_county", "ca_country", "ca_state"], "customer_demographics": ["cd_demo_sk", "cd_dep_count"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_state", "ca_county", "ca_country"], "item": ["i_item_id"]}}
{"id": 19, "query_string": " select top (100) i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,  \tsum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item,customer,customer_address,store  where d_date_sk = ss_sold_date_sk    and ss_item_sk = i_item_sk    and i_manager_id=31    and d_moy=12    and d_year=2001    and ss_customer_sk = c_customer_sk     and c_current_addr_sk = ca_address_sk    and substring(ca_zip,1,5) <> substring(s_zip,1,5)     and ss_store_sk = s_store_sk   group by i_brand       ,i_brand_id       ,i_manufact_id       ,i_manufact  order by ext_price desc          ,i_brand          ,i_brand_id          ,i_manufact_id          ,i_manufact  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip"], "date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_brand_id", "i_manufact_id", "i_brand", "i_manufact"], "store": ["s_zip", "s_store_sk"]}, "group_by": {}, "order_by": {"item": ["i_brand", "i_manufact", "i_brand_id", "i_manufact_id"]}}
{"id": 20, "query_string": " select top (100) i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from\tcatalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Men', 'Jewelry', 'Shoes')    and cs_sold_date_sk = d_date_sk  and d_date between cast('1998-03-03' as date)   \t\t\t\tand dateadd(day, 30, cast('1998-03-03' as date))  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"]}, "group_by": {}, "order_by": {"item": ["i_item_desc", "i_class", "i_item_id", "i_category"]}}
{"id": 21, "query_string": " select top (100) *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-03' as date)) \t                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between dateadd(day, -30, cast ('2000-02-03' as date))                     and dateadd(day, 30, cast ('2000-02-03' as date))    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  ;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"]}, "payload": {"date_dim": ["d_date_sk", "d_date"], "item": ["i_item_id", "i_item_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 22, "query_string": " select top (100) i_product_name              ,i_brand              ,i_class              ,i_category              ,avg(inv_quantity_on_hand) qoh        from inventory            ,date_dim            ,item        where inv_date_sk=d_date_sk               and inv_item_sk=i_item_sk               and d_month_seq between 1215 and 1215 + 11        group by rollup(i_product_name                        ,i_brand                        ,i_class                        ,i_category) order by qoh, i_product_name, i_brand, i_class, i_category;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_brand", "i_product_name", "i_category", "i_class"]}, "group_by": {}, "order_by": {"item": ["i_product_name", "i_class", "i_brand", "i_category"]}}
{"id": 23, "query_string": " with frequent_ss_items as   (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt   from store_sales       ,date_dim        ,item   where ss_sold_date_sk = d_date_sk     and ss_item_sk = i_item_sk      and d_year in (2000,2000+1,2000+2,2000+3)   group by substring(i_item_desc,1,30),i_item_sk,d_date   having count(*) >4),  max_store_sales as  (select max(csales) tpcds_cmax    from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales         from store_sales             ,customer             ,date_dim          where ss_customer_sk = c_customer_sk          and ss_sold_date_sk = d_date_sk          and d_year in (2000,2000+1,2000+2,2000+3)          group by c_customer_sk) a),  best_ss_customer as  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales   from store_sales       ,customer   where ss_customer_sk = c_customer_sk   group by c_customer_sk   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select   * from  max_store_sales))   select top (100) sum(sales)  from (select cs_quantity*cs_list_price sales        from catalog_sales            ,date_dim         where d_year = 2000           and d_moy = 7           and cs_sold_date_sk = d_date_sk           and cs_item_sk in (select item_sk from frequent_ss_items)          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)       union all       select ws_quantity*ws_list_price sales        from web_sales             ,date_dim         where d_year = 2000           and d_moy = 7           and ws_sold_date_sk = d_date_sk           and ws_item_sk in (select item_sk from frequent_ss_items)          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) b  ; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"customer": ["c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "item": ["i_item_sk", "i_item_desc"], "store_sales": ["ss_item_sk", "ss_sales_price", "ss_customer_sk", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 24, "query_string": " with ssales as (select c_last_name       ,c_first_name       ,s_store_name       ,ca_state       ,s_state       ,i_color       ,i_current_price       ,i_manager_id       ,i_units       ,i_size       ,sum(ss_sales_price) netpaid from store_sales     ,store_returns     ,store     ,item     ,customer     ,customer_address where ss_ticket_number = sr_ticket_number   and ss_item_sk = sr_item_sk   and ss_customer_sk = c_customer_sk   and ss_item_sk = i_item_sk   and ss_store_sk = s_store_sk   and c_current_addr_sk = ca_address_sk   and c_birth_country <> upper(ca_country)   and s_zip = ca_zip and s_market_id=8 group by c_last_name         ,c_first_name         ,s_store_name         ,ca_state         ,s_state         ,i_color         ,i_current_price         ,i_manager_id         ,i_units         ,i_size) select c_last_name       ,c_first_name       ,s_store_name       ,sum(netpaid) paid from ssales where i_color = 'papaya' group by c_last_name         ,c_first_name         ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid)                                  from ssales) order by c_last_name         ,c_first_name         ,s_store_name; ", "predicates": {"item": ["i_color"], "store": ["s_market_id"]}, "payload": {"customer": ["c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_current_addr_sk"], "customer_address": ["ca_address_sk", "ca_country", "ca_zip", "ca_state"], "item": ["i_item_sk", "i_units", "i_manager_id", "i_current_price", "i_size"], "store": ["s_zip", "s_store_name", "s_state", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_net_paid_inc_tax"]}, "group_by": {}, "order_by": {}}
{"id": 25, "query_string": " select top (100)   i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  ,max(ss_net_profit) as store_sales_profit  ,max(sr_net_loss) as store_returns_loss  ,max(cs_net_profit) as catalog_sales_profit  from  store_sales  ,store_returns  ,catalog_sales  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,item  where  d1.d_moy = 4  and d1.d_year = 1999  and d1.d_date_sk = ss_sold_date_sk  and i_item_sk = ss_item_sk  and s_store_sk = ss_store_sk  and ss_customer_sk = sr_customer_sk  and ss_item_sk = sr_item_sk  and ss_ticket_number = sr_ticket_number  and sr_returned_date_sk = d2.d_date_sk  and d2.d_moy               between 4 and  10  and d2.d_year              = 1999  and sr_customer_sk = cs_bill_customer_sk  and sr_item_sk = cs_item_sk  and cs_sold_date_sk = d3.d_date_sk  and d3.d_moy               between 4 and  10   and d3.d_year              = 1999  group by  i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  order by  i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  ;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_store_name", "s_store_sk", "s_store_id"], "store_returns": ["sr_returned_date_sk", "sr_net_loss", "sr_customer_sk", "sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 26, "query_string": " select top (100) i_item_id,          avg(cs_quantity) agg1,         avg(cs_list_price) agg2,         avg(cs_coupon_amt) agg3,         avg(cs_sales_price) agg4   from catalog_sales, customer_demographics, date_dim, item, promotion  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd_demo_sk and        cs_promo_sk = p_promo_sk and        cd_gender = 'M' and         cd_marital_status = 'S' and        cd_education_status = 'Unknown' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 1999   group by i_item_id  order by i_item_id  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "promotion": ["p_channel_event", "p_channel_email"]}, "payload": {"item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 27, "query_string": " select top (100) i_item_id,         s_state, grouping(s_state) g_state,         avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4  from store_sales, customer_demographics, date_dim, store, item  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_store_sk = s_store_sk and        ss_cdemo_sk = cd_demo_sk and        cd_gender = 'M' and        cd_marital_status = 'D' and        cd_education_status = 'Unknown' and        d_year = 2002 and        s_state in ('TN','TN', 'TN', 'TN', 'TN', 'TN')  group by rollup (i_item_id, s_state)  order by i_item_id          ,s_state  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "store": ["s_state"]}, "payload": {"customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"], "store": ["s_state", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_cdemo_sk", "ss_list_price", "ss_quantity", "ss_sales_price", "ss_coupon_amt", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_id"], "store": ["s_state"]}}
{"id": 28, "query_string": " select top (100) * from (select avg(ss_list_price) B1_LP             ,count(ss_list_price) B1_CNT             ,count(distinct ss_list_price) B1_CNTD       from store_sales       where ss_quantity between 0 and 5         and (ss_list_price between 29 and 29+10               or ss_coupon_amt between 7771 and 7771+1000              or ss_wholesale_cost between 39 and 39+20)) B1,      (select avg(ss_list_price) B2_LP             ,count(ss_list_price) B2_CNT             ,count(distinct ss_list_price) B2_CNTD       from store_sales       where ss_quantity between 6 and 10         and (ss_list_price between 142 and 142+10           or ss_coupon_amt between 6053 and 6053+1000           or ss_wholesale_cost between 22 and 22+20)) B2,      (select avg(ss_list_price) B3_LP             ,count(ss_list_price) B3_CNT             ,count(distinct ss_list_price) B3_CNTD       from store_sales       where ss_quantity between 11 and 15         and (ss_list_price between 117 and 117+10           or ss_coupon_amt between 429 and 429+1000           or ss_wholesale_cost between 44 and 44+20)) B3,      (select avg(ss_list_price) B4_LP             ,count(ss_list_price) B4_CNT             ,count(distinct ss_list_price) B4_CNTD       from store_sales       where ss_quantity between 16 and 20         and (ss_list_price between 150 and 150+10           or ss_coupon_amt between 6264 and 6264+1000           or ss_wholesale_cost between 76 and 76+20)) B4,      (select avg(ss_list_price) B5_LP             ,count(ss_list_price) B5_CNT             ,count(distinct ss_list_price) B5_CNTD       from store_sales       where ss_quantity between 21 and 25         and (ss_list_price between 146 and 146+10           or ss_coupon_amt between 14516 and 14516+1000           or ss_wholesale_cost between 74 and 74+20)) B5,      (select avg(ss_list_price) B6_LP             ,count(ss_list_price) B6_CNT             ,count(distinct ss_list_price) B6_CNTD       from store_sales       where ss_quantity between 26 and 30         and (ss_list_price between 66 and 66+10           or ss_coupon_amt between 16037 and 16037+1000           or ss_wholesale_cost between 37 and 37+20)) B6;", "predicates": {"store_sales": ["ss_list_price", "ss_coupon_amt", "ss_quantity", "ss_wholesale_cost"]}, "payload": {"store_sales": ["ss_list_price"]}, "group_by": {}, "order_by": {}}
{"id": 29, "query_string": " select top (100)        i_item_id     ,i_item_desc     ,s_store_id     ,s_store_name     ,max(ss_quantity)        as store_sales_quantity     ,max(sr_return_quantity) as store_returns_quantity     ,max(cs_quantity)        as catalog_sales_quantity  from     store_sales    ,store_returns    ,catalog_sales    ,date_dim             d1    ,date_dim             d2    ,date_dim             d3    ,store    ,item  where      d1.d_moy               = 4   and d1.d_year              = 2000  and d1.d_date_sk           = ss_sold_date_sk  and i_item_sk              = ss_item_sk  and s_store_sk             = ss_store_sk  and ss_customer_sk         = sr_customer_sk  and ss_item_sk             = sr_item_sk  and ss_ticket_number       = sr_ticket_number  and sr_returned_date_sk    = d2.d_date_sk  and d2.d_moy               between 4 and  4 + 3   and d2.d_year              = 2000  and sr_customer_sk         = cs_bill_customer_sk  and sr_item_sk             = cs_item_sk  and cs_sold_date_sk        = d3.d_date_sk       and d3.d_year              in (2000,2000+1,2000+2)  group by     i_item_id    ,i_item_desc    ,s_store_id    ,s_store_name  order by     i_item_id     ,i_item_desc    ,s_store_id    ,s_store_name  ;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_store_name", "s_store_sk", "s_store_id"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_return_quantity", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 30, "query_string": " with customer_total_return as  (select wr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   \tsum(wr_return_amt) as ctr_total_return  from web_returns      ,date_dim      ,customer_address  where wr_returned_date_sk = d_date_sk     and d_year =1999    and wr_returning_addr_sk = ca_address_sk   group by wr_returning_customer_sk          ,ca_state)   select top (100) c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag        ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address        ,c_last_review_date,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  \t\t\t  from customer_total_return ctr2                    \t  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'IN'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag                   ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address                   ,c_last_review_date,ctr_total_return;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_year"]}, "payload": {"customer": ["c_birth_year", "c_login", "c_customer_sk", "c_birth_month", "c_salutation", "c_birth_day", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_current_addr_sk", "c_email_address", "c_customer_id", "c_last_review_date"], "customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "web_returns": ["wr_return_amt", "wr_returning_addr_sk", "wr_returned_date_sk", "wr_returning_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_birth_year", "c_login", "c_birth_month", "c_birth_country", "c_salutation", "c_birth_day", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id", "c_last_review_date"]}}
{"id": 31, "query_string": " with ss as  (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales  from store_sales,date_dim,customer_address  where ss_sold_date_sk = d_date_sk   and ss_addr_sk=ca_address_sk  group by ca_county,d_qoy, d_year),  ws as  (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales  from web_sales,date_dim,customer_address  where ws_sold_date_sk = d_date_sk   and ws_bill_addr_sk=ca_address_sk  group by ca_county,d_qoy, d_year)  select          ss1.ca_county        ,ss1.d_year        ,ws2.web_sales/ws1.web_sales web_q1_q2_increase        ,ss2.store_sales/ss1.store_sales store_q1_q2_increase        ,ws3.web_sales/ws2.web_sales web_q2_q3_increase        ,ss3.store_sales/ss2.store_sales store_q2_q3_increase  from         ss ss1        ,ss ss2        ,ss ss3        ,ws ws1        ,ws ws2        ,ws ws3  where     ss1.d_qoy = 1     and ss1.d_year = 1999     and ss1.ca_county = ss2.ca_county     and ss2.d_qoy = 2     and ss2.d_year = 1999  and ss2.ca_county = ss3.ca_county     and ss3.d_qoy = 3     and ss3.d_year = 1999     and ss1.ca_county = ws1.ca_county     and ws1.d_qoy = 1     and ws1.d_year = 1999     and ws1.ca_county = ws2.ca_county     and ws2.d_qoy = 2     and ws2.d_year = 1999     and ws1.ca_county = ws3.ca_county     and ws3.d_qoy = 3     and ws3.d_year =1999     and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end         > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end     and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end        > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end  order by ss1.ca_county;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"customer_address": ["ca_address_sk", "ca_county"], "date_dim": ["d_date_sk", "d_year"], "store_sales": ["ss_sold_date_sk", "ss_addr_sk", "ss_ext_sales_price"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_bill_addr_sk"]}, "group_by": {}, "order_by": {}}
{"id": 32, "query_string": " select top (100) sum(cs_ext_discount_amt)  as \"excess discount amount\"  from     catalog_sales     ,item     ,date_dim where i_manufact_id = 830 and i_item_sk = cs_item_sk  and d_date between '2000-03-20' and          dateadd(day, 90, cast('2000-03-20' as date)) and d_date_sk = cs_sold_date_sk  and cs_ext_discount_amt        > (           select              1.3 * avg(cs_ext_discount_amt)           from              catalog_sales             ,date_dim          where                cs_item_sk = i_item_sk            and d_date between '2000-03-20' and                              dateadd(day, 90, cast('2000-03-20' as date))           and d_date_sk = cs_sold_date_sk        ) ;", "predicates": {"catalog_sales": ["cs_ext_discount_amt"], "date_dim": ["d_date"], "item": ["i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 33, "query_string": " with ss as (  select           i_manufact_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id in (select   i_manufact_id from  item where i_category in ('Home'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 1  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  cs as (  select           i_manufact_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Home'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 1  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  ws as (  select           i_manufact_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Home'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 1  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_manufact_id)   select top (100) i_manufact_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_manufact_id  order by total_sales;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_category"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_addr_sk", "cs_item_sk", "cs_ext_sales_price"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_manufact_id"], "store_sales": ["ss_sold_date_sk", "ss_addr_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk", "ws_bill_addr_sk"]}, "group_by": {}, "order_by": {}}
{"id": 34, "query_string": " select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '501-1000' or          household_demographics.hd_buy_potential = '5001-10000')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  \tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  \telse null  \tend)  > 1.2     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',                            'Williamson County','Williamson County','Williamson County','Williamson County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;", "predicates": {"date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count", "hd_buy_potential"], "store": ["s_county"]}, "payload": {"customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_preferred_cust_flag"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 35, "query_string": " select top (100)     ca_state,   cd_gender,   cd_marital_status,   cd_dep_count,   count(*) cnt1,   min(cd_dep_count),   stdev(cd_dep_count),   min(cd_dep_count),   cd_dep_employed_count,   count(*) cnt2,   min(cd_dep_employed_count),   stdev(cd_dep_employed_count),   min(cd_dep_employed_count),   cd_dep_college_count,   count(*) cnt3,   min(cd_dep_college_count),   stdev(cd_dep_college_count),   min(cd_dep_college_count)  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2001 and                 d_qoy < 4) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_qoy < 4) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_qoy < 4))  group by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  ;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_state"], "customer_demographics": ["cd_dep_college_count", "cd_gender", "cd_demo_sk", "cd_dep_employed_count", "cd_dep_count", "cd_marital_status"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 36, "query_string": " select top (100)      sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  \tpartition by grouping(i_category)+grouping(i_class),  \tcase when grouping(i_class) = 0 then i_category end   \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent  from     store_sales    ,date_dim       d1    ,item    ,store  where     d1.d_year = 1999   and d1.d_date_sk = ss_sold_date_sk  and i_item_sk  = ss_item_sk   and s_store_sk  = ss_store_sk  and s_state in ('TN','TN','TN','TN',                  'TN','TN','TN','TN')  group by rollup(i_category,i_class)  order by    lochierarchy desc   ,case when (grouping(i_category)+grouping(i_class)) = 0 then i_category end   ,rank_within_parent   ;", "predicates": {"date_dim": ["d_year"], "store": ["s_state"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_class", "i_item_sk", "i_category"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_ext_sales_price", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 37, "query_string": " select top (100) i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 63 and 63 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2002-04-07' as date) and dateadd(day, 60, cast('2002-04-07' as date))  and i_manufact_id in (694,684,682,874)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  ;", "predicates": {"date_dim": ["d_date"], "inventory": ["inv_quantity_on_hand"], "item": ["i_current_price", "i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc", "i_current_price"]}, "group_by": {}, "order_by": {}}
{"id": 38, "query_string": " select top (100) count(*) from (     select distinct c_last_name, c_first_name, d_date     from store_sales, date_dim, customer           where store_sales.ss_sold_date_sk = date_dim.d_date_sk       and store_sales.ss_customer_sk = customer.c_customer_sk       and d_month_seq between 1215 and 1215 + 11   intersect     select distinct c_last_name, c_first_name, d_date     from catalog_sales, date_dim, customer           where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk       and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk       and d_month_seq between 1215 and 1215 + 11   intersect     select distinct c_last_name, c_first_name, d_date     from web_sales, date_dim, customer           where web_sales.ws_sold_date_sk = date_dim.d_date_sk       and web_sales.ws_bill_customer_sk = customer.c_customer_sk       and d_month_seq between 1215 and 1215 + 11 ) hot_cust;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk", "ws_item_sk", "ws_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 39, "query_string": " with inv as (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy        ,stdev,mean, case mean when 0 then null else stdev/mean end cov  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy             ,stdev(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean       from inventory           ,item           ,warehouse           ,date_dim       where inv_item_sk = i_item_sk         and inv_warehouse_sk = w_warehouse_sk         and inv_date_sk = d_date_sk         and d_year =2000       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo  where case mean when 0 then 0 else stdev/mean end > 1) select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov from inv inv1,inv inv2 where inv1.i_item_sk = inv2.i_item_sk   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk   and inv1.d_moy=3   and inv2.d_moy=3+1 order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov         ,inv2.d_moy,inv2.mean, inv2.cov; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_item_sk"], "warehouse": ["w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 40, "query_string": " select top (100)     w_state   ,i_item_id   ,sum(case when (cast(d_date as date) < cast ('2000-02-03' as date))   \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before   ,sum(case when (cast(d_date as date) >= cast ('2000-02-03' as date))   \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after  from    catalog_sales left outer join catalog_returns on        (cs_order_number = cr_order_number          and cs_item_sk = cr_item_sk)   ,warehouse    ,item   ,date_dim  where      i_current_price between 0.99 and 1.49  and i_item_sk          = cs_item_sk  and cs_warehouse_sk    = w_warehouse_sk   and cs_sold_date_sk    = d_date_sk  and d_date between dateadd(day, -30, cast ('2000-02-03' as date))                 and dateadd(day, 30, cast ('2000-02-03' as date))   group by     w_state,i_item_id  order by w_state,i_item_id;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_refunded_cash"], "date_dim": ["d_date_sk", "d_date"], "item": ["i_item_id", "i_item_sk"], "warehouse": ["w_state", "w_warehouse_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_id"], "warehouse": ["w_state"]}}
{"id": 41, "query_string": " select distinct top (100) i_product_name  from item i1  where i_manufact_id between 871 and 871+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'green' or i_color = 'red') and          (i_units = 'Tsp' or i_units = 'Box') and         (i_size = 'small' or i_size = 'N/A')         ) or         (i_category = 'Women' and         (i_color = 'cornflower' or i_color = 'honeydew') and         (i_units = 'Ounce' or i_units = 'Pound') and         (i_size = 'medium' or i_size = 'petite')         ) or         (i_category = 'Men' and         (i_color = 'orchid' or i_color = 'brown') and         (i_units = 'Gross' or i_units = 'Bunch') and         (i_size = 'large' or i_size = 'extra large')         ) or         (i_category = 'Men' and         (i_color = 'deep' or i_color = 'dark') and         (i_units = 'N/A' or i_units = 'Pallet') and         (i_size = 'small' or i_size = 'N/A')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'sky' or i_color = 'ivory') and          (i_units = 'Oz' or i_units = 'Case') and         (i_size = 'small' or i_size = 'N/A')         ) or         (i_category = 'Women' and         (i_color = 'tan' or i_color = 'powder') and         (i_units = 'Tbl' or i_units = 'Bundle') and         (i_size = 'medium' or i_size = 'petite')         ) or         (i_category = 'Men' and         (i_color = 'turquoise' or i_color = 'salmon') and         (i_units = 'Gram' or i_units = 'Dozen') and         (i_size = 'large' or i_size = 'extra large')         ) or         (i_category = 'Men' and         (i_color = 'steel' or i_color = 'plum') and         (i_units = 'Dram' or i_units = 'Lb') and         (i_size = 'small' or i_size = 'N/A')         )))) > 0  order by i_product_name  ;", "predicates": {"item": ["i_color", "i_units", "i_manufact_id", "i_category", "i_size", "i_manufact"]}, "payload": {"item": ["i_color", "i_units", "i_product_name", "i_category", "i_size", "i_manufact"]}, "group_by": {}, "order_by": {}}
{"id": 42, "query_string": " select top (100) dt.d_year  \t,item.i_category_id  \t,item.i_category  \t,sum(ss_ext_sales_price)  from \tdate_dim dt  \t,store_sales  \t,item  where dt.d_date_sk = store_sales.ss_sold_date_sk  \tand store_sales.ss_item_sk = item.i_item_sk  \tand item.i_manager_id = 1  \t  \tand dt.d_moy=11  \tand dt.d_year=2000  group by \tdt.d_year  \t\t,item.i_category_id  \t\t,item.i_category  order by       sum(ss_ext_sales_price) desc,dt.d_year  \t\t,item.i_category_id  \t\t,item.i_category  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_item_sk", "i_category", "i_category_id"]}, "group_by": {}, "order_by": {"item": ["i_category", "i_category_id"]}}
{"id": 43, "query_string": " select top (100) s_store_name, s_store_id,         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales  from date_dim, store_sales, store  where d_date_sk = ss_sold_date_sk and        s_store_sk = ss_store_sk and        s_gmt_offset = -5 and        d_year = 2000   group by s_store_name, s_store_id  order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales  ;", "predicates": {"date_dim": ["d_year"], "store": ["s_gmt_offset"]}, "payload": {"date_dim": ["d_date_sk", "d_day_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 44, "query_string": " select top (100) asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing from(select *      from (select item_sk,rank() over (order by rank_col asc) rnk            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col                   from store_sales ss1                  where ss_store_sk = 1                  group by ss_item_sk                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col                                                   from store_sales                                                   where ss_store_sk = 1                                                     and ss_cdemo_sk is null                                                   group by ss_store_sk))V1)V11      where rnk  < 11) asceding,     (select *      from (select item_sk,rank() over (order by rank_col desc) rnk            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col                  from store_sales ss1                  where ss_store_sk = 1                  group by ss_item_sk                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col                                                   from store_sales                                                   where ss_store_sk = 1                                                     and ss_cdemo_sk is null                                                   group by ss_store_sk))V2)V21      where rnk  < 11) descending, item i1, item i2 where asceding.rnk = descending.rnk    and i1.i_item_sk=asceding.item_sk   and i2.i_item_sk=descending.item_sk order by asceding.rnk;", "predicates": {"store_sales": ["ss_store_sk", "ss_customer_sk"]}, "payload": {"store_sales": ["ss_net_profit", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 45, "query_string": " select top (100) ca_zip, ca_state, sum(ws_sales_price)  from web_sales, customer, customer_address, date_dim, item  where ws_bill_customer_sk = c_customer_sk  \tand c_current_addr_sk = ca_address_sk   \tand ws_item_sk = i_item_sk   \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')  \t      or   \t      i_item_id in (select i_item_id                              from item                              where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)                              )  \t    )  \tand ws_sold_date_sk = d_date_sk  \tand d_qoy = 1 and d_year = 2002  group by ca_zip, ca_state  order by ca_zip, ca_state  ;", "predicates": {"customer_address": ["ca_zip"], "date_dim": ["d_qoy", "d_year"], "item": ["i_item_id"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip", "ca_city"], "date_dim": ["d_date_sk"], "web_sales": ["ws_sales_price", "ws_sold_date_sk", "ws_bill_customer_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 46, "query_string": " select top (100) c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,ca_city bought_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics,customer_address      where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and (household_demographics.hd_dep_count = 0 or          household_demographics.hd_vehicle_count= 1)     and date_dim.d_dow in (6,0)     and date_dim.d_year in (1998,1998+1,1998+2)      and store.s_city in ('Midway','Fairview','Midway','Fairview','Fairview')      group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr     where ss_customer_sk = c_customer_sk       and customer.c_current_addr_sk = current_addr.ca_address_sk       and current_addr.ca_city <> bought_city   order by c_last_name           ,c_first_name           ,ca_city           ,bought_city           ,ss_ticket_number   ;", "predicates": {"date_dim": ["d_dow", "d_year"], "household_demographics": ["hd_vehicle_count", "hd_dep_count"], "store": ["s_city"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk", "c_first_name", "c_last_name"], "customer_address": ["ca_city", "ca_address_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_addr_sk", "ss_coupon_amt", "ss_customer_sk", "ss_hdemo_sk", "ss_net_profit", "ss_sold_date_sk", "ss_store_sk", "ss_ticket_number"]}, "group_by": {}, "order_by": {}}
{"id": 47, "query_string": " with v1 as(  select i_category, i_brand,         s_store_name, s_company_name,         d_year, d_moy,         sum(ss_sales_price) sum_sales,         avg(sum(ss_sales_price)) over           (partition by i_category, i_brand,                      s_store_name, s_company_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      s_store_name, s_company_name            order by d_year, d_moy) rn  from item, store_sales, date_dim, store  where ss_item_sk = i_item_sk and        ss_sold_date_sk = d_date_sk and        ss_store_sk = s_store_sk and        (          d_year = 2001 or          ( d_year = 2001-1 and d_moy =12) or          ( d_year = 2001+1 and d_moy =1)        )  group by i_category, i_brand,           s_store_name, s_company_name,           d_year, d_moy),  v2 as(  select v1.i_category         ,v1.d_year, v1.d_moy         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1.s_store_name = v1_lag.s_store_name and        v1.s_store_name = v1_lead.s_store_name and        v1.s_company_name = v1_lag.s_company_name and        v1.s_company_name = v1_lead.s_company_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select top (100) *  from v2  where  d_year = 2001 and             avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, sum_sales  ;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk", "d_moy", "d_year"], "item": ["i_brand", "i_item_sk", "i_category"], "store": ["s_store_name", "s_store_sk", "s_company_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 48, "query_string": " select sum (ss_quantity)  from store_sales, store, customer_demographics, customer_address, date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 1999  and    (   (    cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'M'    and     cd_education_status = '2 yr Degree'    and     ss_sales_price between 100.00 and 150.00      )  or   (   cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'U'    and     cd_education_status = 'College'    and     ss_sales_price between 50.00 and 100.00      )  or   (   cd_demo_sk = ss_cdemo_sk   and     cd_marital_status = 'D'    and     cd_education_status = '4 yr Degree'    and     ss_sales_price between 150.00 and 200.00    )  )  and  (   (   ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('TX', 'NC', 'MS')   and ss_net_profit between 0 and 2000     )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('NE', 'SD', 'HI')   and ss_net_profit between 150 and 3000    )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('UT', 'GA', 'PA')   and ss_net_profit between 50 and 25000    )  );", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "store_sales": ["ss_sales_price", "ss_net_profit"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_cdemo_sk", "ss_addr_sk", "ss_quantity", "ss_sales_price", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 49, "query_string": " select top (100) channel, item, return_ratio, return_rank, currency_rank from  (select  'web' as channel  ,web.item  ,web.return_ratio  ,web.return_rank  ,web.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect ws.ws_item_sk as item  \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\t web_sales ws left outer join web_returns wr   \t\t\ton (ws.ws_order_number = wr.wr_order_number and   \t\t\tws.ws_item_sk = wr.wr_item_sk)                  ,date_dim  \t\twhere   \t\t\twr.wr_return_amt > 10000   \t\t\tand ws.ws_net_profit > 1                          and ws.ws_net_paid > 0                          and ws.ws_quantity > 0                          and ws_sold_date_sk = d_date_sk                          and d_year = 1999                          and d_moy = 11  \t\tgroup by ws.ws_item_sk  \t) in_web  ) web  where   (  web.return_rank <= 10  or  web.currency_rank <= 10  )  union  select   'catalog' as channel  ,catalog.item  ,catalog.return_ratio  ,catalog.return_rank  ,catalog.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect   \t\tcs.cs_item_sk as item  \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\tcatalog_sales cs left outer join catalog_returns cr  \t\t\ton (cs.cs_order_number = cr.cr_order_number and   \t\t\tcs.cs_item_sk = cr.cr_item_sk)                 ,date_dim  \t\twhere   \t\t\tcr.cr_return_amount > 10000   \t\t\tand cs.cs_net_profit > 1                          and cs.cs_net_paid > 0                          and cs.cs_quantity > 0                          and cs_sold_date_sk = d_date_sk                          and d_year = 1999                          and d_moy = 11                  group by cs.cs_item_sk  \t) in_cat  ) catalog  where   (  catalog.return_rank <= 10  or  catalog.currency_rank <=10  )  union  select   'store' as channel  ,store.item  ,store.return_ratio  ,store.return_rank  ,store.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect sts.ss_item_sk as item  \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\tstore_sales sts left outer join store_returns sr  \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)                 ,date_dim  \t\twhere   \t\t\tsr.sr_return_amt > 10000   \t\t\tand sts.ss_net_profit > 1                          and sts.ss_net_paid > 0                           and sts.ss_quantity > 0                          and ss_sold_date_sk = d_date_sk                          and d_year = 1999                          and d_moy = 11  \t\tgroup by sts.ss_item_sk  \t) in_store  ) store  where  (  store.return_rank <= 10  or   store.currency_rank <= 10  )  ) a  order by 1,4,5,2  ;", "predicates": {"catalog_returns": ["cr_return_amount"], "catalog_sales": ["cs_net_paid", "cs_net_profit", "cs_quantity"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_return_amt"], "store_sales": ["ss_net_paid", "ss_quantity", "ss_net_profit"], "web_returns": ["wr_return_amt"], "web_sales": ["ws_net_profit", "ws_net_paid", "ws_quantity"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_quantity", "cr_return_amount"], "store_returns": ["sr_return_amt", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_return_amt", "wr_return_quantity", "wr_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 50, "query_string": " select top (100)     s_store_name   ,s_company_id   ,s_street_number   ,s_street_name   ,s_street_type   ,s_suite_number   ,s_city   ,s_county   ,s_state   ,s_zip   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and                   (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and                   (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and                  (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    store_sales   ,store_returns   ,store   ,date_dim d1   ,date_dim d2 where     d2.d_year = 1999 and d2.d_moy  = 8 and ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_sold_date_sk   = d1.d_date_sk and sr_returned_date_sk   = d2.d_date_sk and ss_customer_sk = sr_customer_sk and ss_store_sk = s_store_sk group by    s_store_name   ,s_company_id   ,s_street_number   ,s_street_name   ,s_street_type   ,s_suite_number   ,s_city   ,s_county   ,s_state   ,s_zip order by s_store_name         ,s_company_id         ,s_street_number         ,s_street_name         ,s_street_type         ,s_suite_number         ,s_city         ,s_county         ,s_state         ,s_zip;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 51, "query_string": " WITH web_v1 as ( select   ws_item_sk item_sk, d_date,   sum(sum(ws_sales_price))       over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from web_sales     ,date_dim where ws_sold_date_sk=d_date_sk   and d_month_seq between 1215 and 1215+11   and ws_item_sk is not NULL group by ws_item_sk, d_date), store_v1 as ( select   ss_item_sk item_sk, d_date,   sum(sum(ss_sales_price))       over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from store_sales     ,date_dim where ss_sold_date_sk=d_date_sk   and d_month_seq between 1215 and 1215+11   and ss_item_sk is not NULL group by ss_item_sk, d_date)  select top (100) * from (select item_sk      ,d_date      ,web_sales      ,store_sales      ,max(web_sales)          over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative      ,max(store_sales)          over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative      from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk                  ,case when web.d_date is not null then web.d_date else store.d_date end d_date                  ,web.cume_sales web_sales                  ,store.cume_sales store_sales            from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk                                                           and web.d_date = store.d_date)           )x )y where web_cumulative > store_cumulative order by item_sk         ,d_date;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_sales_price", "ss_item_sk"], "web_sales": ["ws_sold_date_sk", "ws_sales_price", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 52, "query_string": " select top (100) dt.d_year  \t,item.i_brand_id brand_id  \t,item.i_brand brand  \t,sum(ss_ext_sales_price) ext_price  from date_dim dt      ,store_sales      ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=11     and dt.d_year=2000  group by dt.d_year  \t,item.i_brand  \t,item.i_brand_id  order by dt.d_year  \t,ext_price desc  \t,brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"item": ["i_brand_id"]}}
{"id": 53, "query_string": " select top (100) * from  (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1215,1215+1,1215+2,1215+3,1215+4,1215+5,1215+6,1215+7,1215+8,1215+9,1215+10,1215+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', \t\t'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', \t\t'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0  \tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales  \telse null end > 0.1 order by avg_quarterly_sales, \t sum_sales, \t i_manufact_id;", "predicates": {"date_dim": ["d_month_seq"], "item": ["i_brand", "i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_qoy"], "item": ["i_item_sk", "i_manufact_id", "i_brand", "i_category", "i_class"], "store": ["s_store_sk"]}, "group_by": {}, "order_by": {}}
{"id": 54, "query_string": " with my_customers as (  select distinct c_customer_sk         , c_current_addr_sk  from            ( select cs_sold_date_sk sold_date_sk,                  cs_bill_customer_sk customer_sk,                  cs_item_sk item_sk           from   catalog_sales           union all           select ws_sold_date_sk sold_date_sk,                  ws_bill_customer_sk customer_sk,                  ws_item_sk item_sk           from   web_sales          ) cs_or_ws_sales,          item,          date_dim,          customer  where   sold_date_sk = d_date_sk          and item_sk = i_item_sk          and i_category = 'Men'          and i_class = 'sports-apparel'          and c_customer_sk = cs_or_ws_sales.customer_sk          and d_moy = 1          and d_year = 2001  )  , my_revenue as (  select c_customer_sk,         sum(ss_ext_sales_price) as revenue  from   my_customers,         store_sales,         customer_address,         store,         date_dim  where  c_current_addr_sk = ca_address_sk         and ca_county = s_county         and ca_state = s_state         and ss_sold_date_sk = d_date_sk         and c_customer_sk = ss_customer_sk         and d_month_seq between (select distinct d_month_seq+1                                  from   date_dim where d_year = 2001 and d_moy = 1)                            and  (select distinct d_month_seq+3                                  from   date_dim where d_year = 2001 and d_moy = 1)  group by c_customer_sk  )  , segments as  (select cast((revenue/50) as int) as segment   from   my_revenue  )   select top (100) segment, count(*) as num_customers, segment*50 as segment_base  from segments  group by segment  order by segment, num_customers  ;", "predicates": {"date_dim": ["d_month_seq", "d_moy", "d_year"], "item": ["i_class", "i_category"]}, "payload": {"customer_address": ["ca_address_sk", "ca_county", "ca_state"], "date_dim": ["d_date_sk", "d_month_seq"], "item": ["i_item_sk"], "store": ["s_state", "s_county"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_ext_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 55, "query_string": " select top (100) i_brand_id brand_id, i_brand brand,  \tsum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item  where d_date_sk = ss_sold_date_sk  \tand ss_item_sk = i_item_sk  \tand i_manager_id=53  \tand d_moy=11  \tand d_year=2002  group by i_brand, i_brand_id  order by ext_price desc, i_brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"item": ["i_brand_id"]}}
{"id": 56, "query_string": " with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('papaya','medium','thistle'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 2  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('papaya','medium','thistle'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 2  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('papaya','medium','thistle'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 2  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_item_id)   select top (100) i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  ;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_color"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 57, "query_string": " with v1 as(  select i_category, i_brand,         cc_name,         d_year, d_moy,         sum(cs_sales_price) sum_sales,         avg(sum(cs_sales_price)) over           (partition by i_category, i_brand,                      cc_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      cc_name            order by d_year, d_moy) rn  from item, catalog_sales, date_dim, call_center  where cs_item_sk = i_item_sk and        cs_sold_date_sk = d_date_sk and        cc_call_center_sk= cs_call_center_sk and        (          d_year = 2001 or          ( d_year = 2001-1 and d_moy =12) or          ( d_year = 2001+1 and d_moy =1)        )  group by i_category, i_brand,           cc_name , d_year, d_moy),  v2 as(  select v1.i_brand         ,v1.d_year, v1.d_moy         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1. cc_name = v1_lag. cc_name and        v1. cc_name = v1_lead. cc_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select top (100) *  from v2  where  d_year = 2001 and         avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, sum_sales  ;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"call_center": ["cc_name", "cc_call_center_sk"], "catalog_sales": ["cs_sales_price", "cs_sold_date_sk", "cs_call_center_sk", "cs_item_sk"], "date_dim": ["d_date_sk", "d_moy", "d_year"], "item": ["i_brand", "i_item_sk", "i_category"]}, "group_by": {}, "order_by": {}}
{"id": 58, "query_string": " with ss_items as  (select i_item_id item_id         ,sum(ss_ext_sales_price) ss_item_rev   from store_sales      ,item      ,date_dim  where ss_item_sk = i_item_sk    and d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2000-04-23'))    and ss_sold_date_sk   = d_date_sk  group by i_item_id),  cs_items as  (select i_item_id item_id         ,sum(cs_ext_sales_price) cs_item_rev   from catalog_sales       ,item       ,date_dim  where cs_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2000-04-23'))   and  cs_sold_date_sk = d_date_sk  group by i_item_id),  ws_items as  (select i_item_id item_id         ,sum(ws_ext_sales_price) ws_item_rev   from web_sales       ,item       ,date_dim  where ws_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq =(select d_week_seq                                       from date_dim                                      where d_date = '2000-04-23'))   and ws_sold_date_sk   = d_date_sk  group by i_item_id)   select top (100) ss_items.item_id        ,ss_item_rev        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev        ,cs_item_rev        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev        ,ws_item_rev        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average  from ss_items,cs_items,ws_items  where ss_items.item_id=cs_items.item_id    and ss_items.item_id=ws_items.item_id     and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  order by item_id          ,ss_item_rev  ;", "predicates": {"date_dim": ["d_week_seq", "d_date"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_item_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "item": ["i_item_id", "i_item_sk"], "store_sales": ["ss_sold_date_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 59, "query_string": " with wss as   (select d_week_seq,         ss_store_sk,         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales  from store_sales,date_dim  where d_date_sk = ss_sold_date_sk  group by d_week_seq,ss_store_sk  )   select top (100) s_store_name1,s_store_id1,d_week_seq1        ,sun_sales1/sun_sales2,mon_sales1/mon_sales2        ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2        ,fri_sales1/fri_sales2,sat_sales1/sat_sales2  from  (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1         ,s_store_id s_store_id1,sun_sales sun_sales1         ,mon_sales mon_sales1,tue_sales tue_sales1         ,wed_sales wed_sales1,thu_sales thu_sales1         ,fri_sales fri_sales1,sat_sales sat_sales1   from wss,store,date_dim d   where d.d_week_seq = wss.d_week_seq and         ss_store_sk = s_store_sk and          d_month_seq between 1206 and 1206 + 11) y,  (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2         ,s_store_id s_store_id2,sun_sales sun_sales2         ,mon_sales mon_sales2,tue_sales tue_sales2         ,wed_sales wed_sales2,thu_sales thu_sales2         ,fri_sales fri_sales2,sat_sales sat_sales2   from wss,store,date_dim d   where d.d_week_seq = wss.d_week_seq and         ss_store_sk = s_store_sk and          d_month_seq between 1206+ 12 and 1206 + 23) x  where s_store_id1=s_store_id2    and d_week_seq1=d_week_seq2-52  order by s_store_name1,s_store_id1,d_week_seq1;", "predicates": {"date_dim": ["d_month_seq"], "store": ["s_store_id"]}, "payload": {"date_dim": ["d_date_sk", "d_week_seq", "d_day_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 60, "query_string": " with ss as (  select           i_item_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where          i_item_id in (select   i_item_id from  item where i_category in ('Men'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 10  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  cs as (  select           i_item_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Men'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 10  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  ws as (  select           i_item_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Men'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 10  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_item_id)   select top (100)     i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by i_item_id       ,total_sales  ;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_item_id", "i_category"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 61, "query_string": " select top (100) promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from   (select sum(ss_ext_sales_price) promotions    from  store_sales         ,store         ,promotion         ,date_dim         ,customer         ,customer_address          ,item    where ss_sold_date_sk = d_date_sk    and   ss_store_sk = s_store_sk    and   ss_promo_sk = p_promo_sk    and   ss_customer_sk= c_customer_sk    and   ca_address_sk = c_current_addr_sk    and   ss_item_sk = i_item_sk     and   ca_gmt_offset = -7    and   i_category = 'Home'    and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')    and   s_gmt_offset = -7    and   d_year = 2001    and   d_moy  = 12) promotional_sales,   (select sum(ss_ext_sales_price) total    from  store_sales         ,store         ,date_dim         ,customer         ,customer_address         ,item    where ss_sold_date_sk = d_date_sk    and   ss_store_sk = s_store_sk    and   ss_customer_sk= c_customer_sk    and   ca_address_sk = c_current_addr_sk    and   ss_item_sk = i_item_sk    and   ca_gmt_offset = -7    and   i_category = 'Home'    and   s_gmt_offset = -7    and   d_year = 2001    and   d_moy  = 12) all_sales order by promotions, total;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_category"], "promotion": ["p_channel_dmail", "p_channel_email", "p_channel_tv"], "store": ["s_gmt_offset"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_promo_sk", "ss_item_sk", "ss_ext_sales_price", "ss_customer_sk", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 62, "query_string": " select top (100)     substring(w_warehouse_name,1,20)   ,sm_type   ,web_name   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and                   (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and                   (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and                  (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    web_sales   ,warehouse   ,ship_mode   ,web_site   ,date_dim where     d_month_seq between 1215 and 1215 + 11 and ws_ship_date_sk   = d_date_sk and ws_warehouse_sk   = w_warehouse_sk and ws_ship_mode_sk   = sm_ship_mode_sk and ws_web_site_sk    = web_site_sk group by    substring(w_warehouse_name,1,20)   ,sm_type   ,web_name order by substring(w_warehouse_name,1,20)         ,sm_type        ,web_name;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "ship_mode": ["sm_type", "sm_ship_mode_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"], "web_sales": ["ws_ship_date_sk", "ws_ship_mode_sk", "ws_sold_date_sk", "ws_warehouse_sk", "ws_web_site_sk"], "web_site": ["web_name", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 63, "query_string": " select top (100) *  from (select i_manager_id              ,sum(ss_sales_price) sum_sales              ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales       from item           ,store_sales           ,date_dim           ,store       where ss_item_sk = i_item_sk         and ss_sold_date_sk = d_date_sk         and ss_store_sk = s_store_sk         and d_month_seq in (1215,1215+1,1215+2,1215+3,1215+4,1215+5,1215+6,1215+7,1215+8,1215+9,1215+10,1215+11)         and ((    i_category in ('Books','Children','Electronics')               and i_class in ('personal','portable','reference','self-help')               and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', \t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))            or(    i_category in ('Women','Music','Men')               and i_class in ('accessories','classical','fragrances','pants')               and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', \t\t                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id         ,avg_monthly_sales         ,sum_sales;", "predicates": {"date_dim": ["d_month_seq"], "item": ["i_brand", "i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_item_sk", "i_manager_id", "i_brand", "i_category", "i_class"], "store": ["s_store_sk"]}, "group_by": {}, "order_by": {"item": ["i_manager_id"]}}
{"id": 64, "query_string": " with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('tan','deep','powder','purple','orange','ivory') and          i_current_price between 60 and 60 + 10 and          i_current_price between 60 + 1 and 60 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;", "predicates": {"customer_demographics": ["cd_marital_status"], "date_dim": ["d_year"], "item": ["i_color", "i_current_price"], "store": ["s_zip", "s_store_name"]}, "payload": {"household_demographics": ["hd_income_band_sk", "hd_demo_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 65, "query_string": " select top (100) \ts_store_name, \ti_item_desc, \tsc.revenue, \ti_current_price, \ti_wholesale_cost, \ti_brand  from store, item,      (select ss_store_sk, avg(revenue) as ave  \tfrom  \t    (select  ss_store_sk, ss_item_sk,   \t\t     sum(ss_sales_price) as revenue  \t\tfrom store_sales, date_dim  \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1215 and 1215+11  \t\tgroup by ss_store_sk, ss_item_sk) sa  \tgroup by ss_store_sk) sb,      (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue  \tfrom store_sales, date_dim  \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1215 and 1215+11  \tgroup by ss_store_sk, ss_item_sk) sc  where sb.ss_store_sk = sc.ss_store_sk and         sc.revenue <= 0.1 * sb.ave and        s_store_sk = sc.ss_store_sk and        i_item_sk = sc.ss_item_sk  order by s_store_name, i_item_desc;", "predicates": {"date_dim": ["d_month_seq"], "store_sales": ["ss_store_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_brand", "i_wholesale_cost", "i_item_desc"], "store": ["s_store_name", "s_store_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price", "ss_item_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_desc"], "store": ["s_store_name"]}}
{"id": 66, "query_string": " select top (100)            w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country         ,ship_carriers         ,year  \t,sum(jan_sales) as jan_sales  \t,sum(feb_sales) as feb_sales  \t,sum(mar_sales) as mar_sales  \t,sum(apr_sales) as apr_sales  \t,sum(may_sales) as may_sales  \t,sum(jun_sales) as jun_sales  \t,sum(jul_sales) as jul_sales  \t,sum(aug_sales) as aug_sales  \t,sum(sep_sales) as sep_sales  \t,sum(oct_sales) as oct_sales  \t,sum(nov_sales) as nov_sales  \t,sum(dec_sales) as dec_sales  \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot  \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot  \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot  \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot  \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot  \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot  \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot  \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot  \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot  \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot  \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot  \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot  \t,sum(jan_net) as jan_net  \t,sum(feb_net) as feb_net  \t,sum(mar_net) as mar_net  \t,sum(apr_net) as apr_net  \t,sum(may_net) as may_net  \t,sum(jun_net) as jun_net  \t,sum(jul_net) as jul_net  \t,sum(aug_net) as aug_net  \t,sum(sep_net) as sep_net  \t,sum(oct_net) as oct_net  \t,sum(nov_net) as nov_net  \t,sum(dec_net) as dec_net  from (      select   \tw_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,concat('ALLIANCE' , ',' , 'UPS') as ship_carriers        ,d_year as year  \t,sum(case when d_moy = 1   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jan_sales  \t,sum(case when d_moy = 2   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as feb_sales  \t,sum(case when d_moy = 3   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as mar_sales  \t,sum(case when d_moy = 4   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as apr_sales  \t,sum(case when d_moy = 5   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as may_sales  \t,sum(case when d_moy = 6   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jun_sales  \t,sum(case when d_moy = 7   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jul_sales  \t,sum(case when d_moy = 8   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as aug_sales  \t,sum(case when d_moy = 9   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as sep_sales  \t,sum(case when d_moy = 10   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as oct_sales  \t,sum(case when d_moy = 11  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as nov_sales  \t,sum(case when d_moy = 12  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as dec_sales  \t,sum(case when d_moy = 1   \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jan_net  \t,sum(case when d_moy = 2  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as feb_net  \t,sum(case when d_moy = 3   \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as mar_net  \t,sum(case when d_moy = 4   \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as apr_net  \t,sum(case when d_moy = 5   \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as may_net  \t,sum(case when d_moy = 6   \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jun_net  \t,sum(case when d_moy = 7   \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jul_net  \t,sum(case when d_moy = 8   \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as aug_net  \t,sum(case when d_moy = 9   \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as sep_net  \t,sum(case when d_moy = 10   \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as oct_net  \t,sum(case when d_moy = 11  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as nov_net  \t,sum(case when d_moy = 12  \t\tthen ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as dec_net      from           web_sales          ,warehouse          ,date_dim          ,time_dim  \t  ,ship_mode      where             ws_warehouse_sk =  w_warehouse_sk         and ws_sold_date_sk = d_date_sk         and ws_sold_time_sk = t_time_sk  \tand ws_ship_mode_sk = sm_ship_mode_sk         and d_year = 2001  \tand t_time between 1634 and 1634+28800   \tand sm_carrier in ('ALLIANCE','UPS')      group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country        ,d_year  union all      select   \tw_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,concat('ALLIANCE', ',', 'UPS') as ship_carriers        ,d_year as year  \t,sum(case when d_moy = 1   \t\tthen cs_sales_price* cs_quantity else 0 end) as jan_sales  \t,sum(case when d_moy = 2   \t\tthen cs_sales_price* cs_quantity else 0 end) as feb_sales  \t,sum(case when d_moy = 3   \t\tthen cs_sales_price* cs_quantity else 0 end) as mar_sales  \t,sum(case when d_moy = 4   \t\tthen cs_sales_price* cs_quantity else 0 end) as apr_sales  \t,sum(case when d_moy = 5   \t\tthen cs_sales_price* cs_quantity else 0 end) as may_sales  \t,sum(case when d_moy = 6   \t\tthen cs_sales_price* cs_quantity else 0 end) as jun_sales  \t,sum(case when d_moy = 7   \t\tthen cs_sales_price* cs_quantity else 0 end) as jul_sales  \t,sum(case when d_moy = 8   \t\tthen cs_sales_price* cs_quantity else 0 end) as aug_sales  \t,sum(case when d_moy = 9   \t\tthen cs_sales_price* cs_quantity else 0 end) as sep_sales  \t,sum(case when d_moy = 10   \t\tthen cs_sales_price* cs_quantity else 0 end) as oct_sales  \t,sum(case when d_moy = 11  \t\tthen cs_sales_price* cs_quantity else 0 end) as nov_sales  \t,sum(case when d_moy = 12  \t\tthen cs_sales_price* cs_quantity else 0 end) as dec_sales  \t,sum(case when d_moy = 1   \t\tthen cs_net_paid * cs_quantity else 0 end) as jan_net  \t,sum(case when d_moy = 2   \t\tthen cs_net_paid * cs_quantity else 0 end) as feb_net  \t,sum(case when d_moy = 3   \t\tthen cs_net_paid * cs_quantity else 0 end) as mar_net  \t,sum(case when d_moy = 4   \t\tthen cs_net_paid * cs_quantity else 0 end) as apr_net  \t,sum(case when d_moy = 5   \t\tthen cs_net_paid * cs_quantity else 0 end) as may_net  \t,sum(case when d_moy = 6   \t\tthen cs_net_paid * cs_quantity else 0 end) as jun_net  \t,sum(case when d_moy = 7   \t\tthen cs_net_paid * cs_quantity else 0 end) as jul_net  \t,sum(case when d_moy = 8   \t\tthen cs_net_paid * cs_quantity else 0 end) as aug_net  \t,sum(case when d_moy = 9   \t\tthen cs_net_paid * cs_quantity else 0 end) as sep_net  \t,sum(case when d_moy = 10   \t\tthen cs_net_paid * cs_quantity else 0 end) as oct_net  \t,sum(case when d_moy = 11  \t\tthen cs_net_paid * cs_quantity else 0 end) as nov_net  \t,sum(case when d_moy = 12  \t\tthen cs_net_paid * cs_quantity else 0 end) as dec_net      from           catalog_sales          ,warehouse          ,date_dim          ,time_dim  \t ,ship_mode      where             cs_warehouse_sk =  w_warehouse_sk         and cs_sold_date_sk = d_date_sk         and cs_sold_time_sk = t_time_sk  \tand cs_ship_mode_sk = sm_ship_mode_sk         and d_year = 2001  \tand t_time between 1634 AND 1634+28800   \tand sm_carrier in ('ALLIANCE','UPS')      group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country        ,d_year  ) x  group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,ship_carriers        ,year  order by w_warehouse_name  ;", "predicates": {"date_dim": ["d_year"], "ship_mode": ["sm_carrier"], "time_dim": ["t_time"]}, "payload": {"catalog_sales": ["cs_warehouse_sk", "cs_ext_list_price", "cs_quantity", "cs_net_paid_inc_tax", "cs_ship_mode_sk", "cs_sold_date_sk", "cs_sold_time_sk"], "date_dim": ["d_date_sk", "d_moy", "d_year"], "ship_mode": ["sm_ship_mode_sk"], "time_dim": ["t_time_sk"], "web_sales": ["ws_ship_mode_sk", "ws_ext_list_price", "ws_sold_date_sk", "ws_quantity", "ws_sold_time_sk", "ws_warehouse_sk", "ws_net_paid"]}, "group_by": {}, "order_by": {}}
{"id": 67, "query_string": " select top (100) * from (select i_category             ,i_class             ,i_brand             ,i_product_name             ,d_year             ,d_qoy             ,d_moy             ,s_store_id             ,sumsales             ,rank() over (partition by i_category order by sumsales desc) rk       from (select i_category                   ,i_class                   ,i_brand                   ,i_product_name                   ,d_year                   ,d_qoy                   ,d_moy                   ,s_store_id                   ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales             from store_sales                 ,date_dim                 ,store                 ,item        where  ss_sold_date_sk=d_date_sk           and ss_item_sk=i_item_sk           and ss_store_sk = s_store_sk           and d_month_seq between 1215 and 1215+11        group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 order by i_category         ,i_class         ,i_brand         ,i_product_name         ,d_year         ,d_qoy         ,d_moy         ,s_store_id         ,sumsales         ,rk;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk", "d_moy", "d_qoy", "d_year"], "item": ["i_item_sk", "i_brand", "i_product_name", "i_category", "i_class"], "store": ["s_store_sk", "s_store_id"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_sales_price", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {"date_dim": ["d_moy", "d_qoy", "d_year"], "item": ["i_brand", "i_class", "i_product_name", "i_category"], "store": ["s_store_id"]}}
{"id": 68, "query_string": " select top (100) c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,extended_price        ,extended_tax        ,list_price  from (select ss_ticket_number              ,ss_customer_sk              ,ca_city bought_city              ,sum(ss_ext_sales_price) extended_price               ,sum(ss_ext_list_price) list_price              ,sum(ss_ext_tax) extended_tax         from store_sales            ,date_dim            ,store            ,household_demographics            ,customer_address         where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_store_sk = store.s_store_sk           and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk         and store_sales.ss_addr_sk = customer_address.ca_address_sk         and date_dim.d_dom between 1 and 2          and (household_demographics.hd_dep_count = 9 or              household_demographics.hd_vehicle_count= 2)         and date_dim.d_year in (2000,2000+1,2000+2)         and store.s_city in ('Midway','Fairview')        group by ss_ticket_number                ,ss_customer_sk                ,ss_addr_sk,ca_city) dn       ,customer       ,customer_address current_addr  where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name          ,ss_ticket_number  ;", "predicates": {"customer_address": ["ca_city"], "date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_city"]}, "payload": {"customer": ["c_current_addr_sk", "c_first_name", "c_last_name", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_city"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_ext_sales_price", "ss_addr_sk", "ss_customer_sk", "ss_ticket_number", "ss_ext_list_price", "ss_ext_tax", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 69, "query_string": " select top (100)    cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_state in ('KS','NE','VA') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2001 and                 d_moy between 3 and 3+2) and    (not exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 3 and 3+2) and     not exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 3 and 3+2))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  ;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 70, "query_string": " select top (100)      sum(ss_net_profit) as total_sum    ,s_state    ,s_county    ,grouping(s_state)+grouping(s_county) as lochierarchy    ,rank() over (  \tpartition by grouping(s_state)+grouping(s_county),  \tcase when grouping(s_county) = 0 then s_state end   \torder by sum(ss_net_profit) desc) as rank_within_parent  from     store_sales    ,date_dim       d1    ,store  where     d1.d_month_seq between 1215 and 1215+11  and d1.d_date_sk = ss_sold_date_sk  and s_store_sk  = ss_store_sk  and s_state in              ( select s_state                from  (select s_state as s_state,  \t\t\t    rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking                       from   store_sales, store, date_dim                       where  d_month_seq between 1215 and 1215+11  \t\t\t    and d_date_sk = ss_sold_date_sk  \t\t\t    and s_store_sk  = ss_store_sk                       group by s_state                      ) tmp1                 where ranking <= 5              )  group by rollup(s_state,s_county)  order by    lochierarchy desc   ,case when (grouping(s_state)+grouping(s_county)) = 0 then s_state end   ,rank_within_parent  ;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 71, "query_string": " select i_brand_id brand_id, i_brand brand,t_hour,t_minute,  \tsum(ext_price) ext_price  from item, (select ws_ext_sales_price as ext_price,                          ws_sold_date_sk as sold_date_sk,                         ws_item_sk as sold_item_sk,                         ws_sold_time_sk as time_sk                    from web_sales,date_dim                  where d_date_sk = ws_sold_date_sk                    and d_moy=11                    and d_year=1999                  union all                  select cs_ext_sales_price as ext_price,                         cs_sold_date_sk as sold_date_sk,                         cs_item_sk as sold_item_sk,                         cs_sold_time_sk as time_sk                  from catalog_sales,date_dim                  where d_date_sk = cs_sold_date_sk                    and d_moy=11                    and d_year=1999                  union all                  select ss_ext_sales_price as ext_price,                         ss_sold_date_sk as sold_date_sk,                         ss_item_sk as sold_item_sk,                         ss_sold_time_sk as time_sk                  from store_sales,date_dim                  where d_date_sk = ss_sold_date_sk                    and d_moy=11                    and d_year=1999                  ) tmp,time_dim  where    sold_item_sk = i_item_sk    and i_manager_id=1    and time_sk = t_time_sk    and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')  group by i_brand, i_brand_id,t_hour,t_minute  order by ext_price desc, i_brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"], "time_dim": ["t_meal_time"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_brand", "i_item_sk", "i_brand_id"], "time_dim": ["t_hour", "t_minute", "t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 72, "query_string": " select top (100) i_item_desc       ,w_warehouse_name       ,d1.d_week_seq       ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo       ,sum(case when p_promo_sk is not null then 1 else 0 end) promo       ,count(*) total_cnt from catalog_sales join inventory on (cs_item_sk = inv_item_sk) join warehouse on (w_warehouse_sk=inv_warehouse_sk) join item on (i_item_sk = cs_item_sk) join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk) join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk) join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk) join date_dim d2 on (inv_date_sk = d2.d_date_sk) join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk) left outer join promotion on (cs_promo_sk=p_promo_sk) left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number) where d1.d_week_seq = d2.d_week_seq   and inv_quantity_on_hand < cs_quantity    and d3.d_date > dateadd(day, 5, d1.d_date)   and hd_buy_potential = '1001-5000'   and d1.d_year = 2002   and cd_marital_status = 'D' group by i_item_desc,w_warehouse_name,d1.d_week_seq order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq;", "predicates": {"customer_demographics": ["cd_marital_status"], "date_dim": ["d_date", "d_year"], "household_demographics": ["hd_buy_potential"], "inventory": ["inv_warehouse_sk"], "warehouse": ["w_warehouse_sk"]}, "payload": {"catalog_sales": ["cs_quantity", "cs_promo_sk", "cs_item_sk", "cs_ship_date_sk", "cs_bill_cdemo_sk", "cs_sold_date_sk", "cs_bill_hdemo_sk"], "customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "household_demographics": ["hd_demo_sk"], "item": ["i_item_sk", "i_item_desc"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {"date_dim": ["d_week_seq"], "item": ["i_item_desc"], "warehouse": ["w_warehouse_name"]}}
{"id": 73, "query_string": " select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '501-1000' or          household_demographics.hd_buy_potential = '5001-10000')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;", "predicates": {"date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count", "hd_buy_potential"], "store": ["s_county"]}, "payload": {"customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_preferred_cust_flag"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 74, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,d_year as year        ,max(ss_net_paid) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk    and d_year in (2001,2001+1)  group by c_customer_id          ,c_first_name          ,c_last_name          ,d_year  union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,d_year as year        ,max(ws_net_paid) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk    and d_year in (2001,2001+1)  group by c_customer_id          ,c_first_name          ,c_last_name          ,d_year          )   select top (100)         t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id          and t_s_firstyear.customer_id = t_w_secyear.customer_id          and t_s_firstyear.customer_id = t_w_firstyear.customer_id          and t_s_firstyear.sale_type = 's'          and t_w_firstyear.sale_type = 'w'          and t_s_secyear.sale_type = 's'          and t_w_secyear.sale_type = 'w'          and t_s_firstyear.year = 2001          and t_s_secyear.year = 2001+1          and t_w_firstyear.year = 2001          and t_w_secyear.year = 2001+1          and t_s_firstyear.year_total > 0          and t_w_firstyear.year_total > 0          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end  order by 1,2,3;", "predicates": {"date_dim": ["d_year"]}, "payload": {"customer": ["c_customer_id", "c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_net_paid"], "web_sales": ["ws_net_paid", "ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_customer_id", "c_last_name", "c_first_name"]}}
{"id": 75, "query_string": " WITH all_sales AS (  SELECT d_year        ,i_brand_id        ,i_class_id        ,i_category_id        ,i_manufact_id        ,SUM(sales_cnt) AS sales_cnt        ,SUM(sales_amt) AS sales_amt  FROM (SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt              ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt        FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk                           JOIN date_dim ON d_date_sk=cs_sold_date_sk                           LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number                                                      AND cs_item_sk=cr_item_sk)        WHERE i_category='Home'        UNION        SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt              ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt        FROM store_sales JOIN item ON i_item_sk=ss_item_sk                         JOIN date_dim ON d_date_sk=ss_sold_date_sk                         LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number                                                  AND ss_item_sk=sr_item_sk)        WHERE i_category='Home'        UNION        SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt              ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt        FROM web_sales JOIN item ON i_item_sk=ws_item_sk                       JOIN date_dim ON d_date_sk=ws_sold_date_sk                       LEFT JOIN web_returns ON (ws_order_number=wr_order_number                                              AND ws_item_sk=wr_item_sk)        WHERE i_category='Home') sales_detail  GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)  SELECT top (100) prev_yr.d_year AS prev_year                           ,curr_yr.d_year AS year                           ,curr_yr.i_brand_id                           ,curr_yr.i_class_id                           ,curr_yr.i_category_id                           ,curr_yr.i_manufact_id                           ,prev_yr.sales_cnt AS prev_yr_cnt                           ,curr_yr.sales_cnt AS curr_yr_cnt                           ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff                           ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff  FROM all_sales curr_yr, all_sales prev_yr  WHERE curr_yr.i_brand_id=prev_yr.i_brand_id    AND curr_yr.i_class_id=prev_yr.i_class_id    AND curr_yr.i_category_id=prev_yr.i_category_id    AND curr_yr.i_manufact_id=prev_yr.i_manufact_id    AND curr_yr.d_year=1999    AND prev_yr.d_year=1999-1    AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9  ORDER BY sales_cnt_diff,sales_amt_diff  ;", "predicates": {"date_dim": ["d_year"], "item": ["i_category"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_quantity", "cr_return_amount"], "date_dim": ["d_date_sk", "d_year"], "item": ["i_class_id", "i_item_sk", "i_category_id", "i_brand_id", "i_manufact_id"], "store_returns": ["sr_return_amt", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_return_amt", "wr_return_quantity", "wr_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 76, "query_string": " select top (100) channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (         SELECT 'store' as channel, 'ss_customer_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price          FROM store_sales, item, date_dim          WHERE ss_customer_sk IS NULL            AND ss_sold_date_sk=d_date_sk            AND ss_item_sk=i_item_sk         UNION ALL         SELECT 'web' as channel, 'ws_ship_cdemo_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price          FROM web_sales, item, date_dim          WHERE ws_ship_cdemo_sk IS NULL            AND ws_sold_date_sk=d_date_sk            AND ws_item_sk=i_item_sk         UNION ALL         SELECT 'catalog' as channel, 'cs_promo_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price          FROM catalog_sales, item, date_dim          WHERE cs_promo_sk IS NULL            AND cs_sold_date_sk=d_date_sk            AND cs_item_sk=i_item_sk) foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category;", "predicates": {"catalog_sales": ["cs_ship_addr_sk"], "store_sales": ["ss_promo_sk"], "web_sales": ["ws_promo_sk"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_item_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_qoy", "d_year"], "item": ["i_item_sk", "i_category"], "store_sales": ["ss_sold_date_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 77, "query_string": " with ss as  (select s_store_sk,          sum(ss_ext_sales_price) as sales,          sum(ss_net_profit) as profit  from store_sales,       date_dim,       store  where ss_sold_date_sk = d_date_sk        and d_date between cast('2000-08-06' as date)                    and dateadd(day, 30, cast('2000-08-06' as date))         and ss_store_sk = s_store_sk  group by s_store_sk)  ,  sr as  (select s_store_sk,          sum(sr_return_amt) as returns,          sum(sr_net_loss) as profit_loss  from store_returns,       date_dim,       store  where sr_returned_date_sk = d_date_sk        and d_date between cast('2000-08-06' as date)                   and dateadd(day, 30, cast('2000-08-06' as date))        and sr_store_sk = s_store_sk  group by s_store_sk),   cs as  (select cs_call_center_sk,         sum(cs_ext_sales_price) as sales,         sum(cs_net_profit) as profit  from catalog_sales,       date_dim  where cs_sold_date_sk = d_date_sk        and d_date between cast('2000-08-06' as date)                   and dateadd(day, 30, cast('2000-08-06' as date))  group by cs_call_center_sk   ),   cr as  (select cr_call_center_sk,          sum(cr_return_amount) as returns,          sum(cr_net_loss) as profit_loss  from catalog_returns,       date_dim  where cr_returned_date_sk = d_date_sk        and d_date between cast('2000-08-06' as date)                   and dateadd(day, 30, cast('2000-08-06' as date))  group by cr_call_center_sk  ),   ws as  ( select wp_web_page_sk,         sum(ws_ext_sales_price) as sales,         sum(ws_net_profit) as profit  from web_sales,       date_dim,       web_page  where ws_sold_date_sk = d_date_sk        and d_date between cast('2000-08-06' as date)                   and dateadd(day, 30, cast('2000-08-06' as date))        and ws_web_page_sk = wp_web_page_sk  group by wp_web_page_sk),   wr as  (select wp_web_page_sk,         sum(wr_return_amt) as returns,         sum(wr_net_loss) as profit_loss  from web_returns,       date_dim,       web_page  where wr_returned_date_sk = d_date_sk        and d_date between cast('2000-08-06' as date)                   and dateadd(day, 30, cast('2000-08-06' as date))        and wr_web_page_sk = wp_web_page_sk  group by wp_web_page_sk)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , ss.s_store_sk as id         , sales         , coalesce(returns, 0) as returns         , (profit - coalesce(profit_loss,0)) as profit  from   ss left join sr         on  ss.s_store_sk = sr.s_store_sk  union all  select 'catalog channel' as channel         , cs_call_center_sk as id         , sales         , returns         , (profit - profit_loss) as profit  from  cs        , cr  union all  select 'web channel' as channel         , ws.wp_web_page_sk as id         , sales         , coalesce(returns, 0) returns         , (profit - coalesce(profit_loss,0)) as profit  from   ws left join wr         on  ws.wp_web_page_sk = wr.wp_web_page_sk  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_return_amount", "cr_call_center_sk"], "catalog_sales": ["cs_net_profit", "cs_sold_date_sk", "cs_call_center_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_net_loss"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit", "ss_ext_sales_price"], "web_page": ["wp_web_page_sk"], "web_returns": ["wr_web_page_sk", "wr_returned_date_sk", "wr_return_amt", "wr_net_loss"], "web_sales": ["ws_net_profit", "ws_ext_sales_price", "ws_web_page_sk", "ws_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 78, "query_string": " with ws as   (select d_year AS ws_sold_year, ws_item_sk,     ws_bill_customer_sk ws_customer_sk,     sum(ws_quantity) ws_qty,     sum(ws_wholesale_cost) ws_wc,     sum(ws_sales_price) ws_sp    from web_sales    left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk    join date_dim on ws_sold_date_sk = d_date_sk    where wr_order_number is null    group by d_year, ws_item_sk, ws_bill_customer_sk    ), cs as   (select d_year AS cs_sold_year, cs_item_sk,     cs_bill_customer_sk cs_customer_sk,     sum(cs_quantity) cs_qty,     sum(cs_wholesale_cost) cs_wc,     sum(cs_sales_price) cs_sp    from catalog_sales    left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk    join date_dim on cs_sold_date_sk = d_date_sk    where cr_order_number is null    group by d_year, cs_item_sk, cs_bill_customer_sk    ), ss as   (select d_year AS ss_sold_year, ss_item_sk,     ss_customer_sk,     sum(ss_quantity) ss_qty,     sum(ss_wholesale_cost) ss_wc,     sum(ss_sales_price) ss_sp    from store_sales    left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk    join date_dim on ss_sold_date_sk = d_date_sk    where sr_ticket_number is null    group by d_year, ss_item_sk, ss_customer_sk    )  select top (100) ss_sold_year, round(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk) where (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=1999 order by    ss_sold_year,   ss_qty desc, ss_wc desc, ss_sp desc,   other_chan_qty,   other_chan_wholesale_cost,   other_chan_sales_price,   ratio;", "predicates": {"catalog_returns": ["cr_order_number"], "catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_year"], "store_returns": ["sr_ticket_number"], "store_sales": ["ss_customer_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_bill_customer_sk"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "store_returns": ["sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_item_sk", "ss_sales_price", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_wholesale_cost", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 79, "query_string": " select top (100)   c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,store.s_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (household_demographics.hd_dep_count = 9 or household_demographics.hd_vehicle_count > 3)     and date_dim.d_dow = 1     and date_dim.d_year in (1998,1998+1,1998+2)      and store.s_number_employees between 200 and 295     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer     where ss_customer_sk = c_customer_sk  order by c_last_name,c_first_name,substring(s_city,1,30), profit;", "predicates": {"date_dim": ["d_dow", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_number_employees"]}, "payload": {"customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_city", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_addr_sk", "ss_customer_sk", "ss_ticket_number", "ss_coupon_amt", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {"customer": ["c_last_name", "c_first_name"]}}
{"id": 80, "query_string": " with ssr as  (select  s_store_id as store_id,           sum(ss_ext_sales_price) as sales,           sum(coalesce(sr_return_amt, 0)) as returns,           sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit   from store_sales left outer join store_returns on          (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),      date_dim,      store,      item,      promotion  where ss_sold_date_sk = d_date_sk        and d_date between cast('2000-08-06' as date)                    and dateadd(day, 30, cast('2000-08-06' as date))        and ss_store_sk = s_store_sk        and ss_item_sk = i_item_sk        and i_current_price > 50        and ss_promo_sk = p_promo_sk        and p_channel_tv = 'N'  group by s_store_id)  ,  csr as  (select  cp_catalog_page_id as catalog_page_id,           sum(cs_ext_sales_price) as sales,           sum(coalesce(cr_return_amount, 0)) as returns,           sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit   from catalog_sales left outer join catalog_returns on          (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),      date_dim,      catalog_page,      item,      promotion  where cs_sold_date_sk = d_date_sk        and d_date between cast('2000-08-06' as date)                   and dateadd(day, 30, cast('2000-08-06' as date))         and cs_catalog_page_sk = cp_catalog_page_sk        and cs_item_sk = i_item_sk        and i_current_price > 50        and cs_promo_sk = p_promo_sk        and p_channel_tv = 'N' group by cp_catalog_page_id)  ,  wsr as  (select  web_site_id,           sum(ws_ext_sales_price) as sales,           sum(coalesce(wr_return_amt, 0)) as returns,           sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit   from web_sales left outer join web_returns on          (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),      date_dim,      web_site,      item,      promotion  where ws_sold_date_sk = d_date_sk        and d_date between cast('2000-08-06' as date)                   and dateadd(day, 30, cast('2000-08-06' as date))         and ws_web_site_sk = web_site_sk        and ws_item_sk = i_item_sk        and i_current_price > 50        and ws_promo_sk = p_promo_sk        and p_channel_tv = 'N' group by web_site_id)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , concat('store' , store_id) as id         , sales         , returns         , profit  from   ssr  union all  select 'catalog channel' as channel         , concat('catalog_page' , catalog_page_id) as id         , sales         , returns         , profit  from  csr  union all  select 'web channel' as channel         , concat('web_site' , web_site_id) as id         , sales         , returns         , profit  from   wsr  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"], "promotion": ["p_channel_tv"]}, "payload": {"catalog_page": ["cp_catalog_page_sk", "cp_catalog_page_id"], "catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_amount", "cr_net_loss"], "date_dim": ["d_date_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"], "store": ["s_store_sk", "s_store_id"], "store_returns": ["sr_return_amt", "sr_net_loss", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_net_loss", "wr_return_amt", "wr_order_number"], "web_site": ["web_site_id", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 81, "query_string": " with customer_total_return as  (select cr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   \tsum(cr_return_amt_inc_tax) as ctr_total_return  from catalog_returns      ,date_dim      ,customer_address  where cr_returned_date_sk = d_date_sk     and d_year =2000    and cr_returning_addr_sk = ca_address_sk   group by cr_returning_customer_sk          ,ca_state )   select top (100) c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  \t\t\t  from customer_total_return ctr2                    \t  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'IN'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  ;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_year"]}, "payload": {"catalog_returns": ["cr_returned_date_sk", "cr_returning_customer_sk", "cr_return_amt_inc_tax", "cr_returning_addr_sk"], "customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_current_addr_sk", "c_customer_id"], "customer_address": ["ca_street_type", "ca_county", "ca_street_name", "ca_zip", "ca_street_number", "ca_city", "ca_state", "ca_gmt_offset", "ca_location_type", "ca_address_sk", "ca_suite_number", "ca_country"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer": ["c_salutation", "c_customer_id", "c_last_name", "c_first_name"], "customer_address": ["ca_street_type", "ca_county", "ca_street_name", "ca_zip", "ca_street_number", "ca_city", "ca_gmt_offset", "ca_location_type", "ca_suite_number", "ca_country"]}}
{"id": 82, "query_string": " select top (100) i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, store_sales  where i_current_price between 12 and 12+30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2000-06-27' as date) and dateadd(day, 60, cast('2000-06-27' as date))  and i_manufact_id in (625,881,109,643)  and inv_quantity_on_hand between 100 and 500  and ss_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  ;", "predicates": {"date_dim": ["d_date"], "inventory": ["inv_quantity_on_hand"], "item": ["i_current_price", "i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc", "i_current_price"]}, "group_by": {}, "order_by": {}}
{"id": 83, "query_string": " with sr_items as  (select i_item_id item_id,         sum(sr_return_quantity) sr_item_qty  from store_returns,       item,       date_dim  where sr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t  where d_date in ('1999-07-12','1999-10-12','1999-11-17')))  and   sr_returned_date_sk   = d_date_sk  group by i_item_id),  cr_items as  (select i_item_id item_id,         sum(cr_return_quantity) cr_item_qty  from catalog_returns,       item,       date_dim  where cr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t  where d_date in ('1999-07-12','1999-10-12','1999-11-17')))  and   cr_returned_date_sk   = d_date_sk  group by i_item_id),  wr_items as  (select i_item_id item_id,         sum(wr_return_quantity) wr_item_qty  from web_returns,       item,       date_dim  where wr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t\twhere d_date in ('1999-07-12','1999-10-12','1999-11-17')))  and   wr_returned_date_sk   = d_date_sk  group by i_item_id)   select top (100) sr_items.item_id        ,sr_item_qty        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev        ,cr_item_qty        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev        ,wr_item_qty        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average  from sr_items      ,cr_items      ,wr_items  where sr_items.item_id=cr_items.item_id    and sr_items.item_id=wr_items.item_id   order by sr_items.item_id          ,sr_item_qty  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_returned_date_sk", "cr_order_number", "cr_return_quantity"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "item": ["i_item_id", "i_item_sk"], "store_returns": ["sr_returned_date_sk", "sr_return_quantity", "sr_item_sk"], "web_returns": ["wr_item_sk", "wr_returned_date_sk", "wr_return_quantity"]}, "group_by": {}, "order_by": {}}
{"id": 84, "query_string": " select top (100) c_customer_id as customer_id        , concat(coalesce(c_last_name,'') , ', ' , coalesce(c_first_name,'')) as customername  from customer      ,customer_address      ,customer_demographics      ,household_demographics      ,income_band      ,store_returns  where ca_city\t        =  'Spring Valley'    and c_current_addr_sk = ca_address_sk    and ib_lower_bound   >=  2334    and ib_upper_bound   <=  2334 + 50000    and ib_income_band_sk = hd_income_band_sk    and cd_demo_sk = c_current_cdemo_sk    and hd_demo_sk = c_current_hdemo_sk    and sr_cdemo_sk = cd_demo_sk  order by c_customer_id  ;", "predicates": {"customer": ["c_current_cdemo_sk"], "customer_address": ["ca_city"], "income_band": ["ib_upper_bound", "ib_lower_bound"]}, "payload": {"customer": ["c_last_name", "c_first_name", "c_current_cdemo_sk", "c_current_addr_sk", "c_customer_id", "c_current_hdemo_sk"], "customer_address": ["ca_address_sk"], "household_demographics": ["hd_income_band_sk", "hd_demo_sk"], "income_band": ["ib_income_band_sk"], "store_returns": ["sr_cdemo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 85, "query_string": " select top (100) substring(r_reason_desc,1,20)        ,avg(ws_quantity)        ,avg(wr_refunded_cash)        ,avg(wr_fee)  from web_sales, web_returns, web_page, customer_demographics cd1,       customer_demographics cd2, customer_address, date_dim, reason   where ws_web_page_sk = wp_web_page_sk    and ws_item_sk = wr_item_sk    and ws_order_number = wr_order_number    and ws_sold_date_sk = d_date_sk and d_year = 1999    and cd1.cd_demo_sk = wr_refunded_cdemo_sk     and cd2.cd_demo_sk = wr_returning_cdemo_sk    and ca_address_sk = wr_refunded_addr_sk    and r_reason_sk = wr_reason_sk    and    (     (      cd1.cd_marital_status = 'M'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = '2 yr Degree'      and       cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 100.00 and 150.00     )    or     (      cd1.cd_marital_status = 'U'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'College'       and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 50.00 and 100.00     )    or     (      cd1.cd_marital_status = 'D'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = '4 yr Degree'      and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 150.00 and 200.00     )    )    and    (     (      ca_country = 'United States'      and      ca_state in ('TX', 'NC', 'MS')      and ws_net_profit between 100 and 200       )     or     (      ca_country = 'United States'      and      ca_state in ('NE', 'SD', 'HI')      and ws_net_profit between 150 and 300       )     or     (      ca_country = 'United States'      and      ca_state in ('UT', 'GA', 'PA')      and ws_net_profit between 50 and 250       )    ) group by r_reason_desc order by substring(r_reason_desc,1,20)         ,avg(ws_quantity)         ,avg(wr_refunded_cash)         ,avg(wr_fee);", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "web_sales": ["ws_net_profit", "ws_sales_price"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "reason": ["r_reason_desc", "r_reason_sk"], "web_page": ["wp_web_page_sk"], "web_returns": ["wr_returning_cdemo_sk", "wr_refunded_cdemo_sk", "wr_reason_sk", "wr_item_sk", "wr_refunded_cash", "wr_refunded_addr_sk", "wr_fee", "wr_order_number"], "web_sales": ["ws_net_profit", "ws_item_sk", "ws_sales_price", "ws_quantity", "ws_sold_date_sk", "ws_web_page_sk", "ws_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 86, "query_string": " select top (100)       sum(ws_net_paid) as total_sum    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  \tpartition by grouping(i_category)+grouping(i_class),  \tcase when grouping(i_class) = 0 then i_category end   \torder by sum(ws_net_paid) desc) as rank_within_parent  from     web_sales    ,date_dim       d1    ,item  where     d1.d_month_seq between 1215 and 1215+11  and d1.d_date_sk = ws_sold_date_sk  and i_item_sk  = ws_item_sk  group by rollup(i_category,i_class)  order by    lochierarchy desc,    case when (grouping(i_category)+grouping(i_class)) = 0 then i_category end,    rank_within_parent  ;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_class", "i_item_sk", "i_category"], "web_sales": ["ws_net_paid", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 87, "query_string": " select count(*)  from ((select distinct c_last_name, c_first_name, d_date        from store_sales, date_dim, customer        where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_customer_sk = customer.c_customer_sk          and d_month_seq between 1215 and 1215+11)        except       (select distinct c_last_name, c_first_name, d_date        from catalog_sales, date_dim, customer        where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk          and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk          and d_month_seq between 1215 and 1215+11)        except       (select distinct c_last_name, c_first_name, d_date        from web_sales, date_dim, customer        where web_sales.ws_sold_date_sk = date_dim.d_date_sk          and web_sales.ws_bill_customer_sk = customer.c_customer_sk          and d_month_seq between 1215 and 1215+11) ) cool_cust;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 88, "query_string": " select  * from  (select count(*) h8_30_to_9  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk         and ss_hdemo_sk = household_demographics.hd_demo_sk       and ss_store_sk = s_store_sk      and time_dim.t_hour = 8      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))       and store.s_store_name = 'ese') s1,  (select count(*) h9_to_9_30   from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk       and time_dim.t_hour = 9       and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))      and store.s_store_name = 'ese') s2,  (select count(*) h9_30_to_10   from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 9      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))      and store.s_store_name = 'ese') s3,  (select count(*) h10_to_10_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 10       and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))      and store.s_store_name = 'ese') s4,  (select count(*) h10_30_to_11  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 10       and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))      and store.s_store_name = 'ese') s5,  (select count(*) h11_to_11_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk       and time_dim.t_hour = 11      and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))      and store.s_store_name = 'ese') s6,  (select count(*) h11_30_to_12  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 11      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))      and store.s_store_name = 'ese') s7,  (select count(*) h12_to_12_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 12      and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2))      and store.s_store_name = 'ese') s8;", "predicates": {"household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_store_name"], "time_dim": ["t_hour", "t_minute"]}, "payload": {"household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_sold_time_sk"], "time_dim": ["t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 89, "query_string": " select top (100) * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (1999) and         ((i_category in ('Women','Shoes','Sports') and           i_class in ('swimwear','womens','baseball')          )       or (i_category in ('Home','Jewelry','Children') and           i_class in ('lighting','loose stones','school-uniforms')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name;", "predicates": {"date_dim": ["d_year"], "item": ["i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_brand", "i_class", "i_item_sk", "i_category"], "store": ["s_store_name", "s_store_sk", "s_company_name"]}, "group_by": {}, "order_by": {"store": ["s_store_name"]}}
{"id": 90, "query_string": " select top (100) cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio  from ( select count(*) amc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 12 and 12+1          and household_demographics.hd_dep_count = 9          and web_page.wp_char_count between 5000 and 5200) at,       ( select count(*) pmc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 17 and 17+1          and household_demographics.hd_dep_count = 9          and web_page.wp_char_count between 5000 and 5200) pt  order by am_pm_ratio  ;", "predicates": {"household_demographics": ["hd_dep_count"], "time_dim": ["t_hour"], "web_page": ["wp_char_count"]}, "payload": {"household_demographics": ["hd_demo_sk"], "time_dim": ["t_time_sk"], "web_page": ["wp_web_page_sk"], "web_sales": ["ws_sold_time_sk", "ws_web_page_sk", "ws_ship_hdemo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 91, "query_string": " select           cc_call_center_id Call_Center,         cc_name Call_Center_Name,         cc_manager Manager,         sum(cr_net_loss) Returns_Loss from         call_center,         catalog_returns,         date_dim,         customer,         customer_address,         customer_demographics,         household_demographics where         cr_call_center_sk       = cc_call_center_sk and     cr_returned_date_sk     = d_date_sk and     cr_returning_customer_sk= c_customer_sk and     cd_demo_sk              = c_current_cdemo_sk and     hd_demo_sk              = c_current_hdemo_sk and     ca_address_sk           = c_current_addr_sk and     d_year                  = 2001  and     d_moy                   = 12 and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')         or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree')) and     hd_buy_potential like '0-500%' and     ca_gmt_offset           = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc;", "predicates": {"customer_address": ["ca_gmt_offset"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_moy", "d_year"], "household_demographics": ["hd_buy_potential"]}, "payload": {"call_center": ["cc_name", "cc_call_center_id", "cc_manager", "cc_call_center_sk"], "catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_returning_customer_sk", "cr_call_center_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk", "c_current_hdemo_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 92, "query_string": " select top (100)     sum(ws_ext_discount_amt)  as \"Excess Discount Amount\"  from      web_sales     ,item     ,date_dim where i_manufact_id = 830 and i_item_sk = ws_item_sk  and d_date between '2000-03-20' and          dateadd(day, 90, cast('2000-03-20' as date)) and d_date_sk = ws_sold_date_sk  and ws_ext_discount_amt        > (           SELECT              1.3 * avg(ws_ext_discount_amt)           FROM              web_sales             ,date_dim          WHERE                ws_item_sk = i_item_sk            and d_date between '2000-03-20' and                              dateadd(day, 90, cast('2000-03-20' as date))           and d_date_sk = ws_sold_date_sk        )  order by sum(ws_ext_discount_amt);", "predicates": {"date_dim": ["d_date"], "item": ["i_manufact_id"], "web_sales": ["ws_ext_discount_amt"]}, "payload": {"item": ["i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 93, "query_string": " select top (100) ss_customer_sk             ,sum(act_sales) sumsales       from (select ss_item_sk                   ,ss_ticket_number                   ,ss_customer_sk                   ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price                                                             else (ss_quantity*ss_sales_price) end act_sales             from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk                                                                and sr_ticket_number = ss_ticket_number)                 ,reason             where sr_reason_sk = r_reason_sk               and r_reason_desc = 'reason 29') t       group by ss_customer_sk       order by sumsales, ss_customer_sk;", "predicates": {"reason": ["r_reason_desc"]}, "payload": {"reason": ["r_reason_sk"], "store_returns": ["sr_reason_sk", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"]}, "group_by": {}, "order_by": {"store_sales": ["ss_customer_sk"]}}
{"id": 94, "query_string": " select top (100)     count(distinct ws_order_number) as \"order count\"   ,sum(ws_ext_ship_cost) as \"total shipping cost\"   ,sum(ws_net_profit) as \"total net profit\" from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2000-4-01' and             dateadd(day, 60, cast('2000-4-01' as date)) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'SC' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number);", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_date"], "web_site": ["web_company_name"]}, "payload": {"customer_address": ["ca_address_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_net_profit", "ws_ship_date_sk", "ws_ship_addr_sk", "ws_ext_ship_cost", "ws_warehouse_sk", "ws_order_number", "ws_web_site_sk"], "web_site": ["web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 95, "query_string": " with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select top (100)     count(distinct ws_order_number) as \"order count\"   ,sum(ws_ext_ship_cost) as \"total shipping cost\"   ,sum(ws_net_profit) as \"total net profit\" from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2000-4-01' and             dateadd(day, 60, cast('2000-4-01' as date)) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'SC' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number);", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_date"], "web_site": ["web_company_name"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_net_profit", "ws_ship_date_sk", "ws_item_sk", "ws_ship_addr_sk", "ws_ext_ship_cost", "ws_warehouse_sk", "ws_order_number", "ws_web_site_sk"], "web_site": ["web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 96, "query_string": " select top (100) count(*)  from store_sales     ,household_demographics      ,time_dim, store where ss_sold_time_sk = time_dim.t_time_sk        and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk     and time_dim.t_hour = 16     and time_dim.t_minute >= 30     and household_demographics.hd_dep_count = 2     and store.s_store_name = 'ese' order by count(*);", "predicates": {"household_demographics": ["hd_dep_count"], "store": ["s_store_name"], "time_dim": ["t_hour", "t_minute"]}, "payload": {"household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_sold_time_sk"], "time_dim": ["t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 97, "query_string": " with ssci as ( select ss_customer_sk customer_sk       ,ss_item_sk item_sk from store_sales,date_dim where ss_sold_date_sk = d_date_sk   and d_month_seq between 1215 and 1215 + 11 group by ss_customer_sk         ,ss_item_sk), csci as(  select cs_bill_customer_sk customer_sk       ,cs_item_sk item_sk from catalog_sales,date_dim where cs_sold_date_sk = d_date_sk   and d_month_seq between 1215 and 1215 + 11 group by cs_bill_customer_sk         ,cs_item_sk)  select top (100) sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only       ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only       ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk                                and ssci.item_sk = csci.item_sk);", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk", "cs_item_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 98, "query_string": " select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from\t \tstore_sales     \t,item      \t,date_dim where  \tss_item_sk = i_item_sk    \tand i_category in ('Men', 'Jewelry', 'Shoes')   \tand ss_sold_date_sk = d_date_sk \tand d_date between cast('1998-03-03' as date)  \t\t\t\tand dateadd(day, 30, cast('1998-03-03' as date)) group by  \ti_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  \ti_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"]}, "group_by": {}, "order_by": {}}
{"id": 99, "query_string": " select top (100)     substring(w_warehouse_name,1,20)   ,sm_type   ,cc_name   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and                   (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and                   (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and                  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    catalog_sales   ,warehouse   ,ship_mode   ,call_center   ,date_dim where     d_month_seq between 1215 and 1215 + 11 and cs_ship_date_sk   = d_date_sk and cs_warehouse_sk   = w_warehouse_sk and cs_ship_mode_sk   = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by    substring(w_warehouse_name,1,20)   ,sm_type   ,cc_name order by substring(w_warehouse_name,1,20)         ,sm_type         ,cc_name;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"call_center": ["cc_name", "cc_call_center_sk"], "catalog_sales": ["cs_warehouse_sk", "cs_call_center_sk", "cs_ship_date_sk", "cs_ship_mode_sk", "cs_sold_date_sk"], "date_dim": ["d_date_sk"], "ship_mode": ["sm_type", "sm_ship_mode_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 1, "query_string": " with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sum(SR_STORE_CREDIT) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1998 group by sr_customer_sk ,sr_store_sk)  select top (100) c_customer_id from customer_total_return ctr1 ,store ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'TN' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id;", "predicates": {"date_dim": ["d_year"], "store": ["s_state"], "store_returns": ["sr_store_sk"]}, "payload": {"customer": ["c_customer_id", "c_customer_sk"], "date_dim": ["d_date_sk"], "store": ["s_store_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_customer_id"]}}
{"id": 2, "query_string": " with wscs as  (select sold_date_sk         ,sales_price   from (select ws_sold_date_sk sold_date_sk               ,ws_ext_sales_price sales_price         from web_sales          union all         select cs_sold_date_sk sold_date_sk               ,cs_ext_sales_price sales_price         from catalog_sales) a),  wswscs as   (select d_week_seq,         sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales  from wscs      ,date_dim  where d_date_sk = sold_date_sk  group by d_week_seq)  select d_week_seq1        ,round(sun_sales1/sun_sales2,2)        ,round(mon_sales1/mon_sales2,2)        ,round(tue_sales1/tue_sales2,2)        ,round(wed_sales1/wed_sales2,2)        ,round(thu_sales1/thu_sales2,2)        ,round(fri_sales1/fri_sales2,2)        ,round(sat_sales1/sat_sales2,2)  from  (select wswscs.d_week_seq d_week_seq1         ,sun_sales sun_sales1         ,mon_sales mon_sales1         ,tue_sales tue_sales1         ,wed_sales wed_sales1         ,thu_sales thu_sales1         ,fri_sales fri_sales1         ,sat_sales sat_sales1   from wswscs,date_dim    where date_dim.d_week_seq = wswscs.d_week_seq and         d_year = 2000) y,  (select wswscs.d_week_seq d_week_seq2         ,sun_sales sun_sales2         ,mon_sales mon_sales2         ,tue_sales tue_sales2         ,wed_sales wed_sales2         ,thu_sales thu_sales2         ,fri_sales fri_sales2         ,sat_sales sat_sales2   from wswscs       ,date_dim    where date_dim.d_week_seq = wswscs.d_week_seq and         d_year = 2000+1) z  where d_week_seq1=d_week_seq2-53  order by d_week_seq1;", "predicates": {"date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_week_seq", "d_day_name"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 3, "query_string": " select top (100) dt.d_year         ,item.i_brand_id brand_id         ,item.i_brand brand        ,sum(ss_ext_sales_price) sum_agg  from  date_dim dt        ,store_sales       ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk    and store_sales.ss_item_sk = item.i_item_sk    and item.i_manufact_id = 895    and dt.d_moy=11  group by dt.d_year       ,item.i_brand       ,item.i_brand_id  order by dt.d_year          ,sum_agg desc          ,brand_id  ;", "predicates": {"date_dim": ["d_moy"], "item": ["i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"date_dim": ["d_year"], "item": ["i_brand_id"]}}
{"id": 4, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year  union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total        ,'c' sale_type  from customer      ,catalog_sales      ,date_dim  where c_customer_sk = cs_bill_customer_sk    and cs_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year          )   select top (100)                    t_s_secyear.customer_id                  ,t_s_secyear.customer_first_name                  ,t_s_secyear.customer_last_name                  ,t_s_secyear.customer_email_address  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_c_firstyear      ,year_total t_c_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id    and t_s_firstyear.customer_id = t_c_secyear.customer_id    and t_s_firstyear.customer_id = t_c_firstyear.customer_id    and t_s_firstyear.customer_id = t_w_firstyear.customer_id    and t_s_firstyear.customer_id = t_w_secyear.customer_id    and t_s_firstyear.sale_type = 's'    and t_c_firstyear.sale_type = 'c'    and t_w_firstyear.sale_type = 'w'    and t_s_secyear.sale_type = 's'    and t_c_secyear.sale_type = 'c'    and t_w_secyear.sale_type = 'w'    and t_s_firstyear.dyear =  1999    and t_s_secyear.dyear = 1999+1    and t_c_firstyear.dyear =  1999    and t_c_secyear.dyear =  1999+1    and t_w_firstyear.dyear = 1999    and t_w_secyear.dyear = 1999+1    and t_s_firstyear.year_total > 0    and t_c_firstyear.year_total > 0    and t_w_firstyear.year_total > 0    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end            > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end  order by t_s_secyear.customer_id          ,t_s_secyear.customer_first_name          ,t_s_secyear.customer_last_name          ,t_s_secyear.customer_email_address;", "predicates": {"date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_ext_list_price", "cs_ext_discount_amt", "cs_bill_customer_sk", "cs_ext_sales_price", "cs_ext_wholesale_cost", "cs_sold_date_sk"], "customer": ["c_login", "c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id"], "date_dim": ["d_date_sk"], "store_sales": ["ss_ext_discount_amt", "ss_ext_sales_price", "ss_ext_wholesale_cost", "ss_customer_sk", "ss_ext_list_price", "ss_sold_date_sk"], "web_sales": ["ws_ext_discount_amt", "ws_ext_wholesale_cost", "ws_ext_list_price", "ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 5, "query_string": " with ssr as  (select s_store_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  ss_store_sk as store_sk,             ss_sold_date_sk  as date_sk,             ss_ext_sales_price as sales_price,             ss_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from store_sales     union all     select sr_store_sk as store_sk,            sr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            sr_return_amt as return_amt,            sr_net_loss as net_loss     from store_returns    ) salesreturns,      date_dim,      store  where date_sk = d_date_sk        and d_date between cast('2000-08-17' as date)                    and dateadd(day, 14, cast('2000-08-17' as date))        and store_sk = s_store_sk  group by s_store_id)  ,  csr as  (select cp_catalog_page_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  cs_catalog_page_sk as page_sk,             cs_sold_date_sk  as date_sk,             cs_ext_sales_price as sales_price,             cs_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from catalog_sales     union all     select cr_catalog_page_sk as page_sk,            cr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            cr_return_amount as return_amt,            cr_net_loss as net_loss     from catalog_returns    ) salesreturns,      date_dim,      catalog_page  where date_sk = d_date_sk        and d_date between cast('2000-08-17' as date)                   and dateadd(day, 14, cast('2000-08-17' as date))        and page_sk = cp_catalog_page_sk  group by cp_catalog_page_id)  ,  wsr as  (select web_site_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  ws_web_site_sk as wsr_web_site_sk,             ws_sold_date_sk  as date_sk,             ws_ext_sales_price as sales_price,             ws_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from web_sales     union all     select ws_web_site_sk as wsr_web_site_sk,            wr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            wr_return_amt as return_amt,            wr_net_loss as net_loss     from web_returns left outer join web_sales on          ( wr_item_sk = ws_item_sk            and wr_order_number = ws_order_number)    ) salesreturns,      date_dim,      web_site  where date_sk = d_date_sk        and d_date between cast('2000-08-17' as date)                   and dateadd(day, 14, cast('2000-08-17' as date))        and wsr_web_site_sk = web_site_sk  group by web_site_id)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , concat('store' , s_store_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from   ssr  union all  select 'catalog channel' as channel         , concat('catalog_page' , cp_catalog_page_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from  csr  union all  select 'web channel' as channel         , concat('web_site' , web_site_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from   wsr  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_page": ["cp_catalog_page_sk", "cp_catalog_page_id"], "catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_return_amount", "cr_catalog_page_sk"], "catalog_sales": ["cs_catalog_page_sk", "cs_net_profit", "cs_sold_date_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_net_loss"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit", "ss_ext_sales_price"], "web_returns": ["wr_returned_date_sk", "wr_return_amt", "wr_net_loss", "wr_item_sk", "wr_order_number"], "web_sales": ["ws_net_profit", "ws_ext_sales_price", "ws_sold_date_sk", "ws_web_site_sk"], "web_site": ["web_site_id", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 6, "query_string": " select top (100) a.ca_state state, count(*) cnt  from customer_address a      ,customer c      ,store_sales s      ,date_dim d      ,item i  where       a.ca_address_sk = c.c_current_addr_sk  \tand c.c_customer_sk = s.ss_customer_sk  \tand s.ss_sold_date_sk = d.d_date_sk  \tand s.ss_item_sk = i.i_item_sk  \tand d.d_month_seq =   \t     (select distinct (d_month_seq)  \t      from date_dim                where d_year = 1999  \t        and d_moy = 3 )  \tand i.i_current_price > 1.2 *               (select avg(j.i_current_price)   \t     from item j   \t     where j.i_category = i.i_category)  group by a.ca_state  having count(*) >= 10  order by cnt, a.ca_state   ;", "predicates": {"date_dim": ["d_month_seq", "d_moy", "d_year"], "item": ["i_category", "i_current_price"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk", "d_month_seq"], "item": ["i_item_sk", "i_category", "i_current_price"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_item_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_state"]}}
{"id": 7, "query_string": " select top (100) i_item_id,          avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4   from store_sales, customer_demographics, date_dim, item, promotion  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_cdemo_sk = cd_demo_sk and        ss_promo_sk = p_promo_sk and        cd_gender = 'F' and         cd_marital_status = 'D' and        cd_education_status = '2 yr Degree' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 2002   group by i_item_id  order by i_item_id  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "promotion": ["p_channel_event", "p_channel_email"]}, "payload": {"customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"], "promotion": ["p_promo_sk"], "store_sales": ["ss_promo_sk", "ss_item_sk", "ss_cdemo_sk", "ss_list_price", "ss_quantity", "ss_sales_price", "ss_coupon_amt", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 8, "query_string": " select top (100) s_store_name       ,sum(ss_net_profit)  from store_sales      ,date_dim      ,store,      (select ca_zip      from (       SELECT substring(ca_zip,1,5) ca_zip       FROM customer_address       WHERE substring(ca_zip,1,5) IN (                           '12095','93185','82873','17869','88068','90932',                           '66138','80240','36558','55263','19799',                           '48583','33722','11295','74233','73348',                           '77780','96255','97431','75049','39919',                           '38461','92857','43075','39101','85424',                           '94933','28540','87451','88870','89169',                           '38232','54292','20770','39862','83526',                           '64821','29852','42645','79178','72353',                           '30866','47291','65616','55180','84760',                           '80993','10072','97547','70452','33725',                           '59983','99205','29068','91888','59076',                           '32955','22398','33889','48424','16234',                           '83972','13209','80017','97109','63318',                           '26785','33936','65252','15987','89031',                           '39634','87505','61585','78611','88572',                           '59153','90442','36146','95328','59834',                           '64765','94016','11420','28764','19049',                           '14176','49442','41861','59158','50762',                           '97471','84408','63477','10325','11579',                           '58511','24323','17107','97844','34256',                           '86885','44080','90584','36569','89969',                           '17360','49413','31699','50865','84895',                           '67320','31387','77996','81922','48320',                           '67541','29540','37060','85714','84073',                           '28641','19463','93193','35678','93522',                           '30539','97397','41994','39290','90000',                           '43337','37676','94666','92218','62241',                           '56858','15190','59239','55036','75861',                           '81095','59377','84189','24590','87871',                           '91250','19043','32919','44686','12682',                           '68266','23071','96578','68442','19604',                           '35713','45049','46450','45828','51041',                           '43290','95426','56273','16745','24951',                           '14697','15525','65645','15272','42280',                           '66789','91622','23575','37458','59912',                           '22994','56087','73707','76409','78827',                           '69491','56066','70385','71870','32974',                           '40912','96430','69296','14112','31201',                           '50063','64824','45109','41363','64941',                           '39154','26102','44540','45626','12191',                           '70745','13540','56888','25112','20343',                           '83883','52323','19608','16458','13283',                           '74388','65011','83545','89102','29911',                           '60564','99030','83261','54560','56354',                           '49841','28406','47594','85708','69495',                           '35050','39831','80311','11184','91733',                           '46857','10942','16708','20445','29436',                           '78809','10940','30112','74140','91215',                           '48449','92463','20801','85616','79982',                           '18885','29909','84424','82681','59851',                           '82300','54121','93326','53630','85994',                           '53071','33138','53459','48383','95307',                           '64157','63864','40407','83291','36266',                           '42521','99359','52021','99275','89909',                           '69930','96511','80759','10472','93890',                           '96608','96819','46277','41367','64039',                           '66098','62053','88196','59468','68447',                           '82901','58204','90650','22968','69470',                           '77206','46881','77639','17150','14906',                           '79453','51376','62415','36000','24503',                           '44987','52990','51100','41865','36527',                           '33068','89556','18733','84779','32499',                           '73843','75570','23138','16303','34854',                           '22478','76595','86795','66087','24465',                           '61716','94701','56391','67536','37397',                           '72531','36745','79268','68574','99501',                           '61341','87311','75201','95123','13997',                           '78015','79482','85965','33529','98582',                           '88049','68250','29821','88485','85982',                           '20127','10505','61603','78647','59538',                           '93756','95409','65663','64027','40144',                           '23045','38941','37933','54851','39730',                           '32046','95525','95623','10010','82943',                           '55240','87145','29739','10086','80900',                           '60089','89389','50331','35745','50811',                           '84552','85114','85431','96583','67966',                           '49247','32160','60788','22716','23100',                           '17756','43326','42687','21172','18992',                           '13796','88482','38893','99195','50270',                           '11687','47020','25640','33390')      intersect       select ca_zip       from (SELECT substring(ca_zip,1,5) ca_zip,count(*) cnt             FROM customer_address, customer             WHERE ca_address_sk = c_current_addr_sk and                   c_preferred_cust_flag='Y'             group by ca_zip             having count(*) > 10)A1)A2) V1  where ss_store_sk = s_store_sk   and ss_sold_date_sk = d_date_sk   and d_qoy = 2 and d_year = 1998   and (substring(s_zip,1,2) = substring(V1.ca_zip,1,2))  group by s_store_name  order by s_store_name  ;", "predicates": {"customer": ["c_preferred_cust_flag"], "date_dim": ["d_qoy", "d_year"]}, "payload": {"customer": ["c_current_addr_sk"], "customer_address": ["ca_address_sk", "ca_zip"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 9, "query_string": " select case when (select count(*)                    from store_sales                    where ss_quantity between 1 and 20) > 39224             then (select avg(ss_ext_list_price)                    from store_sales                    where ss_quantity between 1 and 20)              else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 1 and 20) end bucket1 ,        case when (select count(*)                   from store_sales                   where ss_quantity between 21 and 40) > 31313             then (select avg(ss_ext_list_price)                   from store_sales                   where ss_quantity between 21 and 40)              else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 21 and 40) end bucket2,        case when (select count(*)                   from store_sales                   where ss_quantity between 41 and 60) > 29720             then (select avg(ss_ext_list_price)                   from store_sales                   where ss_quantity between 41 and 60)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 41 and 60) end bucket3,        case when (select count(*)                   from store_sales                   where ss_quantity between 61 and 80) > 15440             then (select avg(ss_ext_list_price)                   from store_sales                   where ss_quantity between 61 and 80)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 61 and 80) end bucket4,        case when (select count(*)                   from store_sales                   where ss_quantity between 81 and 100) > 2984             then (select avg(ss_ext_list_price)                   from store_sales                   where ss_quantity between 81 and 100)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 81 and 100) end bucket5 from reason where r_reason_sk = 1;", "predicates": {"store_sales": ["ss_quantity"]}, "payload": {"store_sales": ["ss_ext_tax", "ss_net_paid_inc_tax"]}, "group_by": {}, "order_by": {}}
{"id": 10, "query_string": " select top (100)    cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3,   cd_dep_count,   count(*) cnt4,   cd_dep_employed_count,   count(*) cnt5,   cd_dep_college_count,   count(*) cnt6  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_county in ('Chicot County','Roanoke city','Elbert County','Rush County','York County') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2001 and                 d_moy between 3 and 3+3) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 3 ANd 3+3) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 3 and 3+3))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count;", "predicates": {"customer_address": ["ca_county"], "date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 11, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag           ,c_birth_country          ,c_login          ,c_email_address          ,d_year   union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag           ,c_birth_country          ,c_login          ,c_email_address          ,d_year          )   select top (100)                    t_s_secyear.customer_id                  ,t_s_secyear.customer_first_name                  ,t_s_secyear.customer_last_name                  ,t_s_secyear.customer_email_address  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id          and t_s_firstyear.customer_id = t_w_secyear.customer_id          and t_s_firstyear.customer_id = t_w_firstyear.customer_id          and t_s_firstyear.sale_type = 's'          and t_w_firstyear.sale_type = 'w'          and t_s_secyear.sale_type = 's'          and t_w_secyear.sale_type = 'w'          and t_s_firstyear.dyear = 1999          and t_s_secyear.dyear = 1999+1          and t_w_firstyear.dyear = 1999          and t_w_secyear.dyear = 1999+1          and t_s_firstyear.year_total > 0          and t_w_firstyear.year_total > 0          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end              > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end  order by t_s_secyear.customer_id          ,t_s_secyear.customer_first_name          ,t_s_secyear.customer_last_name          ,t_s_secyear.customer_email_address;", "predicates": {"date_dim": ["d_year"]}, "payload": {"customer": ["c_login", "c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_ext_list_price", "ss_ext_discount_amt"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_discount_amt", "ws_ext_list_price"]}, "group_by": {}, "order_by": {}}
{"id": 12, "query_string": " select top (100) i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from\t \tweb_sales     \t,item      \t,date_dim where  \tws_item_sk = i_item_sk    \tand i_category in ('Books', 'Home', 'Men')   \tand ws_sold_date_sk = d_date_sk \tand d_date between cast('2000-04-27' as date)  \t\t\t\tand dateadd(day, 30, cast('2000-04-27' as date)) group by  \ti_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  \ti_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_desc", "i_class", "i_item_id", "i_category"]}}
{"id": 13, "query_string": " select avg(ss_quantity)        ,avg(ss_ext_sales_price)        ,avg(ss_ext_wholesale_cost)        ,sum(ss_ext_wholesale_cost)  from store_sales      ,store      ,customer_demographics      ,household_demographics      ,customer_address      ,date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2001  and((ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'D'   and cd_education_status = 'Unknown'   and ss_sales_price between 100.00 and 150.00   and hd_dep_count = 3         )or      (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'W'   and cd_education_status = 'Advanced Degree'   and ss_sales_price between 50.00 and 100.00      and hd_dep_count = 1      ) or       (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'U'   and cd_education_status = 'Secondary'   and ss_sales_price between 150.00 and 200.00    and hd_dep_count = 1        ))  and((ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('NE', 'GA', 'MS')   and ss_net_profit between 100 and 200        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('AR', 'KY', 'ID')   and ss_net_profit between 150 and 300        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('IA', 'VA', 'CA')   and ss_net_profit between 50 and 250        ));", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "household_demographics": ["hd_dep_count"], "store_sales": ["ss_sales_price", "ss_net_profit"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_dep_count", "hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_ext_sales_price", "ss_cdemo_sk", "ss_addr_sk", "ss_quantity", "ss_sales_price", "ss_ext_wholesale_cost", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 14, "query_string": " with  cross_items as  (select i_item_sk ss_item_sk  from item,  (select iss.i_brand_id brand_id      ,iss.i_class_id class_id      ,iss.i_category_id category_id  from store_sales      ,item iss      ,date_dim d1  where ss_item_sk = iss.i_item_sk    and ss_sold_date_sk = d1.d_date_sk    and d1.d_year between 2000 AND 2000 + 2  intersect   select ics.i_brand_id      ,ics.i_class_id      ,ics.i_category_id  from catalog_sales      ,item ics      ,date_dim d2  where cs_item_sk = ics.i_item_sk    and cs_sold_date_sk = d2.d_date_sk    and d2.d_year between 2000 AND 2000 + 2  intersect  select iws.i_brand_id      ,iws.i_class_id      ,iws.i_category_id  from web_sales      ,item iws      ,date_dim d3  where ws_item_sk = iws.i_item_sk    and ws_sold_date_sk = d3.d_date_sk    and d3.d_year between 2000 AND 2000 + 2) a  where i_brand_id = brand_id       and i_class_id = class_id       and i_category_id = category_id ),  avg_sales as  (select avg(quantity*list_price) average_sales   from (select ss_quantity quantity              ,ss_list_price list_price        from store_sales            ,date_dim        where ss_sold_date_sk = d_date_sk          and d_year between 2000 and 2000 + 2        union all         select cs_quantity quantity               ,cs_list_price list_price        from catalog_sales            ,date_dim        where cs_sold_date_sk = d_date_sk          and d_year between 2000 and 2000 + 2         union all        select ws_quantity quantity              ,ws_list_price list_price        from web_sales            ,date_dim        where ws_sold_date_sk = d_date_sk          and d_year between 2000 and 2000 + 2) x)   select top (100) channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)  from(        select 'store' channel, i_brand_id,i_class_id              ,i_category_id,sum(ss_quantity*ss_list_price) sales              , count(*) number_sales        from store_sales            ,item            ,date_dim        where ss_item_sk in (select ss_item_sk from cross_items)          and ss_item_sk = i_item_sk          and ss_sold_date_sk = d_date_sk          and d_year = 2000+2           and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)        union all        select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales        from catalog_sales            ,item            ,date_dim        where cs_item_sk in (select ss_item_sk from cross_items)          and cs_item_sk = i_item_sk          and cs_sold_date_sk = d_date_sk          and d_year = 2000+2           and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)        union all        select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales        from web_sales            ,item            ,date_dim        where ws_item_sk in (select ss_item_sk from cross_items)          and ws_item_sk = i_item_sk          and ws_sold_date_sk = d_date_sk          and d_year = 2000+2          and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)  ) y  group by rollup (channel, i_brand_id,i_class_id,i_category_id)  order by channel,i_brand_id,i_class_id,i_category_id  ; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_list_price", "cs_quantity"], "date_dim": ["d_date_sk"], "item": ["i_category_id", "i_class_id", "i_item_sk", "i_brand_id"], "store_sales": ["ss_sold_date_sk", "ss_list_price", "ss_quantity", "ss_item_sk"], "web_sales": ["ws_list_price", "ws_sold_date_sk", "ws_item_sk", "ws_quantity"]}, "group_by": {}, "order_by": {}}
{"id": 15, "query_string": " select top (100) ca_zip        ,sum(cs_sales_price)  from catalog_sales      ,customer      ,customer_address      ,date_dim  where cs_bill_customer_sk = c_customer_sk  \tand c_current_addr_sk = ca_address_sk   \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',                                    '85392', '85460', '80348', '81792')  \t      or ca_state in ('CA','WA','GA')  \t      or cs_sales_price > 500)  \tand cs_sold_date_sk = d_date_sk  \tand d_qoy = 2 and d_year = 1999  group by ca_zip  order by ca_zip  ;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"catalog_sales": ["cs_sales_price", "cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip", "ca_state"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_zip"]}}
{"id": 16, "query_string": " select top (100)     count(distinct cs_order_number) as \"order count\"   ,sum(cs_ext_ship_cost) as \"total shipping cost\"   ,sum(cs_net_profit) as \"total net profit\" from    catalog_sales cs1   ,date_dim   ,customer_address   ,call_center where     d_date between '2000-4-01' and             dateadd(day, 60, cast('2000-4-01' as date)) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'WI' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County',                   'Williamson County' ) and exists (select *             from catalog_sales cs2             where cs1.cs_order_number = cs2.cs_order_number               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select *                from catalog_returns cr1                where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number);", "predicates": {"call_center": ["cc_county"], "customer_address": ["ca_state"], "date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_order_number"], "catalog_sales": ["cs_order_number", "cs_warehouse_sk", "cs_ext_ship_cost", "cs_ship_addr_sk", "cs_net_profit", "cs_call_center_sk", "cs_ship_date_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 17, "query_string": " select top (100) i_item_id        ,i_item_desc        ,s_state        ,count(ss_quantity) as store_sales_quantitycount        ,avg(ss_quantity) as store_sales_quantityave        ,stdev(ss_quantity) as store_sales_quantitystdev        ,stdev(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov        ,count(sr_return_quantity) as store_returns_quantitycount        ,avg(sr_return_quantity) as store_returns_quantityave        ,stdev(sr_return_quantity) as store_returns_quantitystdev        ,stdev(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov        ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave        ,stdev(cs_quantity) as catalog_sales_quantitystdev        ,stdev(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov  from store_sales      ,store_returns      ,catalog_sales      ,date_dim d1      ,date_dim d2      ,date_dim d3      ,store      ,item  where d1.d_quarter_name = '1998Q1'    and d1.d_date_sk = ss_sold_date_sk    and i_item_sk = ss_item_sk    and s_store_sk = ss_store_sk    and ss_customer_sk = sr_customer_sk    and ss_item_sk = sr_item_sk    and ss_ticket_number = sr_ticket_number    and sr_returned_date_sk = d2.d_date_sk    and d2.d_quarter_name in ('1998Q1','1998Q2','1998Q3')    and sr_customer_sk = cs_bill_customer_sk    and sr_item_sk = cs_item_sk    and cs_sold_date_sk = d3.d_date_sk    and d3.d_quarter_name in ('1998Q1','1998Q2','1998Q3')  group by i_item_id          ,i_item_desc          ,s_state  order by i_item_id          ,i_item_desc          ,s_state;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_quarter_name"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_state", "s_store_sk"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_return_quantity", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 18, "query_string": " select top (100) i_item_id,         ca_country,         ca_state,          ca_county,         avg( cast(cs_quantity as decimal(12,2))) agg1,         avg( cast(cs_list_price as decimal(12,2))) agg2,         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,         avg( cast(cs_sales_price as decimal(12,2))) agg4,         avg( cast(cs_net_profit as decimal(12,2))) agg5,         avg( cast(c_birth_year as decimal(12,2))) agg6,         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7  from catalog_sales, customer_demographics cd1,        customer_demographics cd2, customer, customer_address, date_dim, item  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd1.cd_demo_sk and        cs_bill_customer_sk = c_customer_sk and        cd1.cd_gender = 'F' and         cd1.cd_education_status = 'College' and        c_current_cdemo_sk = cd2.cd_demo_sk and        c_current_addr_sk = ca_address_sk and        c_birth_month in (9,1,10,11,3,7) and        d_year = 2001 and        ca_state in ('GA','NY','KY'                    ,'CA','IL','VA','VT')  group by rollup (i_item_id, ca_country, ca_state, ca_county)  order by ca_country,         ca_state,          ca_county, \ti_item_id  ;", "predicates": {"customer": ["c_birth_month"], "customer_address": ["ca_state"], "customer_demographics": ["cd_education_status", "cd_gender"], "date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_quantity", "cs_sales_price", "cs_bill_customer_sk", "cs_item_sk", "cs_net_profit", "cs_list_price", "cs_coupon_amt", "cs_sold_date_sk", "cs_bill_cdemo_sk"], "customer": ["c_birth_year", "c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_county", "ca_country", "ca_state"], "customer_demographics": ["cd_demo_sk", "cd_dep_count"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_state", "ca_county", "ca_country"], "item": ["i_item_id"]}}
{"id": 19, "query_string": " select top (100) i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,  \tsum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item,customer,customer_address,store  where d_date_sk = ss_sold_date_sk    and ss_item_sk = i_item_sk    and i_manager_id=10    and d_moy=11    and d_year=1999    and ss_customer_sk = c_customer_sk     and c_current_addr_sk = ca_address_sk    and substring(ca_zip,1,5) <> substring(s_zip,1,5)     and ss_store_sk = s_store_sk   group by i_brand       ,i_brand_id       ,i_manufact_id       ,i_manufact  order by ext_price desc          ,i_brand          ,i_brand_id          ,i_manufact_id          ,i_manufact  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip"], "date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_brand_id", "i_manufact_id", "i_brand", "i_manufact"], "store": ["s_zip", "s_store_sk"]}, "group_by": {}, "order_by": {"item": ["i_brand", "i_manufact", "i_brand_id", "i_manufact_id"]}}
{"id": 20, "query_string": " select top (100) i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from\tcatalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Books', 'Home', 'Men')    and cs_sold_date_sk = d_date_sk  and d_date between cast('2000-04-27' as date)   \t\t\t\tand dateadd(day, 30, cast('2000-04-27' as date))  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"]}, "group_by": {}, "order_by": {"item": ["i_item_desc", "i_class", "i_item_id", "i_category"]}}
{"id": 21, "query_string": " select top (100) *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-13' as date)) \t                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-13' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between dateadd(day, -30, cast ('2000-05-13' as date))                     and dateadd(day, 30, cast ('2000-05-13' as date))    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  ;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"]}, "payload": {"date_dim": ["d_date_sk", "d_date"], "item": ["i_item_id", "i_item_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 22, "query_string": " select top (100) i_product_name              ,i_brand              ,i_class              ,i_category              ,avg(inv_quantity_on_hand) qoh        from inventory            ,date_dim            ,item        where inv_date_sk=d_date_sk               and inv_item_sk=i_item_sk               and d_month_seq between 1205 and 1205 + 11        group by rollup(i_product_name                        ,i_brand                        ,i_class                        ,i_category) order by qoh, i_product_name, i_brand, i_class, i_category;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_brand", "i_product_name", "i_category", "i_class"]}, "group_by": {}, "order_by": {"item": ["i_product_name", "i_class", "i_brand", "i_category"]}}
{"id": 23, "query_string": " with frequent_ss_items as   (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt   from store_sales       ,date_dim        ,item   where ss_sold_date_sk = d_date_sk     and ss_item_sk = i_item_sk      and d_year in (2000,2000+1,2000+2,2000+3)   group by substring(i_item_desc,1,30),i_item_sk,d_date   having count(*) >4),  max_store_sales as  (select max(csales) tpcds_cmax    from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales         from store_sales             ,customer             ,date_dim          where ss_customer_sk = c_customer_sk          and ss_sold_date_sk = d_date_sk          and d_year in (2000,2000+1,2000+2,2000+3)          group by c_customer_sk) a),  best_ss_customer as  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales   from store_sales       ,customer   where ss_customer_sk = c_customer_sk   group by c_customer_sk   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select   * from  max_store_sales))   select top (100) sum(sales)  from (select cs_quantity*cs_list_price sales        from catalog_sales            ,date_dim         where d_year = 2000           and d_moy = 5           and cs_sold_date_sk = d_date_sk           and cs_item_sk in (select item_sk from frequent_ss_items)          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)       union all       select ws_quantity*ws_list_price sales        from web_sales             ,date_dim         where d_year = 2000           and d_moy = 5           and ws_sold_date_sk = d_date_sk           and ws_item_sk in (select item_sk from frequent_ss_items)          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) b  ; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"customer": ["c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "item": ["i_item_sk", "i_item_desc"], "store_sales": ["ss_item_sk", "ss_sales_price", "ss_customer_sk", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 24, "query_string": " with ssales as (select c_last_name       ,c_first_name       ,s_store_name       ,ca_state       ,s_state       ,i_color       ,i_current_price       ,i_manager_id       ,i_units       ,i_size       ,sum(ss_net_paid_inc_tax) netpaid from store_sales     ,store_returns     ,store     ,item     ,customer     ,customer_address where ss_ticket_number = sr_ticket_number   and ss_item_sk = sr_item_sk   and ss_customer_sk = c_customer_sk   and ss_item_sk = i_item_sk   and ss_store_sk = s_store_sk   and c_current_addr_sk = ca_address_sk   and c_birth_country <> upper(ca_country)   and s_zip = ca_zip and s_market_id=10 group by c_last_name         ,c_first_name         ,s_store_name         ,ca_state         ,s_state         ,i_color         ,i_current_price         ,i_manager_id         ,i_units         ,i_size) select c_last_name       ,c_first_name       ,s_store_name       ,sum(netpaid) paid from ssales where i_color = 'honeydew' group by c_last_name         ,c_first_name         ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid)                                  from ssales) order by c_last_name         ,c_first_name         ,s_store_name; ", "predicates": {"item": ["i_color"], "store": ["s_market_id"]}, "payload": {"customer": ["c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_current_addr_sk"], "customer_address": ["ca_address_sk", "ca_country", "ca_zip", "ca_state"], "item": ["i_item_sk", "i_units", "i_manager_id", "i_current_price", "i_size"], "store": ["s_zip", "s_store_name", "s_state", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_net_paid_inc_tax"]}, "group_by": {}, "order_by": {}}
{"id": 25, "query_string": " select top (100)   i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  ,max(ss_net_profit) as store_sales_profit  ,max(sr_net_loss) as store_returns_loss  ,max(cs_net_profit) as catalog_sales_profit  from  store_sales  ,store_returns  ,catalog_sales  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,item  where  d1.d_moy = 4  and d1.d_year = 1999  and d1.d_date_sk = ss_sold_date_sk  and i_item_sk = ss_item_sk  and s_store_sk = ss_store_sk  and ss_customer_sk = sr_customer_sk  and ss_item_sk = sr_item_sk  and ss_ticket_number = sr_ticket_number  and sr_returned_date_sk = d2.d_date_sk  and d2.d_moy               between 4 and  10  and d2.d_year              = 1999  and sr_customer_sk = cs_bill_customer_sk  and sr_item_sk = cs_item_sk  and cs_sold_date_sk = d3.d_date_sk  and d3.d_moy               between 4 and  10   and d3.d_year              = 1999  group by  i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  order by  i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  ;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_store_name", "s_store_sk", "s_store_id"], "store_returns": ["sr_returned_date_sk", "sr_net_loss", "sr_customer_sk", "sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 26, "query_string": " select top (100) i_item_id,          avg(cs_quantity) agg1,         avg(cs_list_price) agg2,         avg(cs_coupon_amt) agg3,         avg(cs_sales_price) agg4   from catalog_sales, customer_demographics, date_dim, item, promotion  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd_demo_sk and        cs_promo_sk = p_promo_sk and        cd_gender = 'F' and         cd_marital_status = 'D' and        cd_education_status = '2 yr Degree' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 2002   group by i_item_id  order by i_item_id  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "promotion": ["p_channel_event", "p_channel_email"]}, "payload": {"item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 27, "query_string": " select top (100) i_item_id,         s_state, grouping(s_state) g_state,         avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4  from store_sales, customer_demographics, date_dim, store, item  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_store_sk = s_store_sk and        ss_cdemo_sk = cd_demo_sk and        cd_gender = 'F' and        cd_marital_status = 'S' and        cd_education_status = 'College' and        d_year = 1998 and        s_state in ('TN','TN', 'TN', 'TN', 'TN', 'TN')  group by rollup (i_item_id, s_state)  order by i_item_id          ,s_state  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "store": ["s_state"]}, "payload": {"customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"], "store": ["s_state", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_cdemo_sk", "ss_list_price", "ss_quantity", "ss_sales_price", "ss_coupon_amt", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_id"], "store": ["s_state"]}}
{"id": 28, "query_string": " select top (100) * from (select avg(ss_list_price) B1_LP             ,count(ss_list_price) B1_CNT             ,count(distinct ss_list_price) B1_CNTD       from store_sales       where ss_quantity between 0 and 5         and (ss_list_price between 94 and 94+10               or ss_coupon_amt between 17462 and 17462+1000              or ss_wholesale_cost between 51 and 51+20)) B1,      (select avg(ss_list_price) B2_LP             ,count(ss_list_price) B2_CNT             ,count(distinct ss_list_price) B2_CNTD       from store_sales       where ss_quantity between 6 and 10         and (ss_list_price between 43 and 43+10           or ss_coupon_amt between 15321 and 15321+1000           or ss_wholesale_cost between 61 and 61+20)) B2,      (select avg(ss_list_price) B3_LP             ,count(ss_list_price) B3_CNT             ,count(distinct ss_list_price) B3_CNTD       from store_sales       where ss_quantity between 11 and 15         and (ss_list_price between 11 and 11+10           or ss_coupon_amt between 12405 and 12405+1000           or ss_wholesale_cost between 1 and 1+20)) B3,      (select avg(ss_list_price) B4_LP             ,count(ss_list_price) B4_CNT             ,count(distinct ss_list_price) B4_CNTD       from store_sales       where ss_quantity between 16 and 20         and (ss_list_price between 180 and 180+10           or ss_coupon_amt between 4612 and 4612+1000           or ss_wholesale_cost between 30 and 30+20)) B4,      (select avg(ss_list_price) B5_LP             ,count(ss_list_price) B5_CNT             ,count(distinct ss_list_price) B5_CNTD       from store_sales       where ss_quantity between 21 and 25         and (ss_list_price between 26 and 26+10           or ss_coupon_amt between 5850 and 5850+1000           or ss_wholesale_cost between 24 and 24+20)) B5,      (select avg(ss_list_price) B6_LP             ,count(ss_list_price) B6_CNT             ,count(distinct ss_list_price) B6_CNTD       from store_sales       where ss_quantity between 26 and 30         and (ss_list_price between 9 and 9+10           or ss_coupon_amt between 12210 and 12210+1000           or ss_wholesale_cost between 33 and 33+20)) B6;", "predicates": {"store_sales": ["ss_list_price", "ss_coupon_amt", "ss_quantity", "ss_wholesale_cost"]}, "payload": {"store_sales": ["ss_list_price"]}, "group_by": {}, "order_by": {}}
{"id": 29, "query_string": " select top (100)        i_item_id     ,i_item_desc     ,s_store_id     ,s_store_name     ,stdev(ss_quantity)        as store_sales_quantity     ,stdev(sr_return_quantity) as store_returns_quantity     ,stdev(cs_quantity)        as catalog_sales_quantity  from     store_sales    ,store_returns    ,catalog_sales    ,date_dim             d1    ,date_dim             d2    ,date_dim             d3    ,store    ,item  where      d1.d_moy               = 4   and d1.d_year              = 2000  and d1.d_date_sk           = ss_sold_date_sk  and i_item_sk              = ss_item_sk  and s_store_sk             = ss_store_sk  and ss_customer_sk         = sr_customer_sk  and ss_item_sk             = sr_item_sk  and ss_ticket_number       = sr_ticket_number  and sr_returned_date_sk    = d2.d_date_sk  and d2.d_moy               between 4 and  4 + 3   and d2.d_year              = 2000  and sr_customer_sk         = cs_bill_customer_sk  and sr_item_sk             = cs_item_sk  and cs_sold_date_sk        = d3.d_date_sk       and d3.d_year              in (2000,2000+1,2000+2)  group by     i_item_id    ,i_item_desc    ,s_store_id    ,s_store_name  order by     i_item_id     ,i_item_desc    ,s_store_id    ,s_store_name  ;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_store_name", "s_store_sk", "s_store_id"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_return_quantity", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 30, "query_string": " with customer_total_return as  (select wr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   \tsum(wr_return_amt) as ctr_total_return  from web_returns      ,date_dim      ,customer_address  where wr_returned_date_sk = d_date_sk     and d_year =2002    and wr_returning_addr_sk = ca_address_sk   group by wr_returning_customer_sk          ,ca_state)   select top (100) c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag        ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address        ,c_last_review_date,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  \t\t\t  from customer_total_return ctr2                    \t  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'NM'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag                   ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address                   ,c_last_review_date,ctr_total_return;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_year"]}, "payload": {"customer": ["c_birth_year", "c_login", "c_customer_sk", "c_birth_month", "c_salutation", "c_birth_day", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_current_addr_sk", "c_email_address", "c_customer_id", "c_last_review_date"], "customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "web_returns": ["wr_return_amt", "wr_returning_addr_sk", "wr_returned_date_sk", "wr_returning_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_birth_year", "c_login", "c_birth_month", "c_birth_country", "c_salutation", "c_birth_day", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id", "c_last_review_date"]}}
{"id": 31, "query_string": " with ss as  (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales  from store_sales,date_dim,customer_address  where ss_sold_date_sk = d_date_sk   and ss_addr_sk=ca_address_sk  group by ca_county,d_qoy, d_year),  ws as  (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales  from web_sales,date_dim,customer_address  where ws_sold_date_sk = d_date_sk   and ws_bill_addr_sk=ca_address_sk  group by ca_county,d_qoy, d_year)  select          ss1.ca_county        ,ss1.d_year        ,ws2.web_sales/ws1.web_sales web_q1_q2_increase        ,ss2.store_sales/ss1.store_sales store_q1_q2_increase        ,ws3.web_sales/ws2.web_sales web_q2_q3_increase        ,ss3.store_sales/ss2.store_sales store_q2_q3_increase  from         ss ss1        ,ss ss2        ,ss ss3        ,ws ws1        ,ws ws2        ,ws ws3  where     ss1.d_qoy = 1     and ss1.d_year = 1999     and ss1.ca_county = ss2.ca_county     and ss2.d_qoy = 2     and ss2.d_year = 1999  and ss2.ca_county = ss3.ca_county     and ss3.d_qoy = 3     and ss3.d_year = 1999     and ss1.ca_county = ws1.ca_county     and ws1.d_qoy = 1     and ws1.d_year = 1999     and ws1.ca_county = ws2.ca_county     and ws2.d_qoy = 2     and ws2.d_year = 1999     and ws1.ca_county = ws3.ca_county     and ws3.d_qoy = 3     and ws3.d_year =1999     and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end         > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end     and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end        > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end  order by store_q1_q2_increase;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"customer_address": ["ca_address_sk", "ca_county"], "date_dim": ["d_date_sk", "d_year"], "store_sales": ["ss_sold_date_sk", "ss_addr_sk", "ss_ext_sales_price"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_bill_addr_sk"]}, "group_by": {}, "order_by": {}}
{"id": 32, "query_string": " select top (100) sum(cs_ext_discount_amt)  as \"excess discount amount\"  from     catalog_sales     ,item     ,date_dim where i_manufact_id = 357 and i_item_sk = cs_item_sk  and d_date between '2002-03-20' and          dateadd(day, 90, cast('2002-03-20' as date)) and d_date_sk = cs_sold_date_sk  and cs_ext_discount_amt        > (           select              1.3 * avg(cs_ext_discount_amt)           from              catalog_sales             ,date_dim          where                cs_item_sk = i_item_sk            and d_date between '2002-03-20' and                              dateadd(day, 90, cast('2002-03-20' as date))           and d_date_sk = cs_sold_date_sk        ) ;", "predicates": {"catalog_sales": ["cs_ext_discount_amt"], "date_dim": ["d_date"], "item": ["i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 33, "query_string": " with ss as (  select           i_manufact_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id in (select   i_manufact_id from  item where i_category in ('Sports'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 1  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  cs as (  select           i_manufact_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Sports'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 1  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  ws as (  select           i_manufact_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Sports'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 1  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_manufact_id)   select top (100) i_manufact_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_manufact_id  order by total_sales;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_category"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_addr_sk", "cs_item_sk", "cs_ext_sales_price"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_manufact_id"], "store_sales": ["ss_sold_date_sk", "ss_addr_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk", "ws_bill_addr_sk"]}, "group_by": {}, "order_by": {}}
{"id": 34, "query_string": " select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '1001-5000' or          household_demographics.hd_buy_potential = '5001-10000')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  \tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  \telse null  \tend)  > 1.2     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',                            'Williamson County','Williamson County','Williamson County','Williamson County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;", "predicates": {"date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count", "hd_buy_potential"], "store": ["s_county"]}, "payload": {"customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_preferred_cust_flag"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 35, "query_string": " select top (100)     ca_state,   cd_gender,   cd_marital_status,   cd_dep_count,   count(*) cnt1,   max(cd_dep_count),   stdev(cd_dep_count),   stdev(cd_dep_count),   cd_dep_employed_count,   count(*) cnt2,   max(cd_dep_employed_count),   stdev(cd_dep_employed_count),   stdev(cd_dep_employed_count),   cd_dep_college_count,   count(*) cnt3,   max(cd_dep_college_count),   stdev(cd_dep_college_count),   stdev(cd_dep_college_count)  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2000 and                 d_qoy < 4) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2000 and                   d_qoy < 4) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2000 and                   d_qoy < 4))  group by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  ;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_state"], "customer_demographics": ["cd_dep_college_count", "cd_gender", "cd_demo_sk", "cd_dep_employed_count", "cd_dep_count", "cd_marital_status"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 36, "query_string": " select top (100)      sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  \tpartition by grouping(i_category)+grouping(i_class),  \tcase when grouping(i_class) = 0 then i_category end   \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent  from     store_sales    ,date_dim       d1    ,item    ,store  where     d1.d_year = 1999   and d1.d_date_sk = ss_sold_date_sk  and i_item_sk  = ss_item_sk   and s_store_sk  = ss_store_sk  and s_state in ('TN','TN','TN','TN',                  'TN','TN','TN','TN')  group by rollup(i_category,i_class)  order by    lochierarchy desc   ,case when (grouping(i_category)+grouping(i_class)) = 0 then i_category end   ,rank_within_parent   ;", "predicates": {"date_dim": ["d_year"], "store": ["s_state"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_class", "i_item_sk", "i_category"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_ext_sales_price", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 37, "query_string": " select top (100) i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 48 and 48 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('1999-04-28' as date) and dateadd(day, 60, cast('1999-04-28' as date))  and i_manufact_id in (678,915,891,784)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  ;", "predicates": {"date_dim": ["d_date"], "inventory": ["inv_quantity_on_hand"], "item": ["i_current_price", "i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc", "i_current_price"]}, "group_by": {}, "order_by": {}}
{"id": 38, "query_string": " select top (100) count(*) from (     select distinct c_last_name, c_first_name, d_date     from store_sales, date_dim, customer           where store_sales.ss_sold_date_sk = date_dim.d_date_sk       and store_sales.ss_customer_sk = customer.c_customer_sk       and d_month_seq between 1205 and 1205 + 11   intersect     select distinct c_last_name, c_first_name, d_date     from catalog_sales, date_dim, customer           where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk       and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk       and d_month_seq between 1205 and 1205 + 11   intersect     select distinct c_last_name, c_first_name, d_date     from web_sales, date_dim, customer           where web_sales.ws_sold_date_sk = date_dim.d_date_sk       and web_sales.ws_bill_customer_sk = customer.c_customer_sk       and d_month_seq between 1205 and 1205 + 11 ) hot_cust;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk", "ws_item_sk", "ws_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 39, "query_string": " with inv as (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy        ,stdev,mean, case mean when 0 then null else stdev/mean end cov  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy             ,stdev(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean       from inventory           ,item           ,warehouse           ,date_dim       where inv_item_sk = i_item_sk         and inv_warehouse_sk = w_warehouse_sk         and inv_date_sk = d_date_sk         and d_year =2000       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo  where case mean when 0 then 0 else stdev/mean end > 1) select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov from inv inv1,inv inv2 where inv1.i_item_sk = inv2.i_item_sk   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk   and inv1.d_moy=2   and inv2.d_moy=2+1 order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov         ,inv2.d_moy,inv2.mean, inv2.cov; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_item_sk"], "warehouse": ["w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 40, "query_string": " select top (100)     w_state   ,i_item_id   ,sum(case when (cast(d_date as date) < cast ('2000-05-13' as date))   \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before   ,sum(case when (cast(d_date as date) >= cast ('2000-05-13' as date))   \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after  from    catalog_sales left outer join catalog_returns on        (cs_order_number = cr_order_number          and cs_item_sk = cr_item_sk)   ,warehouse    ,item   ,date_dim  where      i_current_price between 0.99 and 1.49  and i_item_sk          = cs_item_sk  and cs_warehouse_sk    = w_warehouse_sk   and cs_sold_date_sk    = d_date_sk  and d_date between dateadd(day, -30, cast ('2000-05-13' as date))                 and dateadd(day, 30, cast ('2000-05-13' as date))   group by     w_state,i_item_id  order by w_state,i_item_id;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_refunded_cash"], "date_dim": ["d_date_sk", "d_date"], "item": ["i_item_id", "i_item_sk"], "warehouse": ["w_state", "w_warehouse_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_id"], "warehouse": ["w_state"]}}
{"id": 41, "query_string": " select distinct top (100) i_product_name  from item i1  where i_manufact_id between 850 and 850+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'plum' or i_color = 'purple') and          (i_units = 'Oz' or i_units = 'Unknown') and         (i_size = 'small' or i_size = 'petite')         ) or         (i_category = 'Women' and         (i_color = 'saddle' or i_color = 'snow') and         (i_units = 'Bunch' or i_units = 'Ounce') and         (i_size = 'N/A' or i_size = 'extra large')         ) or         (i_category = 'Men' and         (i_color = 'smoke' or i_color = 'maroon') and         (i_units = 'Lb' or i_units = 'Dozen') and         (i_size = 'large' or i_size = 'medium')         ) or         (i_category = 'Men' and         (i_color = 'indian' or i_color = 'black') and         (i_units = 'Gross' or i_units = 'Cup') and         (i_size = 'small' or i_size = 'petite')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'red' or i_color = 'olive') and          (i_units = 'Case' or i_units = 'Pallet') and         (i_size = 'small' or i_size = 'petite')         ) or         (i_category = 'Women' and         (i_color = 'powder' or i_color = 'seashell') and         (i_units = 'Box' or i_units = 'Dram') and         (i_size = 'N/A' or i_size = 'extra large')         ) or         (i_category = 'Men' and         (i_color = 'turquoise' or i_color = 'pale') and         (i_units = 'Each' or i_units = 'Bundle') and         (i_size = 'large' or i_size = 'medium')         ) or         (i_category = 'Men' and         (i_color = 'blanched' or i_color = 'honeydew') and         (i_units = 'Tsp' or i_units = 'N/A') and         (i_size = 'small' or i_size = 'petite')         )))) > 0  order by i_product_name  ;", "predicates": {"item": ["i_color", "i_units", "i_manufact_id", "i_category", "i_size", "i_manufact"]}, "payload": {"item": ["i_color", "i_units", "i_product_name", "i_category", "i_size", "i_manufact"]}, "group_by": {}, "order_by": {}}
{"id": 42, "query_string": " select top (100) dt.d_year  \t,item.i_category_id  \t,item.i_category  \t,sum(ss_ext_sales_price)  from \tdate_dim dt  \t,store_sales  \t,item  where dt.d_date_sk = store_sales.ss_sold_date_sk  \tand store_sales.ss_item_sk = item.i_item_sk  \tand item.i_manager_id = 1  \t  \tand dt.d_moy=12  \tand dt.d_year=2000  group by \tdt.d_year  \t\t,item.i_category_id  \t\t,item.i_category  order by       sum(ss_ext_sales_price) desc,dt.d_year  \t\t,item.i_category_id  \t\t,item.i_category  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_item_sk", "i_category", "i_category_id"]}, "group_by": {}, "order_by": {"item": ["i_category", "i_category_id"]}}
{"id": 43, "query_string": " select top (100) s_store_name, s_store_id,         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales  from date_dim, store_sales, store  where d_date_sk = ss_sold_date_sk and        s_store_sk = ss_store_sk and        s_gmt_offset = -5 and        d_year = 2000   group by s_store_name, s_store_id  order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales  ;", "predicates": {"date_dim": ["d_year"], "store": ["s_gmt_offset"]}, "payload": {"date_dim": ["d_date_sk", "d_day_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 44, "query_string": " select top (100) asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing from(select *      from (select item_sk,rank() over (order by rank_col asc) rnk            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col                   from store_sales ss1                  where ss_store_sk = 4                  group by ss_item_sk                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col                                                   from store_sales                                                   where ss_store_sk = 4                                                     and ss_cdemo_sk is null                                                   group by ss_store_sk))V1)V11      where rnk  < 11) asceding,     (select *      from (select item_sk,rank() over (order by rank_col desc) rnk            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col                  from store_sales ss1                  where ss_store_sk = 4                  group by ss_item_sk                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col                                                   from store_sales                                                   where ss_store_sk = 4                                                     and ss_cdemo_sk is null                                                   group by ss_store_sk))V2)V21      where rnk  < 11) descending, item i1, item i2 where asceding.rnk = descending.rnk    and i1.i_item_sk=asceding.item_sk   and i2.i_item_sk=descending.item_sk order by asceding.rnk;", "predicates": {"store_sales": ["ss_store_sk", "ss_customer_sk"]}, "payload": {"store_sales": ["ss_net_profit", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 45, "query_string": " select top (100) ca_zip, ca_state, sum(ws_sales_price)  from web_sales, customer, customer_address, date_dim, item  where ws_bill_customer_sk = c_customer_sk  \tand c_current_addr_sk = ca_address_sk   \tand ws_item_sk = i_item_sk   \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')  \t      or   \t      i_item_id in (select i_item_id                              from item                              where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)                              )  \t    )  \tand ws_sold_date_sk = d_date_sk  \tand d_qoy = 1 and d_year = 1998  group by ca_zip, ca_state  order by ca_zip, ca_state  ;", "predicates": {"customer_address": ["ca_zip"], "date_dim": ["d_qoy", "d_year"], "item": ["i_item_id"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip", "ca_city"], "date_dim": ["d_date_sk"], "web_sales": ["ws_sales_price", "ws_sold_date_sk", "ws_bill_customer_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 46, "query_string": " select top (100) c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,ca_city bought_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics,customer_address      where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and (household_demographics.hd_dep_count = 4 or          household_demographics.hd_vehicle_count= -1)     and date_dim.d_dow in (6,0)     and date_dim.d_year in (2000,2000+1,2000+2)      and store.s_city in ('Fairview','Midway','Midway','Fairview','Fairview')      group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr     where ss_customer_sk = c_customer_sk       and customer.c_current_addr_sk = current_addr.ca_address_sk       and current_addr.ca_city <> bought_city   order by c_last_name           ,c_first_name           ,ca_city           ,bought_city           ,ss_ticket_number   ;", "predicates": {"date_dim": ["d_dow", "d_year"], "household_demographics": ["hd_vehicle_count", "hd_dep_count"], "store": ["s_city"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk", "c_first_name", "c_last_name"], "customer_address": ["ca_city", "ca_address_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_addr_sk", "ss_coupon_amt", "ss_customer_sk", "ss_hdemo_sk", "ss_net_profit", "ss_sold_date_sk", "ss_store_sk", "ss_ticket_number"]}, "group_by": {}, "order_by": {}}
{"id": 47, "query_string": " with v1 as(  select i_category, i_brand,         s_store_name, s_company_name,         d_year, d_moy,         sum(ss_sales_price) sum_sales,         avg(sum(ss_sales_price)) over           (partition by i_category, i_brand,                      s_store_name, s_company_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      s_store_name, s_company_name            order by d_year, d_moy) rn  from item, store_sales, date_dim, store  where ss_item_sk = i_item_sk and        ss_sold_date_sk = d_date_sk and        ss_store_sk = s_store_sk and        (          d_year = 1999 or          ( d_year = 1999-1 and d_moy =12) or          ( d_year = 1999+1 and d_moy =1)        )  group by i_category, i_brand,           s_store_name, s_company_name,           d_year, d_moy),  v2 as(  select v1.i_category         ,v1.d_year, v1.d_moy         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1.s_store_name = v1_lag.s_store_name and        v1.s_store_name = v1_lead.s_store_name and        v1.s_company_name = v1_lag.s_company_name and        v1.s_company_name = v1_lead.s_company_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select top (100) *  from v2  where  d_year = 1999 and             avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, sum_sales  ;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk", "d_moy", "d_year"], "item": ["i_brand", "i_item_sk", "i_category"], "store": ["s_store_name", "s_store_sk", "s_company_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 48, "query_string": " select sum (ss_quantity)  from store_sales, store, customer_demographics, customer_address, date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2001  and    (   (    cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'M'    and     cd_education_status = '2 yr Degree'    and     ss_sales_price between 100.00 and 150.00      )  or   (   cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'S'    and     cd_education_status = 'Primary'    and     ss_sales_price between 50.00 and 100.00      )  or   (   cd_demo_sk = ss_cdemo_sk   and     cd_marital_status = 'W'    and     cd_education_status = 'Secondary'    and     ss_sales_price between 150.00 and 200.00    )  )  and  (   (   ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('VA', 'CO', 'IN')   and ss_net_profit between 0 and 2000     )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('WV', 'NE', 'MI')   and ss_net_profit between 150 and 3000    )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('NC', 'AL', 'GA')   and ss_net_profit between 50 and 25000    )  );", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "store_sales": ["ss_sales_price", "ss_net_profit"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_cdemo_sk", "ss_addr_sk", "ss_quantity", "ss_sales_price", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 49, "query_string": " select top (100) channel, item, return_ratio, return_rank, currency_rank from  (select  'web' as channel  ,web.item  ,web.return_ratio  ,web.return_rank  ,web.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect ws.ws_item_sk as item  \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\t web_sales ws left outer join web_returns wr   \t\t\ton (ws.ws_order_number = wr.wr_order_number and   \t\t\tws.ws_item_sk = wr.wr_item_sk)                  ,date_dim  \t\twhere   \t\t\twr.wr_return_amt > 10000   \t\t\tand ws.ws_net_profit > 1                          and ws.ws_net_paid > 0                          and ws.ws_quantity > 0                          and ws_sold_date_sk = d_date_sk                          and d_year = 1999                          and d_moy = 12  \t\tgroup by ws.ws_item_sk  \t) in_web  ) web  where   (  web.return_rank <= 10  or  web.currency_rank <= 10  )  union  select   'catalog' as channel  ,catalog.item  ,catalog.return_ratio  ,catalog.return_rank  ,catalog.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect   \t\tcs.cs_item_sk as item  \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\tcatalog_sales cs left outer join catalog_returns cr  \t\t\ton (cs.cs_order_number = cr.cr_order_number and   \t\t\tcs.cs_item_sk = cr.cr_item_sk)                 ,date_dim  \t\twhere   \t\t\tcr.cr_return_amount > 10000   \t\t\tand cs.cs_net_profit > 1                          and cs.cs_net_paid > 0                          and cs.cs_quantity > 0                          and cs_sold_date_sk = d_date_sk                          and d_year = 1999                          and d_moy = 12                  group by cs.cs_item_sk  \t) in_cat  ) catalog  where   (  catalog.return_rank <= 10  or  catalog.currency_rank <=10  )  union  select   'store' as channel  ,store.item  ,store.return_ratio  ,store.return_rank  ,store.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect sts.ss_item_sk as item  \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\tstore_sales sts left outer join store_returns sr  \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)                 ,date_dim  \t\twhere   \t\t\tsr.sr_return_amt > 10000   \t\t\tand sts.ss_net_profit > 1                          and sts.ss_net_paid > 0                           and sts.ss_quantity > 0                          and ss_sold_date_sk = d_date_sk                          and d_year = 1999                          and d_moy = 12  \t\tgroup by sts.ss_item_sk  \t) in_store  ) store  where  (  store.return_rank <= 10  or   store.currency_rank <= 10  )  ) a  order by 1,4,5,2  ;", "predicates": {"catalog_returns": ["cr_return_amount"], "catalog_sales": ["cs_net_paid", "cs_net_profit", "cs_quantity"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_return_amt"], "store_sales": ["ss_net_paid", "ss_quantity", "ss_net_profit"], "web_returns": ["wr_return_amt"], "web_sales": ["ws_net_profit", "ws_net_paid", "ws_quantity"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_quantity", "cr_return_amount"], "store_returns": ["sr_return_amt", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_return_amt", "wr_return_quantity", "wr_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 50, "query_string": " select top (100)     s_store_name   ,s_company_id   ,s_street_number   ,s_street_name   ,s_street_type   ,s_suite_number   ,s_city   ,s_county   ,s_state   ,s_zip   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and                   (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and                   (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and                  (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    store_sales   ,store_returns   ,store   ,date_dim d1   ,date_dim d2 where     d2.d_year = 1999 and d2.d_moy  = 8 and ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_sold_date_sk   = d1.d_date_sk and sr_returned_date_sk   = d2.d_date_sk and ss_customer_sk = sr_customer_sk and ss_store_sk = s_store_sk group by    s_store_name   ,s_company_id   ,s_street_number   ,s_street_name   ,s_street_type   ,s_suite_number   ,s_city   ,s_county   ,s_state   ,s_zip order by s_store_name         ,s_company_id         ,s_street_number         ,s_street_name         ,s_street_type         ,s_suite_number         ,s_city         ,s_county         ,s_state         ,s_zip;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 51, "query_string": " WITH web_v1 as ( select   ws_item_sk item_sk, d_date,   sum(sum(ws_sales_price))       over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from web_sales     ,date_dim where ws_sold_date_sk=d_date_sk   and d_month_seq between 1205 and 1205+11   and ws_item_sk is not NULL group by ws_item_sk, d_date), store_v1 as ( select   ss_item_sk item_sk, d_date,   sum(sum(ss_sales_price))       over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from store_sales     ,date_dim where ss_sold_date_sk=d_date_sk   and d_month_seq between 1205 and 1205+11   and ss_item_sk is not NULL group by ss_item_sk, d_date)  select top (100) * from (select item_sk      ,d_date      ,web_sales      ,store_sales      ,max(web_sales)          over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative      ,max(store_sales)          over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative      from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk                  ,case when web.d_date is not null then web.d_date else store.d_date end d_date                  ,web.cume_sales web_sales                  ,store.cume_sales store_sales            from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk                                                           and web.d_date = store.d_date)           )x )y where web_cumulative > store_cumulative order by item_sk         ,d_date;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_sales_price", "ss_item_sk"], "web_sales": ["ws_sold_date_sk", "ws_sales_price", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 52, "query_string": " select top (100) dt.d_year  \t,item.i_brand_id brand_id  \t,item.i_brand brand  \t,sum(ss_ext_sales_price) ext_price  from date_dim dt      ,store_sales      ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=2000  group by dt.d_year  \t,item.i_brand  \t,item.i_brand_id  order by dt.d_year  \t,ext_price desc  \t,brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"item": ["i_brand_id"]}}
{"id": 53, "query_string": " select top (100) * from  (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1205,1205+1,1205+2,1205+3,1205+4,1205+5,1205+6,1205+7,1205+8,1205+9,1205+10,1205+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', \t\t'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', \t\t'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0  \tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales  \telse null end > 0.1 order by avg_quarterly_sales, \t sum_sales, \t i_manufact_id;", "predicates": {"date_dim": ["d_month_seq"], "item": ["i_brand", "i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_qoy"], "item": ["i_item_sk", "i_manufact_id", "i_brand", "i_category", "i_class"], "store": ["s_store_sk"]}, "group_by": {}, "order_by": {}}
{"id": 54, "query_string": " with my_customers as (  select distinct c_customer_sk         , c_current_addr_sk  from            ( select cs_sold_date_sk sold_date_sk,                  cs_bill_customer_sk customer_sk,                  cs_item_sk item_sk           from   catalog_sales           union all           select ws_sold_date_sk sold_date_sk,                  ws_bill_customer_sk customer_sk,                  ws_item_sk item_sk           from   web_sales          ) cs_or_ws_sales,          item,          date_dim,          customer  where   sold_date_sk = d_date_sk          and item_sk = i_item_sk          and i_category = 'Electronics'          and i_class = 'monitors'          and c_customer_sk = cs_or_ws_sales.customer_sk          and d_moy = 1          and d_year = 1999  )  , my_revenue as (  select c_customer_sk,         sum(ss_ext_sales_price) as revenue  from   my_customers,         store_sales,         customer_address,         store,         date_dim  where  c_current_addr_sk = ca_address_sk         and ca_county = s_county         and ca_state = s_state         and ss_sold_date_sk = d_date_sk         and c_customer_sk = ss_customer_sk         and d_month_seq between (select distinct d_month_seq+1                                  from   date_dim where d_year = 1999 and d_moy = 1)                            and  (select distinct d_month_seq+3                                  from   date_dim where d_year = 1999 and d_moy = 1)  group by c_customer_sk  )  , segments as  (select cast((revenue/50) as int) as segment   from   my_revenue  )   select top (100) segment, count(*) as num_customers, segment*50 as segment_base  from segments  group by segment  order by segment, num_customers  ;", "predicates": {"date_dim": ["d_month_seq", "d_moy", "d_year"], "item": ["i_class", "i_category"]}, "payload": {"customer_address": ["ca_address_sk", "ca_county", "ca_state"], "date_dim": ["d_date_sk", "d_month_seq"], "item": ["i_item_sk"], "store": ["s_state", "s_county"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_ext_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 55, "query_string": " select top (100) i_brand_id brand_id, i_brand brand,  \tsum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item  where d_date_sk = ss_sold_date_sk  \tand ss_item_sk = i_item_sk  \tand i_manager_id=95  \tand d_moy=11  \tand d_year=1999  group by i_brand, i_brand_id  order by ext_price desc, i_brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"item": ["i_brand_id"]}}
{"id": 56, "query_string": " with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('salmon','hot','sienna'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 3  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('salmon','hot','sienna'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 3  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('salmon','hot','sienna'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 3  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_item_id)   select top (100) i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  ;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_color"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 57, "query_string": " with v1 as(  select i_category, i_brand,         cc_name,         d_year, d_moy,         sum(cs_sales_price) sum_sales,         avg(sum(cs_sales_price)) over           (partition by i_category, i_brand,                      cc_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      cc_name            order by d_year, d_moy) rn  from item, catalog_sales, date_dim, call_center  where cs_item_sk = i_item_sk and        cs_sold_date_sk = d_date_sk and        cc_call_center_sk= cs_call_center_sk and        (          d_year = 1999 or          ( d_year = 1999-1 and d_moy =12) or          ( d_year = 1999+1 and d_moy =1)        )  group by i_category, i_brand,           cc_name , d_year, d_moy),  v2 as(  select v1.i_category, v1.i_brand         ,v1.d_year, v1.d_moy         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1. cc_name = v1_lag. cc_name and        v1. cc_name = v1_lead. cc_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select top (100) *  from v2  where  d_year = 1999 and         avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, sum_sales  ;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"call_center": ["cc_name", "cc_call_center_sk"], "catalog_sales": ["cs_sales_price", "cs_sold_date_sk", "cs_call_center_sk", "cs_item_sk"], "date_dim": ["d_date_sk", "d_moy", "d_year"], "item": ["i_brand", "i_item_sk", "i_category"]}, "group_by": {}, "order_by": {}}
{"id": 58, "query_string": " with ss_items as  (select i_item_id item_id         ,sum(ss_ext_sales_price) ss_item_rev   from store_sales      ,item      ,date_dim  where ss_item_sk = i_item_sk    and d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2000-07-23'))    and ss_sold_date_sk   = d_date_sk  group by i_item_id),  cs_items as  (select i_item_id item_id         ,sum(cs_ext_sales_price) cs_item_rev   from catalog_sales       ,item       ,date_dim  where cs_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2000-07-23'))   and  cs_sold_date_sk = d_date_sk  group by i_item_id),  ws_items as  (select i_item_id item_id         ,sum(ws_ext_sales_price) ws_item_rev   from web_sales       ,item       ,date_dim  where ws_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq =(select d_week_seq                                       from date_dim                                      where d_date = '2000-07-23'))   and ws_sold_date_sk   = d_date_sk  group by i_item_id)   select top (100) ss_items.item_id        ,ss_item_rev        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev        ,cs_item_rev        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev        ,ws_item_rev        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average  from ss_items,cs_items,ws_items  where ss_items.item_id=cs_items.item_id    and ss_items.item_id=ws_items.item_id     and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  order by item_id          ,ss_item_rev  ;", "predicates": {"date_dim": ["d_week_seq", "d_date"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_item_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "item": ["i_item_id", "i_item_sk"], "store_sales": ["ss_sold_date_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 59, "query_string": " with wss as   (select d_week_seq,         ss_store_sk,         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales  from store_sales,date_dim  where d_date_sk = ss_sold_date_sk  group by d_week_seq,ss_store_sk  )   select top (100) s_store_name1,s_store_id1,d_week_seq1        ,sun_sales1/sun_sales2,mon_sales1/mon_sales2        ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2        ,fri_sales1/fri_sales2,sat_sales1/sat_sales2  from  (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1         ,s_store_id s_store_id1,sun_sales sun_sales1         ,mon_sales mon_sales1,tue_sales tue_sales1         ,wed_sales wed_sales1,thu_sales thu_sales1         ,fri_sales fri_sales1,sat_sales sat_sales1   from wss,store,date_dim d   where d.d_week_seq = wss.d_week_seq and         ss_store_sk = s_store_sk and          d_month_seq between 1202 and 1202 + 11) y,  (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2         ,s_store_id s_store_id2,sun_sales sun_sales2         ,mon_sales mon_sales2,tue_sales tue_sales2         ,wed_sales wed_sales2,thu_sales thu_sales2         ,fri_sales fri_sales2,sat_sales sat_sales2   from wss,store,date_dim d   where d.d_week_seq = wss.d_week_seq and         ss_store_sk = s_store_sk and          d_month_seq between 1202+ 12 and 1202 + 23) x  where s_store_id1=s_store_id2    and d_week_seq1=d_week_seq2-52  order by s_store_name1,s_store_id1,d_week_seq1;", "predicates": {"date_dim": ["d_month_seq"], "store": ["s_store_id"]}, "payload": {"date_dim": ["d_date_sk", "d_week_seq", "d_day_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 60, "query_string": " with ss as (  select           i_item_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where          i_item_id in (select   i_item_id from  item where i_category in ('Shoes'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 10  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  cs as (  select           i_item_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Shoes'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 10  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  ws as (  select           i_item_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Shoes'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 10  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_item_id)   select top (100)     i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by i_item_id       ,total_sales  ;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_item_id", "i_category"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 61, "query_string": " select top (100) promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from   (select sum(ss_ext_sales_price) promotions    from  store_sales         ,store         ,promotion         ,date_dim         ,customer         ,customer_address          ,item    where ss_sold_date_sk = d_date_sk    and   ss_store_sk = s_store_sk    and   ss_promo_sk = p_promo_sk    and   ss_customer_sk= c_customer_sk    and   ca_address_sk = c_current_addr_sk    and   ss_item_sk = i_item_sk     and   ca_gmt_offset = -7    and   i_category = 'Sports'    and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')    and   s_gmt_offset = -7    and   d_year = 1999    and   d_moy  = 11) promotional_sales,   (select sum(ss_ext_sales_price) total    from  store_sales         ,store         ,date_dim         ,customer         ,customer_address         ,item    where ss_sold_date_sk = d_date_sk    and   ss_store_sk = s_store_sk    and   ss_customer_sk= c_customer_sk    and   ca_address_sk = c_current_addr_sk    and   ss_item_sk = i_item_sk    and   ca_gmt_offset = -7    and   i_category = 'Sports'    and   s_gmt_offset = -7    and   d_year = 1999    and   d_moy  = 11) all_sales order by promotions, total;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_category"], "promotion": ["p_channel_dmail", "p_channel_email", "p_channel_tv"], "store": ["s_gmt_offset"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_promo_sk", "ss_item_sk", "ss_ext_sales_price", "ss_customer_sk", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 62, "query_string": " select top (100)     substring(w_warehouse_name,1,20)   ,sm_type   ,web_name   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and                   (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and                   (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and                  (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    web_sales   ,warehouse   ,ship_mode   ,web_site   ,date_dim where     d_month_seq between 1205 and 1205 + 11 and ws_ship_date_sk   = d_date_sk and ws_warehouse_sk   = w_warehouse_sk and ws_ship_mode_sk   = sm_ship_mode_sk and ws_web_site_sk    = web_site_sk group by    substring(w_warehouse_name,1,20)   ,sm_type   ,web_name order by substring(w_warehouse_name,1,20)         ,sm_type        ,web_name;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "ship_mode": ["sm_type", "sm_ship_mode_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"], "web_sales": ["ws_ship_date_sk", "ws_ship_mode_sk", "ws_sold_date_sk", "ws_warehouse_sk", "ws_web_site_sk"], "web_site": ["web_name", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 63, "query_string": " select top (100) *  from (select i_manager_id              ,sum(ss_sales_price) sum_sales              ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales       from item           ,store_sales           ,date_dim           ,store       where ss_item_sk = i_item_sk         and ss_sold_date_sk = d_date_sk         and ss_store_sk = s_store_sk         and d_month_seq in (1205,1205+1,1205+2,1205+3,1205+4,1205+5,1205+6,1205+7,1205+8,1205+9,1205+10,1205+11)         and ((    i_category in ('Books','Children','Electronics')               and i_class in ('personal','portable','reference','self-help')               and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', \t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))            or(    i_category in ('Women','Music','Men')               and i_class in ('accessories','classical','fragrances','pants')               and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', \t\t                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id         ,avg_monthly_sales         ,sum_sales;", "predicates": {"date_dim": ["d_month_seq"], "item": ["i_brand", "i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_item_sk", "i_manager_id", "i_brand", "i_category", "i_class"], "store": ["s_store_sk"]}, "group_by": {}, "order_by": {"item": ["i_manager_id"]}}
{"id": 64, "query_string": " with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('ghost','grey','tomato','chartreuse','seashell','dim') and          i_current_price between 27 and 27 + 10 and          i_current_price between 27 + 1 and 27 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;", "predicates": {"customer_demographics": ["cd_marital_status"], "date_dim": ["d_year"], "item": ["i_color", "i_current_price"], "store": ["s_zip", "s_store_name"]}, "payload": {"household_demographics": ["hd_income_band_sk", "hd_demo_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 65, "query_string": " select top (100) \ts_store_name, \ti_item_desc, \tsc.revenue, \ti_current_price, \ti_wholesale_cost, \ti_brand  from store, item,      (select ss_store_sk, avg(revenue) as ave  \tfrom  \t    (select  ss_store_sk, ss_item_sk,   \t\t     sum(ss_sales_price) as revenue  \t\tfrom store_sales, date_dim  \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1205 and 1205+11  \t\tgroup by ss_store_sk, ss_item_sk) sa  \tgroup by ss_store_sk) sb,      (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue  \tfrom store_sales, date_dim  \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1205 and 1205+11  \tgroup by ss_store_sk, ss_item_sk) sc  where sb.ss_store_sk = sc.ss_store_sk and         sc.revenue <= 0.1 * sb.ave and        s_store_sk = sc.ss_store_sk and        i_item_sk = sc.ss_item_sk  order by s_store_name, i_item_desc;", "predicates": {"date_dim": ["d_month_seq"], "store_sales": ["ss_store_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_brand", "i_wholesale_cost", "i_item_desc"], "store": ["s_store_name", "s_store_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price", "ss_item_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_desc"], "store": ["s_store_name"]}}
{"id": 66, "query_string": " select top (100)            w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country         ,ship_carriers         ,year  \t,sum(jan_sales) as jan_sales  \t,sum(feb_sales) as feb_sales  \t,sum(mar_sales) as mar_sales  \t,sum(apr_sales) as apr_sales  \t,sum(may_sales) as may_sales  \t,sum(jun_sales) as jun_sales  \t,sum(jul_sales) as jul_sales  \t,sum(aug_sales) as aug_sales  \t,sum(sep_sales) as sep_sales  \t,sum(oct_sales) as oct_sales  \t,sum(nov_sales) as nov_sales  \t,sum(dec_sales) as dec_sales  \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot  \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot  \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot  \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot  \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot  \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot  \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot  \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot  \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot  \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot  \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot  \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot  \t,sum(jan_net) as jan_net  \t,sum(feb_net) as feb_net  \t,sum(mar_net) as mar_net  \t,sum(apr_net) as apr_net  \t,sum(may_net) as may_net  \t,sum(jun_net) as jun_net  \t,sum(jul_net) as jul_net  \t,sum(aug_net) as aug_net  \t,sum(sep_net) as sep_net  \t,sum(oct_net) as oct_net  \t,sum(nov_net) as nov_net  \t,sum(dec_net) as dec_net  from (      select   \tw_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,concat('ORIENTAL' , ',' , 'MSC') as ship_carriers        ,d_year as year  \t,sum(case when d_moy = 1   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jan_sales  \t,sum(case when d_moy = 2   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as feb_sales  \t,sum(case when d_moy = 3   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as mar_sales  \t,sum(case when d_moy = 4   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as apr_sales  \t,sum(case when d_moy = 5   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as may_sales  \t,sum(case when d_moy = 6   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jun_sales  \t,sum(case when d_moy = 7   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jul_sales  \t,sum(case when d_moy = 8   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as aug_sales  \t,sum(case when d_moy = 9   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as sep_sales  \t,sum(case when d_moy = 10   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as oct_sales  \t,sum(case when d_moy = 11  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as nov_sales  \t,sum(case when d_moy = 12  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as dec_sales  \t,sum(case when d_moy = 1   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net  \t,sum(case when d_moy = 2  \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net  \t,sum(case when d_moy = 3   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net  \t,sum(case when d_moy = 4   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net  \t,sum(case when d_moy = 5   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net  \t,sum(case when d_moy = 6   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net  \t,sum(case when d_moy = 7   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net  \t,sum(case when d_moy = 8   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net  \t,sum(case when d_moy = 9   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net  \t,sum(case when d_moy = 10   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net  \t,sum(case when d_moy = 11  \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net  \t,sum(case when d_moy = 12  \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net      from           web_sales          ,warehouse          ,date_dim          ,time_dim  \t  ,ship_mode      where             ws_warehouse_sk =  w_warehouse_sk         and ws_sold_date_sk = d_date_sk         and ws_sold_time_sk = t_time_sk  \tand ws_ship_mode_sk = sm_ship_mode_sk         and d_year = 2001  \tand t_time between 31119 and 31119+28800   \tand sm_carrier in ('ORIENTAL','MSC')      group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country        ,d_year  union all      select   \tw_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,concat('ORIENTAL', ',', 'MSC') as ship_carriers        ,d_year as year  \t,sum(case when d_moy = 1   \t\tthen cs_sales_price* cs_quantity else 0 end) as jan_sales  \t,sum(case when d_moy = 2   \t\tthen cs_sales_price* cs_quantity else 0 end) as feb_sales  \t,sum(case when d_moy = 3   \t\tthen cs_sales_price* cs_quantity else 0 end) as mar_sales  \t,sum(case when d_moy = 4   \t\tthen cs_sales_price* cs_quantity else 0 end) as apr_sales  \t,sum(case when d_moy = 5   \t\tthen cs_sales_price* cs_quantity else 0 end) as may_sales  \t,sum(case when d_moy = 6   \t\tthen cs_sales_price* cs_quantity else 0 end) as jun_sales  \t,sum(case when d_moy = 7   \t\tthen cs_sales_price* cs_quantity else 0 end) as jul_sales  \t,sum(case when d_moy = 8   \t\tthen cs_sales_price* cs_quantity else 0 end) as aug_sales  \t,sum(case when d_moy = 9   \t\tthen cs_sales_price* cs_quantity else 0 end) as sep_sales  \t,sum(case when d_moy = 10   \t\tthen cs_sales_price* cs_quantity else 0 end) as oct_sales  \t,sum(case when d_moy = 11  \t\tthen cs_sales_price* cs_quantity else 0 end) as nov_sales  \t,sum(case when d_moy = 12  \t\tthen cs_sales_price* cs_quantity else 0 end) as dec_sales  \t,sum(case when d_moy = 1   \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as jan_net  \t,sum(case when d_moy = 2   \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as feb_net  \t,sum(case when d_moy = 3   \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as mar_net  \t,sum(case when d_moy = 4   \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as apr_net  \t,sum(case when d_moy = 5   \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as may_net  \t,sum(case when d_moy = 6   \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as jun_net  \t,sum(case when d_moy = 7   \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as jul_net  \t,sum(case when d_moy = 8   \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as aug_net  \t,sum(case when d_moy = 9   \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as sep_net  \t,sum(case when d_moy = 10   \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as oct_net  \t,sum(case when d_moy = 11  \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as nov_net  \t,sum(case when d_moy = 12  \t\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as dec_net      from           catalog_sales          ,warehouse          ,date_dim          ,time_dim  \t ,ship_mode      where             cs_warehouse_sk =  w_warehouse_sk         and cs_sold_date_sk = d_date_sk         and cs_sold_time_sk = t_time_sk  \tand cs_ship_mode_sk = sm_ship_mode_sk         and d_year = 2001  \tand t_time between 31119 AND 31119+28800   \tand sm_carrier in ('ORIENTAL','MSC')      group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country        ,d_year  ) x  group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,ship_carriers        ,year  order by w_warehouse_name  ;", "predicates": {"date_dim": ["d_year"], "ship_mode": ["sm_carrier"], "time_dim": ["t_time"]}, "payload": {"catalog_sales": ["cs_warehouse_sk", "cs_ext_list_price", "cs_quantity", "cs_net_paid_inc_tax", "cs_ship_mode_sk", "cs_sold_date_sk", "cs_sold_time_sk"], "date_dim": ["d_date_sk", "d_moy", "d_year"], "ship_mode": ["sm_ship_mode_sk"], "time_dim": ["t_time_sk"], "web_sales": ["ws_ship_mode_sk", "ws_ext_list_price", "ws_sold_date_sk", "ws_quantity", "ws_sold_time_sk", "ws_warehouse_sk", "ws_net_paid"]}, "group_by": {}, "order_by": {}}
{"id": 67, "query_string": " select top (100) * from (select i_category             ,i_class             ,i_brand             ,i_product_name             ,d_year             ,d_qoy             ,d_moy             ,s_store_id             ,sumsales             ,rank() over (partition by i_category order by sumsales desc) rk       from (select i_category                   ,i_class                   ,i_brand                   ,i_product_name                   ,d_year                   ,d_qoy                   ,d_moy                   ,s_store_id                   ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales             from store_sales                 ,date_dim                 ,store                 ,item        where  ss_sold_date_sk=d_date_sk           and ss_item_sk=i_item_sk           and ss_store_sk = s_store_sk           and d_month_seq between 1205 and 1205+11        group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 order by i_category         ,i_class         ,i_brand         ,i_product_name         ,d_year         ,d_qoy         ,d_moy         ,s_store_id         ,sumsales         ,rk;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk", "d_moy", "d_qoy", "d_year"], "item": ["i_item_sk", "i_brand", "i_product_name", "i_category", "i_class"], "store": ["s_store_sk", "s_store_id"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_sales_price", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {"date_dim": ["d_moy", "d_qoy", "d_year"], "item": ["i_brand", "i_class", "i_product_name", "i_category"], "store": ["s_store_id"]}}
{"id": 68, "query_string": " select top (100) c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,extended_price        ,extended_tax        ,list_price  from (select ss_ticket_number              ,ss_customer_sk              ,ca_city bought_city              ,sum(ss_ext_sales_price) extended_price               ,sum(ss_ext_list_price) list_price              ,sum(ss_ext_tax) extended_tax         from store_sales            ,date_dim            ,store            ,household_demographics            ,customer_address         where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_store_sk = store.s_store_sk           and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk         and store_sales.ss_addr_sk = customer_address.ca_address_sk         and date_dim.d_dom between 1 and 2          and (household_demographics.hd_dep_count = 5 or              household_demographics.hd_vehicle_count= 2)         and date_dim.d_year in (2000,2000+1,2000+2)         and store.s_city in ('Midway','Fairview')        group by ss_ticket_number                ,ss_customer_sk                ,ss_addr_sk,ca_city) dn       ,customer       ,customer_address current_addr  where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name          ,ss_ticket_number  ;", "predicates": {"customer_address": ["ca_city"], "date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_city"]}, "payload": {"customer": ["c_current_addr_sk", "c_first_name", "c_last_name", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_city"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_ext_sales_price", "ss_addr_sk", "ss_customer_sk", "ss_ticket_number", "ss_ext_list_price", "ss_ext_tax", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 69, "query_string": " select top (100)    cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_state in ('TX','KS','MD') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2002 and                 d_moy between 4 and 4+2) and    (not exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_moy between 4 and 4+2) and     not exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_moy between 4 and 4+2))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  ;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 70, "query_string": " select top (100)      sum(ss_net_profit) as total_sum    ,s_state    ,s_county    ,grouping(s_state)+grouping(s_county) as lochierarchy    ,rank() over (  \tpartition by grouping(s_state)+grouping(s_county),  \tcase when grouping(s_county) = 0 then s_state end   \torder by sum(ss_net_profit) desc) as rank_within_parent  from     store_sales    ,date_dim       d1    ,store  where     d1.d_month_seq between 1205 and 1205+11  and d1.d_date_sk = ss_sold_date_sk  and s_store_sk  = ss_store_sk  and s_state in              ( select s_state                from  (select s_state as s_state,  \t\t\t    rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking                       from   store_sales, store, date_dim                       where  d_month_seq between 1205 and 1205+11  \t\t\t    and d_date_sk = ss_sold_date_sk  \t\t\t    and s_store_sk  = ss_store_sk                       group by s_state                      ) tmp1                 where ranking <= 5              )  group by rollup(s_state,s_county)  order by    lochierarchy desc   ,case when (grouping(s_state)+grouping(s_county)) = 0 then s_state end   ,rank_within_parent  ;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 71, "query_string": " select i_brand_id brand_id, i_brand brand,t_hour,t_minute,  \tsum(ext_price) ext_price  from item, (select ws_ext_sales_price as ext_price,                          ws_sold_date_sk as sold_date_sk,                         ws_item_sk as sold_item_sk,                         ws_sold_time_sk as time_sk                    from web_sales,date_dim                  where d_date_sk = ws_sold_date_sk                    and d_moy=12                    and d_year=1999                  union all                  select cs_ext_sales_price as ext_price,                         cs_sold_date_sk as sold_date_sk,                         cs_item_sk as sold_item_sk,                         cs_sold_time_sk as time_sk                  from catalog_sales,date_dim                  where d_date_sk = cs_sold_date_sk                    and d_moy=12                    and d_year=1999                  union all                  select ss_ext_sales_price as ext_price,                         ss_sold_date_sk as sold_date_sk,                         ss_item_sk as sold_item_sk,                         ss_sold_time_sk as time_sk                  from store_sales,date_dim                  where d_date_sk = ss_sold_date_sk                    and d_moy=12                    and d_year=1999                  ) tmp,time_dim  where    sold_item_sk = i_item_sk    and i_manager_id=1    and time_sk = t_time_sk    and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')  group by i_brand, i_brand_id,t_hour,t_minute  order by ext_price desc, i_brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"], "time_dim": ["t_meal_time"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_brand", "i_item_sk", "i_brand_id"], "time_dim": ["t_hour", "t_minute", "t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 72, "query_string": " select top (100) i_item_desc       ,w_warehouse_name       ,d1.d_week_seq       ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo       ,sum(case when p_promo_sk is not null then 1 else 0 end) promo       ,count(*) total_cnt from catalog_sales join inventory on (cs_item_sk = inv_item_sk) join warehouse on (w_warehouse_sk=inv_warehouse_sk) join item on (i_item_sk = cs_item_sk) join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk) join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk) join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk) join date_dim d2 on (inv_date_sk = d2.d_date_sk) join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk) left outer join promotion on (cs_promo_sk=p_promo_sk) left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number) where d1.d_week_seq = d2.d_week_seq   and inv_quantity_on_hand < cs_quantity    and d3.d_date > dateadd(day, 5, d1.d_date)   and hd_buy_potential = '501-1000'   and d1.d_year = 1999   and cd_marital_status = 'U' group by i_item_desc,w_warehouse_name,d1.d_week_seq order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq;", "predicates": {"customer_demographics": ["cd_marital_status"], "date_dim": ["d_date", "d_year"], "household_demographics": ["hd_buy_potential"], "inventory": ["inv_warehouse_sk"], "warehouse": ["w_warehouse_sk"]}, "payload": {"catalog_sales": ["cs_quantity", "cs_promo_sk", "cs_item_sk", "cs_ship_date_sk", "cs_bill_cdemo_sk", "cs_sold_date_sk", "cs_bill_hdemo_sk"], "customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "household_demographics": ["hd_demo_sk"], "item": ["i_item_sk", "i_item_desc"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {"date_dim": ["d_week_seq"], "item": ["i_item_desc"], "warehouse": ["w_warehouse_name"]}}
{"id": 73, "query_string": " select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '1001-5000' or          household_demographics.hd_buy_potential = '5001-10000')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;", "predicates": {"date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count", "hd_buy_potential"], "store": ["s_county"]}, "payload": {"customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_preferred_cust_flag"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 74, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,d_year as year        ,max(ss_net_paid) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk    and d_year in (2001,2001+1)  group by c_customer_id          ,c_first_name          ,c_last_name          ,d_year  union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,d_year as year        ,max(ws_net_paid) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk    and d_year in (2001,2001+1)  group by c_customer_id          ,c_first_name          ,c_last_name          ,d_year          )   select top (100)         t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id          and t_s_firstyear.customer_id = t_w_secyear.customer_id          and t_s_firstyear.customer_id = t_w_firstyear.customer_id          and t_s_firstyear.sale_type = 's'          and t_w_firstyear.sale_type = 'w'          and t_s_secyear.sale_type = 's'          and t_w_secyear.sale_type = 'w'          and t_s_firstyear.year = 2001          and t_s_secyear.year = 2001+1          and t_w_firstyear.year = 2001          and t_w_secyear.year = 2001+1          and t_s_firstyear.year_total > 0          and t_w_firstyear.year_total > 0          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end  order by 3,1,2;", "predicates": {"date_dim": ["d_year"]}, "payload": {"customer": ["c_customer_id", "c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_net_paid"], "web_sales": ["ws_net_paid", "ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_customer_id", "c_last_name", "c_first_name"]}}
{"id": 75, "query_string": " WITH all_sales AS (  SELECT d_year        ,i_brand_id        ,i_class_id        ,i_category_id        ,i_manufact_id        ,SUM(sales_cnt) AS sales_cnt        ,SUM(sales_amt) AS sales_amt  FROM (SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt              ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt        FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk                           JOIN date_dim ON d_date_sk=cs_sold_date_sk                           LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number                                                      AND cs_item_sk=cr_item_sk)        WHERE i_category='Men'        UNION        SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt              ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt        FROM store_sales JOIN item ON i_item_sk=ss_item_sk                         JOIN date_dim ON d_date_sk=ss_sold_date_sk                         LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number                                                  AND ss_item_sk=sr_item_sk)        WHERE i_category='Men'        UNION        SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt              ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt        FROM web_sales JOIN item ON i_item_sk=ws_item_sk                       JOIN date_dim ON d_date_sk=ws_sold_date_sk                       LEFT JOIN web_returns ON (ws_order_number=wr_order_number                                              AND ws_item_sk=wr_item_sk)        WHERE i_category='Men') sales_detail  GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)  SELECT top (100) prev_yr.d_year AS prev_year                           ,curr_yr.d_year AS year                           ,curr_yr.i_brand_id                           ,curr_yr.i_class_id                           ,curr_yr.i_category_id                           ,curr_yr.i_manufact_id                           ,prev_yr.sales_cnt AS prev_yr_cnt                           ,curr_yr.sales_cnt AS curr_yr_cnt                           ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff                           ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff  FROM all_sales curr_yr, all_sales prev_yr  WHERE curr_yr.i_brand_id=prev_yr.i_brand_id    AND curr_yr.i_class_id=prev_yr.i_class_id    AND curr_yr.i_category_id=prev_yr.i_category_id    AND curr_yr.i_manufact_id=prev_yr.i_manufact_id    AND curr_yr.d_year=2002    AND prev_yr.d_year=2002-1    AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9  ORDER BY sales_cnt_diff,sales_amt_diff  ;", "predicates": {"date_dim": ["d_year"], "item": ["i_category"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_quantity", "cr_return_amount"], "date_dim": ["d_date_sk", "d_year"], "item": ["i_class_id", "i_item_sk", "i_category_id", "i_brand_id", "i_manufact_id"], "store_returns": ["sr_return_amt", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_return_amt", "wr_return_quantity", "wr_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 76, "query_string": " select top (100) channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (         SELECT 'store' as channel, 'ss_hdemo_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price          FROM store_sales, item, date_dim          WHERE ss_hdemo_sk IS NULL            AND ss_sold_date_sk=d_date_sk            AND ss_item_sk=i_item_sk         UNION ALL         SELECT 'web' as channel, 'ws_bill_addr_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price          FROM web_sales, item, date_dim          WHERE ws_bill_addr_sk IS NULL            AND ws_sold_date_sk=d_date_sk            AND ws_item_sk=i_item_sk         UNION ALL         SELECT 'catalog' as channel, 'cs_ship_addr_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price          FROM catalog_sales, item, date_dim          WHERE cs_ship_addr_sk IS NULL            AND cs_sold_date_sk=d_date_sk            AND cs_item_sk=i_item_sk) foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category;", "predicates": {"catalog_sales": ["cs_ship_addr_sk"], "store_sales": ["ss_promo_sk"], "web_sales": ["ws_promo_sk"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_item_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_qoy", "d_year"], "item": ["i_item_sk", "i_category"], "store_sales": ["ss_sold_date_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 77, "query_string": " with ss as  (select s_store_sk,          sum(ss_ext_sales_price) as sales,          sum(ss_net_profit) as profit  from store_sales,       date_dim,       store  where ss_sold_date_sk = d_date_sk        and d_date between cast('2000-08-17' as date)                    and dateadd(day, 30, cast('2000-08-17' as date))         and ss_store_sk = s_store_sk  group by s_store_sk)  ,  sr as  (select s_store_sk,          sum(sr_return_amt) as returns,          sum(sr_net_loss) as profit_loss  from store_returns,       date_dim,       store  where sr_returned_date_sk = d_date_sk        and d_date between cast('2000-08-17' as date)                   and dateadd(day, 30, cast('2000-08-17' as date))        and sr_store_sk = s_store_sk  group by s_store_sk),   cs as  (select cs_call_center_sk,         sum(cs_ext_sales_price) as sales,         sum(cs_net_profit) as profit  from catalog_sales,       date_dim  where cs_sold_date_sk = d_date_sk        and d_date between cast('2000-08-17' as date)                   and dateadd(day, 30, cast('2000-08-17' as date))  group by cs_call_center_sk   ),   cr as  (select cr_call_center_sk,          sum(cr_return_amount) as returns,          sum(cr_net_loss) as profit_loss  from catalog_returns,       date_dim  where cr_returned_date_sk = d_date_sk        and d_date between cast('2000-08-17' as date)                   and dateadd(day, 30, cast('2000-08-17' as date))  group by cr_call_center_sk  ),   ws as  ( select wp_web_page_sk,         sum(ws_ext_sales_price) as sales,         sum(ws_net_profit) as profit  from web_sales,       date_dim,       web_page  where ws_sold_date_sk = d_date_sk        and d_date between cast('2000-08-17' as date)                   and dateadd(day, 30, cast('2000-08-17' as date))        and ws_web_page_sk = wp_web_page_sk  group by wp_web_page_sk),   wr as  (select wp_web_page_sk,         sum(wr_return_amt) as returns,         sum(wr_net_loss) as profit_loss  from web_returns,       date_dim,       web_page  where wr_returned_date_sk = d_date_sk        and d_date between cast('2000-08-17' as date)                   and dateadd(day, 30, cast('2000-08-17' as date))        and wr_web_page_sk = wp_web_page_sk  group by wp_web_page_sk)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , ss.s_store_sk as id         , sales         , coalesce(returns, 0) as returns         , (profit - coalesce(profit_loss,0)) as profit  from   ss left join sr         on  ss.s_store_sk = sr.s_store_sk  union all  select 'catalog channel' as channel         , cs_call_center_sk as id         , sales         , returns         , (profit - profit_loss) as profit  from  cs        , cr  union all  select 'web channel' as channel         , ws.wp_web_page_sk as id         , sales         , coalesce(returns, 0) returns         , (profit - coalesce(profit_loss,0)) as profit  from   ws left join wr         on  ws.wp_web_page_sk = wr.wp_web_page_sk  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_return_amount", "cr_call_center_sk"], "catalog_sales": ["cs_net_profit", "cs_sold_date_sk", "cs_call_center_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_net_loss"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit", "ss_ext_sales_price"], "web_page": ["wp_web_page_sk"], "web_returns": ["wr_web_page_sk", "wr_returned_date_sk", "wr_return_amt", "wr_net_loss"], "web_sales": ["ws_net_profit", "ws_ext_sales_price", "ws_web_page_sk", "ws_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 78, "query_string": " with ws as   (select d_year AS ws_sold_year, ws_item_sk,     ws_bill_customer_sk ws_customer_sk,     sum(ws_quantity) ws_qty,     sum(ws_wholesale_cost) ws_wc,     sum(ws_sales_price) ws_sp    from web_sales    left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk    join date_dim on ws_sold_date_sk = d_date_sk    where wr_order_number is null    group by d_year, ws_item_sk, ws_bill_customer_sk    ), cs as   (select d_year AS cs_sold_year, cs_item_sk,     cs_bill_customer_sk cs_customer_sk,     sum(cs_quantity) cs_qty,     sum(cs_wholesale_cost) cs_wc,     sum(cs_sales_price) cs_sp    from catalog_sales    left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk    join date_dim on cs_sold_date_sk = d_date_sk    where cr_order_number is null    group by d_year, cs_item_sk, cs_bill_customer_sk    ), ss as   (select d_year AS ss_sold_year, ss_item_sk,     ss_customer_sk,     sum(ss_quantity) ss_qty,     sum(ss_wholesale_cost) ss_wc,     sum(ss_sales_price) ss_sp    from store_sales    left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk    join date_dim on ss_sold_date_sk = d_date_sk    where sr_ticket_number is null    group by d_year, ss_item_sk, ss_customer_sk    )  select top (100) ss_sold_year, ss_item_sk, ss_customer_sk, round(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk) where (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=1999 order by    ss_sold_year, ss_item_sk, ss_customer_sk,   ss_qty desc, ss_wc desc, ss_sp desc,   other_chan_qty,   other_chan_wholesale_cost,   other_chan_sales_price,   ratio;", "predicates": {"catalog_returns": ["cr_order_number"], "catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_year"], "store_returns": ["sr_ticket_number"], "store_sales": ["ss_customer_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_bill_customer_sk"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "store_returns": ["sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_item_sk", "ss_sales_price", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_wholesale_cost", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 79, "query_string": " select top (100)   c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,store.s_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (household_demographics.hd_dep_count = 6 or household_demographics.hd_vehicle_count > 1)     and date_dim.d_dow = 1     and date_dim.d_year in (2000,2000+1,2000+2)      and store.s_number_employees between 200 and 295     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer     where ss_customer_sk = c_customer_sk  order by c_last_name,c_first_name,substring(s_city,1,30), profit;", "predicates": {"date_dim": ["d_dow", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_number_employees"]}, "payload": {"customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_city", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_addr_sk", "ss_customer_sk", "ss_ticket_number", "ss_coupon_amt", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {"customer": ["c_last_name", "c_first_name"]}}
{"id": 80, "query_string": " with ssr as  (select  s_store_id as store_id,           sum(ss_ext_sales_price) as sales,           sum(coalesce(sr_return_amt, 0)) as returns,           sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit   from store_sales left outer join store_returns on          (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),      date_dim,      store,      item,      promotion  where ss_sold_date_sk = d_date_sk        and d_date between cast('2000-08-17' as date)                    and dateadd(day, 30, cast('2000-08-17' as date))        and ss_store_sk = s_store_sk        and ss_item_sk = i_item_sk        and i_current_price > 50        and ss_promo_sk = p_promo_sk        and p_channel_tv = 'N'  group by s_store_id)  ,  csr as  (select  cp_catalog_page_id as catalog_page_id,           sum(cs_ext_sales_price) as sales,           sum(coalesce(cr_return_amount, 0)) as returns,           sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit   from catalog_sales left outer join catalog_returns on          (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),      date_dim,      catalog_page,      item,      promotion  where cs_sold_date_sk = d_date_sk        and d_date between cast('2000-08-17' as date)                   and dateadd(day, 30, cast('2000-08-17' as date))         and cs_catalog_page_sk = cp_catalog_page_sk        and cs_item_sk = i_item_sk        and i_current_price > 50        and cs_promo_sk = p_promo_sk        and p_channel_tv = 'N' group by cp_catalog_page_id)  ,  wsr as  (select  web_site_id,           sum(ws_ext_sales_price) as sales,           sum(coalesce(wr_return_amt, 0)) as returns,           sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit   from web_sales left outer join web_returns on          (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),      date_dim,      web_site,      item,      promotion  where ws_sold_date_sk = d_date_sk        and d_date between cast('2000-08-17' as date)                   and dateadd(day, 30, cast('2000-08-17' as date))         and ws_web_site_sk = web_site_sk        and ws_item_sk = i_item_sk        and i_current_price > 50        and ws_promo_sk = p_promo_sk        and p_channel_tv = 'N' group by web_site_id)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , concat('store' , store_id) as id         , sales         , returns         , profit  from   ssr  union all  select 'catalog channel' as channel         , concat('catalog_page' , catalog_page_id) as id         , sales         , returns         , profit  from  csr  union all  select 'web channel' as channel         , concat('web_site' , web_site_id) as id         , sales         , returns         , profit  from   wsr  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"], "promotion": ["p_channel_tv"]}, "payload": {"catalog_page": ["cp_catalog_page_sk", "cp_catalog_page_id"], "catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_amount", "cr_net_loss"], "date_dim": ["d_date_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"], "store": ["s_store_sk", "s_store_id"], "store_returns": ["sr_return_amt", "sr_net_loss", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_net_loss", "wr_return_amt", "wr_order_number"], "web_site": ["web_site_id", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 81, "query_string": " with customer_total_return as  (select cr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   \tsum(cr_return_amt_inc_tax) as ctr_total_return  from catalog_returns      ,date_dim      ,customer_address  where cr_returned_date_sk = d_date_sk     and d_year =2000    and cr_returning_addr_sk = ca_address_sk   group by cr_returning_customer_sk          ,ca_state )   select top (100) c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  \t\t\t  from customer_total_return ctr2                    \t  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'NM'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  ;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_year"]}, "payload": {"catalog_returns": ["cr_returned_date_sk", "cr_returning_customer_sk", "cr_return_amt_inc_tax", "cr_returning_addr_sk"], "customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_current_addr_sk", "c_customer_id"], "customer_address": ["ca_street_type", "ca_county", "ca_street_name", "ca_zip", "ca_street_number", "ca_city", "ca_state", "ca_gmt_offset", "ca_location_type", "ca_address_sk", "ca_suite_number", "ca_country"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer": ["c_salutation", "c_customer_id", "c_last_name", "c_first_name"], "customer_address": ["ca_street_type", "ca_county", "ca_street_name", "ca_zip", "ca_street_number", "ca_city", "ca_gmt_offset", "ca_location_type", "ca_suite_number", "ca_country"]}}
{"id": 82, "query_string": " select top (100) i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, store_sales  where i_current_price between 39 and 39+30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2002-06-07' as date) and dateadd(day, 60, cast('2002-06-07' as date))  and i_manufact_id in (83,683,91,693)  and inv_quantity_on_hand between 100 and 500  and ss_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  ;", "predicates": {"date_dim": ["d_date"], "inventory": ["inv_quantity_on_hand"], "item": ["i_current_price", "i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc", "i_current_price"]}, "group_by": {}, "order_by": {}}
{"id": 83, "query_string": " with sr_items as  (select i_item_id item_id,         sum(sr_return_quantity) sr_item_qty  from store_returns,       item,       date_dim  where sr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t  where d_date in ('2002-01-31','2002-08-18','2002-11-19')))  and   sr_returned_date_sk   = d_date_sk  group by i_item_id),  cr_items as  (select i_item_id item_id,         sum(cr_return_quantity) cr_item_qty  from catalog_returns,       item,       date_dim  where cr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t  where d_date in ('2002-01-31','2002-08-18','2002-11-19')))  and   cr_returned_date_sk   = d_date_sk  group by i_item_id),  wr_items as  (select i_item_id item_id,         sum(wr_return_quantity) wr_item_qty  from web_returns,       item,       date_dim  where wr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t\twhere d_date in ('2002-01-31','2002-08-18','2002-11-19')))  and   wr_returned_date_sk   = d_date_sk  group by i_item_id)   select top (100) sr_items.item_id        ,sr_item_qty        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev        ,cr_item_qty        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev        ,wr_item_qty        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average  from sr_items      ,cr_items      ,wr_items  where sr_items.item_id=cr_items.item_id    and sr_items.item_id=wr_items.item_id   order by sr_items.item_id          ,sr_item_qty  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_returned_date_sk", "cr_order_number", "cr_return_quantity"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "item": ["i_item_id", "i_item_sk"], "store_returns": ["sr_returned_date_sk", "sr_return_quantity", "sr_item_sk"], "web_returns": ["wr_item_sk", "wr_returned_date_sk", "wr_return_quantity"]}, "group_by": {}, "order_by": {}}
{"id": 84, "query_string": " select top (100) c_customer_id as customer_id        , concat(coalesce(c_last_name,'') , ', ' , coalesce(c_first_name,'')) as customername  from customer      ,customer_address      ,customer_demographics      ,household_demographics      ,income_band      ,store_returns  where ca_city\t        =  'Concord'    and c_current_addr_sk = ca_address_sk    and ib_lower_bound   >=  13893    and ib_upper_bound   <=  13893 + 50000    and ib_income_band_sk = hd_income_band_sk    and cd_demo_sk = c_current_cdemo_sk    and hd_demo_sk = c_current_hdemo_sk    and sr_cdemo_sk = cd_demo_sk  order by c_customer_id  ;", "predicates": {"customer": ["c_current_cdemo_sk"], "customer_address": ["ca_city"], "income_band": ["ib_upper_bound", "ib_lower_bound"]}, "payload": {"customer": ["c_last_name", "c_first_name", "c_current_cdemo_sk", "c_current_addr_sk", "c_customer_id", "c_current_hdemo_sk"], "customer_address": ["ca_address_sk"], "household_demographics": ["hd_income_band_sk", "hd_demo_sk"], "income_band": ["ib_income_band_sk"], "store_returns": ["sr_cdemo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 85, "query_string": " select top (100) substring(r_reason_desc,1,20)        ,avg(ws_quantity)        ,avg(wr_refunded_cash)        ,avg(wr_fee)  from web_sales, web_returns, web_page, customer_demographics cd1,       customer_demographics cd2, customer_address, date_dim, reason   where ws_web_page_sk = wp_web_page_sk    and ws_item_sk = wr_item_sk    and ws_order_number = wr_order_number    and ws_sold_date_sk = d_date_sk and d_year = 2001    and cd1.cd_demo_sk = wr_refunded_cdemo_sk     and cd2.cd_demo_sk = wr_returning_cdemo_sk    and ca_address_sk = wr_refunded_addr_sk    and r_reason_sk = wr_reason_sk    and    (     (      cd1.cd_marital_status = 'M'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = '2 yr Degree'      and       cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 100.00 and 150.00     )    or     (      cd1.cd_marital_status = 'S'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Primary'       and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 50.00 and 100.00     )    or     (      cd1.cd_marital_status = 'W'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Secondary'      and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 150.00 and 200.00     )    )    and    (     (      ca_country = 'United States'      and      ca_state in ('VA', 'CO', 'IN')      and ws_net_profit between 100 and 200       )     or     (      ca_country = 'United States'      and      ca_state in ('WV', 'NE', 'MI')      and ws_net_profit between 150 and 300       )     or     (      ca_country = 'United States'      and      ca_state in ('NC', 'AL', 'GA')      and ws_net_profit between 50 and 250       )    ) group by r_reason_desc order by substring(r_reason_desc,1,20)         ,avg(ws_quantity)         ,avg(wr_refunded_cash)         ,avg(wr_fee);", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "web_sales": ["ws_net_profit", "ws_sales_price"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "reason": ["r_reason_desc", "r_reason_sk"], "web_page": ["wp_web_page_sk"], "web_returns": ["wr_returning_cdemo_sk", "wr_refunded_cdemo_sk", "wr_reason_sk", "wr_item_sk", "wr_refunded_cash", "wr_refunded_addr_sk", "wr_fee", "wr_order_number"], "web_sales": ["ws_net_profit", "ws_item_sk", "ws_sales_price", "ws_quantity", "ws_sold_date_sk", "ws_web_page_sk", "ws_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 86, "query_string": " select top (100)       sum(ws_net_paid) as total_sum    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  \tpartition by grouping(i_category)+grouping(i_class),  \tcase when grouping(i_class) = 0 then i_category end   \torder by sum(ws_net_paid) desc) as rank_within_parent  from     web_sales    ,date_dim       d1    ,item  where     d1.d_month_seq between 1205 and 1205+11  and d1.d_date_sk = ws_sold_date_sk  and i_item_sk  = ws_item_sk  group by rollup(i_category,i_class)  order by    lochierarchy desc,    case when (grouping(i_category)+grouping(i_class)) = 0 then i_category end,    rank_within_parent  ;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_class", "i_item_sk", "i_category"], "web_sales": ["ws_net_paid", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 87, "query_string": " select count(*)  from ((select distinct c_last_name, c_first_name, d_date        from store_sales, date_dim, customer        where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_customer_sk = customer.c_customer_sk          and d_month_seq between 1205 and 1205+11)        except       (select distinct c_last_name, c_first_name, d_date        from catalog_sales, date_dim, customer        where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk          and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk          and d_month_seq between 1205 and 1205+11)        except       (select distinct c_last_name, c_first_name, d_date        from web_sales, date_dim, customer        where web_sales.ws_sold_date_sk = date_dim.d_date_sk          and web_sales.ws_bill_customer_sk = customer.c_customer_sk          and d_month_seq between 1205 and 1205+11) ) cool_cust;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 88, "query_string": " select  * from  (select count(*) h8_30_to_9  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk         and ss_hdemo_sk = household_demographics.hd_demo_sk       and ss_store_sk = s_store_sk      and time_dim.t_hour = 8      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))       and store.s_store_name = 'ese') s1,  (select count(*) h9_to_9_30   from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk       and time_dim.t_hour = 9       and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))      and store.s_store_name = 'ese') s2,  (select count(*) h9_30_to_10   from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 9      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))      and store.s_store_name = 'ese') s3,  (select count(*) h10_to_10_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 10       and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))      and store.s_store_name = 'ese') s4,  (select count(*) h10_30_to_11  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 10       and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))      and store.s_store_name = 'ese') s5,  (select count(*) h11_to_11_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk       and time_dim.t_hour = 11      and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))      and store.s_store_name = 'ese') s6,  (select count(*) h11_30_to_12  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 11      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))      and store.s_store_name = 'ese') s7,  (select count(*) h12_to_12_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 12      and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2))      and store.s_store_name = 'ese') s8;", "predicates": {"household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_store_name"], "time_dim": ["t_hour", "t_minute"]}, "payload": {"household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_sold_time_sk"], "time_dim": ["t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 89, "query_string": " select top (100) * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (1999) and         ((i_category in ('Music','Jewelry','Sports') and           i_class in ('rock','rings','hockey')          )       or (i_category in ('Women','Home','Shoes') and           i_class in ('dresses','paint','mens')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name;", "predicates": {"date_dim": ["d_year"], "item": ["i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_brand", "i_class", "i_item_sk", "i_category"], "store": ["s_store_name", "s_store_sk", "s_company_name"]}, "group_by": {}, "order_by": {"store": ["s_store_name"]}}
{"id": 90, "query_string": " select top (100) cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio  from ( select count(*) amc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 10 and 10+1          and household_demographics.hd_dep_count = 6          and web_page.wp_char_count between 5000 and 5200) at,       ( select count(*) pmc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 15 and 15+1          and household_demographics.hd_dep_count = 6          and web_page.wp_char_count between 5000 and 5200) pt  order by am_pm_ratio  ;", "predicates": {"household_demographics": ["hd_dep_count"], "time_dim": ["t_hour"], "web_page": ["wp_char_count"]}, "payload": {"household_demographics": ["hd_demo_sk"], "time_dim": ["t_time_sk"], "web_page": ["wp_web_page_sk"], "web_sales": ["ws_sold_time_sk", "ws_web_page_sk", "ws_ship_hdemo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 91, "query_string": " select           cc_call_center_id Call_Center,         cc_name Call_Center_Name,         cc_manager Manager,         sum(cr_net_loss) Returns_Loss from         call_center,         catalog_returns,         date_dim,         customer,         customer_address,         customer_demographics,         household_demographics where         cr_call_center_sk       = cc_call_center_sk and     cr_returned_date_sk     = d_date_sk and     cr_returning_customer_sk= c_customer_sk and     cd_demo_sk              = c_current_cdemo_sk and     hd_demo_sk              = c_current_hdemo_sk and     ca_address_sk           = c_current_addr_sk and     d_year                  = 1999  and     d_moy                   = 11 and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')         or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree')) and     hd_buy_potential like '0-500%' and     ca_gmt_offset           = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc;", "predicates": {"customer_address": ["ca_gmt_offset"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_moy", "d_year"], "household_demographics": ["hd_buy_potential"]}, "payload": {"call_center": ["cc_name", "cc_call_center_id", "cc_manager", "cc_call_center_sk"], "catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_returning_customer_sk", "cr_call_center_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk", "c_current_hdemo_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 92, "query_string": " select top (100)     sum(ws_ext_discount_amt)  as \"Excess Discount Amount\"  from      web_sales     ,item     ,date_dim where i_manufact_id = 357 and i_item_sk = ws_item_sk  and d_date between '2002-03-20' and          dateadd(day, 90, cast('2002-03-20' as date)) and d_date_sk = ws_sold_date_sk  and ws_ext_discount_amt        > (           SELECT              1.3 * avg(ws_ext_discount_amt)           FROM              web_sales             ,date_dim          WHERE                ws_item_sk = i_item_sk            and d_date between '2002-03-20' and                              dateadd(day, 90, cast('2002-03-20' as date))           and d_date_sk = ws_sold_date_sk        )  order by sum(ws_ext_discount_amt);", "predicates": {"date_dim": ["d_date"], "item": ["i_manufact_id"], "web_sales": ["ws_ext_discount_amt"]}, "payload": {"item": ["i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 93, "query_string": " select top (100) ss_customer_sk             ,sum(act_sales) sumsales       from (select ss_item_sk                   ,ss_ticket_number                   ,ss_customer_sk                   ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price                                                             else (ss_quantity*ss_sales_price) end act_sales             from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk                                                                and sr_ticket_number = ss_ticket_number)                 ,reason             where sr_reason_sk = r_reason_sk               and r_reason_desc = 'Did not fit') t       group by ss_customer_sk       order by sumsales, ss_customer_sk;", "predicates": {"reason": ["r_reason_desc"]}, "payload": {"reason": ["r_reason_sk"], "store_returns": ["sr_reason_sk", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"]}, "group_by": {}, "order_by": {"store_sales": ["ss_customer_sk"]}}
{"id": 94, "query_string": " select top (100)     count(distinct ws_order_number) as \"order count\"   ,sum(ws_ext_ship_cost) as \"total shipping cost\"   ,sum(ws_net_profit) as \"total net profit\" from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '1999-2-01' and             dateadd(day, 60, cast('1999-2-01' as date)) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'MS' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number);", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_date"], "web_site": ["web_company_name"]}, "payload": {"customer_address": ["ca_address_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_net_profit", "ws_ship_date_sk", "ws_ship_addr_sk", "ws_ext_ship_cost", "ws_warehouse_sk", "ws_order_number", "ws_web_site_sk"], "web_site": ["web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 95, "query_string": " with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select top (100)     count(distinct ws_order_number) as \"order count\"   ,sum(ws_ext_ship_cost) as \"total shipping cost\"   ,sum(ws_net_profit) as \"total net profit\" from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '1999-2-01' and             dateadd(day, 60, cast('1999-2-01' as date)) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'MS' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number);", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_date"], "web_site": ["web_company_name"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_net_profit", "ws_ship_date_sk", "ws_item_sk", "ws_ship_addr_sk", "ws_ext_ship_cost", "ws_warehouse_sk", "ws_order_number", "ws_web_site_sk"], "web_site": ["web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 96, "query_string": " select top (100) count(*)  from store_sales     ,household_demographics      ,time_dim, store where ss_sold_time_sk = time_dim.t_time_sk        and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk     and time_dim.t_hour = 15     and time_dim.t_minute >= 30     and household_demographics.hd_dep_count = 7     and store.s_store_name = 'ese' order by count(*);", "predicates": {"household_demographics": ["hd_dep_count"], "store": ["s_store_name"], "time_dim": ["t_hour", "t_minute"]}, "payload": {"household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_sold_time_sk"], "time_dim": ["t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 97, "query_string": " with ssci as ( select ss_customer_sk customer_sk       ,ss_item_sk item_sk from store_sales,date_dim where ss_sold_date_sk = d_date_sk   and d_month_seq between 1205 and 1205 + 11 group by ss_customer_sk         ,ss_item_sk), csci as(  select cs_bill_customer_sk customer_sk       ,cs_item_sk item_sk from catalog_sales,date_dim where cs_sold_date_sk = d_date_sk   and d_month_seq between 1205 and 1205 + 11 group by cs_bill_customer_sk         ,cs_item_sk)  select top (100) sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only       ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only       ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk                                and ssci.item_sk = csci.item_sk);", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk", "cs_item_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 98, "query_string": " select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from\t \tstore_sales     \t,item      \t,date_dim where  \tss_item_sk = i_item_sk    \tand i_category in ('Books', 'Home', 'Men')   \tand ss_sold_date_sk = d_date_sk \tand d_date between cast('2000-04-27' as date)  \t\t\t\tand dateadd(day, 30, cast('2000-04-27' as date)) group by  \ti_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  \ti_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"]}, "group_by": {}, "order_by": {}}
{"id": 99, "query_string": " select top (100)     substring(w_warehouse_name,1,20)   ,sm_type   ,cc_name   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and                   (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and                   (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and                  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    catalog_sales   ,warehouse   ,ship_mode   ,call_center   ,date_dim where     d_month_seq between 1205 and 1205 + 11 and cs_ship_date_sk   = d_date_sk and cs_warehouse_sk   = w_warehouse_sk and cs_ship_mode_sk   = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by    substring(w_warehouse_name,1,20)   ,sm_type   ,cc_name order by substring(w_warehouse_name,1,20)         ,sm_type         ,cc_name;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"call_center": ["cc_name", "cc_call_center_sk"], "catalog_sales": ["cs_warehouse_sk", "cs_call_center_sk", "cs_ship_date_sk", "cs_ship_mode_sk", "cs_sold_date_sk"], "date_dim": ["d_date_sk"], "ship_mode": ["sm_type", "sm_ship_mode_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 1, "query_string": " with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sum(SR_REFUNDED_CASH) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1998 group by sr_customer_sk ,sr_store_sk)  select top (100) c_customer_id from customer_total_return ctr1 ,store ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'TN' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id;", "predicates": {"date_dim": ["d_year"], "store": ["s_state"], "store_returns": ["sr_store_sk"]}, "payload": {"customer": ["c_customer_id", "c_customer_sk"], "date_dim": ["d_date_sk"], "store": ["s_store_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_customer_id"]}}
{"id": 2, "query_string": " with wscs as  (select sold_date_sk         ,sales_price   from (select ws_sold_date_sk sold_date_sk               ,ws_ext_sales_price sales_price         from web_sales          union all         select cs_sold_date_sk sold_date_sk               ,cs_ext_sales_price sales_price         from catalog_sales) a),  wswscs as   (select d_week_seq,         sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales  from wscs      ,date_dim  where d_date_sk = sold_date_sk  group by d_week_seq)  select d_week_seq1        ,round(sun_sales1/sun_sales2,2)        ,round(mon_sales1/mon_sales2,2)        ,round(tue_sales1/tue_sales2,2)        ,round(wed_sales1/wed_sales2,2)        ,round(thu_sales1/thu_sales2,2)        ,round(fri_sales1/fri_sales2,2)        ,round(sat_sales1/sat_sales2,2)  from  (select wswscs.d_week_seq d_week_seq1         ,sun_sales sun_sales1         ,mon_sales mon_sales1         ,tue_sales tue_sales1         ,wed_sales wed_sales1         ,thu_sales thu_sales1         ,fri_sales fri_sales1         ,sat_sales sat_sales1   from wswscs,date_dim    where date_dim.d_week_seq = wswscs.d_week_seq and         d_year = 1998) y,  (select wswscs.d_week_seq d_week_seq2         ,sun_sales sun_sales2         ,mon_sales mon_sales2         ,tue_sales tue_sales2         ,wed_sales wed_sales2         ,thu_sales thu_sales2         ,fri_sales fri_sales2         ,sat_sales sat_sales2   from wswscs       ,date_dim    where date_dim.d_week_seq = wswscs.d_week_seq and         d_year = 1998+1) z  where d_week_seq1=d_week_seq2-53  order by d_week_seq1;", "predicates": {"date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_week_seq", "d_day_name"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 3, "query_string": " select top (100) dt.d_year         ,item.i_brand_id brand_id         ,item.i_brand brand        ,sum(ss_ext_sales_price) sum_agg  from  date_dim dt        ,store_sales       ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk    and store_sales.ss_item_sk = item.i_item_sk    and item.i_manufact_id = 505    and dt.d_moy=11  group by dt.d_year       ,item.i_brand       ,item.i_brand_id  order by dt.d_year          ,sum_agg desc          ,brand_id  ;", "predicates": {"date_dim": ["d_moy"], "item": ["i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"date_dim": ["d_year"], "item": ["i_brand_id"]}}
{"id": 4, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year  union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total        ,'c' sale_type  from customer      ,catalog_sales      ,date_dim  where c_customer_sk = cs_bill_customer_sk    and cs_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year          )   select top (100)                    t_s_secyear.customer_id                  ,t_s_secyear.customer_first_name                  ,t_s_secyear.customer_last_name                  ,t_s_secyear.customer_email_address  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_c_firstyear      ,year_total t_c_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id    and t_s_firstyear.customer_id = t_c_secyear.customer_id    and t_s_firstyear.customer_id = t_c_firstyear.customer_id    and t_s_firstyear.customer_id = t_w_firstyear.customer_id    and t_s_firstyear.customer_id = t_w_secyear.customer_id    and t_s_firstyear.sale_type = 's'    and t_c_firstyear.sale_type = 'c'    and t_w_firstyear.sale_type = 'w'    and t_s_secyear.sale_type = 's'    and t_c_secyear.sale_type = 'c'    and t_w_secyear.sale_type = 'w'    and t_s_firstyear.dyear =  1998    and t_s_secyear.dyear = 1998+1    and t_c_firstyear.dyear =  1998    and t_c_secyear.dyear =  1998+1    and t_w_firstyear.dyear = 1998    and t_w_secyear.dyear = 1998+1    and t_s_firstyear.year_total > 0    and t_c_firstyear.year_total > 0    and t_w_firstyear.year_total > 0    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end            > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end  order by t_s_secyear.customer_id          ,t_s_secyear.customer_first_name          ,t_s_secyear.customer_last_name          ,t_s_secyear.customer_email_address;", "predicates": {"date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_ext_list_price", "cs_ext_discount_amt", "cs_bill_customer_sk", "cs_ext_sales_price", "cs_ext_wholesale_cost", "cs_sold_date_sk"], "customer": ["c_login", "c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id"], "date_dim": ["d_date_sk"], "store_sales": ["ss_ext_discount_amt", "ss_ext_sales_price", "ss_ext_wholesale_cost", "ss_customer_sk", "ss_ext_list_price", "ss_sold_date_sk"], "web_sales": ["ws_ext_discount_amt", "ws_ext_wholesale_cost", "ws_ext_list_price", "ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 5, "query_string": " with ssr as  (select s_store_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  ss_store_sk as store_sk,             ss_sold_date_sk  as date_sk,             ss_ext_sales_price as sales_price,             ss_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from store_sales     union all     select sr_store_sk as store_sk,            sr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            sr_return_amt as return_amt,            sr_net_loss as net_loss     from store_returns    ) salesreturns,      date_dim,      store  where date_sk = d_date_sk        and d_date between cast('1999-08-18' as date)                    and dateadd(day, 14, cast('1999-08-18' as date))        and store_sk = s_store_sk  group by s_store_id)  ,  csr as  (select cp_catalog_page_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  cs_catalog_page_sk as page_sk,             cs_sold_date_sk  as date_sk,             cs_ext_sales_price as sales_price,             cs_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from catalog_sales     union all     select cr_catalog_page_sk as page_sk,            cr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            cr_return_amount as return_amt,            cr_net_loss as net_loss     from catalog_returns    ) salesreturns,      date_dim,      catalog_page  where date_sk = d_date_sk        and d_date between cast('1999-08-18' as date)                   and dateadd(day, 14, cast('1999-08-18' as date))        and page_sk = cp_catalog_page_sk  group by cp_catalog_page_id)  ,  wsr as  (select web_site_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  ws_web_site_sk as wsr_web_site_sk,             ws_sold_date_sk  as date_sk,             ws_ext_sales_price as sales_price,             ws_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from web_sales     union all     select ws_web_site_sk as wsr_web_site_sk,            wr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            wr_return_amt as return_amt,            wr_net_loss as net_loss     from web_returns left outer join web_sales on          ( wr_item_sk = ws_item_sk            and wr_order_number = ws_order_number)    ) salesreturns,      date_dim,      web_site  where date_sk = d_date_sk        and d_date between cast('1999-08-18' as date)                   and dateadd(day, 14, cast('1999-08-18' as date))        and wsr_web_site_sk = web_site_sk  group by web_site_id)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , concat('store' , s_store_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from   ssr  union all  select 'catalog channel' as channel         , concat('catalog_page' , cp_catalog_page_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from  csr  union all  select 'web channel' as channel         , concat('web_site' , web_site_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from   wsr  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_page": ["cp_catalog_page_sk", "cp_catalog_page_id"], "catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_return_amount", "cr_catalog_page_sk"], "catalog_sales": ["cs_catalog_page_sk", "cs_net_profit", "cs_sold_date_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_net_loss"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit", "ss_ext_sales_price"], "web_returns": ["wr_returned_date_sk", "wr_return_amt", "wr_net_loss", "wr_item_sk", "wr_order_number"], "web_sales": ["ws_net_profit", "ws_ext_sales_price", "ws_sold_date_sk", "ws_web_site_sk"], "web_site": ["web_site_id", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 6, "query_string": " select top (100) a.ca_state state, count(*) cnt  from customer_address a      ,customer c      ,store_sales s      ,date_dim d      ,item i  where       a.ca_address_sk = c.c_current_addr_sk  \tand c.c_customer_sk = s.ss_customer_sk  \tand s.ss_sold_date_sk = d.d_date_sk  \tand s.ss_item_sk = i.i_item_sk  \tand d.d_month_seq =   \t     (select distinct (d_month_seq)  \t      from date_dim                where d_year = 1998  \t        and d_moy = 1 )  \tand i.i_current_price > 1.2 *               (select avg(j.i_current_price)   \t     from item j   \t     where j.i_category = i.i_category)  group by a.ca_state  having count(*) >= 10  order by cnt, a.ca_state   ;", "predicates": {"date_dim": ["d_month_seq", "d_moy", "d_year"], "item": ["i_category", "i_current_price"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk", "d_month_seq"], "item": ["i_item_sk", "i_category", "i_current_price"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_item_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_state"]}}
{"id": 7, "query_string": " select top (100) i_item_id,          avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4   from store_sales, customer_demographics, date_dim, item, promotion  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_cdemo_sk = cd_demo_sk and        ss_promo_sk = p_promo_sk and        cd_gender = 'F' and         cd_marital_status = 'D' and        cd_education_status = 'Unknown' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 2000   group by i_item_id  order by i_item_id  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "promotion": ["p_channel_event", "p_channel_email"]}, "payload": {"customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"], "promotion": ["p_promo_sk"], "store_sales": ["ss_promo_sk", "ss_item_sk", "ss_cdemo_sk", "ss_list_price", "ss_quantity", "ss_sales_price", "ss_coupon_amt", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 8, "query_string": " select top (100) s_store_name       ,sum(ss_net_profit)  from store_sales      ,date_dim      ,store,      (select ca_zip      from (       SELECT substring(ca_zip,1,5) ca_zip       FROM customer_address       WHERE substring(ca_zip,1,5) IN (                           '87090','57369','64126','59223','45427','40879',                           '83942','11393','29366','15796','50471',                           '90314','47391','74734','56577','62489',                           '20292','68548','24587','20275','17012',                           '84153','47304','84569','53565','90701',                           '74450','64487','48388','35268','44846',                           '56586','21650','66668','78389','94111',                           '29733','71601','85945','49281','95904',                           '96134','91218','90877','94228','64448',                           '88153','80473','78394','84959','62187',                           '78284','89256','45808','62322','59718',                           '17484','68880','46024','16672','46399',                           '20070','49784','57349','50835','21389',                           '62121','41935','71579','41505','31403',                           '50239','62344','26031','15885','12300',                           '41949','57778','10392','16887','12520',                           '76922','37065','22651','33977','68990',                           '92530','12757','76780','34541','22889',                           '95846','82786','51709','24409','39606',                           '90185','74316','69032','96512','36226',                           '40601','51695','27379','40577','99585',                           '51337','20985','61774','78043','37051',                           '52277','90673','10963','59426','68479',                           '34974','74929','91298','61291','56535',                           '11236','80764','82377','40930','20211',                           '69408','17923','74585','56937','16230',                           '91960','46933','10970','67314','87455',                           '66409','61302','54511','27491','15130',                           '64311','97618','27041','10036','23781',                           '29782','37542','87282','26929','80719',                           '38769','77452','49847','31343','79721',                           '14635','72686','58193','15226','55152',                           '74360','73396','45416','20477','77232',                           '14607','30540','45946','83772','96173',                           '51299','69360','24650','84705','64375',                           '34495','10147','48089','78622','76629',                           '15477','92176','94664','20685','61117',                           '70971','12958','24238','99660','19054',                           '52922','90692','83135','47655','78453',                           '11371','81309','67675','50971','21753',                           '13812','15266','63332','46427','98030',                           '17293','47249','16156','67865','89377',                           '88333','44803','48520','39489','55574',                           '17345','56925','84171','58835','89429',                           '28152','50817','90678','92124','31454',                           '88880','56291','24809','75429','97133',                           '39525','91780','67201','94535','75848',                           '83652','10144','96581','61640','83386',                           '94874','95900','97828','20758','92901',                           '89908','40858','90478','87730','30613',                           '44748','23056','28516','64772','91126',                           '68955','38403','78173','83033','62617',                           '61009','39038','61530','81345','67123',                           '62509','76638','20767','54460','57722',                           '21475','50469','67416','75416','56763',                           '47314','57111','19846','62275','95143',                           '73403','80315','15040','57147','85889',                           '33405','52108','89992','12282','19163',                           '35155','59160','46364','24058','26153',                           '74879','71139','71862','37521','94586',                           '47412','17213','46466','46589','82165',                           '43913','20595','15131','42853','62268',                           '50806','99949','25507','90089','81791',                           '70221','35904','54719','31019','45526',                           '22084','85882','57890','33023','28403',                           '71500','77729','58209','97462','55331',                           '70126','13562','72791','23810','23054',                           '89776','70296','24445','74372','33710',                           '73135','55373','12054','96537','74181',                           '49754','65525','86618','16518','28718',                           '38862','23063','19303','11277','31985',                           '15111','23738','87192','97949','52167',                           '96779','88033','50931','20056','45943',                           '66015','73807','42661','92451','27852',                           '75635','68031','21383','90668','58735',                           '42229','72495','90171','77972','28519',                           '53734','77795','78869','48653','83057',                           '56516','32875','82508','43813','35513',                           '58464','55826','54377','28000','75769',                           '37993','27169','50358','60011')      intersect       select ca_zip       from (SELECT substring(ca_zip,1,5) ca_zip,count(*) cnt             FROM customer_address, customer             WHERE ca_address_sk = c_current_addr_sk and                   c_preferred_cust_flag='Y'             group by ca_zip             having count(*) > 10)A1)A2) V1  where ss_store_sk = s_store_sk   and ss_sold_date_sk = d_date_sk   and d_qoy = 1 and d_year = 2001   and (substring(s_zip,1,2) = substring(V1.ca_zip,1,2))  group by s_store_name  order by s_store_name  ;", "predicates": {"customer": ["c_preferred_cust_flag"], "date_dim": ["d_qoy", "d_year"]}, "payload": {"customer": ["c_current_addr_sk"], "customer_address": ["ca_address_sk", "ca_zip"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 9, "query_string": " select case when (select count(*)                    from store_sales                    where ss_quantity between 1 and 20) > 20173             then (select avg(ss_ext_discount_amt)                    from store_sales                    where ss_quantity between 1 and 20)              else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 1 and 20) end bucket1 ,        case when (select count(*)                   from store_sales                   where ss_quantity between 21 and 40) > 27733             then (select avg(ss_ext_discount_amt)                   from store_sales                   where ss_quantity between 21 and 40)              else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 21 and 40) end bucket2,        case when (select count(*)                   from store_sales                   where ss_quantity between 41 and 60) > 14121             then (select avg(ss_ext_discount_amt)                   from store_sales                   where ss_quantity between 41 and 60)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 41 and 60) end bucket3,        case when (select count(*)                   from store_sales                   where ss_quantity between 61 and 80) > 883             then (select avg(ss_ext_discount_amt)                   from store_sales                   where ss_quantity between 61 and 80)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 61 and 80) end bucket4,        case when (select count(*)                   from store_sales                   where ss_quantity between 81 and 100) > 14467             then (select avg(ss_ext_discount_amt)                   from store_sales                   where ss_quantity between 81 and 100)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 81 and 100) end bucket5 from reason where r_reason_sk = 1;", "predicates": {"store_sales": ["ss_quantity"]}, "payload": {"store_sales": ["ss_ext_tax", "ss_net_paid_inc_tax"]}, "group_by": {}, "order_by": {}}
{"id": 10, "query_string": " select top (100)    cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3,   cd_dep_count,   count(*) cnt4,   cd_dep_employed_count,   count(*) cnt5,   cd_dep_college_count,   count(*) cnt6  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_county in ('Thurston County','Butler County','Merrimack County','Grant County','Alleghany County') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 1999 and                 d_moy between 2 and 2+3) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 1999 and                   d_moy between 2 ANd 2+3) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 1999 and                   d_moy between 2 and 2+3))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count;", "predicates": {"customer_address": ["ca_county"], "date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 11, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag           ,c_birth_country          ,c_login          ,c_email_address          ,d_year   union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag           ,c_birth_country          ,c_login          ,c_email_address          ,d_year          )   select top (100)                    t_s_secyear.customer_id                  ,t_s_secyear.customer_first_name                  ,t_s_secyear.customer_last_name                  ,t_s_secyear.customer_email_address  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id          and t_s_firstyear.customer_id = t_w_secyear.customer_id          and t_s_firstyear.customer_id = t_w_firstyear.customer_id          and t_s_firstyear.sale_type = 's'          and t_w_firstyear.sale_type = 'w'          and t_s_secyear.sale_type = 's'          and t_w_secyear.sale_type = 'w'          and t_s_firstyear.dyear = 1998          and t_s_secyear.dyear = 1998+1          and t_w_firstyear.dyear = 1998          and t_w_secyear.dyear = 1998+1          and t_s_firstyear.year_total > 0          and t_w_firstyear.year_total > 0          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end              > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end  order by t_s_secyear.customer_id          ,t_s_secyear.customer_first_name          ,t_s_secyear.customer_last_name          ,t_s_secyear.customer_email_address;", "predicates": {"date_dim": ["d_year"]}, "payload": {"customer": ["c_login", "c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_ext_list_price", "ss_ext_discount_amt"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_discount_amt", "ws_ext_list_price"]}, "group_by": {}, "order_by": {}}
{"id": 12, "query_string": " select top (100) i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from\t \tweb_sales     \t,item      \t,date_dim where  \tws_item_sk = i_item_sk    \tand i_category in ('Shoes', 'Children', 'Jewelry')   \tand ws_sold_date_sk = d_date_sk \tand d_date between cast('1999-03-30' as date)  \t\t\t\tand dateadd(day, 30, cast('1999-03-30' as date)) group by  \ti_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  \ti_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_desc", "i_class", "i_item_id", "i_category"]}}
{"id": 13, "query_string": " select avg(ss_quantity)        ,avg(ss_ext_sales_price)        ,avg(ss_ext_wholesale_cost)        ,sum(ss_ext_wholesale_cost)  from store_sales      ,store      ,customer_demographics      ,household_demographics      ,customer_address      ,date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2001  and((ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'M'   and cd_education_status = '2 yr Degree'   and ss_sales_price between 100.00 and 150.00   and hd_dep_count = 3         )or      (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'W'   and cd_education_status = 'Unknown'   and ss_sales_price between 50.00 and 100.00      and hd_dep_count = 1      ) or       (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'S'   and cd_education_status = 'Secondary'   and ss_sales_price between 150.00 and 200.00    and hd_dep_count = 1        ))  and((ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('HI', 'TX', 'MS')   and ss_net_profit between 100 and 200        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('KY', 'ID', 'LA')   and ss_net_profit between 150 and 300        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('MT', 'IL', 'AK')   and ss_net_profit between 50 and 250        ));", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "household_demographics": ["hd_dep_count"], "store_sales": ["ss_sales_price", "ss_net_profit"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_dep_count", "hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_ext_sales_price", "ss_cdemo_sk", "ss_addr_sk", "ss_quantity", "ss_sales_price", "ss_ext_wholesale_cost", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 14, "query_string": " with  cross_items as  (select i_item_sk ss_item_sk  from item,  (select iss.i_brand_id brand_id      ,iss.i_class_id class_id      ,iss.i_category_id category_id  from store_sales      ,item iss      ,date_dim d1  where ss_item_sk = iss.i_item_sk    and ss_sold_date_sk = d1.d_date_sk    and d1.d_year between 1998 AND 1998 + 2  intersect   select ics.i_brand_id      ,ics.i_class_id      ,ics.i_category_id  from catalog_sales      ,item ics      ,date_dim d2  where cs_item_sk = ics.i_item_sk    and cs_sold_date_sk = d2.d_date_sk    and d2.d_year between 1998 AND 1998 + 2  intersect  select iws.i_brand_id      ,iws.i_class_id      ,iws.i_category_id  from web_sales      ,item iws      ,date_dim d3  where ws_item_sk = iws.i_item_sk    and ws_sold_date_sk = d3.d_date_sk    and d3.d_year between 1998 AND 1998 + 2) a  where i_brand_id = brand_id       and i_class_id = class_id       and i_category_id = category_id ),  avg_sales as  (select avg(quantity*list_price) average_sales   from (select ss_quantity quantity              ,ss_list_price list_price        from store_sales            ,date_dim        where ss_sold_date_sk = d_date_sk          and d_year between 1998 and 1998 + 2        union all         select cs_quantity quantity               ,cs_list_price list_price        from catalog_sales            ,date_dim        where cs_sold_date_sk = d_date_sk          and d_year between 1998 and 1998 + 2         union all        select ws_quantity quantity              ,ws_list_price list_price        from web_sales            ,date_dim        where ws_sold_date_sk = d_date_sk          and d_year between 1998 and 1998 + 2) x)   select top (100) channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)  from(        select 'store' channel, i_brand_id,i_class_id              ,i_category_id,sum(ss_quantity*ss_list_price) sales              , count(*) number_sales        from store_sales            ,item            ,date_dim        where ss_item_sk in (select ss_item_sk from cross_items)          and ss_item_sk = i_item_sk          and ss_sold_date_sk = d_date_sk          and d_year = 1998+2           and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)        union all        select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales        from catalog_sales            ,item            ,date_dim        where cs_item_sk in (select ss_item_sk from cross_items)          and cs_item_sk = i_item_sk          and cs_sold_date_sk = d_date_sk          and d_year = 1998+2           and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)        union all        select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales        from web_sales            ,item            ,date_dim        where ws_item_sk in (select ss_item_sk from cross_items)          and ws_item_sk = i_item_sk          and ws_sold_date_sk = d_date_sk          and d_year = 1998+2          and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)  ) y  group by rollup (channel, i_brand_id,i_class_id,i_category_id)  order by channel,i_brand_id,i_class_id,i_category_id  ; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_list_price", "cs_quantity"], "date_dim": ["d_date_sk"], "item": ["i_category_id", "i_class_id", "i_item_sk", "i_brand_id"], "store_sales": ["ss_sold_date_sk", "ss_list_price", "ss_quantity", "ss_item_sk"], "web_sales": ["ws_list_price", "ws_sold_date_sk", "ws_item_sk", "ws_quantity"]}, "group_by": {}, "order_by": {}}
{"id": 15, "query_string": " select top (100) ca_zip        ,sum(cs_sales_price)  from catalog_sales      ,customer      ,customer_address      ,date_dim  where cs_bill_customer_sk = c_customer_sk  \tand c_current_addr_sk = ca_address_sk   \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',                                    '85392', '85460', '80348', '81792')  \t      or ca_state in ('CA','WA','GA')  \t      or cs_sales_price > 500)  \tand cs_sold_date_sk = d_date_sk  \tand d_qoy = 2 and d_year = 1998  group by ca_zip  order by ca_zip  ;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"catalog_sales": ["cs_sales_price", "cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip", "ca_state"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_zip"]}}
{"id": 16, "query_string": " select top (100)     count(distinct cs_order_number) as \"order count\"   ,sum(cs_ext_ship_cost) as \"total shipping cost\"   ,sum(cs_net_profit) as \"total net profit\" from    catalog_sales cs1   ,date_dim   ,customer_address   ,call_center where     d_date between '2001-4-01' and             dateadd(day, 60, cast('2001-4-01' as date)) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'WI' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County',                   'Williamson County' ) and exists (select *             from catalog_sales cs2             where cs1.cs_order_number = cs2.cs_order_number               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select *                from catalog_returns cr1                where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number);", "predicates": {"call_center": ["cc_county"], "customer_address": ["ca_state"], "date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_order_number"], "catalog_sales": ["cs_order_number", "cs_warehouse_sk", "cs_ext_ship_cost", "cs_ship_addr_sk", "cs_net_profit", "cs_call_center_sk", "cs_ship_date_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 17, "query_string": " select top (100) i_item_id        ,i_item_desc        ,s_state        ,count(ss_quantity) as store_sales_quantitycount        ,avg(ss_quantity) as store_sales_quantityave        ,stdev(ss_quantity) as store_sales_quantitystdev        ,stdev(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov        ,count(sr_return_quantity) as store_returns_quantitycount        ,avg(sr_return_quantity) as store_returns_quantityave        ,stdev(sr_return_quantity) as store_returns_quantitystdev        ,stdev(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov        ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave        ,stdev(cs_quantity) as catalog_sales_quantitystdev        ,stdev(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov  from store_sales      ,store_returns      ,catalog_sales      ,date_dim d1      ,date_dim d2      ,date_dim d3      ,store      ,item  where d1.d_quarter_name = '2001Q1'    and d1.d_date_sk = ss_sold_date_sk    and i_item_sk = ss_item_sk    and s_store_sk = ss_store_sk    and ss_customer_sk = sr_customer_sk    and ss_item_sk = sr_item_sk    and ss_ticket_number = sr_ticket_number    and sr_returned_date_sk = d2.d_date_sk    and d2.d_quarter_name in ('2001Q1','2001Q2','2001Q3')    and sr_customer_sk = cs_bill_customer_sk    and sr_item_sk = cs_item_sk    and cs_sold_date_sk = d3.d_date_sk    and d3.d_quarter_name in ('2001Q1','2001Q2','2001Q3')  group by i_item_id          ,i_item_desc          ,s_state  order by i_item_id          ,i_item_desc          ,s_state;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_quarter_name"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_state", "s_store_sk"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_return_quantity", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 18, "query_string": " select top (100) i_item_id,         ca_country,         ca_state,          ca_county,         avg( cast(cs_quantity as decimal(12,2))) agg1,         avg( cast(cs_list_price as decimal(12,2))) agg2,         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,         avg( cast(cs_sales_price as decimal(12,2))) agg4,         avg( cast(cs_net_profit as decimal(12,2))) agg5,         avg( cast(c_birth_year as decimal(12,2))) agg6,         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7  from catalog_sales, customer_demographics cd1,        customer_demographics cd2, customer, customer_address, date_dim, item  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd1.cd_demo_sk and        cs_bill_customer_sk = c_customer_sk and        cd1.cd_gender = 'M' and         cd1.cd_education_status = 'Advanced Degree' and        c_current_cdemo_sk = cd2.cd_demo_sk and        c_current_addr_sk = ca_address_sk and        c_birth_month in (6,3,5,8,7,1) and        d_year = 2002 and        ca_state in ('TX','OK','WV'                    ,'WA','GA','NY','MD')  group by rollup (i_item_id, ca_country, ca_state, ca_county)  order by ca_country,         ca_state,          ca_county, \ti_item_id  ;", "predicates": {"customer": ["c_birth_month"], "customer_address": ["ca_state"], "customer_demographics": ["cd_education_status", "cd_gender"], "date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_quantity", "cs_sales_price", "cs_bill_customer_sk", "cs_item_sk", "cs_net_profit", "cs_list_price", "cs_coupon_amt", "cs_sold_date_sk", "cs_bill_cdemo_sk"], "customer": ["c_birth_year", "c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_county", "ca_country", "ca_state"], "customer_demographics": ["cd_demo_sk", "cd_dep_count"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_state", "ca_county", "ca_country"], "item": ["i_item_id"]}}
{"id": 19, "query_string": " select top (100) i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,  \tsum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item,customer,customer_address,store  where d_date_sk = ss_sold_date_sk    and ss_item_sk = i_item_sk    and i_manager_id=15    and d_moy=11    and d_year=1999    and ss_customer_sk = c_customer_sk     and c_current_addr_sk = ca_address_sk    and substring(ca_zip,1,5) <> substring(s_zip,1,5)     and ss_store_sk = s_store_sk   group by i_brand       ,i_brand_id       ,i_manufact_id       ,i_manufact  order by ext_price desc          ,i_brand          ,i_brand_id          ,i_manufact_id          ,i_manufact  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip"], "date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_brand_id", "i_manufact_id", "i_brand", "i_manufact"], "store": ["s_zip", "s_store_sk"]}, "group_by": {}, "order_by": {"item": ["i_brand", "i_manufact", "i_brand_id", "i_manufact_id"]}}
{"id": 20, "query_string": " select top (100) i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from\tcatalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Shoes', 'Children', 'Jewelry')    and cs_sold_date_sk = d_date_sk  and d_date between cast('1999-03-30' as date)   \t\t\t\tand dateadd(day, 30, cast('1999-03-30' as date))  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"]}, "group_by": {}, "order_by": {"item": ["i_item_desc", "i_class", "i_item_id", "i_category"]}}
{"id": 21, "query_string": " select top (100) *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-08' as date)) \t                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between dateadd(day, -30, cast ('1999-05-08' as date))                     and dateadd(day, 30, cast ('1999-05-08' as date))    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  ;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"]}, "payload": {"date_dim": ["d_date_sk", "d_date"], "item": ["i_item_id", "i_item_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 22, "query_string": " select top (100) i_product_name              ,i_brand              ,i_class              ,i_category              ,avg(inv_quantity_on_hand) qoh        from inventory            ,date_dim            ,item        where inv_date_sk=d_date_sk               and inv_item_sk=i_item_sk               and d_month_seq between 1219 and 1219 + 11        group by rollup(i_product_name                        ,i_brand                        ,i_class                        ,i_category) order by qoh, i_product_name, i_brand, i_class, i_category;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_brand", "i_product_name", "i_category", "i_class"]}, "group_by": {}, "order_by": {"item": ["i_product_name", "i_class", "i_brand", "i_category"]}}
{"id": 23, "query_string": " with frequent_ss_items as   (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt   from store_sales       ,date_dim        ,item   where ss_sold_date_sk = d_date_sk     and ss_item_sk = i_item_sk      and d_year in (1999,1999+1,1999+2,1999+3)   group by substring(i_item_desc,1,30),i_item_sk,d_date   having count(*) >4),  max_store_sales as  (select max(csales) tpcds_cmax    from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales         from store_sales             ,customer             ,date_dim          where ss_customer_sk = c_customer_sk          and ss_sold_date_sk = d_date_sk          and d_year in (1999,1999+1,1999+2,1999+3)          group by c_customer_sk) a),  best_ss_customer as  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales   from store_sales       ,customer   where ss_customer_sk = c_customer_sk   group by c_customer_sk   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select   * from  max_store_sales))   select top (100) sum(sales)  from (select cs_quantity*cs_list_price sales        from catalog_sales            ,date_dim         where d_year = 1999           and d_moy = 3           and cs_sold_date_sk = d_date_sk           and cs_item_sk in (select item_sk from frequent_ss_items)          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)       union all       select ws_quantity*ws_list_price sales        from web_sales             ,date_dim         where d_year = 1999           and d_moy = 3           and ws_sold_date_sk = d_date_sk           and ws_item_sk in (select item_sk from frequent_ss_items)          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) b  ; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"customer": ["c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "item": ["i_item_sk", "i_item_desc"], "store_sales": ["ss_item_sk", "ss_sales_price", "ss_customer_sk", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 24, "query_string": " with ssales as (select c_last_name       ,c_first_name       ,s_store_name       ,ca_state       ,s_state       ,i_color       ,i_current_price       ,i_manager_id       ,i_units       ,i_size       ,sum(ss_ext_sales_price) netpaid from store_sales     ,store_returns     ,store     ,item     ,customer     ,customer_address where ss_ticket_number = sr_ticket_number   and ss_item_sk = sr_item_sk   and ss_customer_sk = c_customer_sk   and ss_item_sk = i_item_sk   and ss_store_sk = s_store_sk   and c_current_addr_sk = ca_address_sk   and c_birth_country <> upper(ca_country)   and s_zip = ca_zip and s_market_id=10 group by c_last_name         ,c_first_name         ,s_store_name         ,ca_state         ,s_state         ,i_color         ,i_current_price         ,i_manager_id         ,i_units         ,i_size) select c_last_name       ,c_first_name       ,s_store_name       ,sum(netpaid) paid from ssales where i_color = 'gainsboro' group by c_last_name         ,c_first_name         ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid)                                  from ssales) order by c_last_name         ,c_first_name         ,s_store_name; ", "predicates": {"item": ["i_color"], "store": ["s_market_id"]}, "payload": {"customer": ["c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_current_addr_sk"], "customer_address": ["ca_address_sk", "ca_country", "ca_zip", "ca_state"], "item": ["i_item_sk", "i_units", "i_manager_id", "i_current_price", "i_size"], "store": ["s_zip", "s_store_name", "s_state", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_net_paid_inc_tax"]}, "group_by": {}, "order_by": {}}
{"id": 25, "query_string": " select top (100)   i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  ,min(ss_net_profit) as store_sales_profit  ,min(sr_net_loss) as store_returns_loss  ,min(cs_net_profit) as catalog_sales_profit  from  store_sales  ,store_returns  ,catalog_sales  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,item  where  d1.d_moy = 4  and d1.d_year = 1998  and d1.d_date_sk = ss_sold_date_sk  and i_item_sk = ss_item_sk  and s_store_sk = ss_store_sk  and ss_customer_sk = sr_customer_sk  and ss_item_sk = sr_item_sk  and ss_ticket_number = sr_ticket_number  and sr_returned_date_sk = d2.d_date_sk  and d2.d_moy               between 4 and  10  and d2.d_year              = 1998  and sr_customer_sk = cs_bill_customer_sk  and sr_item_sk = cs_item_sk  and cs_sold_date_sk = d3.d_date_sk  and d3.d_moy               between 4 and  10   and d3.d_year              = 1998  group by  i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  order by  i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  ;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_store_name", "s_store_sk", "s_store_id"], "store_returns": ["sr_returned_date_sk", "sr_net_loss", "sr_customer_sk", "sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 26, "query_string": " select top (100) i_item_id,          avg(cs_quantity) agg1,         avg(cs_list_price) agg2,         avg(cs_coupon_amt) agg3,         avg(cs_sales_price) agg4   from catalog_sales, customer_demographics, date_dim, item, promotion  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd_demo_sk and        cs_promo_sk = p_promo_sk and        cd_gender = 'F' and         cd_marital_status = 'D' and        cd_education_status = 'Unknown' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 2000   group by i_item_id  order by i_item_id  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "promotion": ["p_channel_event", "p_channel_email"]}, "payload": {"item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 27, "query_string": " select top (100) i_item_id,         s_state, grouping(s_state) g_state,         avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4  from store_sales, customer_demographics, date_dim, store, item  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_store_sk = s_store_sk and        ss_cdemo_sk = cd_demo_sk and        cd_gender = 'M' and        cd_marital_status = 'W' and        cd_education_status = 'Primary' and        d_year = 2001 and        s_state in ('TN','TN', 'TN', 'TN', 'TN', 'TN')  group by rollup (i_item_id, s_state)  order by i_item_id          ,s_state  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "store": ["s_state"]}, "payload": {"customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"], "store": ["s_state", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_cdemo_sk", "ss_list_price", "ss_quantity", "ss_sales_price", "ss_coupon_amt", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_id"], "store": ["s_state"]}}
{"id": 28, "query_string": " select top (100) * from (select avg(ss_list_price) B1_LP             ,count(ss_list_price) B1_CNT             ,count(distinct ss_list_price) B1_CNTD       from store_sales       where ss_quantity between 0 and 5         and (ss_list_price between 99 and 99+10               or ss_coupon_amt between 16322 and 16322+1000              or ss_wholesale_cost between 2 and 2+20)) B1,      (select avg(ss_list_price) B2_LP             ,count(ss_list_price) B2_CNT             ,count(distinct ss_list_price) B2_CNTD       from store_sales       where ss_quantity between 6 and 10         and (ss_list_price between 137 and 137+10           or ss_coupon_amt between 2090 and 2090+1000           or ss_wholesale_cost between 31 and 31+20)) B2,      (select avg(ss_list_price) B3_LP             ,count(ss_list_price) B3_CNT             ,count(distinct ss_list_price) B3_CNTD       from store_sales       where ss_quantity between 11 and 15         and (ss_list_price between 73 and 73+10           or ss_coupon_amt between 9860 and 9860+1000           or ss_wholesale_cost between 6 and 6+20)) B3,      (select avg(ss_list_price) B4_LP             ,count(ss_list_price) B4_CNT             ,count(distinct ss_list_price) B4_CNTD       from store_sales       where ss_quantity between 16 and 20         and (ss_list_price between 38 and 38+10           or ss_coupon_amt between 14179 and 14179+1000           or ss_wholesale_cost between 26 and 26+20)) B4,      (select avg(ss_list_price) B5_LP             ,count(ss_list_price) B5_CNT             ,count(distinct ss_list_price) B5_CNTD       from store_sales       where ss_quantity between 21 and 25         and (ss_list_price between 20 and 20+10           or ss_coupon_amt between 5467 and 5467+1000           or ss_wholesale_cost between 17 and 17+20)) B5,      (select avg(ss_list_price) B6_LP             ,count(ss_list_price) B6_CNT             ,count(distinct ss_list_price) B6_CNTD       from store_sales       where ss_quantity between 26 and 30         and (ss_list_price between 142 and 142+10           or ss_coupon_amt between 13850 and 13850+1000           or ss_wholesale_cost between 14 and 14+20)) B6;", "predicates": {"store_sales": ["ss_list_price", "ss_coupon_amt", "ss_quantity", "ss_wholesale_cost"]}, "payload": {"store_sales": ["ss_list_price"]}, "group_by": {}, "order_by": {}}
{"id": 29, "query_string": " select top (100)        i_item_id     ,i_item_desc     ,s_store_id     ,s_store_name     ,stdev(ss_quantity)        as store_sales_quantity     ,stdev(sr_return_quantity) as store_returns_quantity     ,stdev(cs_quantity)        as catalog_sales_quantity  from     store_sales    ,store_returns    ,catalog_sales    ,date_dim             d1    ,date_dim             d2    ,date_dim             d3    ,store    ,item  where      d1.d_moy               = 4   and d1.d_year              = 1999  and d1.d_date_sk           = ss_sold_date_sk  and i_item_sk              = ss_item_sk  and s_store_sk             = ss_store_sk  and ss_customer_sk         = sr_customer_sk  and ss_item_sk             = sr_item_sk  and ss_ticket_number       = sr_ticket_number  and sr_returned_date_sk    = d2.d_date_sk  and d2.d_moy               between 4 and  4 + 3   and d2.d_year              = 1999  and sr_customer_sk         = cs_bill_customer_sk  and sr_item_sk             = cs_item_sk  and cs_sold_date_sk        = d3.d_date_sk       and d3.d_year              in (1999,1999+1,1999+2)  group by     i_item_id    ,i_item_desc    ,s_store_id    ,s_store_name  order by     i_item_id     ,i_item_desc    ,s_store_id    ,s_store_name  ;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_store_name", "s_store_sk", "s_store_id"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_return_quantity", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 30, "query_string": " with customer_total_return as  (select wr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   \tsum(wr_return_amt) as ctr_total_return  from web_returns      ,date_dim      ,customer_address  where wr_returned_date_sk = d_date_sk     and d_year =2002    and wr_returning_addr_sk = ca_address_sk   group by wr_returning_customer_sk          ,ca_state)   select top (100) c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag        ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address        ,c_last_review_date,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  \t\t\t  from customer_total_return ctr2                    \t  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'MO'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag                   ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address                   ,c_last_review_date,ctr_total_return;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_year"]}, "payload": {"customer": ["c_birth_year", "c_login", "c_customer_sk", "c_birth_month", "c_salutation", "c_birth_day", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_current_addr_sk", "c_email_address", "c_customer_id", "c_last_review_date"], "customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "web_returns": ["wr_return_amt", "wr_returning_addr_sk", "wr_returned_date_sk", "wr_returning_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_birth_year", "c_login", "c_birth_month", "c_birth_country", "c_salutation", "c_birth_day", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id", "c_last_review_date"]}}
{"id": 31, "query_string": " with ss as  (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales  from store_sales,date_dim,customer_address  where ss_sold_date_sk = d_date_sk   and ss_addr_sk=ca_address_sk  group by ca_county,d_qoy, d_year),  ws as  (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales  from web_sales,date_dim,customer_address  where ws_sold_date_sk = d_date_sk   and ws_bill_addr_sk=ca_address_sk  group by ca_county,d_qoy, d_year)  select          ss1.ca_county        ,ss1.d_year        ,ws2.web_sales/ws1.web_sales web_q1_q2_increase        ,ss2.store_sales/ss1.store_sales store_q1_q2_increase        ,ws3.web_sales/ws2.web_sales web_q2_q3_increase        ,ss3.store_sales/ss2.store_sales store_q2_q3_increase  from         ss ss1        ,ss ss2        ,ss ss3        ,ws ws1        ,ws ws2        ,ws ws3  where     ss1.d_qoy = 1     and ss1.d_year = 1998     and ss1.ca_county = ss2.ca_county     and ss2.d_qoy = 2     and ss2.d_year = 1998  and ss2.ca_county = ss3.ca_county     and ss3.d_qoy = 3     and ss3.d_year = 1998     and ss1.ca_county = ws1.ca_county     and ws1.d_qoy = 1     and ws1.d_year = 1998     and ws1.ca_county = ws2.ca_county     and ws2.d_qoy = 2     and ws2.d_year = 1998     and ws1.ca_county = ws3.ca_county     and ws3.d_qoy = 3     and ws3.d_year =1998     and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end         > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end     and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end        > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end  order by store_q1_q2_increase;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"customer_address": ["ca_address_sk", "ca_county"], "date_dim": ["d_date_sk", "d_year"], "store_sales": ["ss_sold_date_sk", "ss_addr_sk", "ss_ext_sales_price"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_bill_addr_sk"]}, "group_by": {}, "order_by": {}}
{"id": 32, "query_string": " select top (100) sum(cs_ext_discount_amt)  as \"excess discount amount\"  from     catalog_sales     ,item     ,date_dim where i_manufact_id = 625 and i_item_sk = cs_item_sk  and d_date between '2002-03-10' and          dateadd(day, 90, cast('2002-03-10' as date)) and d_date_sk = cs_sold_date_sk  and cs_ext_discount_amt        > (           select              1.3 * avg(cs_ext_discount_amt)           from              catalog_sales             ,date_dim          where                cs_item_sk = i_item_sk            and d_date between '2002-03-10' and                              dateadd(day, 90, cast('2002-03-10' as date))           and d_date_sk = cs_sold_date_sk        ) ;", "predicates": {"catalog_sales": ["cs_ext_discount_amt"], "date_dim": ["d_date"], "item": ["i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 33, "query_string": " with ss as (  select           i_manufact_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id in (select   i_manufact_id from  item where i_category in ('Electronics'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 4  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  cs as (  select           i_manufact_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Electronics'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 4  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  ws as (  select           i_manufact_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Electronics'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 4  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_manufact_id)   select top (100) i_manufact_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_manufact_id  order by total_sales;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_category"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_addr_sk", "cs_item_sk", "cs_ext_sales_price"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_manufact_id"], "store_sales": ["ss_sold_date_sk", "ss_addr_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk", "ws_bill_addr_sk"]}, "group_by": {}, "order_by": {}}
{"id": 34, "query_string": " select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = 'Unknown')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  \tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  \telse null  \tend)  > 1.2     and date_dim.d_year in (2000,2000+1,2000+2)     and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',                            'Williamson County','Williamson County','Williamson County','Williamson County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;", "predicates": {"date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count", "hd_buy_potential"], "store": ["s_county"]}, "payload": {"customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_preferred_cust_flag"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 35, "query_string": " select top (100)     ca_state,   cd_gender,   cd_marital_status,   cd_dep_count,   count(*) cnt1,   max(cd_dep_count),   stdev(cd_dep_count),   max(cd_dep_count),   cd_dep_employed_count,   count(*) cnt2,   max(cd_dep_employed_count),   stdev(cd_dep_employed_count),   max(cd_dep_employed_count),   cd_dep_college_count,   count(*) cnt3,   max(cd_dep_college_count),   stdev(cd_dep_college_count),   max(cd_dep_college_count)  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2001 and                 d_qoy < 4) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_qoy < 4) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_qoy < 4))  group by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  ;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_state"], "customer_demographics": ["cd_dep_college_count", "cd_gender", "cd_demo_sk", "cd_dep_employed_count", "cd_dep_count", "cd_marital_status"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 36, "query_string": " select top (100)      sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  \tpartition by grouping(i_category)+grouping(i_class),  \tcase when grouping(i_class) = 0 then i_category end   \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent  from     store_sales    ,date_dim       d1    ,item    ,store  where     d1.d_year = 1998   and d1.d_date_sk = ss_sold_date_sk  and i_item_sk  = ss_item_sk   and s_store_sk  = ss_store_sk  and s_state in ('TN','TN','TN','TN',                  'TN','TN','TN','TN')  group by rollup(i_category,i_class)  order by    lochierarchy desc   ,case when (grouping(i_category)+grouping(i_class)) = 0 then i_category end   ,rank_within_parent   ;", "predicates": {"date_dim": ["d_year"], "store": ["s_state"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_class", "i_item_sk", "i_category"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_ext_sales_price", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 37, "query_string": " select top (100) i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 67 and 67 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('1999-03-28' as date) and dateadd(day, 60, cast('1999-03-28' as date))  and i_manufact_id in (989,791,922,917)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  ;", "predicates": {"date_dim": ["d_date"], "inventory": ["inv_quantity_on_hand"], "item": ["i_current_price", "i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc", "i_current_price"]}, "group_by": {}, "order_by": {}}
{"id": 38, "query_string": " select top (100) count(*) from (     select distinct c_last_name, c_first_name, d_date     from store_sales, date_dim, customer           where store_sales.ss_sold_date_sk = date_dim.d_date_sk       and store_sales.ss_customer_sk = customer.c_customer_sk       and d_month_seq between 1219 and 1219 + 11   intersect     select distinct c_last_name, c_first_name, d_date     from catalog_sales, date_dim, customer           where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk       and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk       and d_month_seq between 1219 and 1219 + 11   intersect     select distinct c_last_name, c_first_name, d_date     from web_sales, date_dim, customer           where web_sales.ws_sold_date_sk = date_dim.d_date_sk       and web_sales.ws_bill_customer_sk = customer.c_customer_sk       and d_month_seq between 1219 and 1219 + 11 ) hot_cust;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk", "ws_item_sk", "ws_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 39, "query_string": " with inv as (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy        ,stdev,mean, case mean when 0 then null else stdev/mean end cov  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy             ,stdev(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean       from inventory           ,item           ,warehouse           ,date_dim       where inv_item_sk = i_item_sk         and inv_warehouse_sk = w_warehouse_sk         and inv_date_sk = d_date_sk         and d_year =1999       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo  where case mean when 0 then 0 else stdev/mean end > 1) select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov from inv inv1,inv inv2 where inv1.i_item_sk = inv2.i_item_sk   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk   and inv1.d_moy=1   and inv2.d_moy=1+1 order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov         ,inv2.d_moy,inv2.mean, inv2.cov; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_item_sk"], "warehouse": ["w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 40, "query_string": " select top (100)     w_state   ,i_item_id   ,sum(case when (cast(d_date as date) < cast ('1999-05-08' as date))   \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before   ,sum(case when (cast(d_date as date) >= cast ('1999-05-08' as date))   \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after  from    catalog_sales left outer join catalog_returns on        (cs_order_number = cr_order_number          and cs_item_sk = cr_item_sk)   ,warehouse    ,item   ,date_dim  where      i_current_price between 0.99 and 1.49  and i_item_sk          = cs_item_sk  and cs_warehouse_sk    = w_warehouse_sk   and cs_sold_date_sk    = d_date_sk  and d_date between dateadd(day, -30, cast ('1999-05-08' as date))                 and dateadd(day, 30, cast ('1999-05-08' as date))   group by     w_state,i_item_id  order by w_state,i_item_id;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_refunded_cash"], "date_dim": ["d_date_sk", "d_date"], "item": ["i_item_id", "i_item_sk"], "warehouse": ["w_state", "w_warehouse_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_id"], "warehouse": ["w_state"]}}
{"id": 41, "query_string": " select distinct top (100) i_product_name  from item i1  where i_manufact_id between 982 and 982+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'violet' or i_color = 'dim') and          (i_units = 'Gram' or i_units = 'Dram') and         (i_size = 'N/A' or i_size = 'small')         ) or         (i_category = 'Women' and         (i_color = 'pale' or i_color = 'dark') and         (i_units = 'Gross' or i_units = 'Case') and         (i_size = 'economy' or i_size = 'medium')         ) or         (i_category = 'Men' and         (i_color = 'hot' or i_color = 'sky') and         (i_units = 'Tsp' or i_units = 'Bunch') and         (i_size = 'extra large' or i_size = 'large')         ) or         (i_category = 'Men' and         (i_color = 'gainsboro' or i_color = 'indian') and         (i_units = 'Bundle' or i_units = 'Ton') and         (i_size = 'N/A' or i_size = 'small')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'cream' or i_color = 'chartreuse') and          (i_units = 'Dozen' or i_units = 'Pallet') and         (i_size = 'N/A' or i_size = 'small')         ) or         (i_category = 'Women' and         (i_color = 'red' or i_color = 'orange') and         (i_units = 'Oz' or i_units = 'Unknown') and         (i_size = 'economy' or i_size = 'medium')         ) or         (i_category = 'Men' and         (i_color = 'light' or i_color = 'beige') and         (i_units = 'Box' or i_units = 'Tbl') and         (i_size = 'extra large' or i_size = 'large')         ) or         (i_category = 'Men' and         (i_color = 'chiffon' or i_color = 'forest') and         (i_units = 'Cup' or i_units = 'Lb') and         (i_size = 'N/A' or i_size = 'small')         )))) > 0  order by i_product_name  ;", "predicates": {"item": ["i_color", "i_units", "i_manufact_id", "i_category", "i_size", "i_manufact"]}, "payload": {"item": ["i_color", "i_units", "i_product_name", "i_category", "i_size", "i_manufact"]}, "group_by": {}, "order_by": {}}
{"id": 42, "query_string": " select top (100) dt.d_year  \t,item.i_category_id  \t,item.i_category  \t,sum(ss_ext_sales_price)  from \tdate_dim dt  \t,store_sales  \t,item  where dt.d_date_sk = store_sales.ss_sold_date_sk  \tand store_sales.ss_item_sk = item.i_item_sk  \tand item.i_manager_id = 1  \t  \tand dt.d_moy=11  \tand dt.d_year=1999  group by \tdt.d_year  \t\t,item.i_category_id  \t\t,item.i_category  order by       sum(ss_ext_sales_price) desc,dt.d_year  \t\t,item.i_category_id  \t\t,item.i_category  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_item_sk", "i_category", "i_category_id"]}, "group_by": {}, "order_by": {"item": ["i_category", "i_category_id"]}}
{"id": 43, "query_string": " select top (100) s_store_name, s_store_id,         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales  from date_dim, store_sales, store  where d_date_sk = ss_sold_date_sk and        s_store_sk = ss_store_sk and        s_gmt_offset = -5 and        d_year = 1999   group by s_store_name, s_store_id  order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales  ;", "predicates": {"date_dim": ["d_year"], "store": ["s_gmt_offset"]}, "payload": {"date_dim": ["d_date_sk", "d_day_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 44, "query_string": " select top (100) asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing from(select *      from (select item_sk,rank() over (order by rank_col asc) rnk            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col                   from store_sales ss1                  where ss_store_sk = 4                  group by ss_item_sk                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col                                                   from store_sales                                                   where ss_store_sk = 4                                                     and ss_customer_sk is null                                                   group by ss_store_sk))V1)V11      where rnk  < 11) asceding,     (select *      from (select item_sk,rank() over (order by rank_col desc) rnk            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col                  from store_sales ss1                  where ss_store_sk = 4                  group by ss_item_sk                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col                                                   from store_sales                                                   where ss_store_sk = 4                                                     and ss_customer_sk is null                                                   group by ss_store_sk))V2)V21      where rnk  < 11) descending, item i1, item i2 where asceding.rnk = descending.rnk    and i1.i_item_sk=asceding.item_sk   and i2.i_item_sk=descending.item_sk order by asceding.rnk;", "predicates": {"store_sales": ["ss_store_sk", "ss_customer_sk"]}, "payload": {"store_sales": ["ss_net_profit", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 45, "query_string": " select top (100) ca_zip, ca_county, sum(ws_sales_price)  from web_sales, customer, customer_address, date_dim, item  where ws_bill_customer_sk = c_customer_sk  \tand c_current_addr_sk = ca_address_sk   \tand ws_item_sk = i_item_sk   \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')  \t      or   \t      i_item_id in (select i_item_id                              from item                              where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)                              )  \t    )  \tand ws_sold_date_sk = d_date_sk  \tand d_qoy = 1 and d_year = 1998  group by ca_zip, ca_county  order by ca_zip, ca_county  ;", "predicates": {"customer_address": ["ca_zip"], "date_dim": ["d_qoy", "d_year"], "item": ["i_item_id"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip", "ca_city"], "date_dim": ["d_date_sk"], "web_sales": ["ws_sales_price", "ws_sold_date_sk", "ws_bill_customer_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 46, "query_string": " select top (100) c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,ca_city bought_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics,customer_address      where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and (household_demographics.hd_dep_count = 6 or          household_demographics.hd_vehicle_count= 1)     and date_dim.d_dow in (6,0)     and date_dim.d_year in (2000,2000+1,2000+2)      and store.s_city in ('Fairview','Midway','Midway','Fairview','Fairview')      group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr     where ss_customer_sk = c_customer_sk       and customer.c_current_addr_sk = current_addr.ca_address_sk       and current_addr.ca_city <> bought_city   order by c_last_name           ,c_first_name           ,ca_city           ,bought_city           ,ss_ticket_number   ;", "predicates": {"date_dim": ["d_dow", "d_year"], "household_demographics": ["hd_vehicle_count", "hd_dep_count"], "store": ["s_city"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk", "c_first_name", "c_last_name"], "customer_address": ["ca_city", "ca_address_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_addr_sk", "ss_coupon_amt", "ss_customer_sk", "ss_hdemo_sk", "ss_net_profit", "ss_sold_date_sk", "ss_store_sk", "ss_ticket_number"]}, "group_by": {}, "order_by": {}}
{"id": 47, "query_string": " with v1 as(  select i_category, i_brand,         s_store_name, s_company_name,         d_year, d_moy,         sum(ss_sales_price) sum_sales,         avg(sum(ss_sales_price)) over           (partition by i_category, i_brand,                      s_store_name, s_company_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      s_store_name, s_company_name            order by d_year, d_moy) rn  from item, store_sales, date_dim, store  where ss_item_sk = i_item_sk and        ss_sold_date_sk = d_date_sk and        ss_store_sk = s_store_sk and        (          d_year = 2000 or          ( d_year = 2000-1 and d_moy =12) or          ( d_year = 2000+1 and d_moy =1)        )  group by i_category, i_brand,           s_store_name, s_company_name,           d_year, d_moy),  v2 as(  select v1.s_store_name         ,v1.d_year, v1.d_moy         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1.s_store_name = v1_lag.s_store_name and        v1.s_store_name = v1_lead.s_store_name and        v1.s_company_name = v1_lag.s_company_name and        v1.s_company_name = v1_lead.s_company_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select top (100) *  from v2  where  d_year = 2000 and             avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, psum  ;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk", "d_moy", "d_year"], "item": ["i_brand", "i_item_sk", "i_category"], "store": ["s_store_name", "s_store_sk", "s_company_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 48, "query_string": " select sum (ss_quantity)  from store_sales, store, customer_demographics, customer_address, date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 1998  and    (   (    cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'M'    and     cd_education_status = '4 yr Degree'    and     ss_sales_price between 100.00 and 150.00      )  or   (   cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'U'    and     cd_education_status = 'Secondary'    and     ss_sales_price between 50.00 and 100.00      )  or   (   cd_demo_sk = ss_cdemo_sk   and     cd_marital_status = 'S'    and     cd_education_status = '2 yr Degree'    and     ss_sales_price between 150.00 and 200.00    )  )  and  (   (   ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('KS', 'WI', 'NJ')   and ss_net_profit between 0 and 2000     )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('WV', 'NE', 'MT')   and ss_net_profit between 150 and 3000    )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('CA', 'MI', 'FL')   and ss_net_profit between 50 and 25000    )  );", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "store_sales": ["ss_sales_price", "ss_net_profit"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_cdemo_sk", "ss_addr_sk", "ss_quantity", "ss_sales_price", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 49, "query_string": " select top (100) channel, item, return_ratio, return_rank, currency_rank from  (select  'web' as channel  ,web.item  ,web.return_ratio  ,web.return_rank  ,web.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect ws.ws_item_sk as item  \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\t web_sales ws left outer join web_returns wr   \t\t\ton (ws.ws_order_number = wr.wr_order_number and   \t\t\tws.ws_item_sk = wr.wr_item_sk)                  ,date_dim  \t\twhere   \t\t\twr.wr_return_amt > 10000   \t\t\tand ws.ws_net_profit > 1                          and ws.ws_net_paid > 0                          and ws.ws_quantity > 0                          and ws_sold_date_sk = d_date_sk                          and d_year = 1998                          and d_moy = 12  \t\tgroup by ws.ws_item_sk  \t) in_web  ) web  where   (  web.return_rank <= 10  or  web.currency_rank <= 10  )  union  select   'catalog' as channel  ,catalog.item  ,catalog.return_ratio  ,catalog.return_rank  ,catalog.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect   \t\tcs.cs_item_sk as item  \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\tcatalog_sales cs left outer join catalog_returns cr  \t\t\ton (cs.cs_order_number = cr.cr_order_number and   \t\t\tcs.cs_item_sk = cr.cr_item_sk)                 ,date_dim  \t\twhere   \t\t\tcr.cr_return_amount > 10000   \t\t\tand cs.cs_net_profit > 1                          and cs.cs_net_paid > 0                          and cs.cs_quantity > 0                          and cs_sold_date_sk = d_date_sk                          and d_year = 1998                          and d_moy = 12                  group by cs.cs_item_sk  \t) in_cat  ) catalog  where   (  catalog.return_rank <= 10  or  catalog.currency_rank <=10  )  union  select   'store' as channel  ,store.item  ,store.return_ratio  ,store.return_rank  ,store.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect sts.ss_item_sk as item  \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\tstore_sales sts left outer join store_returns sr  \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)                 ,date_dim  \t\twhere   \t\t\tsr.sr_return_amt > 10000   \t\t\tand sts.ss_net_profit > 1                          and sts.ss_net_paid > 0                           and sts.ss_quantity > 0                          and ss_sold_date_sk = d_date_sk                          and d_year = 1998                          and d_moy = 12  \t\tgroup by sts.ss_item_sk  \t) in_store  ) store  where  (  store.return_rank <= 10  or   store.currency_rank <= 10  )  ) a  order by 1,4,5,2  ;", "predicates": {"catalog_returns": ["cr_return_amount"], "catalog_sales": ["cs_net_paid", "cs_net_profit", "cs_quantity"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_return_amt"], "store_sales": ["ss_net_paid", "ss_quantity", "ss_net_profit"], "web_returns": ["wr_return_amt"], "web_sales": ["ws_net_profit", "ws_net_paid", "ws_quantity"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_quantity", "cr_return_amount"], "store_returns": ["sr_return_amt", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_return_amt", "wr_return_quantity", "wr_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 50, "query_string": " select top (100)     s_store_name   ,s_company_id   ,s_street_number   ,s_street_name   ,s_street_type   ,s_suite_number   ,s_city   ,s_county   ,s_state   ,s_zip   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and                   (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and                   (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and                  (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    store_sales   ,store_returns   ,store   ,date_dim d1   ,date_dim d2 where     d2.d_year = 1998 and d2.d_moy  = 8 and ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_sold_date_sk   = d1.d_date_sk and sr_returned_date_sk   = d2.d_date_sk and ss_customer_sk = sr_customer_sk and ss_store_sk = s_store_sk group by    s_store_name   ,s_company_id   ,s_street_number   ,s_street_name   ,s_street_type   ,s_suite_number   ,s_city   ,s_county   ,s_state   ,s_zip order by s_store_name         ,s_company_id         ,s_street_number         ,s_street_name         ,s_street_type         ,s_suite_number         ,s_city         ,s_county         ,s_state         ,s_zip;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 51, "query_string": " WITH web_v1 as ( select   ws_item_sk item_sk, d_date,   sum(sum(ws_sales_price))       over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from web_sales     ,date_dim where ws_sold_date_sk=d_date_sk   and d_month_seq between 1219 and 1219+11   and ws_item_sk is not NULL group by ws_item_sk, d_date), store_v1 as ( select   ss_item_sk item_sk, d_date,   sum(sum(ss_sales_price))       over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from store_sales     ,date_dim where ss_sold_date_sk=d_date_sk   and d_month_seq between 1219 and 1219+11   and ss_item_sk is not NULL group by ss_item_sk, d_date)  select top (100) * from (select item_sk      ,d_date      ,web_sales      ,store_sales      ,max(web_sales)          over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative      ,max(store_sales)          over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative      from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk                  ,case when web.d_date is not null then web.d_date else store.d_date end d_date                  ,web.cume_sales web_sales                  ,store.cume_sales store_sales            from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk                                                           and web.d_date = store.d_date)           )x )y where web_cumulative > store_cumulative order by item_sk         ,d_date;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_sales_price", "ss_item_sk"], "web_sales": ["ws_sold_date_sk", "ws_sales_price", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 52, "query_string": " select top (100) dt.d_year  \t,item.i_brand_id brand_id  \t,item.i_brand brand  \t,sum(ss_ext_sales_price) ext_price  from date_dim dt      ,store_sales      ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=11     and dt.d_year=1999  group by dt.d_year  \t,item.i_brand  \t,item.i_brand_id  order by dt.d_year  \t,ext_price desc  \t,brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"item": ["i_brand_id"]}}
{"id": 53, "query_string": " select top (100) * from  (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1219,1219+1,1219+2,1219+3,1219+4,1219+5,1219+6,1219+7,1219+8,1219+9,1219+10,1219+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', \t\t'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', \t\t'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0  \tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales  \telse null end > 0.1 order by avg_quarterly_sales, \t sum_sales, \t i_manufact_id;", "predicates": {"date_dim": ["d_month_seq"], "item": ["i_brand", "i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_qoy"], "item": ["i_item_sk", "i_manufact_id", "i_brand", "i_category", "i_class"], "store": ["s_store_sk"]}, "group_by": {}, "order_by": {}}
{"id": 54, "query_string": " with my_customers as (  select distinct c_customer_sk         , c_current_addr_sk  from            ( select cs_sold_date_sk sold_date_sk,                  cs_bill_customer_sk customer_sk,                  cs_item_sk item_sk           from   catalog_sales           union all           select ws_sold_date_sk sold_date_sk,                  ws_bill_customer_sk customer_sk,                  ws_item_sk item_sk           from   web_sales          ) cs_or_ws_sales,          item,          date_dim,          customer  where   sold_date_sk = d_date_sk          and item_sk = i_item_sk          and i_category = 'Children'          and i_class = 'infants'          and c_customer_sk = cs_or_ws_sales.customer_sk          and d_moy = 4          and d_year = 1999  )  , my_revenue as (  select c_customer_sk,         sum(ss_ext_sales_price) as revenue  from   my_customers,         store_sales,         customer_address,         store,         date_dim  where  c_current_addr_sk = ca_address_sk         and ca_county = s_county         and ca_state = s_state         and ss_sold_date_sk = d_date_sk         and c_customer_sk = ss_customer_sk         and d_month_seq between (select distinct d_month_seq+1                                  from   date_dim where d_year = 1999 and d_moy = 4)                            and  (select distinct d_month_seq+3                                  from   date_dim where d_year = 1999 and d_moy = 4)  group by c_customer_sk  )  , segments as  (select cast((revenue/50) as int) as segment   from   my_revenue  )   select top (100) segment, count(*) as num_customers, segment*50 as segment_base  from segments  group by segment  order by segment, num_customers  ;", "predicates": {"date_dim": ["d_month_seq", "d_moy", "d_year"], "item": ["i_class", "i_category"]}, "payload": {"customer_address": ["ca_address_sk", "ca_county", "ca_state"], "date_dim": ["d_date_sk", "d_month_seq"], "item": ["i_item_sk"], "store": ["s_state", "s_county"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_ext_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 55, "query_string": " select top (100) i_brand_id brand_id, i_brand brand,  \tsum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item  where d_date_sk = ss_sold_date_sk  \tand ss_item_sk = i_item_sk  \tand i_manager_id=5  \tand d_moy=11  \tand d_year=2002  group by i_brand, i_brand_id  order by ext_price desc, i_brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"item": ["i_brand_id"]}}
{"id": 56, "query_string": " with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('beige','spring','slate'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 3  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('beige','spring','slate'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 3  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('beige','spring','slate'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 3  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_item_id)   select top (100) i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  ;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_color"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 57, "query_string": " with v1 as(  select i_category, i_brand,         cc_name,         d_year, d_moy,         sum(cs_sales_price) sum_sales,         avg(sum(cs_sales_price)) over           (partition by i_category, i_brand,                      cc_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      cc_name            order by d_year, d_moy) rn  from item, catalog_sales, date_dim, call_center  where cs_item_sk = i_item_sk and        cs_sold_date_sk = d_date_sk and        cc_call_center_sk= cs_call_center_sk and        (          d_year = 2000 or          ( d_year = 2000-1 and d_moy =12) or          ( d_year = 2000+1 and d_moy =1)        )  group by i_category, i_brand,           cc_name , d_year, d_moy),  v2 as(  select v1.i_category, v1.i_brand         ,v1.d_year, v1.d_moy         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1. cc_name = v1_lag. cc_name and        v1. cc_name = v1_lead. cc_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select top (100) *  from v2  where  d_year = 2000 and         avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, psum  ;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"call_center": ["cc_name", "cc_call_center_sk"], "catalog_sales": ["cs_sales_price", "cs_sold_date_sk", "cs_call_center_sk", "cs_item_sk"], "date_dim": ["d_date_sk", "d_moy", "d_year"], "item": ["i_brand", "i_item_sk", "i_category"]}, "group_by": {}, "order_by": {}}
{"id": 58, "query_string": " with ss_items as  (select i_item_id item_id         ,sum(ss_ext_sales_price) ss_item_rev   from store_sales      ,item      ,date_dim  where ss_item_sk = i_item_sk    and d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '1999-04-19'))    and ss_sold_date_sk   = d_date_sk  group by i_item_id),  cs_items as  (select i_item_id item_id         ,sum(cs_ext_sales_price) cs_item_rev   from catalog_sales       ,item       ,date_dim  where cs_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '1999-04-19'))   and  cs_sold_date_sk = d_date_sk  group by i_item_id),  ws_items as  (select i_item_id item_id         ,sum(ws_ext_sales_price) ws_item_rev   from web_sales       ,item       ,date_dim  where ws_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq =(select d_week_seq                                       from date_dim                                      where d_date = '1999-04-19'))   and ws_sold_date_sk   = d_date_sk  group by i_item_id)   select top (100) ss_items.item_id        ,ss_item_rev        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev        ,cs_item_rev        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev        ,ws_item_rev        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average  from ss_items,cs_items,ws_items  where ss_items.item_id=cs_items.item_id    and ss_items.item_id=ws_items.item_id     and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  order by item_id          ,ss_item_rev  ;", "predicates": {"date_dim": ["d_week_seq", "d_date"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_item_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "item": ["i_item_id", "i_item_sk"], "store_sales": ["ss_sold_date_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 59, "query_string": " with wss as   (select d_week_seq,         ss_store_sk,         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales  from store_sales,date_dim  where d_date_sk = ss_sold_date_sk  group by d_week_seq,ss_store_sk  )   select top (100) s_store_name1,s_store_id1,d_week_seq1        ,sun_sales1/sun_sales2,mon_sales1/mon_sales2        ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2        ,fri_sales1/fri_sales2,sat_sales1/sat_sales2  from  (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1         ,s_store_id s_store_id1,sun_sales sun_sales1         ,mon_sales mon_sales1,tue_sales tue_sales1         ,wed_sales wed_sales1,thu_sales thu_sales1         ,fri_sales fri_sales1,sat_sales sat_sales1   from wss,store,date_dim d   where d.d_week_seq = wss.d_week_seq and         ss_store_sk = s_store_sk and          d_month_seq between 1186 and 1186 + 11) y,  (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2         ,s_store_id s_store_id2,sun_sales sun_sales2         ,mon_sales mon_sales2,tue_sales tue_sales2         ,wed_sales wed_sales2,thu_sales thu_sales2         ,fri_sales fri_sales2,sat_sales sat_sales2   from wss,store,date_dim d   where d.d_week_seq = wss.d_week_seq and         ss_store_sk = s_store_sk and          d_month_seq between 1186+ 12 and 1186 + 23) x  where s_store_id1=s_store_id2    and d_week_seq1=d_week_seq2-52  order by s_store_name1,s_store_id1,d_week_seq1;", "predicates": {"date_dim": ["d_month_seq"], "store": ["s_store_id"]}, "payload": {"date_dim": ["d_date_sk", "d_week_seq", "d_day_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 60, "query_string": " with ss as (  select           i_item_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where          i_item_id in (select   i_item_id from  item where i_category in ('Music'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 9  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  cs as (  select           i_item_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Music'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 9  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  ws as (  select           i_item_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Music'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 9  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_item_id)   select top (100)     i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by i_item_id       ,total_sales  ;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_item_id", "i_category"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 61, "query_string": " select top (100) promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from   (select sum(ss_ext_sales_price) promotions    from  store_sales         ,store         ,promotion         ,date_dim         ,customer         ,customer_address          ,item    where ss_sold_date_sk = d_date_sk    and   ss_store_sk = s_store_sk    and   ss_promo_sk = p_promo_sk    and   ss_customer_sk= c_customer_sk    and   ca_address_sk = c_current_addr_sk    and   ss_item_sk = i_item_sk     and   ca_gmt_offset = -7    and   i_category = 'Electronics'    and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')    and   s_gmt_offset = -7    and   d_year = 1999    and   d_moy  = 11) promotional_sales,   (select sum(ss_ext_sales_price) total    from  store_sales         ,store         ,date_dim         ,customer         ,customer_address         ,item    where ss_sold_date_sk = d_date_sk    and   ss_store_sk = s_store_sk    and   ss_customer_sk= c_customer_sk    and   ca_address_sk = c_current_addr_sk    and   ss_item_sk = i_item_sk    and   ca_gmt_offset = -7    and   i_category = 'Electronics'    and   s_gmt_offset = -7    and   d_year = 1999    and   d_moy  = 11) all_sales order by promotions, total;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_category"], "promotion": ["p_channel_dmail", "p_channel_email", "p_channel_tv"], "store": ["s_gmt_offset"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_promo_sk", "ss_item_sk", "ss_ext_sales_price", "ss_customer_sk", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 62, "query_string": " select top (100)     substring(w_warehouse_name,1,20)   ,sm_type   ,web_name   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and                   (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and                   (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and                  (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    web_sales   ,warehouse   ,ship_mode   ,web_site   ,date_dim where     d_month_seq between 1219 and 1219 + 11 and ws_ship_date_sk   = d_date_sk and ws_warehouse_sk   = w_warehouse_sk and ws_ship_mode_sk   = sm_ship_mode_sk and ws_web_site_sk    = web_site_sk group by    substring(w_warehouse_name,1,20)   ,sm_type   ,web_name order by substring(w_warehouse_name,1,20)         ,sm_type        ,web_name;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "ship_mode": ["sm_type", "sm_ship_mode_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"], "web_sales": ["ws_ship_date_sk", "ws_ship_mode_sk", "ws_sold_date_sk", "ws_warehouse_sk", "ws_web_site_sk"], "web_site": ["web_name", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 63, "query_string": " select top (100) *  from (select i_manager_id              ,sum(ss_sales_price) sum_sales              ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales       from item           ,store_sales           ,date_dim           ,store       where ss_item_sk = i_item_sk         and ss_sold_date_sk = d_date_sk         and ss_store_sk = s_store_sk         and d_month_seq in (1219,1219+1,1219+2,1219+3,1219+4,1219+5,1219+6,1219+7,1219+8,1219+9,1219+10,1219+11)         and ((    i_category in ('Books','Children','Electronics')               and i_class in ('personal','portable','reference','self-help')               and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', \t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))            or(    i_category in ('Women','Music','Men')               and i_class in ('accessories','classical','fragrances','pants')               and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', \t\t                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id         ,avg_monthly_sales         ,sum_sales;", "predicates": {"date_dim": ["d_month_seq"], "item": ["i_brand", "i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_item_sk", "i_manager_id", "i_brand", "i_category", "i_class"], "store": ["s_store_sk"]}, "group_by": {}, "order_by": {"item": ["i_manager_id"]}}
{"id": 64, "query_string": " with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('misty','lace','cornsilk','drab','sky','chiffon') and          i_current_price between 79 and 79 + 10 and          i_current_price between 79 + 1 and 79 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;", "predicates": {"customer_demographics": ["cd_marital_status"], "date_dim": ["d_year"], "item": ["i_color", "i_current_price"], "store": ["s_zip", "s_store_name"]}, "payload": {"household_demographics": ["hd_income_band_sk", "hd_demo_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 65, "query_string": " select top (100) \ts_store_name, \ti_item_desc, \tsc.revenue, \ti_current_price, \ti_wholesale_cost, \ti_brand  from store, item,      (select ss_store_sk, avg(revenue) as ave  \tfrom  \t    (select  ss_store_sk, ss_item_sk,   \t\t     sum(ss_sales_price) as revenue  \t\tfrom store_sales, date_dim  \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1219 and 1219+11  \t\tgroup by ss_store_sk, ss_item_sk) sa  \tgroup by ss_store_sk) sb,      (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue  \tfrom store_sales, date_dim  \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1219 and 1219+11  \tgroup by ss_store_sk, ss_item_sk) sc  where sb.ss_store_sk = sc.ss_store_sk and         sc.revenue <= 0.1 * sb.ave and        s_store_sk = sc.ss_store_sk and        i_item_sk = sc.ss_item_sk  order by s_store_name, i_item_desc;", "predicates": {"date_dim": ["d_month_seq"], "store_sales": ["ss_store_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_brand", "i_wholesale_cost", "i_item_desc"], "store": ["s_store_name", "s_store_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price", "ss_item_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_desc"], "store": ["s_store_name"]}}
{"id": 66, "query_string": " select top (100)            w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country         ,ship_carriers         ,year  \t,sum(jan_sales) as jan_sales  \t,sum(feb_sales) as feb_sales  \t,sum(mar_sales) as mar_sales  \t,sum(apr_sales) as apr_sales  \t,sum(may_sales) as may_sales  \t,sum(jun_sales) as jun_sales  \t,sum(jul_sales) as jul_sales  \t,sum(aug_sales) as aug_sales  \t,sum(sep_sales) as sep_sales  \t,sum(oct_sales) as oct_sales  \t,sum(nov_sales) as nov_sales  \t,sum(dec_sales) as dec_sales  \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot  \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot  \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot  \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot  \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot  \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot  \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot  \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot  \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot  \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot  \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot  \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot  \t,sum(jan_net) as jan_net  \t,sum(feb_net) as feb_net  \t,sum(mar_net) as mar_net  \t,sum(apr_net) as apr_net  \t,sum(may_net) as may_net  \t,sum(jun_net) as jun_net  \t,sum(jul_net) as jul_net  \t,sum(aug_net) as aug_net  \t,sum(sep_net) as sep_net  \t,sum(oct_net) as oct_net  \t,sum(nov_net) as nov_net  \t,sum(dec_net) as dec_net  from (      select   \tw_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,concat('ALLIANCE' , ',' , 'MSC') as ship_carriers        ,d_year as year  \t,sum(case when d_moy = 1   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jan_sales  \t,sum(case when d_moy = 2   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as feb_sales  \t,sum(case when d_moy = 3   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as mar_sales  \t,sum(case when d_moy = 4   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as apr_sales  \t,sum(case when d_moy = 5   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as may_sales  \t,sum(case when d_moy = 6   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jun_sales  \t,sum(case when d_moy = 7   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jul_sales  \t,sum(case when d_moy = 8   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as aug_sales  \t,sum(case when d_moy = 9   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as sep_sales  \t,sum(case when d_moy = 10   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as oct_sales  \t,sum(case when d_moy = 11  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as nov_sales  \t,sum(case when d_moy = 12  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as dec_sales  \t,sum(case when d_moy = 1   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net  \t,sum(case when d_moy = 2  \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net  \t,sum(case when d_moy = 3   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net  \t,sum(case when d_moy = 4   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net  \t,sum(case when d_moy = 5   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net  \t,sum(case when d_moy = 6   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net  \t,sum(case when d_moy = 7   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net  \t,sum(case when d_moy = 8   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net  \t,sum(case when d_moy = 9   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net  \t,sum(case when d_moy = 10   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net  \t,sum(case when d_moy = 11  \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net  \t,sum(case when d_moy = 12  \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net      from           web_sales          ,warehouse          ,date_dim          ,time_dim  \t  ,ship_mode      where             ws_warehouse_sk =  w_warehouse_sk         and ws_sold_date_sk = d_date_sk         and ws_sold_time_sk = t_time_sk  \tand ws_ship_mode_sk = sm_ship_mode_sk         and d_year = 2001  \tand t_time between 33358 and 33358+28800   \tand sm_carrier in ('ALLIANCE','MSC')      group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country        ,d_year  union all      select   \tw_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,concat('ALLIANCE', ',', 'MSC') as ship_carriers        ,d_year as year  \t,sum(case when d_moy = 1   \t\tthen cs_sales_price* cs_quantity else 0 end) as jan_sales  \t,sum(case when d_moy = 2   \t\tthen cs_sales_price* cs_quantity else 0 end) as feb_sales  \t,sum(case when d_moy = 3   \t\tthen cs_sales_price* cs_quantity else 0 end) as mar_sales  \t,sum(case when d_moy = 4   \t\tthen cs_sales_price* cs_quantity else 0 end) as apr_sales  \t,sum(case when d_moy = 5   \t\tthen cs_sales_price* cs_quantity else 0 end) as may_sales  \t,sum(case when d_moy = 6   \t\tthen cs_sales_price* cs_quantity else 0 end) as jun_sales  \t,sum(case when d_moy = 7   \t\tthen cs_sales_price* cs_quantity else 0 end) as jul_sales  \t,sum(case when d_moy = 8   \t\tthen cs_sales_price* cs_quantity else 0 end) as aug_sales  \t,sum(case when d_moy = 9   \t\tthen cs_sales_price* cs_quantity else 0 end) as sep_sales  \t,sum(case when d_moy = 10   \t\tthen cs_sales_price* cs_quantity else 0 end) as oct_sales  \t,sum(case when d_moy = 11  \t\tthen cs_sales_price* cs_quantity else 0 end) as nov_sales  \t,sum(case when d_moy = 12  \t\tthen cs_sales_price* cs_quantity else 0 end) as dec_sales  \t,sum(case when d_moy = 1   \t\tthen cs_net_paid * cs_quantity else 0 end) as jan_net  \t,sum(case when d_moy = 2   \t\tthen cs_net_paid * cs_quantity else 0 end) as feb_net  \t,sum(case when d_moy = 3   \t\tthen cs_net_paid * cs_quantity else 0 end) as mar_net  \t,sum(case when d_moy = 4   \t\tthen cs_net_paid * cs_quantity else 0 end) as apr_net  \t,sum(case when d_moy = 5   \t\tthen cs_net_paid * cs_quantity else 0 end) as may_net  \t,sum(case when d_moy = 6   \t\tthen cs_net_paid * cs_quantity else 0 end) as jun_net  \t,sum(case when d_moy = 7   \t\tthen cs_net_paid * cs_quantity else 0 end) as jul_net  \t,sum(case when d_moy = 8   \t\tthen cs_net_paid * cs_quantity else 0 end) as aug_net  \t,sum(case when d_moy = 9   \t\tthen cs_net_paid * cs_quantity else 0 end) as sep_net  \t,sum(case when d_moy = 10   \t\tthen cs_net_paid * cs_quantity else 0 end) as oct_net  \t,sum(case when d_moy = 11  \t\tthen cs_net_paid * cs_quantity else 0 end) as nov_net  \t,sum(case when d_moy = 12  \t\tthen cs_net_paid * cs_quantity else 0 end) as dec_net      from           catalog_sales          ,warehouse          ,date_dim          ,time_dim  \t ,ship_mode      where             cs_warehouse_sk =  w_warehouse_sk         and cs_sold_date_sk = d_date_sk         and cs_sold_time_sk = t_time_sk  \tand cs_ship_mode_sk = sm_ship_mode_sk         and d_year = 2001  \tand t_time between 33358 AND 33358+28800   \tand sm_carrier in ('ALLIANCE','MSC')      group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country        ,d_year  ) x  group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,ship_carriers        ,year  order by w_warehouse_name  ;", "predicates": {"date_dim": ["d_year"], "ship_mode": ["sm_carrier"], "time_dim": ["t_time"]}, "payload": {"catalog_sales": ["cs_warehouse_sk", "cs_ext_list_price", "cs_quantity", "cs_net_paid_inc_tax", "cs_ship_mode_sk", "cs_sold_date_sk", "cs_sold_time_sk"], "date_dim": ["d_date_sk", "d_moy", "d_year"], "ship_mode": ["sm_ship_mode_sk"], "time_dim": ["t_time_sk"], "web_sales": ["ws_ship_mode_sk", "ws_ext_list_price", "ws_sold_date_sk", "ws_quantity", "ws_sold_time_sk", "ws_warehouse_sk", "ws_net_paid"]}, "group_by": {}, "order_by": {}}
{"id": 67, "query_string": " select top (100) * from (select i_category             ,i_class             ,i_brand             ,i_product_name             ,d_year             ,d_qoy             ,d_moy             ,s_store_id             ,sumsales             ,rank() over (partition by i_category order by sumsales desc) rk       from (select i_category                   ,i_class                   ,i_brand                   ,i_product_name                   ,d_year                   ,d_qoy                   ,d_moy                   ,s_store_id                   ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales             from store_sales                 ,date_dim                 ,store                 ,item        where  ss_sold_date_sk=d_date_sk           and ss_item_sk=i_item_sk           and ss_store_sk = s_store_sk           and d_month_seq between 1219 and 1219+11        group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 order by i_category         ,i_class         ,i_brand         ,i_product_name         ,d_year         ,d_qoy         ,d_moy         ,s_store_id         ,sumsales         ,rk;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk", "d_moy", "d_qoy", "d_year"], "item": ["i_item_sk", "i_brand", "i_product_name", "i_category", "i_class"], "store": ["s_store_sk", "s_store_id"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_sales_price", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {"date_dim": ["d_moy", "d_qoy", "d_year"], "item": ["i_brand", "i_class", "i_product_name", "i_category"], "store": ["s_store_id"]}}
{"id": 68, "query_string": " select top (100) c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,extended_price        ,extended_tax        ,list_price  from (select ss_ticket_number              ,ss_customer_sk              ,ca_city bought_city              ,sum(ss_ext_sales_price) extended_price               ,sum(ss_ext_list_price) list_price              ,sum(ss_ext_tax) extended_tax         from store_sales            ,date_dim            ,store            ,household_demographics            ,customer_address         where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_store_sk = store.s_store_sk           and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk         and store_sales.ss_addr_sk = customer_address.ca_address_sk         and date_dim.d_dom between 1 and 2          and (household_demographics.hd_dep_count = 8 or              household_demographics.hd_vehicle_count= 4)         and date_dim.d_year in (1999,1999+1,1999+2)         and store.s_city in ('Fairview','Midway')        group by ss_ticket_number                ,ss_customer_sk                ,ss_addr_sk,ca_city) dn       ,customer       ,customer_address current_addr  where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name          ,ss_ticket_number  ;", "predicates": {"customer_address": ["ca_city"], "date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_city"]}, "payload": {"customer": ["c_current_addr_sk", "c_first_name", "c_last_name", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_city"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_ext_sales_price", "ss_addr_sk", "ss_customer_sk", "ss_ticket_number", "ss_ext_list_price", "ss_ext_tax", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 69, "query_string": " select top (100)    cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_state in ('TX','AL','OR') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 1999 and                 d_moy between 1 and 1+2) and    (not exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 1999 and                   d_moy between 1 and 1+2) and     not exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 1999 and                   d_moy between 1 and 1+2))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  ;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 70, "query_string": " select top (100)      sum(ss_net_profit) as total_sum    ,s_state    ,s_county    ,grouping(s_state)+grouping(s_county) as lochierarchy    ,rank() over (  \tpartition by grouping(s_state)+grouping(s_county),  \tcase when grouping(s_county) = 0 then s_state end   \torder by sum(ss_net_profit) desc) as rank_within_parent  from     store_sales    ,date_dim       d1    ,store  where     d1.d_month_seq between 1219 and 1219+11  and d1.d_date_sk = ss_sold_date_sk  and s_store_sk  = ss_store_sk  and s_state in              ( select s_state                from  (select s_state as s_state,  \t\t\t    rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking                       from   store_sales, store, date_dim                       where  d_month_seq between 1219 and 1219+11  \t\t\t    and d_date_sk = ss_sold_date_sk  \t\t\t    and s_store_sk  = ss_store_sk                       group by s_state                      ) tmp1                 where ranking <= 5              )  group by rollup(s_state,s_county)  order by    lochierarchy desc   ,case when (grouping(s_state)+grouping(s_county)) = 0 then s_state end   ,rank_within_parent  ;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 71, "query_string": " select i_brand_id brand_id, i_brand brand,t_hour,t_minute,  \tsum(ext_price) ext_price  from item, (select ws_ext_sales_price as ext_price,                          ws_sold_date_sk as sold_date_sk,                         ws_item_sk as sold_item_sk,                         ws_sold_time_sk as time_sk                    from web_sales,date_dim                  where d_date_sk = ws_sold_date_sk                    and d_moy=12                    and d_year=1998                  union all                  select cs_ext_sales_price as ext_price,                         cs_sold_date_sk as sold_date_sk,                         cs_item_sk as sold_item_sk,                         cs_sold_time_sk as time_sk                  from catalog_sales,date_dim                  where d_date_sk = cs_sold_date_sk                    and d_moy=12                    and d_year=1998                  union all                  select ss_ext_sales_price as ext_price,                         ss_sold_date_sk as sold_date_sk,                         ss_item_sk as sold_item_sk,                         ss_sold_time_sk as time_sk                  from store_sales,date_dim                  where d_date_sk = ss_sold_date_sk                    and d_moy=12                    and d_year=1998                  ) tmp,time_dim  where    sold_item_sk = i_item_sk    and i_manager_id=1    and time_sk = t_time_sk    and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')  group by i_brand, i_brand_id,t_hour,t_minute  order by ext_price desc, i_brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"], "time_dim": ["t_meal_time"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_brand", "i_item_sk", "i_brand_id"], "time_dim": ["t_hour", "t_minute", "t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 72, "query_string": " select top (100) i_item_desc       ,w_warehouse_name       ,d1.d_week_seq       ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo       ,sum(case when p_promo_sk is not null then 1 else 0 end) promo       ,count(*) total_cnt from catalog_sales join inventory on (cs_item_sk = inv_item_sk) join warehouse on (w_warehouse_sk=inv_warehouse_sk) join item on (i_item_sk = cs_item_sk) join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk) join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk) join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk) join date_dim d2 on (inv_date_sk = d2.d_date_sk) join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk) left outer join promotion on (cs_promo_sk=p_promo_sk) left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number) where d1.d_week_seq = d2.d_week_seq   and inv_quantity_on_hand < cs_quantity    and d3.d_date > dateadd(day, 5, d1.d_date)   and hd_buy_potential = '1001-5000'   and d1.d_year = 2002   and cd_marital_status = 'U' group by i_item_desc,w_warehouse_name,d1.d_week_seq order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq;", "predicates": {"customer_demographics": ["cd_marital_status"], "date_dim": ["d_date", "d_year"], "household_demographics": ["hd_buy_potential"], "inventory": ["inv_warehouse_sk"], "warehouse": ["w_warehouse_sk"]}, "payload": {"catalog_sales": ["cs_quantity", "cs_promo_sk", "cs_item_sk", "cs_ship_date_sk", "cs_bill_cdemo_sk", "cs_sold_date_sk", "cs_bill_hdemo_sk"], "customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "household_demographics": ["hd_demo_sk"], "item": ["i_item_sk", "i_item_desc"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {"date_dim": ["d_week_seq"], "item": ["i_item_desc"], "warehouse": ["w_warehouse_name"]}}
{"id": 73, "query_string": " select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = 'Unknown')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (2000,2000+1,2000+2)     and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;", "predicates": {"date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count", "hd_buy_potential"], "store": ["s_county"]}, "payload": {"customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_preferred_cust_flag"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 74, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,d_year as year        ,min(ss_net_paid) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk    and d_year in (1998,1998+1)  group by c_customer_id          ,c_first_name          ,c_last_name          ,d_year  union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,d_year as year        ,min(ws_net_paid) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk    and d_year in (1998,1998+1)  group by c_customer_id          ,c_first_name          ,c_last_name          ,d_year          )   select top (100)         t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id          and t_s_firstyear.customer_id = t_w_secyear.customer_id          and t_s_firstyear.customer_id = t_w_firstyear.customer_id          and t_s_firstyear.sale_type = 's'          and t_w_firstyear.sale_type = 'w'          and t_s_secyear.sale_type = 's'          and t_w_secyear.sale_type = 'w'          and t_s_firstyear.year = 1998          and t_s_secyear.year = 1998+1          and t_w_firstyear.year = 1998          and t_w_secyear.year = 1998+1          and t_s_firstyear.year_total > 0          and t_w_firstyear.year_total > 0          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end  order by 3,2,1;", "predicates": {"date_dim": ["d_year"]}, "payload": {"customer": ["c_customer_id", "c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_net_paid"], "web_sales": ["ws_net_paid", "ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_customer_id", "c_last_name", "c_first_name"]}}
{"id": 75, "query_string": " WITH all_sales AS (  SELECT d_year        ,i_brand_id        ,i_class_id        ,i_category_id        ,i_manufact_id        ,SUM(sales_cnt) AS sales_cnt        ,SUM(sales_amt) AS sales_amt  FROM (SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt              ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt        FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk                           JOIN date_dim ON d_date_sk=cs_sold_date_sk                           LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number                                                      AND cs_item_sk=cr_item_sk)        WHERE i_category='Women'        UNION        SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt              ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt        FROM store_sales JOIN item ON i_item_sk=ss_item_sk                         JOIN date_dim ON d_date_sk=ss_sold_date_sk                         LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number                                                  AND ss_item_sk=sr_item_sk)        WHERE i_category='Women'        UNION        SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt              ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt        FROM web_sales JOIN item ON i_item_sk=ws_item_sk                       JOIN date_dim ON d_date_sk=ws_sold_date_sk                       LEFT JOIN web_returns ON (ws_order_number=wr_order_number                                              AND ws_item_sk=wr_item_sk)        WHERE i_category='Women') sales_detail  GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)  SELECT top (100) prev_yr.d_year AS prev_year                           ,curr_yr.d_year AS year                           ,curr_yr.i_brand_id                           ,curr_yr.i_class_id                           ,curr_yr.i_category_id                           ,curr_yr.i_manufact_id                           ,prev_yr.sales_cnt AS prev_yr_cnt                           ,curr_yr.sales_cnt AS curr_yr_cnt                           ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff                           ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff  FROM all_sales curr_yr, all_sales prev_yr  WHERE curr_yr.i_brand_id=prev_yr.i_brand_id    AND curr_yr.i_class_id=prev_yr.i_class_id    AND curr_yr.i_category_id=prev_yr.i_category_id    AND curr_yr.i_manufact_id=prev_yr.i_manufact_id    AND curr_yr.d_year=2002    AND prev_yr.d_year=2002-1    AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9  ORDER BY sales_cnt_diff,sales_amt_diff  ;", "predicates": {"date_dim": ["d_year"], "item": ["i_category"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_quantity", "cr_return_amount"], "date_dim": ["d_date_sk", "d_year"], "item": ["i_class_id", "i_item_sk", "i_category_id", "i_brand_id", "i_manufact_id"], "store_returns": ["sr_return_amt", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_return_amt", "wr_return_quantity", "wr_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 76, "query_string": " select top (100) channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (         SELECT 'store' as channel, 'ss_customer_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price          FROM store_sales, item, date_dim          WHERE ss_customer_sk IS NULL            AND ss_sold_date_sk=d_date_sk            AND ss_item_sk=i_item_sk         UNION ALL         SELECT 'web' as channel, 'ws_ship_cdemo_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price          FROM web_sales, item, date_dim          WHERE ws_ship_cdemo_sk IS NULL            AND ws_sold_date_sk=d_date_sk            AND ws_item_sk=i_item_sk         UNION ALL         SELECT 'catalog' as channel, 'cs_ship_cdemo_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price          FROM catalog_sales, item, date_dim          WHERE cs_ship_cdemo_sk IS NULL            AND cs_sold_date_sk=d_date_sk            AND cs_item_sk=i_item_sk) foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category;", "predicates": {"catalog_sales": ["cs_ship_addr_sk"], "store_sales": ["ss_promo_sk"], "web_sales": ["ws_promo_sk"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_item_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_qoy", "d_year"], "item": ["i_item_sk", "i_category"], "store_sales": ["ss_sold_date_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 77, "query_string": " with ss as  (select s_store_sk,          sum(ss_ext_sales_price) as sales,          sum(ss_net_profit) as profit  from store_sales,       date_dim,       store  where ss_sold_date_sk = d_date_sk        and d_date between cast('1999-08-18' as date)                    and dateadd(day, 30, cast('1999-08-18' as date))         and ss_store_sk = s_store_sk  group by s_store_sk)  ,  sr as  (select s_store_sk,          sum(sr_return_amt) as returns,          sum(sr_net_loss) as profit_loss  from store_returns,       date_dim,       store  where sr_returned_date_sk = d_date_sk        and d_date between cast('1999-08-18' as date)                   and dateadd(day, 30, cast('1999-08-18' as date))        and sr_store_sk = s_store_sk  group by s_store_sk),   cs as  (select cs_call_center_sk,         sum(cs_ext_sales_price) as sales,         sum(cs_net_profit) as profit  from catalog_sales,       date_dim  where cs_sold_date_sk = d_date_sk        and d_date between cast('1999-08-18' as date)                   and dateadd(day, 30, cast('1999-08-18' as date))  group by cs_call_center_sk   ),   cr as  (select cr_call_center_sk,          sum(cr_return_amount) as returns,          sum(cr_net_loss) as profit_loss  from catalog_returns,       date_dim  where cr_returned_date_sk = d_date_sk        and d_date between cast('1999-08-18' as date)                   and dateadd(day, 30, cast('1999-08-18' as date))  group by cr_call_center_sk  ),   ws as  ( select wp_web_page_sk,         sum(ws_ext_sales_price) as sales,         sum(ws_net_profit) as profit  from web_sales,       date_dim,       web_page  where ws_sold_date_sk = d_date_sk        and d_date between cast('1999-08-18' as date)                   and dateadd(day, 30, cast('1999-08-18' as date))        and ws_web_page_sk = wp_web_page_sk  group by wp_web_page_sk),   wr as  (select wp_web_page_sk,         sum(wr_return_amt) as returns,         sum(wr_net_loss) as profit_loss  from web_returns,       date_dim,       web_page  where wr_returned_date_sk = d_date_sk        and d_date between cast('1999-08-18' as date)                   and dateadd(day, 30, cast('1999-08-18' as date))        and wr_web_page_sk = wp_web_page_sk  group by wp_web_page_sk)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , ss.s_store_sk as id         , sales         , coalesce(returns, 0) as returns         , (profit - coalesce(profit_loss,0)) as profit  from   ss left join sr         on  ss.s_store_sk = sr.s_store_sk  union all  select 'catalog channel' as channel         , cs_call_center_sk as id         , sales         , returns         , (profit - profit_loss) as profit  from  cs        , cr  union all  select 'web channel' as channel         , ws.wp_web_page_sk as id         , sales         , coalesce(returns, 0) returns         , (profit - coalesce(profit_loss,0)) as profit  from   ws left join wr         on  ws.wp_web_page_sk = wr.wp_web_page_sk  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_return_amount", "cr_call_center_sk"], "catalog_sales": ["cs_net_profit", "cs_sold_date_sk", "cs_call_center_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_net_loss"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit", "ss_ext_sales_price"], "web_page": ["wp_web_page_sk"], "web_returns": ["wr_web_page_sk", "wr_returned_date_sk", "wr_return_amt", "wr_net_loss"], "web_sales": ["ws_net_profit", "ws_ext_sales_price", "ws_web_page_sk", "ws_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 78, "query_string": " with ws as   (select d_year AS ws_sold_year, ws_item_sk,     ws_bill_customer_sk ws_customer_sk,     sum(ws_quantity) ws_qty,     sum(ws_wholesale_cost) ws_wc,     sum(ws_sales_price) ws_sp    from web_sales    left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk    join date_dim on ws_sold_date_sk = d_date_sk    where wr_order_number is null    group by d_year, ws_item_sk, ws_bill_customer_sk    ), cs as   (select d_year AS cs_sold_year, cs_item_sk,     cs_bill_customer_sk cs_customer_sk,     sum(cs_quantity) cs_qty,     sum(cs_wholesale_cost) cs_wc,     sum(cs_sales_price) cs_sp    from catalog_sales    left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk    join date_dim on cs_sold_date_sk = d_date_sk    where cr_order_number is null    group by d_year, cs_item_sk, cs_bill_customer_sk    ), ss as   (select d_year AS ss_sold_year, ss_item_sk,     ss_customer_sk,     sum(ss_quantity) ss_qty,     sum(ss_wholesale_cost) ss_wc,     sum(ss_sales_price) ss_sp    from store_sales    left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk    join date_dim on ss_sold_date_sk = d_date_sk    where sr_ticket_number is null    group by d_year, ss_item_sk, ss_customer_sk    )  select top (100) ss_sold_year, ss_item_sk, ss_customer_sk, round(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk) where (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=1998 order by    ss_sold_year, ss_item_sk, ss_customer_sk,   ss_qty desc, ss_wc desc, ss_sp desc,   other_chan_qty,   other_chan_wholesale_cost,   other_chan_sales_price,   ratio;", "predicates": {"catalog_returns": ["cr_order_number"], "catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_year"], "store_returns": ["sr_ticket_number"], "store_sales": ["ss_customer_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_bill_customer_sk"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "store_returns": ["sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_item_sk", "ss_sales_price", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_wholesale_cost", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 79, "query_string": " select top (100)   c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,store.s_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (household_demographics.hd_dep_count = 4 or household_demographics.hd_vehicle_count > 3)     and date_dim.d_dow = 1     and date_dim.d_year in (1998,1998+1,1998+2)      and store.s_number_employees between 200 and 295     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer     where ss_customer_sk = c_customer_sk  order by c_last_name,c_first_name,substring(s_city,1,30), profit;", "predicates": {"date_dim": ["d_dow", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_number_employees"]}, "payload": {"customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_city", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_addr_sk", "ss_customer_sk", "ss_ticket_number", "ss_coupon_amt", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {"customer": ["c_last_name", "c_first_name"]}}
{"id": 80, "query_string": " with ssr as  (select  s_store_id as store_id,           sum(ss_ext_sales_price) as sales,           sum(coalesce(sr_return_amt, 0)) as returns,           sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit   from store_sales left outer join store_returns on          (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),      date_dim,      store,      item,      promotion  where ss_sold_date_sk = d_date_sk        and d_date between cast('1999-08-18' as date)                    and dateadd(day, 30, cast('1999-08-18' as date))        and ss_store_sk = s_store_sk        and ss_item_sk = i_item_sk        and i_current_price > 50        and ss_promo_sk = p_promo_sk        and p_channel_tv = 'N'  group by s_store_id)  ,  csr as  (select  cp_catalog_page_id as catalog_page_id,           sum(cs_ext_sales_price) as sales,           sum(coalesce(cr_return_amount, 0)) as returns,           sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit   from catalog_sales left outer join catalog_returns on          (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),      date_dim,      catalog_page,      item,      promotion  where cs_sold_date_sk = d_date_sk        and d_date between cast('1999-08-18' as date)                   and dateadd(day, 30, cast('1999-08-18' as date))         and cs_catalog_page_sk = cp_catalog_page_sk        and cs_item_sk = i_item_sk        and i_current_price > 50        and cs_promo_sk = p_promo_sk        and p_channel_tv = 'N' group by cp_catalog_page_id)  ,  wsr as  (select  web_site_id,           sum(ws_ext_sales_price) as sales,           sum(coalesce(wr_return_amt, 0)) as returns,           sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit   from web_sales left outer join web_returns on          (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),      date_dim,      web_site,      item,      promotion  where ws_sold_date_sk = d_date_sk        and d_date between cast('1999-08-18' as date)                   and dateadd(day, 30, cast('1999-08-18' as date))         and ws_web_site_sk = web_site_sk        and ws_item_sk = i_item_sk        and i_current_price > 50        and ws_promo_sk = p_promo_sk        and p_channel_tv = 'N' group by web_site_id)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , concat('store' , store_id) as id         , sales         , returns         , profit  from   ssr  union all  select 'catalog channel' as channel         , concat('catalog_page' , catalog_page_id) as id         , sales         , returns         , profit  from  csr  union all  select 'web channel' as channel         , concat('web_site' , web_site_id) as id         , sales         , returns         , profit  from   wsr  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"], "promotion": ["p_channel_tv"]}, "payload": {"catalog_page": ["cp_catalog_page_sk", "cp_catalog_page_id"], "catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_amount", "cr_net_loss"], "date_dim": ["d_date_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"], "store": ["s_store_sk", "s_store_id"], "store_returns": ["sr_return_amt", "sr_net_loss", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_net_loss", "wr_return_amt", "wr_order_number"], "web_site": ["web_site_id", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 81, "query_string": " with customer_total_return as  (select cr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   \tsum(cr_return_amt_inc_tax) as ctr_total_return  from catalog_returns      ,date_dim      ,customer_address  where cr_returned_date_sk = d_date_sk     and d_year =1999    and cr_returning_addr_sk = ca_address_sk   group by cr_returning_customer_sk          ,ca_state )   select top (100) c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  \t\t\t  from customer_total_return ctr2                    \t  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'MO'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  ;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_year"]}, "payload": {"catalog_returns": ["cr_returned_date_sk", "cr_returning_customer_sk", "cr_return_amt_inc_tax", "cr_returning_addr_sk"], "customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_current_addr_sk", "c_customer_id"], "customer_address": ["ca_street_type", "ca_county", "ca_street_name", "ca_zip", "ca_street_number", "ca_city", "ca_state", "ca_gmt_offset", "ca_location_type", "ca_address_sk", "ca_suite_number", "ca_country"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer": ["c_salutation", "c_customer_id", "c_last_name", "c_first_name"], "customer_address": ["ca_street_type", "ca_county", "ca_street_name", "ca_zip", "ca_street_number", "ca_city", "ca_gmt_offset", "ca_location_type", "ca_suite_number", "ca_country"]}}
{"id": 82, "query_string": " select top (100) i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, store_sales  where i_current_price between 44 and 44+30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2002-05-30' as date) and dateadd(day, 60, cast('2002-05-30' as date))  and i_manufact_id in (857,537,565,22)  and inv_quantity_on_hand between 100 and 500  and ss_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  ;", "predicates": {"date_dim": ["d_date"], "inventory": ["inv_quantity_on_hand"], "item": ["i_current_price", "i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc", "i_current_price"]}, "group_by": {}, "order_by": {}}
{"id": 83, "query_string": " with sr_items as  (select i_item_id item_id,         sum(sr_return_quantity) sr_item_qty  from store_returns,       item,       date_dim  where sr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t  where d_date in ('2000-03-03','2000-10-14','2000-11-18')))  and   sr_returned_date_sk   = d_date_sk  group by i_item_id),  cr_items as  (select i_item_id item_id,         sum(cr_return_quantity) cr_item_qty  from catalog_returns,       item,       date_dim  where cr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t  where d_date in ('2000-03-03','2000-10-14','2000-11-18')))  and   cr_returned_date_sk   = d_date_sk  group by i_item_id),  wr_items as  (select i_item_id item_id,         sum(wr_return_quantity) wr_item_qty  from web_returns,       item,       date_dim  where wr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t\twhere d_date in ('2000-03-03','2000-10-14','2000-11-18')))  and   wr_returned_date_sk   = d_date_sk  group by i_item_id)   select top (100) sr_items.item_id        ,sr_item_qty        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev        ,cr_item_qty        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev        ,wr_item_qty        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average  from sr_items      ,cr_items      ,wr_items  where sr_items.item_id=cr_items.item_id    and sr_items.item_id=wr_items.item_id   order by sr_items.item_id          ,sr_item_qty  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_returned_date_sk", "cr_order_number", "cr_return_quantity"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "item": ["i_item_id", "i_item_sk"], "store_returns": ["sr_returned_date_sk", "sr_return_quantity", "sr_item_sk"], "web_returns": ["wr_item_sk", "wr_returned_date_sk", "wr_return_quantity"]}, "group_by": {}, "order_by": {}}
{"id": 84, "query_string": " select top (100) c_customer_id as customer_id        , concat(coalesce(c_last_name,'') , ', ' , coalesce(c_first_name,'')) as customername  from customer      ,customer_address      ,customer_demographics      ,household_demographics      ,income_band      ,store_returns  where ca_city\t        =  'Mountain View'    and c_current_addr_sk = ca_address_sk    and ib_lower_bound   >=  27974    and ib_upper_bound   <=  27974 + 50000    and ib_income_band_sk = hd_income_band_sk    and cd_demo_sk = c_current_cdemo_sk    and hd_demo_sk = c_current_hdemo_sk    and sr_cdemo_sk = cd_demo_sk  order by c_customer_id  ;", "predicates": {"customer": ["c_current_cdemo_sk"], "customer_address": ["ca_city"], "income_band": ["ib_upper_bound", "ib_lower_bound"]}, "payload": {"customer": ["c_last_name", "c_first_name", "c_current_cdemo_sk", "c_current_addr_sk", "c_customer_id", "c_current_hdemo_sk"], "customer_address": ["ca_address_sk"], "household_demographics": ["hd_income_band_sk", "hd_demo_sk"], "income_band": ["ib_income_band_sk"], "store_returns": ["sr_cdemo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 85, "query_string": " select top (100) substring(r_reason_desc,1,20)        ,avg(ws_quantity)        ,avg(wr_refunded_cash)        ,avg(wr_fee)  from web_sales, web_returns, web_page, customer_demographics cd1,       customer_demographics cd2, customer_address, date_dim, reason   where ws_web_page_sk = wp_web_page_sk    and ws_item_sk = wr_item_sk    and ws_order_number = wr_order_number    and ws_sold_date_sk = d_date_sk and d_year = 1998    and cd1.cd_demo_sk = wr_refunded_cdemo_sk     and cd2.cd_demo_sk = wr_returning_cdemo_sk    and ca_address_sk = wr_refunded_addr_sk    and r_reason_sk = wr_reason_sk    and    (     (      cd1.cd_marital_status = 'M'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = '4 yr Degree'      and       cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 100.00 and 150.00     )    or     (      cd1.cd_marital_status = 'U'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Secondary'       and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 50.00 and 100.00     )    or     (      cd1.cd_marital_status = 'S'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = '2 yr Degree'      and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 150.00 and 200.00     )    )    and    (     (      ca_country = 'United States'      and      ca_state in ('KS', 'WI', 'NJ')      and ws_net_profit between 100 and 200       )     or     (      ca_country = 'United States'      and      ca_state in ('WV', 'NE', 'MT')      and ws_net_profit between 150 and 300       )     or     (      ca_country = 'United States'      and      ca_state in ('CA', 'MI', 'FL')      and ws_net_profit between 50 and 250       )    ) group by r_reason_desc order by substring(r_reason_desc,1,20)         ,avg(ws_quantity)         ,avg(wr_refunded_cash)         ,avg(wr_fee);", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "web_sales": ["ws_net_profit", "ws_sales_price"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "reason": ["r_reason_desc", "r_reason_sk"], "web_page": ["wp_web_page_sk"], "web_returns": ["wr_returning_cdemo_sk", "wr_refunded_cdemo_sk", "wr_reason_sk", "wr_item_sk", "wr_refunded_cash", "wr_refunded_addr_sk", "wr_fee", "wr_order_number"], "web_sales": ["ws_net_profit", "ws_item_sk", "ws_sales_price", "ws_quantity", "ws_sold_date_sk", "ws_web_page_sk", "ws_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 86, "query_string": " select top (100)       sum(ws_net_paid) as total_sum    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  \tpartition by grouping(i_category)+grouping(i_class),  \tcase when grouping(i_class) = 0 then i_category end   \torder by sum(ws_net_paid) desc) as rank_within_parent  from     web_sales    ,date_dim       d1    ,item  where     d1.d_month_seq between 1219 and 1219+11  and d1.d_date_sk = ws_sold_date_sk  and i_item_sk  = ws_item_sk  group by rollup(i_category,i_class)  order by    lochierarchy desc,    case when (grouping(i_category)+grouping(i_class)) = 0 then i_category end,    rank_within_parent  ;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_class", "i_item_sk", "i_category"], "web_sales": ["ws_net_paid", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 87, "query_string": " select count(*)  from ((select distinct c_last_name, c_first_name, d_date        from store_sales, date_dim, customer        where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_customer_sk = customer.c_customer_sk          and d_month_seq between 1219 and 1219+11)        except       (select distinct c_last_name, c_first_name, d_date        from catalog_sales, date_dim, customer        where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk          and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk          and d_month_seq between 1219 and 1219+11)        except       (select distinct c_last_name, c_first_name, d_date        from web_sales, date_dim, customer        where web_sales.ws_sold_date_sk = date_dim.d_date_sk          and web_sales.ws_bill_customer_sk = customer.c_customer_sk          and d_month_seq between 1219 and 1219+11) ) cool_cust;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 88, "query_string": " select  * from  (select count(*) h8_30_to_9  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk         and ss_hdemo_sk = household_demographics.hd_demo_sk       and ss_store_sk = s_store_sk      and time_dim.t_hour = 8      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))       and store.s_store_name = 'ese') s1,  (select count(*) h9_to_9_30   from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk       and time_dim.t_hour = 9       and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))      and store.s_store_name = 'ese') s2,  (select count(*) h9_30_to_10   from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 9      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))      and store.s_store_name = 'ese') s3,  (select count(*) h10_to_10_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 10       and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))      and store.s_store_name = 'ese') s4,  (select count(*) h10_30_to_11  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 10       and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))      and store.s_store_name = 'ese') s5,  (select count(*) h11_to_11_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk       and time_dim.t_hour = 11      and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))      and store.s_store_name = 'ese') s6,  (select count(*) h11_30_to_12  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 11      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))      and store.s_store_name = 'ese') s7,  (select count(*) h12_to_12_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 12      and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))      and store.s_store_name = 'ese') s8;", "predicates": {"household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_store_name"], "time_dim": ["t_hour", "t_minute"]}, "payload": {"household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_sold_time_sk"], "time_dim": ["t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 89, "query_string": " select top (100) * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (2002) and         ((i_category in ('Shoes','Women','Sports') and           i_class in ('athletic','fragrances','pools')          )       or (i_category in ('Music','Books','Electronics') and           i_class in ('pop','arts','monitors')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name;", "predicates": {"date_dim": ["d_year"], "item": ["i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_brand", "i_class", "i_item_sk", "i_category"], "store": ["s_store_name", "s_store_sk", "s_company_name"]}, "group_by": {}, "order_by": {"store": ["s_store_name"]}}
{"id": 90, "query_string": " select top (100) cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio  from ( select count(*) amc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 8 and 8+1          and household_demographics.hd_dep_count = 4          and web_page.wp_char_count between 5000 and 5200) at,       ( select count(*) pmc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 20 and 20+1          and household_demographics.hd_dep_count = 4          and web_page.wp_char_count between 5000 and 5200) pt  order by am_pm_ratio  ;", "predicates": {"household_demographics": ["hd_dep_count"], "time_dim": ["t_hour"], "web_page": ["wp_char_count"]}, "payload": {"household_demographics": ["hd_demo_sk"], "time_dim": ["t_time_sk"], "web_page": ["wp_web_page_sk"], "web_sales": ["ws_sold_time_sk", "ws_web_page_sk", "ws_ship_hdemo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 91, "query_string": " select           cc_call_center_id Call_Center,         cc_name Call_Center_Name,         cc_manager Manager,         sum(cr_net_loss) Returns_Loss from         call_center,         catalog_returns,         date_dim,         customer,         customer_address,         customer_demographics,         household_demographics where         cr_call_center_sk       = cc_call_center_sk and     cr_returned_date_sk     = d_date_sk and     cr_returning_customer_sk= c_customer_sk and     cd_demo_sk              = c_current_cdemo_sk and     hd_demo_sk              = c_current_hdemo_sk and     ca_address_sk           = c_current_addr_sk and     d_year                  = 1999  and     d_moy                   = 11 and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')         or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree')) and     hd_buy_potential like '5001-10000%' and     ca_gmt_offset           = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc;", "predicates": {"customer_address": ["ca_gmt_offset"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_moy", "d_year"], "household_demographics": ["hd_buy_potential"]}, "payload": {"call_center": ["cc_name", "cc_call_center_id", "cc_manager", "cc_call_center_sk"], "catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_returning_customer_sk", "cr_call_center_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk", "c_current_hdemo_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 92, "query_string": " select top (100)     sum(ws_ext_discount_amt)  as \"Excess Discount Amount\"  from      web_sales     ,item     ,date_dim where i_manufact_id = 625 and i_item_sk = ws_item_sk  and d_date between '2002-03-10' and          dateadd(day, 90, cast('2002-03-10' as date)) and d_date_sk = ws_sold_date_sk  and ws_ext_discount_amt        > (           SELECT              1.3 * avg(ws_ext_discount_amt)           FROM              web_sales             ,date_dim          WHERE                ws_item_sk = i_item_sk            and d_date between '2002-03-10' and                              dateadd(day, 90, cast('2002-03-10' as date))           and d_date_sk = ws_sold_date_sk        )  order by sum(ws_ext_discount_amt);", "predicates": {"date_dim": ["d_date"], "item": ["i_manufact_id"], "web_sales": ["ws_ext_discount_amt"]}, "payload": {"item": ["i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 93, "query_string": " select top (100) ss_customer_sk             ,sum(act_sales) sumsales       from (select ss_item_sk                   ,ss_ticket_number                   ,ss_customer_sk                   ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price                                                             else (ss_quantity*ss_sales_price) end act_sales             from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk                                                                and sr_ticket_number = ss_ticket_number)                 ,reason             where sr_reason_sk = r_reason_sk               and r_reason_desc = 'reason 74') t       group by ss_customer_sk       order by sumsales, ss_customer_sk;", "predicates": {"reason": ["r_reason_desc"]}, "payload": {"reason": ["r_reason_sk"], "store_returns": ["sr_reason_sk", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"]}, "group_by": {}, "order_by": {"store_sales": ["ss_customer_sk"]}}
{"id": 94, "query_string": " select top (100)     count(distinct ws_order_number) as \"order count\"   ,sum(ws_ext_ship_cost) as \"total shipping cost\"   ,sum(ws_net_profit) as \"total net profit\" from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '1999-2-01' and             dateadd(day, 60, cast('1999-2-01' as date)) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'MD' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number);", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_date"], "web_site": ["web_company_name"]}, "payload": {"customer_address": ["ca_address_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_net_profit", "ws_ship_date_sk", "ws_ship_addr_sk", "ws_ext_ship_cost", "ws_warehouse_sk", "ws_order_number", "ws_web_site_sk"], "web_site": ["web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 95, "query_string": " with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select top (100)     count(distinct ws_order_number) as \"order count\"   ,sum(ws_ext_ship_cost) as \"total shipping cost\"   ,sum(ws_net_profit) as \"total net profit\" from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '1999-2-01' and             dateadd(day, 60, cast('1999-2-01' as date)) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'MD' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number);", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_date"], "web_site": ["web_company_name"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_net_profit", "ws_ship_date_sk", "ws_item_sk", "ws_ship_addr_sk", "ws_ext_ship_cost", "ws_warehouse_sk", "ws_order_number", "ws_web_site_sk"], "web_site": ["web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 96, "query_string": " select top (100) count(*)  from store_sales     ,household_demographics      ,time_dim, store where ss_sold_time_sk = time_dim.t_time_sk        and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk     and time_dim.t_hour = 20     and time_dim.t_minute >= 30     and household_demographics.hd_dep_count = 1     and store.s_store_name = 'ese' order by count(*);", "predicates": {"household_demographics": ["hd_dep_count"], "store": ["s_store_name"], "time_dim": ["t_hour", "t_minute"]}, "payload": {"household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_sold_time_sk"], "time_dim": ["t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 97, "query_string": " with ssci as ( select ss_customer_sk customer_sk       ,ss_item_sk item_sk from store_sales,date_dim where ss_sold_date_sk = d_date_sk   and d_month_seq between 1219 and 1219 + 11 group by ss_customer_sk         ,ss_item_sk), csci as(  select cs_bill_customer_sk customer_sk       ,cs_item_sk item_sk from catalog_sales,date_dim where cs_sold_date_sk = d_date_sk   and d_month_seq between 1219 and 1219 + 11 group by cs_bill_customer_sk         ,cs_item_sk)  select top (100) sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only       ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only       ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk                                and ssci.item_sk = csci.item_sk);", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk", "cs_item_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 98, "query_string": " select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from\t \tstore_sales     \t,item      \t,date_dim where  \tss_item_sk = i_item_sk    \tand i_category in ('Shoes', 'Children', 'Jewelry')   \tand ss_sold_date_sk = d_date_sk \tand d_date between cast('1999-03-30' as date)  \t\t\t\tand dateadd(day, 30, cast('1999-03-30' as date)) group by  \ti_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  \ti_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"]}, "group_by": {}, "order_by": {}}
{"id": 99, "query_string": " select top (100)     substring(w_warehouse_name,1,20)   ,sm_type   ,cc_name   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and                   (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and                   (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and                  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    catalog_sales   ,warehouse   ,ship_mode   ,call_center   ,date_dim where     d_month_seq between 1219 and 1219 + 11 and cs_ship_date_sk   = d_date_sk and cs_warehouse_sk   = w_warehouse_sk and cs_ship_mode_sk   = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by    substring(w_warehouse_name,1,20)   ,sm_type   ,cc_name order by substring(w_warehouse_name,1,20)         ,sm_type         ,cc_name;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"call_center": ["cc_name", "cc_call_center_sk"], "catalog_sales": ["cs_warehouse_sk", "cs_call_center_sk", "cs_ship_date_sk", "cs_ship_mode_sk", "cs_sold_date_sk"], "date_dim": ["d_date_sk"], "ship_mode": ["sm_type", "sm_ship_mode_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 1, "query_string": " with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sum(SR_FEE) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1998 group by sr_customer_sk ,sr_store_sk)  select top (100) c_customer_id from customer_total_return ctr1 ,store ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'TN' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id;", "predicates": {"date_dim": ["d_year"], "store": ["s_state"], "store_returns": ["sr_store_sk"]}, "payload": {"customer": ["c_customer_id", "c_customer_sk"], "date_dim": ["d_date_sk"], "store": ["s_store_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_customer_id"]}}
{"id": 2, "query_string": " with wscs as  (select sold_date_sk         ,sales_price   from (select ws_sold_date_sk sold_date_sk               ,ws_ext_sales_price sales_price         from web_sales          union all         select cs_sold_date_sk sold_date_sk               ,cs_ext_sales_price sales_price         from catalog_sales) a),  wswscs as   (select d_week_seq,         sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales  from wscs      ,date_dim  where d_date_sk = sold_date_sk  group by d_week_seq)  select d_week_seq1        ,round(sun_sales1/sun_sales2,2)        ,round(mon_sales1/mon_sales2,2)        ,round(tue_sales1/tue_sales2,2)        ,round(wed_sales1/wed_sales2,2)        ,round(thu_sales1/thu_sales2,2)        ,round(fri_sales1/fri_sales2,2)        ,round(sat_sales1/sat_sales2,2)  from  (select wswscs.d_week_seq d_week_seq1         ,sun_sales sun_sales1         ,mon_sales mon_sales1         ,tue_sales tue_sales1         ,wed_sales wed_sales1         ,thu_sales thu_sales1         ,fri_sales fri_sales1         ,sat_sales sat_sales1   from wswscs,date_dim    where date_dim.d_week_seq = wswscs.d_week_seq and         d_year = 2001) y,  (select wswscs.d_week_seq d_week_seq2         ,sun_sales sun_sales2         ,mon_sales mon_sales2         ,tue_sales tue_sales2         ,wed_sales wed_sales2         ,thu_sales thu_sales2         ,fri_sales fri_sales2         ,sat_sales sat_sales2   from wswscs       ,date_dim    where date_dim.d_week_seq = wswscs.d_week_seq and         d_year = 2001+1) z  where d_week_seq1=d_week_seq2-53  order by d_week_seq1;", "predicates": {"date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_week_seq", "d_day_name"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 3, "query_string": " select top (100) dt.d_year         ,item.i_brand_id brand_id         ,item.i_brand brand        ,sum(ss_sales_price) sum_agg  from  date_dim dt        ,store_sales       ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk    and store_sales.ss_item_sk = item.i_item_sk    and item.i_manufact_id = 882    and dt.d_moy=12  group by dt.d_year       ,item.i_brand       ,item.i_brand_id  order by dt.d_year          ,sum_agg desc          ,brand_id  ;", "predicates": {"date_dim": ["d_moy"], "item": ["i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"date_dim": ["d_year"], "item": ["i_brand_id"]}}
{"id": 4, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year  union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total        ,'c' sale_type  from customer      ,catalog_sales      ,date_dim  where c_customer_sk = cs_bill_customer_sk    and cs_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year          )   select top (100)                    t_s_secyear.customer_id                  ,t_s_secyear.customer_first_name                  ,t_s_secyear.customer_last_name                  ,t_s_secyear.customer_preferred_cust_flag  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_c_firstyear      ,year_total t_c_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id    and t_s_firstyear.customer_id = t_c_secyear.customer_id    and t_s_firstyear.customer_id = t_c_firstyear.customer_id    and t_s_firstyear.customer_id = t_w_firstyear.customer_id    and t_s_firstyear.customer_id = t_w_secyear.customer_id    and t_s_firstyear.sale_type = 's'    and t_c_firstyear.sale_type = 'c'    and t_w_firstyear.sale_type = 'w'    and t_s_secyear.sale_type = 's'    and t_c_secyear.sale_type = 'c'    and t_w_secyear.sale_type = 'w'    and t_s_firstyear.dyear =  2000    and t_s_secyear.dyear = 2000+1    and t_c_firstyear.dyear =  2000    and t_c_secyear.dyear =  2000+1    and t_w_firstyear.dyear = 2000    and t_w_secyear.dyear = 2000+1    and t_s_firstyear.year_total > 0    and t_c_firstyear.year_total > 0    and t_w_firstyear.year_total > 0    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end            > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end  order by t_s_secyear.customer_id          ,t_s_secyear.customer_first_name          ,t_s_secyear.customer_last_name          ,t_s_secyear.customer_preferred_cust_flag;", "predicates": {"date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_ext_list_price", "cs_ext_discount_amt", "cs_bill_customer_sk", "cs_ext_sales_price", "cs_ext_wholesale_cost", "cs_sold_date_sk"], "customer": ["c_login", "c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id"], "date_dim": ["d_date_sk"], "store_sales": ["ss_ext_discount_amt", "ss_ext_sales_price", "ss_ext_wholesale_cost", "ss_customer_sk", "ss_ext_list_price", "ss_sold_date_sk"], "web_sales": ["ws_ext_discount_amt", "ws_ext_wholesale_cost", "ws_ext_list_price", "ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 5, "query_string": " with ssr as  (select s_store_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  ss_store_sk as store_sk,             ss_sold_date_sk  as date_sk,             ss_ext_sales_price as sales_price,             ss_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from store_sales     union all     select sr_store_sk as store_sk,            sr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            sr_return_amt as return_amt,            sr_net_loss as net_loss     from store_returns    ) salesreturns,      date_dim,      store  where date_sk = d_date_sk        and d_date between cast('1998-08-16' as date)                    and dateadd(day, 14, cast('1998-08-16' as date))        and store_sk = s_store_sk  group by s_store_id)  ,  csr as  (select cp_catalog_page_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  cs_catalog_page_sk as page_sk,             cs_sold_date_sk  as date_sk,             cs_ext_sales_price as sales_price,             cs_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from catalog_sales     union all     select cr_catalog_page_sk as page_sk,            cr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            cr_return_amount as return_amt,            cr_net_loss as net_loss     from catalog_returns    ) salesreturns,      date_dim,      catalog_page  where date_sk = d_date_sk        and d_date between cast('1998-08-16' as date)                   and dateadd(day, 14, cast('1998-08-16' as date))        and page_sk = cp_catalog_page_sk  group by cp_catalog_page_id)  ,  wsr as  (select web_site_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  ws_web_site_sk as wsr_web_site_sk,             ws_sold_date_sk  as date_sk,             ws_ext_sales_price as sales_price,             ws_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from web_sales     union all     select ws_web_site_sk as wsr_web_site_sk,            wr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            wr_return_amt as return_amt,            wr_net_loss as net_loss     from web_returns left outer join web_sales on          ( wr_item_sk = ws_item_sk            and wr_order_number = ws_order_number)    ) salesreturns,      date_dim,      web_site  where date_sk = d_date_sk        and d_date between cast('1998-08-16' as date)                   and dateadd(day, 14, cast('1998-08-16' as date))        and wsr_web_site_sk = web_site_sk  group by web_site_id)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , concat('store' , s_store_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from   ssr  union all  select 'catalog channel' as channel         , concat('catalog_page' , cp_catalog_page_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from  csr  union all  select 'web channel' as channel         , concat('web_site' , web_site_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from   wsr  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_page": ["cp_catalog_page_sk", "cp_catalog_page_id"], "catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_return_amount", "cr_catalog_page_sk"], "catalog_sales": ["cs_catalog_page_sk", "cs_net_profit", "cs_sold_date_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_net_loss"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit", "ss_ext_sales_price"], "web_returns": ["wr_returned_date_sk", "wr_return_amt", "wr_net_loss", "wr_item_sk", "wr_order_number"], "web_sales": ["ws_net_profit", "ws_ext_sales_price", "ws_sold_date_sk", "ws_web_site_sk"], "web_site": ["web_site_id", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 6, "query_string": " select top (100) a.ca_state state, count(*) cnt  from customer_address a      ,customer c      ,store_sales s      ,date_dim d      ,item i  where       a.ca_address_sk = c.c_current_addr_sk  \tand c.c_customer_sk = s.ss_customer_sk  \tand s.ss_sold_date_sk = d.d_date_sk  \tand s.ss_item_sk = i.i_item_sk  \tand d.d_month_seq =   \t     (select distinct (d_month_seq)  \t      from date_dim                where d_year = 2001  \t        and d_moy = 3 )  \tand i.i_current_price > 1.2 *               (select avg(j.i_current_price)   \t     from item j   \t     where j.i_category = i.i_category)  group by a.ca_state  having count(*) >= 10  order by cnt, a.ca_state   ;", "predicates": {"date_dim": ["d_month_seq", "d_moy", "d_year"], "item": ["i_category", "i_current_price"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk", "d_month_seq"], "item": ["i_item_sk", "i_category", "i_current_price"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_item_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_state"]}}
{"id": 7, "query_string": " select top (100) i_item_id,          avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4   from store_sales, customer_demographics, date_dim, item, promotion  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_cdemo_sk = cd_demo_sk and        ss_promo_sk = p_promo_sk and        cd_gender = 'M' and         cd_marital_status = 'D' and        cd_education_status = 'College' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 1998   group by i_item_id  order by i_item_id  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "promotion": ["p_channel_event", "p_channel_email"]}, "payload": {"customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"], "promotion": ["p_promo_sk"], "store_sales": ["ss_promo_sk", "ss_item_sk", "ss_cdemo_sk", "ss_list_price", "ss_quantity", "ss_sales_price", "ss_coupon_amt", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 8, "query_string": " select top (100) s_store_name       ,sum(ss_net_profit)  from store_sales      ,date_dim      ,store,      (select ca_zip      from (       SELECT substring(ca_zip,1,5) ca_zip       FROM customer_address       WHERE substring(ca_zip,1,5) IN (                           '26752','93570','61808','51868','70890','87561',                           '34973','33025','30281','37487','62031',                           '18649','29317','98633','39343','46304',                           '72651','49793','78148','76517','80988',                           '10957','10642','59701','28764','55387',                           '93771','94214','47298','75922','33618',                           '41903','91300','81584','50214','39293',                           '60523','54351','21311','20735','99707',                           '56102','43008','95849','50297','73632',                           '46689','29379','63958','10589','92035',                           '35755','74771','27094','47389','48748',                           '79435','18732','54789','92530','49097',                           '71600','72833','72695','66816','23895',                           '63655','41041','57898','16520','88851',                           '89501','25394','64429','32344','52718',                           '42151','55278','24252','11852','81804',                           '75759','63200','13089','93283','89043',                           '73372','90284','48609','12766','67555',                           '21318','52318','43364','93063','87815',                           '94054','18725','63225','33729','54845',                           '45640','13019','19399','81931','16797',                           '54646','17915','20235','15706','78136',                           '90646','82646','70319','94546','39283',                           '79286','12976','80421','10710','22220',                           '45596','75709','24975','88486','62675',                           '35578','51851','17973','29378','66116',                           '41491','73086','63281','35178','82959',                           '31343','82116','45470','36367','60679',                           '96026','90287','90371','15640','26217',                           '25730','33095','83990','19647','34466',                           '12942','64081','77007','25283','52670',                           '74681','47470','22238','15092','78529',                           '30962','42398','50148','46456','11134',                           '92163','84354','18579','94838','77477',                           '80418','62661','32286','88573','69410',                           '93721','99123','92801','64847','20157',                           '29812','60351','96841','12675','13358',                           '14197','74228','27424','35327','81118',                           '64965','10695','59528','86720','42998',                           '84677','80805','24238','68850','47845',                           '20368','59802','95560','34280','32643',                           '81164','56819','24370','68687','26413',                           '54337','36497','51201','85983','46294',                           '16618','95421','68119','57596','93198',                           '99457','58434','75336','98927','27522',                           '53060','39340','19819','58211','48647',                           '55443','50170','52780','53473','55288',                           '36590','83488','89648','82639','26105',                           '15261','77273','86921','23365','77991',                           '72634','15044','53402','41817','60420',                           '17593','47345','45608','36833','54422',                           '94352','29336','92153','28208','63786',                           '64311','75393','14508','48201','56180',                           '26631','37858','40030','57340','65621',                           '65445','56232','58681','31094','26444',                           '30248','36114','77827','69265','86104',                           '96109','48129','58493','56934','82718',                           '97628','21221','66964','74509','25392',                           '98376','70439','16365','27840','46065',                           '27645','21407','54394','25572','21889',                           '57555','30499','15265','94312','74855',                           '86269','51002','10347','27402','30068',                           '76621','55198','88025','13104','17599',                           '14898','50541','15193','83605','23508',                           '34949','55273','34492','42353','21718',                           '89809','85804','56689','53023','53696',                           '99086','57181','99398','65394','20454',                           '41745','26150','43964','38052','79865',                           '34402','96480','78090','38477','33965',                           '32556','20574','38233','37818','29005',                           '34802','12788','43034','85221','95517',                           '68794','81065','46646','59878','60793',                           '95771','82389','85255','21462','82628',                           '44471','15267','29848','33694','99254',                           '56882','52982','70093','41209','19167',                           '99344','93424','94861','15118','31803',                           '62384','64571','68274','22444','23934',                           '97780','92121','90841','52024','26701',                           '42502','97047','33163','48677','68406',                           '49027','40211','20752','75902')      intersect       select ca_zip       from (SELECT substring(ca_zip,1,5) ca_zip,count(*) cnt             FROM customer_address, customer             WHERE ca_address_sk = c_current_addr_sk and                   c_preferred_cust_flag='Y'             group by ca_zip             having count(*) > 10)A1)A2) V1  where ss_store_sk = s_store_sk   and ss_sold_date_sk = d_date_sk   and d_qoy = 2 and d_year = 2000   and (substring(s_zip,1,2) = substring(V1.ca_zip,1,2))  group by s_store_name  order by s_store_name  ;", "predicates": {"customer": ["c_preferred_cust_flag"], "date_dim": ["d_qoy", "d_year"]}, "payload": {"customer": ["c_current_addr_sk"], "customer_address": ["ca_address_sk", "ca_zip"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 9, "query_string": " select case when (select count(*)                    from store_sales                    where ss_quantity between 1 and 20) > 40117             then (select avg(ss_ext_discount_amt)                    from store_sales                    where ss_quantity between 1 and 20)              else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 1 and 20) end bucket1 ,        case when (select count(*)                   from store_sales                   where ss_quantity between 21 and 40) > 44305             then (select avg(ss_ext_discount_amt)                   from store_sales                   where ss_quantity between 21 and 40)              else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 21 and 40) end bucket2,        case when (select count(*)                   from store_sales                   where ss_quantity between 41 and 60) > 3217             then (select avg(ss_ext_discount_amt)                   from store_sales                   where ss_quantity between 41 and 60)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 41 and 60) end bucket3,        case when (select count(*)                   from store_sales                   where ss_quantity between 61 and 80) > 6102             then (select avg(ss_ext_discount_amt)                   from store_sales                   where ss_quantity between 61 and 80)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 61 and 80) end bucket4,        case when (select count(*)                   from store_sales                   where ss_quantity between 81 and 100) > 17244             then (select avg(ss_ext_discount_amt)                   from store_sales                   where ss_quantity between 81 and 100)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 81 and 100) end bucket5 from reason where r_reason_sk = 1;", "predicates": {"store_sales": ["ss_quantity"]}, "payload": {"store_sales": ["ss_ext_tax", "ss_net_paid_inc_tax"]}, "group_by": {}, "order_by": {}}
{"id": 10, "query_string": " select top (100)    cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3,   cd_dep_count,   count(*) cnt4,   cd_dep_employed_count,   count(*) cnt5,   cd_dep_college_count,   count(*) cnt6  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_county in ('Dane County','Madison County','Boone County','Carroll County','Dallam County') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2000 and                 d_moy between 1 and 1+3) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2000 and                   d_moy between 1 ANd 1+3) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2000 and                   d_moy between 1 and 1+3))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count;", "predicates": {"customer_address": ["ca_county"], "date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 11, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag           ,c_birth_country          ,c_login          ,c_email_address          ,d_year   union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag           ,c_birth_country          ,c_login          ,c_email_address          ,d_year          )   select top (100)                    t_s_secyear.customer_id                  ,t_s_secyear.customer_first_name                  ,t_s_secyear.customer_last_name                  ,t_s_secyear.customer_preferred_cust_flag  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id          and t_s_firstyear.customer_id = t_w_secyear.customer_id          and t_s_firstyear.customer_id = t_w_firstyear.customer_id          and t_s_firstyear.sale_type = 's'          and t_w_firstyear.sale_type = 'w'          and t_s_secyear.sale_type = 's'          and t_w_secyear.sale_type = 'w'          and t_s_firstyear.dyear = 2000          and t_s_secyear.dyear = 2000+1          and t_w_firstyear.dyear = 2000          and t_w_secyear.dyear = 2000+1          and t_s_firstyear.year_total > 0          and t_w_firstyear.year_total > 0          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end              > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end  order by t_s_secyear.customer_id          ,t_s_secyear.customer_first_name          ,t_s_secyear.customer_last_name          ,t_s_secyear.customer_preferred_cust_flag;", "predicates": {"date_dim": ["d_year"]}, "payload": {"customer": ["c_login", "c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_ext_list_price", "ss_ext_discount_amt"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_discount_amt", "ws_ext_list_price"]}, "group_by": {}, "order_by": {}}
{"id": 12, "query_string": " select top (100) i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from\t \tweb_sales     \t,item      \t,date_dim where  \tws_item_sk = i_item_sk    \tand i_category in ('Jewelry', 'Shoes', 'Women')   \tand ws_sold_date_sk = d_date_sk \tand d_date between cast('1999-06-04' as date)  \t\t\t\tand dateadd(day, 30, cast('1999-06-04' as date)) group by  \ti_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  \ti_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_desc", "i_class", "i_item_id", "i_category"]}}
{"id": 13, "query_string": " select avg(ss_quantity)        ,avg(ss_ext_sales_price)        ,avg(ss_ext_wholesale_cost)        ,sum(ss_ext_wholesale_cost)  from store_sales      ,store      ,customer_demographics      ,household_demographics      ,customer_address      ,date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2001  and((ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'S'   and cd_education_status = '2 yr Degree'   and ss_sales_price between 100.00 and 150.00   and hd_dep_count = 3         )or      (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'W'   and cd_education_status = '4 yr Degree'   and ss_sales_price between 50.00 and 100.00      and hd_dep_count = 1      ) or       (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'D'   and cd_education_status = 'Advanced Degree'   and ss_sales_price between 150.00 and 200.00    and hd_dep_count = 1        ))  and((ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('KY', 'KS', 'OK')   and ss_net_profit between 100 and 200        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('MI', 'TX', 'AL')   and ss_net_profit between 150 and 300        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('NC', 'IL', 'VA')   and ss_net_profit between 50 and 250        ));", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "household_demographics": ["hd_dep_count"], "store_sales": ["ss_sales_price", "ss_net_profit"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_dep_count", "hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_ext_sales_price", "ss_cdemo_sk", "ss_addr_sk", "ss_quantity", "ss_sales_price", "ss_ext_wholesale_cost", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 14, "query_string": " with  cross_items as  (select i_item_sk ss_item_sk  from item,  (select iss.i_brand_id brand_id      ,iss.i_class_id class_id      ,iss.i_category_id category_id  from store_sales      ,item iss      ,date_dim d1  where ss_item_sk = iss.i_item_sk    and ss_sold_date_sk = d1.d_date_sk    and d1.d_year between 2000 AND 2000 + 2  intersect   select ics.i_brand_id      ,ics.i_class_id      ,ics.i_category_id  from catalog_sales      ,item ics      ,date_dim d2  where cs_item_sk = ics.i_item_sk    and cs_sold_date_sk = d2.d_date_sk    and d2.d_year between 2000 AND 2000 + 2  intersect  select iws.i_brand_id      ,iws.i_class_id      ,iws.i_category_id  from web_sales      ,item iws      ,date_dim d3  where ws_item_sk = iws.i_item_sk    and ws_sold_date_sk = d3.d_date_sk    and d3.d_year between 2000 AND 2000 + 2) a  where i_brand_id = brand_id       and i_class_id = class_id       and i_category_id = category_id ),  avg_sales as  (select avg(quantity*list_price) average_sales   from (select ss_quantity quantity              ,ss_list_price list_price        from store_sales            ,date_dim        where ss_sold_date_sk = d_date_sk          and d_year between 2000 and 2000 + 2        union all         select cs_quantity quantity               ,cs_list_price list_price        from catalog_sales            ,date_dim        where cs_sold_date_sk = d_date_sk          and d_year between 2000 and 2000 + 2         union all        select ws_quantity quantity              ,ws_list_price list_price        from web_sales            ,date_dim        where ws_sold_date_sk = d_date_sk          and d_year between 2000 and 2000 + 2) x)   select top (100) channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)  from(        select 'store' channel, i_brand_id,i_class_id              ,i_category_id,sum(ss_quantity*ss_list_price) sales              , count(*) number_sales        from store_sales            ,item            ,date_dim        where ss_item_sk in (select ss_item_sk from cross_items)          and ss_item_sk = i_item_sk          and ss_sold_date_sk = d_date_sk          and d_year = 2000+2           and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)        union all        select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales        from catalog_sales            ,item            ,date_dim        where cs_item_sk in (select ss_item_sk from cross_items)          and cs_item_sk = i_item_sk          and cs_sold_date_sk = d_date_sk          and d_year = 2000+2           and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)        union all        select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales        from web_sales            ,item            ,date_dim        where ws_item_sk in (select ss_item_sk from cross_items)          and ws_item_sk = i_item_sk          and ws_sold_date_sk = d_date_sk          and d_year = 2000+2          and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)  ) y  group by rollup (channel, i_brand_id,i_class_id,i_category_id)  order by channel,i_brand_id,i_class_id,i_category_id  ; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_list_price", "cs_quantity"], "date_dim": ["d_date_sk"], "item": ["i_category_id", "i_class_id", "i_item_sk", "i_brand_id"], "store_sales": ["ss_sold_date_sk", "ss_list_price", "ss_quantity", "ss_item_sk"], "web_sales": ["ws_list_price", "ws_sold_date_sk", "ws_item_sk", "ws_quantity"]}, "group_by": {}, "order_by": {}}
{"id": 15, "query_string": " select top (100) ca_zip        ,sum(cs_sales_price)  from catalog_sales      ,customer      ,customer_address      ,date_dim  where cs_bill_customer_sk = c_customer_sk  \tand c_current_addr_sk = ca_address_sk   \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',                                    '85392', '85460', '80348', '81792')  \t      or ca_state in ('CA','WA','GA')  \t      or cs_sales_price > 500)  \tand cs_sold_date_sk = d_date_sk  \tand d_qoy = 1 and d_year = 2001  group by ca_zip  order by ca_zip  ;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"catalog_sales": ["cs_sales_price", "cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip", "ca_state"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_zip"]}}
{"id": 16, "query_string": " select top (100)     count(distinct cs_order_number) as \"order count\"   ,sum(cs_ext_ship_cost) as \"total shipping cost\"   ,sum(cs_net_profit) as \"total net profit\" from    catalog_sales cs1   ,date_dim   ,customer_address   ,call_center where     d_date between '2001-3-01' and             dateadd(day, 60, cast('2001-3-01' as date)) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'AR' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County',                   'Williamson County' ) and exists (select *             from catalog_sales cs2             where cs1.cs_order_number = cs2.cs_order_number               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select *                from catalog_returns cr1                where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number);", "predicates": {"call_center": ["cc_county"], "customer_address": ["ca_state"], "date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_order_number"], "catalog_sales": ["cs_order_number", "cs_warehouse_sk", "cs_ext_ship_cost", "cs_ship_addr_sk", "cs_net_profit", "cs_call_center_sk", "cs_ship_date_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 17, "query_string": " select top (100) i_item_id        ,i_item_desc        ,s_state        ,count(ss_quantity) as store_sales_quantitycount        ,avg(ss_quantity) as store_sales_quantityave        ,stdev(ss_quantity) as store_sales_quantitystdev        ,stdev(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov        ,count(sr_return_quantity) as store_returns_quantitycount        ,avg(sr_return_quantity) as store_returns_quantityave        ,stdev(sr_return_quantity) as store_returns_quantitystdev        ,stdev(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov        ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave        ,stdev(cs_quantity) as catalog_sales_quantitystdev        ,stdev(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov  from store_sales      ,store_returns      ,catalog_sales      ,date_dim d1      ,date_dim d2      ,date_dim d3      ,store      ,item  where d1.d_quarter_name = '2000Q1'    and d1.d_date_sk = ss_sold_date_sk    and i_item_sk = ss_item_sk    and s_store_sk = ss_store_sk    and ss_customer_sk = sr_customer_sk    and ss_item_sk = sr_item_sk    and ss_ticket_number = sr_ticket_number    and sr_returned_date_sk = d2.d_date_sk    and d2.d_quarter_name in ('2000Q1','2000Q2','2000Q3')    and sr_customer_sk = cs_bill_customer_sk    and sr_item_sk = cs_item_sk    and cs_sold_date_sk = d3.d_date_sk    and d3.d_quarter_name in ('2000Q1','2000Q2','2000Q3')  group by i_item_id          ,i_item_desc          ,s_state  order by i_item_id          ,i_item_desc          ,s_state;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_quarter_name"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_state", "s_store_sk"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_return_quantity", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 18, "query_string": " select top (100) i_item_id,         ca_country,         ca_state,          ca_county,         avg( cast(cs_quantity as decimal(12,2))) agg1,         avg( cast(cs_list_price as decimal(12,2))) agg2,         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,         avg( cast(cs_sales_price as decimal(12,2))) agg4,         avg( cast(cs_net_profit as decimal(12,2))) agg5,         avg( cast(c_birth_year as decimal(12,2))) agg6,         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7  from catalog_sales, customer_demographics cd1,        customer_demographics cd2, customer, customer_address, date_dim, item  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd1.cd_demo_sk and        cs_bill_customer_sk = c_customer_sk and        cd1.cd_gender = 'M' and         cd1.cd_education_status = 'College' and        c_current_cdemo_sk = cd2.cd_demo_sk and        c_current_addr_sk = ca_address_sk and        c_birth_month in (7,9,5,10,6,4) and        d_year = 2001 and        ca_state in ('TN','MT','IN'                    ,'WY','WA','IA','NE')  group by rollup (i_item_id, ca_country, ca_state, ca_county)  order by ca_country,         ca_state,          ca_county, \ti_item_id  ;", "predicates": {"customer": ["c_birth_month"], "customer_address": ["ca_state"], "customer_demographics": ["cd_education_status", "cd_gender"], "date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_quantity", "cs_sales_price", "cs_bill_customer_sk", "cs_item_sk", "cs_net_profit", "cs_list_price", "cs_coupon_amt", "cs_sold_date_sk", "cs_bill_cdemo_sk"], "customer": ["c_birth_year", "c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_county", "ca_country", "ca_state"], "customer_demographics": ["cd_demo_sk", "cd_dep_count"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_state", "ca_county", "ca_country"], "item": ["i_item_id"]}}
{"id": 19, "query_string": " select top (100) i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,  \tsum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item,customer,customer_address,store  where d_date_sk = ss_sold_date_sk    and ss_item_sk = i_item_sk    and i_manager_id=10    and d_moy=12    and d_year=2000    and ss_customer_sk = c_customer_sk     and c_current_addr_sk = ca_address_sk    and substring(ca_zip,1,5) <> substring(s_zip,1,5)     and ss_store_sk = s_store_sk   group by i_brand       ,i_brand_id       ,i_manufact_id       ,i_manufact  order by ext_price desc          ,i_brand          ,i_brand_id          ,i_manufact_id          ,i_manufact  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip"], "date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_brand_id", "i_manufact_id", "i_brand", "i_manufact"], "store": ["s_zip", "s_store_sk"]}, "group_by": {}, "order_by": {"item": ["i_brand", "i_manufact", "i_brand_id", "i_manufact_id"]}}
{"id": 20, "query_string": " select top (100) i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from\tcatalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Jewelry', 'Shoes', 'Women')    and cs_sold_date_sk = d_date_sk  and d_date between cast('1999-06-04' as date)   \t\t\t\tand dateadd(day, 30, cast('1999-06-04' as date))  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"]}, "group_by": {}, "order_by": {"item": ["i_item_desc", "i_class", "i_item_id", "i_category"]}}
{"id": 21, "query_string": " select top (100) *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-29' as date)) \t                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between dateadd(day, -30, cast ('1998-06-29' as date))                     and dateadd(day, 30, cast ('1998-06-29' as date))    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  ;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"]}, "payload": {"date_dim": ["d_date_sk", "d_date"], "item": ["i_item_id", "i_item_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 22, "query_string": " select top (100) i_product_name              ,i_brand              ,i_class              ,i_category              ,avg(inv_quantity_on_hand) qoh        from inventory            ,date_dim            ,item        where inv_date_sk=d_date_sk               and inv_item_sk=i_item_sk               and d_month_seq between 1222 and 1222 + 11        group by rollup(i_product_name                        ,i_brand                        ,i_class                        ,i_category) order by qoh, i_product_name, i_brand, i_class, i_category;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_brand", "i_product_name", "i_category", "i_class"]}, "group_by": {}, "order_by": {"item": ["i_product_name", "i_class", "i_brand", "i_category"]}}
{"id": 23, "query_string": " with frequent_ss_items as   (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt   from store_sales       ,date_dim        ,item   where ss_sold_date_sk = d_date_sk     and ss_item_sk = i_item_sk      and d_year in (2000,2000+1,2000+2,2000+3)   group by substring(i_item_desc,1,30),i_item_sk,d_date   having count(*) >4),  max_store_sales as  (select max(csales) tpcds_cmax    from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales         from store_sales             ,customer             ,date_dim          where ss_customer_sk = c_customer_sk          and ss_sold_date_sk = d_date_sk          and d_year in (2000,2000+1,2000+2,2000+3)          group by c_customer_sk) a),  best_ss_customer as  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales   from store_sales       ,customer   where ss_customer_sk = c_customer_sk   group by c_customer_sk   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select   * from  max_store_sales))   select top (100) sum(sales)  from (select cs_quantity*cs_list_price sales        from catalog_sales            ,date_dim         where d_year = 2000           and d_moy = 1           and cs_sold_date_sk = d_date_sk           and cs_item_sk in (select item_sk from frequent_ss_items)          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)       union all       select ws_quantity*ws_list_price sales        from web_sales             ,date_dim         where d_year = 2000           and d_moy = 1           and ws_sold_date_sk = d_date_sk           and ws_item_sk in (select item_sk from frequent_ss_items)          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) b  ; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"customer": ["c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "item": ["i_item_sk", "i_item_desc"], "store_sales": ["ss_item_sk", "ss_sales_price", "ss_customer_sk", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 24, "query_string": " with ssales as (select c_last_name       ,c_first_name       ,s_store_name       ,ca_state       ,s_state       ,i_color       ,i_current_price       ,i_manager_id       ,i_units       ,i_size       ,sum(ss_sales_price) netpaid from store_sales     ,store_returns     ,store     ,item     ,customer     ,customer_address where ss_ticket_number = sr_ticket_number   and ss_item_sk = sr_item_sk   and ss_customer_sk = c_customer_sk   and ss_item_sk = i_item_sk   and ss_store_sk = s_store_sk   and c_current_addr_sk = ca_address_sk   and c_birth_country <> upper(ca_country)   and s_zip = ca_zip and s_market_id=10 group by c_last_name         ,c_first_name         ,s_store_name         ,ca_state         ,s_state         ,i_color         ,i_current_price         ,i_manager_id         ,i_units         ,i_size) select c_last_name       ,c_first_name       ,s_store_name       ,sum(netpaid) paid from ssales where i_color = 'gainsboro' group by c_last_name         ,c_first_name         ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid)                                  from ssales) order by c_last_name         ,c_first_name         ,s_store_name; ", "predicates": {"item": ["i_color"], "store": ["s_market_id"]}, "payload": {"customer": ["c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_current_addr_sk"], "customer_address": ["ca_address_sk", "ca_country", "ca_zip", "ca_state"], "item": ["i_item_sk", "i_units", "i_manager_id", "i_current_price", "i_size"], "store": ["s_zip", "s_store_name", "s_state", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_net_paid_inc_tax"]}, "group_by": {}, "order_by": {}}
{"id": 25, "query_string": " select top (100)   i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  ,sum(ss_net_profit) as store_sales_profit  ,sum(sr_net_loss) as store_returns_loss  ,sum(cs_net_profit) as catalog_sales_profit  from  store_sales  ,store_returns  ,catalog_sales  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,item  where  d1.d_moy = 4  and d1.d_year = 2001  and d1.d_date_sk = ss_sold_date_sk  and i_item_sk = ss_item_sk  and s_store_sk = ss_store_sk  and ss_customer_sk = sr_customer_sk  and ss_item_sk = sr_item_sk  and ss_ticket_number = sr_ticket_number  and sr_returned_date_sk = d2.d_date_sk  and d2.d_moy               between 4 and  10  and d2.d_year              = 2001  and sr_customer_sk = cs_bill_customer_sk  and sr_item_sk = cs_item_sk  and cs_sold_date_sk = d3.d_date_sk  and d3.d_moy               between 4 and  10   and d3.d_year              = 2001  group by  i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  order by  i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  ;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_store_name", "s_store_sk", "s_store_id"], "store_returns": ["sr_returned_date_sk", "sr_net_loss", "sr_customer_sk", "sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 26, "query_string": " select top (100) i_item_id,          avg(cs_quantity) agg1,         avg(cs_list_price) agg2,         avg(cs_coupon_amt) agg3,         avg(cs_sales_price) agg4   from catalog_sales, customer_demographics, date_dim, item, promotion  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd_demo_sk and        cs_promo_sk = p_promo_sk and        cd_gender = 'M' and         cd_marital_status = 'D' and        cd_education_status = 'College' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 1998   group by i_item_id  order by i_item_id  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "promotion": ["p_channel_event", "p_channel_email"]}, "payload": {"item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 27, "query_string": " select top (100) i_item_id,         s_state, grouping(s_state) g_state,         avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4  from store_sales, customer_demographics, date_dim, store, item  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_store_sk = s_store_sk and        ss_cdemo_sk = cd_demo_sk and        cd_gender = 'F' and        cd_marital_status = 'S' and        cd_education_status = 'College' and        d_year = 2002 and        s_state in ('TN','TN', 'TN', 'TN', 'TN', 'TN')  group by rollup (i_item_id, s_state)  order by i_item_id          ,s_state  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "store": ["s_state"]}, "payload": {"customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"], "store": ["s_state", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_cdemo_sk", "ss_list_price", "ss_quantity", "ss_sales_price", "ss_coupon_amt", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_id"], "store": ["s_state"]}}
{"id": 28, "query_string": " select top (100) * from (select avg(ss_list_price) B1_LP             ,count(ss_list_price) B1_CNT             ,count(distinct ss_list_price) B1_CNTD       from store_sales       where ss_quantity between 0 and 5         and (ss_list_price between 144 and 144+10               or ss_coupon_amt between 10673 and 10673+1000              or ss_wholesale_cost between 66 and 66+20)) B1,      (select avg(ss_list_price) B2_LP             ,count(ss_list_price) B2_CNT             ,count(distinct ss_list_price) B2_CNTD       from store_sales       where ss_quantity between 6 and 10         and (ss_list_price between 111 and 111+10           or ss_coupon_amt between 16879 and 16879+1000           or ss_wholesale_cost between 55 and 55+20)) B2,      (select avg(ss_list_price) B3_LP             ,count(ss_list_price) B3_CNT             ,count(distinct ss_list_price) B3_CNTD       from store_sales       where ss_quantity between 11 and 15         and (ss_list_price between 186 and 186+10           or ss_coupon_amt between 17321 and 17321+1000           or ss_wholesale_cost between 51 and 51+20)) B3,      (select avg(ss_list_price) B4_LP             ,count(ss_list_price) B4_CNT             ,count(distinct ss_list_price) B4_CNTD       from store_sales       where ss_quantity between 16 and 20         and (ss_list_price between 65 and 65+10           or ss_coupon_amt between 6203 and 6203+1000           or ss_wholesale_cost between 39 and 39+20)) B4,      (select avg(ss_list_price) B5_LP             ,count(ss_list_price) B5_CNT             ,count(distinct ss_list_price) B5_CNTD       from store_sales       where ss_quantity between 21 and 25         and (ss_list_price between 131 and 131+10           or ss_coupon_amt between 14432 and 14432+1000           or ss_wholesale_cost between 57 and 57+20)) B5,      (select avg(ss_list_price) B6_LP             ,count(ss_list_price) B6_CNT             ,count(distinct ss_list_price) B6_CNTD       from store_sales       where ss_quantity between 26 and 30         and (ss_list_price between 135 and 135+10           or ss_coupon_amt between 8517 and 8517+1000           or ss_wholesale_cost between 34 and 34+20)) B6;", "predicates": {"store_sales": ["ss_list_price", "ss_coupon_amt", "ss_quantity", "ss_wholesale_cost"]}, "payload": {"store_sales": ["ss_list_price"]}, "group_by": {}, "order_by": {}}
{"id": 29, "query_string": " select top (100)        i_item_id     ,i_item_desc     ,s_store_id     ,s_store_name     ,min(ss_quantity)        as store_sales_quantity     ,min(sr_return_quantity) as store_returns_quantity     ,min(cs_quantity)        as catalog_sales_quantity  from     store_sales    ,store_returns    ,catalog_sales    ,date_dim             d1    ,date_dim             d2    ,date_dim             d3    ,store    ,item  where      d1.d_moy               = 4   and d1.d_year              = 2000  and d1.d_date_sk           = ss_sold_date_sk  and i_item_sk              = ss_item_sk  and s_store_sk             = ss_store_sk  and ss_customer_sk         = sr_customer_sk  and ss_item_sk             = sr_item_sk  and ss_ticket_number       = sr_ticket_number  and sr_returned_date_sk    = d2.d_date_sk  and d2.d_moy               between 4 and  4 + 3   and d2.d_year              = 2000  and sr_customer_sk         = cs_bill_customer_sk  and sr_item_sk             = cs_item_sk  and cs_sold_date_sk        = d3.d_date_sk       and d3.d_year              in (2000,2000+1,2000+2)  group by     i_item_id    ,i_item_desc    ,s_store_id    ,s_store_name  order by     i_item_id     ,i_item_desc    ,s_store_id    ,s_store_name  ;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_store_name", "s_store_sk", "s_store_id"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_return_quantity", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 30, "query_string": " with customer_total_return as  (select wr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   \tsum(wr_return_amt) as ctr_total_return  from web_returns      ,date_dim      ,customer_address  where wr_returned_date_sk = d_date_sk     and d_year =1999    and wr_returning_addr_sk = ca_address_sk   group by wr_returning_customer_sk          ,ca_state)   select top (100) c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag        ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address        ,c_last_review_date,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  \t\t\t  from customer_total_return ctr2                    \t  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'WV'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag                   ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address                   ,c_last_review_date,ctr_total_return;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_year"]}, "payload": {"customer": ["c_birth_year", "c_login", "c_customer_sk", "c_birth_month", "c_salutation", "c_birth_day", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_current_addr_sk", "c_email_address", "c_customer_id", "c_last_review_date"], "customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "web_returns": ["wr_return_amt", "wr_returning_addr_sk", "wr_returned_date_sk", "wr_returning_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_birth_year", "c_login", "c_birth_month", "c_birth_country", "c_salutation", "c_birth_day", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id", "c_last_review_date"]}}
{"id": 31, "query_string": " with ss as  (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales  from store_sales,date_dim,customer_address  where ss_sold_date_sk = d_date_sk   and ss_addr_sk=ca_address_sk  group by ca_county,d_qoy, d_year),  ws as  (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales  from web_sales,date_dim,customer_address  where ws_sold_date_sk = d_date_sk   and ws_bill_addr_sk=ca_address_sk  group by ca_county,d_qoy, d_year)  select          ss1.ca_county        ,ss1.d_year        ,ws2.web_sales/ws1.web_sales web_q1_q2_increase        ,ss2.store_sales/ss1.store_sales store_q1_q2_increase        ,ws3.web_sales/ws2.web_sales web_q2_q3_increase        ,ss3.store_sales/ss2.store_sales store_q2_q3_increase  from         ss ss1        ,ss ss2        ,ss ss3        ,ws ws1        ,ws ws2        ,ws ws3  where     ss1.d_qoy = 1     and ss1.d_year = 2001     and ss1.ca_county = ss2.ca_county     and ss2.d_qoy = 2     and ss2.d_year = 2001  and ss2.ca_county = ss3.ca_county     and ss3.d_qoy = 3     and ss3.d_year = 2001     and ss1.ca_county = ws1.ca_county     and ws1.d_qoy = 1     and ws1.d_year = 2001     and ws1.ca_county = ws2.ca_county     and ws2.d_qoy = 2     and ws2.d_year = 2001     and ws1.ca_county = ws3.ca_county     and ws3.d_qoy = 3     and ws3.d_year =2001     and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end         > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end     and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end        > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end  order by web_q1_q2_increase;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"customer_address": ["ca_address_sk", "ca_county"], "date_dim": ["d_date_sk", "d_year"], "store_sales": ["ss_sold_date_sk", "ss_addr_sk", "ss_ext_sales_price"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_bill_addr_sk"]}, "group_by": {}, "order_by": {}}
{"id": 32, "query_string": " select top (100) sum(cs_ext_discount_amt)  as \"excess discount amount\"  from     catalog_sales     ,item     ,date_dim where i_manufact_id = 750 and i_item_sk = cs_item_sk  and d_date between '1999-02-04' and          dateadd(day, 90, cast('1999-02-04' as date)) and d_date_sk = cs_sold_date_sk  and cs_ext_discount_amt        > (           select              1.3 * avg(cs_ext_discount_amt)           from              catalog_sales             ,date_dim          where                cs_item_sk = i_item_sk            and d_date between '1999-02-04' and                              dateadd(day, 90, cast('1999-02-04' as date))           and d_date_sk = cs_sold_date_sk        ) ;", "predicates": {"catalog_sales": ["cs_ext_discount_amt"], "date_dim": ["d_date"], "item": ["i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 33, "query_string": " with ss as (  select           i_manufact_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id in (select   i_manufact_id from  item where i_category in ('Books'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 2  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  cs as (  select           i_manufact_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Books'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 2  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  ws as (  select           i_manufact_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Books'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 2  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_manufact_id)   select top (100) i_manufact_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_manufact_id  order by total_sales;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_category"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_addr_sk", "cs_item_sk", "cs_ext_sales_price"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_manufact_id"], "store_sales": ["ss_sold_date_sk", "ss_addr_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk", "ws_bill_addr_sk"]}, "group_by": {}, "order_by": {}}
{"id": 34, "query_string": " select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '1001-5000' or          household_demographics.hd_buy_potential = '5001-10000')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  \tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  \telse null  \tend)  > 1.2     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',                            'Williamson County','Williamson County','Williamson County','Williamson County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;", "predicates": {"date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count", "hd_buy_potential"], "store": ["s_county"]}, "payload": {"customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_preferred_cust_flag"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 35, "query_string": " select top (100)     ca_state,   cd_gender,   cd_marital_status,   cd_dep_count,   count(*) cnt1,   max(cd_dep_count),   max(cd_dep_count),   sum(cd_dep_count),   cd_dep_employed_count,   count(*) cnt2,   max(cd_dep_employed_count),   max(cd_dep_employed_count),   sum(cd_dep_employed_count),   cd_dep_college_count,   count(*) cnt3,   max(cd_dep_college_count),   max(cd_dep_college_count),   sum(cd_dep_college_count)  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2001 and                 d_qoy < 4) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_qoy < 4) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_qoy < 4))  group by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  ;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_state"], "customer_demographics": ["cd_dep_college_count", "cd_gender", "cd_demo_sk", "cd_dep_employed_count", "cd_dep_count", "cd_marital_status"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 36, "query_string": " select top (100)      sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  \tpartition by grouping(i_category)+grouping(i_class),  \tcase when grouping(i_class) = 0 then i_category end   \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent  from     store_sales    ,date_dim       d1    ,item    ,store  where     d1.d_year = 2001   and d1.d_date_sk = ss_sold_date_sk  and i_item_sk  = ss_item_sk   and s_store_sk  = ss_store_sk  and s_state in ('TN','TN','TN','TN',                  'TN','TN','TN','TN')  group by rollup(i_category,i_class)  order by    lochierarchy desc   ,case when (grouping(i_category)+grouping(i_class)) = 0 then i_category end   ,rank_within_parent   ;", "predicates": {"date_dim": ["d_year"], "store": ["s_state"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_class", "i_item_sk", "i_category"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_ext_sales_price", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 37, "query_string": " select top (100) i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 47 and 47 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('1998-02-03' as date) and dateadd(day, 60, cast('1998-02-03' as date))  and i_manufact_id in (854,946,674,990)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  ;", "predicates": {"date_dim": ["d_date"], "inventory": ["inv_quantity_on_hand"], "item": ["i_current_price", "i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc", "i_current_price"]}, "group_by": {}, "order_by": {}}
{"id": 38, "query_string": " select top (100) count(*) from (     select distinct c_last_name, c_first_name, d_date     from store_sales, date_dim, customer           where store_sales.ss_sold_date_sk = date_dim.d_date_sk       and store_sales.ss_customer_sk = customer.c_customer_sk       and d_month_seq between 1222 and 1222 + 11   intersect     select distinct c_last_name, c_first_name, d_date     from catalog_sales, date_dim, customer           where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk       and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk       and d_month_seq between 1222 and 1222 + 11   intersect     select distinct c_last_name, c_first_name, d_date     from web_sales, date_dim, customer           where web_sales.ws_sold_date_sk = date_dim.d_date_sk       and web_sales.ws_bill_customer_sk = customer.c_customer_sk       and d_month_seq between 1222 and 1222 + 11 ) hot_cust;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk", "ws_item_sk", "ws_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 39, "query_string": " with inv as (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy        ,stdev,mean, case mean when 0 then null else stdev/mean end cov  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy             ,stdev(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean       from inventory           ,item           ,warehouse           ,date_dim       where inv_item_sk = i_item_sk         and inv_warehouse_sk = w_warehouse_sk         and inv_date_sk = d_date_sk         and d_year =1998       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo  where case mean when 0 then 0 else stdev/mean end > 1) select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov from inv inv1,inv inv2 where inv1.i_item_sk = inv2.i_item_sk   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk   and inv1.d_moy=3   and inv2.d_moy=3+1 order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov         ,inv2.d_moy,inv2.mean, inv2.cov; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_item_sk"], "warehouse": ["w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 40, "query_string": " select top (100)     w_state   ,i_item_id   ,sum(case when (cast(d_date as date) < cast ('1998-06-29' as date))   \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before   ,sum(case when (cast(d_date as date) >= cast ('1998-06-29' as date))   \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after  from    catalog_sales left outer join catalog_returns on        (cs_order_number = cr_order_number          and cs_item_sk = cr_item_sk)   ,warehouse    ,item   ,date_dim  where      i_current_price between 0.99 and 1.49  and i_item_sk          = cs_item_sk  and cs_warehouse_sk    = w_warehouse_sk   and cs_sold_date_sk    = d_date_sk  and d_date between dateadd(day, -30, cast ('1998-06-29' as date))                 and dateadd(day, 30, cast ('1998-06-29' as date))   group by     w_state,i_item_id  order by w_state,i_item_id;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_refunded_cash"], "date_dim": ["d_date_sk", "d_date"], "item": ["i_item_id", "i_item_sk"], "warehouse": ["w_state", "w_warehouse_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_id"], "warehouse": ["w_state"]}}
{"id": 41, "query_string": " select distinct top (100) i_product_name  from item i1  where i_manufact_id between 701 and 701+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'floral' or i_color = 'powder') and          (i_units = 'Bundle' or i_units = 'Box') and         (i_size = 'large' or i_size = 'medium')         ) or         (i_category = 'Women' and         (i_color = 'saddle' or i_color = 'maroon') and         (i_units = 'N/A' or i_units = 'Tsp') and         (i_size = 'economy' or i_size = 'petite')         ) or         (i_category = 'Men' and         (i_color = 'frosted' or i_color = 'peach') and         (i_units = 'Pound' or i_units = 'Oz') and         (i_size = 'extra large' or i_size = 'small')         ) or         (i_category = 'Men' and         (i_color = 'smoke' or i_color = 'gainsboro') and         (i_units = 'Lb' or i_units = 'Ton') and         (i_size = 'large' or i_size = 'medium')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'midnight' or i_color = 'violet') and          (i_units = 'Cup' or i_units = 'Gross') and         (i_size = 'large' or i_size = 'medium')         ) or         (i_category = 'Women' and         (i_color = 'ghost' or i_color = 'coral') and         (i_units = 'Gram' or i_units = 'Pallet') and         (i_size = 'economy' or i_size = 'petite')         ) or         (i_category = 'Men' and         (i_color = 'orange' or i_color = 'lime') and         (i_units = 'Dram' or i_units = 'Unknown') and         (i_size = 'extra large' or i_size = 'small')         ) or         (i_category = 'Men' and         (i_color = 'plum' or i_color = 'blanched') and         (i_units = 'Carton' or i_units = 'Ounce') and         (i_size = 'large' or i_size = 'medium')         )))) > 0  order by i_product_name  ;", "predicates": {"item": ["i_color", "i_units", "i_manufact_id", "i_category", "i_size", "i_manufact"]}, "payload": {"item": ["i_color", "i_units", "i_product_name", "i_category", "i_size", "i_manufact"]}, "group_by": {}, "order_by": {}}
{"id": 42, "query_string": " select top (100) dt.d_year  \t,item.i_category_id  \t,item.i_category  \t,sum(ss_ext_sales_price)  from \tdate_dim dt  \t,store_sales  \t,item  where dt.d_date_sk = store_sales.ss_sold_date_sk  \tand store_sales.ss_item_sk = item.i_item_sk  \tand item.i_manager_id = 1  \t  \tand dt.d_moy=11  \tand dt.d_year=1998  group by \tdt.d_year  \t\t,item.i_category_id  \t\t,item.i_category  order by       sum(ss_ext_sales_price) desc,dt.d_year  \t\t,item.i_category_id  \t\t,item.i_category  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_item_sk", "i_category", "i_category_id"]}, "group_by": {}, "order_by": {"item": ["i_category", "i_category_id"]}}
{"id": 43, "query_string": " select top (100) s_store_name, s_store_id,         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales  from date_dim, store_sales, store  where d_date_sk = ss_sold_date_sk and        s_store_sk = ss_store_sk and        s_gmt_offset = -5 and        d_year = 1998   group by s_store_name, s_store_id  order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales  ;", "predicates": {"date_dim": ["d_year"], "store": ["s_gmt_offset"]}, "payload": {"date_dim": ["d_date_sk", "d_day_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 44, "query_string": " select top (100) asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing from(select *      from (select item_sk,rank() over (order by rank_col asc) rnk            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col                   from store_sales ss1                  where ss_store_sk = 3                  group by ss_item_sk                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col                                                   from store_sales                                                   where ss_store_sk = 3                                                     and ss_addr_sk is null                                                   group by ss_store_sk))V1)V11      where rnk  < 11) asceding,     (select *      from (select item_sk,rank() over (order by rank_col desc) rnk            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col                  from store_sales ss1                  where ss_store_sk = 3                  group by ss_item_sk                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col                                                   from store_sales                                                   where ss_store_sk = 3                                                     and ss_addr_sk is null                                                   group by ss_store_sk))V2)V21      where rnk  < 11) descending, item i1, item i2 where asceding.rnk = descending.rnk    and i1.i_item_sk=asceding.item_sk   and i2.i_item_sk=descending.item_sk order by asceding.rnk;", "predicates": {"store_sales": ["ss_store_sk", "ss_customer_sk"]}, "payload": {"store_sales": ["ss_net_profit", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 45, "query_string": " select top (100) ca_zip, ca_state, sum(ws_sales_price)  from web_sales, customer, customer_address, date_dim, item  where ws_bill_customer_sk = c_customer_sk  \tand c_current_addr_sk = ca_address_sk   \tand ws_item_sk = i_item_sk   \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')  \t      or   \t      i_item_id in (select i_item_id                              from item                              where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)                              )  \t    )  \tand ws_sold_date_sk = d_date_sk  \tand d_qoy = 2 and d_year = 1998  group by ca_zip, ca_state  order by ca_zip, ca_state  ;", "predicates": {"customer_address": ["ca_zip"], "date_dim": ["d_qoy", "d_year"], "item": ["i_item_id"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip", "ca_city"], "date_dim": ["d_date_sk"], "web_sales": ["ws_sales_price", "ws_sold_date_sk", "ws_bill_customer_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 46, "query_string": " select top (100) c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,ca_city bought_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics,customer_address      where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and (household_demographics.hd_dep_count = 6 or          household_demographics.hd_vehicle_count= 2)     and date_dim.d_dow in (6,0)     and date_dim.d_year in (2000,2000+1,2000+2)      and store.s_city in ('Fairview','Midway','Midway','Fairview','Fairview')      group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr     where ss_customer_sk = c_customer_sk       and customer.c_current_addr_sk = current_addr.ca_address_sk       and current_addr.ca_city <> bought_city   order by c_last_name           ,c_first_name           ,ca_city           ,bought_city           ,ss_ticket_number   ;", "predicates": {"date_dim": ["d_dow", "d_year"], "household_demographics": ["hd_vehicle_count", "hd_dep_count"], "store": ["s_city"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk", "c_first_name", "c_last_name"], "customer_address": ["ca_city", "ca_address_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_addr_sk", "ss_coupon_amt", "ss_customer_sk", "ss_hdemo_sk", "ss_net_profit", "ss_sold_date_sk", "ss_store_sk", "ss_ticket_number"]}, "group_by": {}, "order_by": {}}
{"id": 47, "query_string": " with v1 as(  select i_category, i_brand,         s_store_name, s_company_name,         d_year, d_moy,         sum(ss_sales_price) sum_sales,         avg(sum(ss_sales_price)) over           (partition by i_category, i_brand,                      s_store_name, s_company_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      s_store_name, s_company_name            order by d_year, d_moy) rn  from item, store_sales, date_dim, store  where ss_item_sk = i_item_sk and        ss_sold_date_sk = d_date_sk and        ss_store_sk = s_store_sk and        (          d_year = 1999 or          ( d_year = 1999-1 and d_moy =12) or          ( d_year = 1999+1 and d_moy =1)        )  group by i_category, i_brand,           s_store_name, s_company_name,           d_year, d_moy),  v2 as(  select v1.i_brand         ,v1.d_year         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1.s_store_name = v1_lag.s_store_name and        v1.s_store_name = v1_lead.s_store_name and        v1.s_company_name = v1_lag.s_company_name and        v1.s_company_name = v1_lead.s_company_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select top (100) *  from v2  where  d_year = 1999 and             avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, nsum  ;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk", "d_moy", "d_year"], "item": ["i_brand", "i_item_sk", "i_category"], "store": ["s_store_name", "s_store_sk", "s_company_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 48, "query_string": " select sum (ss_quantity)  from store_sales, store, customer_demographics, customer_address, date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2000  and    (   (    cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'W'    and     cd_education_status = 'Primary'    and     ss_sales_price between 100.00 and 150.00      )  or   (   cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'D'    and     cd_education_status = '2 yr Degree'    and     ss_sales_price between 50.00 and 100.00      )  or   (   cd_demo_sk = ss_cdemo_sk   and     cd_marital_status = 'U'    and     cd_education_status = 'Advanced Degree'    and     ss_sales_price between 150.00 and 200.00    )  )  and  (   (   ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('TX', 'VA', 'TN')   and ss_net_profit between 0 and 2000     )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('WI', 'CO', 'MO')   and ss_net_profit between 150 and 3000    )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('GA', 'KS', 'PA')   and ss_net_profit between 50 and 25000    )  );", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "store_sales": ["ss_sales_price", "ss_net_profit"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_cdemo_sk", "ss_addr_sk", "ss_quantity", "ss_sales_price", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 49, "query_string": " select top (100) channel, item, return_ratio, return_rank, currency_rank from  (select  'web' as channel  ,web.item  ,web.return_ratio  ,web.return_rank  ,web.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect ws.ws_item_sk as item  \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\t web_sales ws left outer join web_returns wr   \t\t\ton (ws.ws_order_number = wr.wr_order_number and   \t\t\tws.ws_item_sk = wr.wr_item_sk)                  ,date_dim  \t\twhere   \t\t\twr.wr_return_amt > 10000   \t\t\tand ws.ws_net_profit > 1                          and ws.ws_net_paid > 0                          and ws.ws_quantity > 0                          and ws_sold_date_sk = d_date_sk                          and d_year = 2001                          and d_moy = 11  \t\tgroup by ws.ws_item_sk  \t) in_web  ) web  where   (  web.return_rank <= 10  or  web.currency_rank <= 10  )  union  select   'catalog' as channel  ,catalog.item  ,catalog.return_ratio  ,catalog.return_rank  ,catalog.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect   \t\tcs.cs_item_sk as item  \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\tcatalog_sales cs left outer join catalog_returns cr  \t\t\ton (cs.cs_order_number = cr.cr_order_number and   \t\t\tcs.cs_item_sk = cr.cr_item_sk)                 ,date_dim  \t\twhere   \t\t\tcr.cr_return_amount > 10000   \t\t\tand cs.cs_net_profit > 1                          and cs.cs_net_paid > 0                          and cs.cs_quantity > 0                          and cs_sold_date_sk = d_date_sk                          and d_year = 2001                          and d_moy = 11                  group by cs.cs_item_sk  \t) in_cat  ) catalog  where   (  catalog.return_rank <= 10  or  catalog.currency_rank <=10  )  union  select   'store' as channel  ,store.item  ,store.return_ratio  ,store.return_rank  ,store.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect sts.ss_item_sk as item  \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\tstore_sales sts left outer join store_returns sr  \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)                 ,date_dim  \t\twhere   \t\t\tsr.sr_return_amt > 10000   \t\t\tand sts.ss_net_profit > 1                          and sts.ss_net_paid > 0                           and sts.ss_quantity > 0                          and ss_sold_date_sk = d_date_sk                          and d_year = 2001                          and d_moy = 11  \t\tgroup by sts.ss_item_sk  \t) in_store  ) store  where  (  store.return_rank <= 10  or   store.currency_rank <= 10  )  ) a  order by 1,4,5,2  ;", "predicates": {"catalog_returns": ["cr_return_amount"], "catalog_sales": ["cs_net_paid", "cs_net_profit", "cs_quantity"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_return_amt"], "store_sales": ["ss_net_paid", "ss_quantity", "ss_net_profit"], "web_returns": ["wr_return_amt"], "web_sales": ["ws_net_profit", "ws_net_paid", "ws_quantity"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_quantity", "cr_return_amount"], "store_returns": ["sr_return_amt", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_return_amt", "wr_return_quantity", "wr_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 50, "query_string": " select top (100)     s_store_name   ,s_company_id   ,s_street_number   ,s_street_name   ,s_street_type   ,s_suite_number   ,s_city   ,s_county   ,s_state   ,s_zip   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and                   (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and                   (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and                  (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    store_sales   ,store_returns   ,store   ,date_dim d1   ,date_dim d2 where     d2.d_year = 2001 and d2.d_moy  = 10 and ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_sold_date_sk   = d1.d_date_sk and sr_returned_date_sk   = d2.d_date_sk and ss_customer_sk = sr_customer_sk and ss_store_sk = s_store_sk group by    s_store_name   ,s_company_id   ,s_street_number   ,s_street_name   ,s_street_type   ,s_suite_number   ,s_city   ,s_county   ,s_state   ,s_zip order by s_store_name         ,s_company_id         ,s_street_number         ,s_street_name         ,s_street_type         ,s_suite_number         ,s_city         ,s_county         ,s_state         ,s_zip;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 51, "query_string": " WITH web_v1 as ( select   ws_item_sk item_sk, d_date,   sum(sum(ws_sales_price))       over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from web_sales     ,date_dim where ws_sold_date_sk=d_date_sk   and d_month_seq between 1222 and 1222+11   and ws_item_sk is not NULL group by ws_item_sk, d_date), store_v1 as ( select   ss_item_sk item_sk, d_date,   sum(sum(ss_sales_price))       over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from store_sales     ,date_dim where ss_sold_date_sk=d_date_sk   and d_month_seq between 1222 and 1222+11   and ss_item_sk is not NULL group by ss_item_sk, d_date)  select top (100) * from (select item_sk      ,d_date      ,web_sales      ,store_sales      ,max(web_sales)          over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative      ,max(store_sales)          over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative      from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk                  ,case when web.d_date is not null then web.d_date else store.d_date end d_date                  ,web.cume_sales web_sales                  ,store.cume_sales store_sales            from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk                                                           and web.d_date = store.d_date)           )x )y where web_cumulative > store_cumulative order by item_sk         ,d_date;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_sales_price", "ss_item_sk"], "web_sales": ["ws_sold_date_sk", "ws_sales_price", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 52, "query_string": " select top (100) dt.d_year  \t,item.i_brand_id brand_id  \t,item.i_brand brand  \t,sum(ss_ext_sales_price) ext_price  from date_dim dt      ,store_sales      ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=11     and dt.d_year=1998  group by dt.d_year  \t,item.i_brand  \t,item.i_brand_id  order by dt.d_year  \t,ext_price desc  \t,brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"item": ["i_brand_id"]}}
{"id": 53, "query_string": " select top (100) * from  (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1222,1222+1,1222+2,1222+3,1222+4,1222+5,1222+6,1222+7,1222+8,1222+9,1222+10,1222+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', \t\t'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', \t\t'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0  \tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales  \telse null end > 0.1 order by avg_quarterly_sales, \t sum_sales, \t i_manufact_id;", "predicates": {"date_dim": ["d_month_seq"], "item": ["i_brand", "i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_qoy"], "item": ["i_item_sk", "i_manufact_id", "i_brand", "i_category", "i_class"], "store": ["s_store_sk"]}, "group_by": {}, "order_by": {}}
{"id": 54, "query_string": " with my_customers as (  select distinct c_customer_sk         , c_current_addr_sk  from            ( select cs_sold_date_sk sold_date_sk,                  cs_bill_customer_sk customer_sk,                  cs_item_sk item_sk           from   catalog_sales           union all           select ws_sold_date_sk sold_date_sk,                  ws_bill_customer_sk customer_sk,                  ws_item_sk item_sk           from   web_sales          ) cs_or_ws_sales,          item,          date_dim,          customer  where   sold_date_sk = d_date_sk          and item_sk = i_item_sk          and i_category = 'Jewelry'          and i_class = 'gold'          and c_customer_sk = cs_or_ws_sales.customer_sk          and d_moy = 2          and d_year = 2000  )  , my_revenue as (  select c_customer_sk,         sum(ss_ext_sales_price) as revenue  from   my_customers,         store_sales,         customer_address,         store,         date_dim  where  c_current_addr_sk = ca_address_sk         and ca_county = s_county         and ca_state = s_state         and ss_sold_date_sk = d_date_sk         and c_customer_sk = ss_customer_sk         and d_month_seq between (select distinct d_month_seq+1                                  from   date_dim where d_year = 2000 and d_moy = 2)                            and  (select distinct d_month_seq+3                                  from   date_dim where d_year = 2000 and d_moy = 2)  group by c_customer_sk  )  , segments as  (select cast((revenue/50) as int) as segment   from   my_revenue  )   select top (100) segment, count(*) as num_customers, segment*50 as segment_base  from segments  group by segment  order by segment, num_customers  ;", "predicates": {"date_dim": ["d_month_seq", "d_moy", "d_year"], "item": ["i_class", "i_category"]}, "payload": {"customer_address": ["ca_address_sk", "ca_county", "ca_state"], "date_dim": ["d_date_sk", "d_month_seq"], "item": ["i_item_sk"], "store": ["s_state", "s_county"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_ext_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 55, "query_string": " select top (100) i_brand_id brand_id, i_brand brand,  \tsum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item  where d_date_sk = ss_sold_date_sk  \tand ss_item_sk = i_item_sk  \tand i_manager_id=82  \tand d_moy=12  \tand d_year=2002  group by i_brand, i_brand_id  order by ext_price desc, i_brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"item": ["i_brand_id"]}}
{"id": 56, "query_string": " with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('linen','frosted','azure'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 5  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('linen','frosted','azure'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 5  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('linen','frosted','azure'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 5  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_item_id)   select top (100) i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  ;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_color"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 57, "query_string": " with v1 as(  select i_category, i_brand,         cc_name,         d_year, d_moy,         sum(cs_sales_price) sum_sales,         avg(sum(cs_sales_price)) over           (partition by i_category, i_brand,                      cc_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      cc_name            order by d_year, d_moy) rn  from item, catalog_sales, date_dim, call_center  where cs_item_sk = i_item_sk and        cs_sold_date_sk = d_date_sk and        cc_call_center_sk= cs_call_center_sk and        (          d_year = 1999 or          ( d_year = 1999-1 and d_moy =12) or          ( d_year = 1999+1 and d_moy =1)        )  group by i_category, i_brand,           cc_name , d_year, d_moy),  v2 as(  select v1.i_category, v1.i_brand         ,v1.d_year         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1. cc_name = v1_lag. cc_name and        v1. cc_name = v1_lead. cc_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select top (100) *  from v2  where  d_year = 1999 and         avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, nsum  ;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"call_center": ["cc_name", "cc_call_center_sk"], "catalog_sales": ["cs_sales_price", "cs_sold_date_sk", "cs_call_center_sk", "cs_item_sk"], "date_dim": ["d_date_sk", "d_moy", "d_year"], "item": ["i_brand", "i_item_sk", "i_category"]}, "group_by": {}, "order_by": {}}
{"id": 58, "query_string": " with ss_items as  (select i_item_id item_id         ,sum(ss_ext_sales_price) ss_item_rev   from store_sales      ,item      ,date_dim  where ss_item_sk = i_item_sk    and d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '1998-04-03'))    and ss_sold_date_sk   = d_date_sk  group by i_item_id),  cs_items as  (select i_item_id item_id         ,sum(cs_ext_sales_price) cs_item_rev   from catalog_sales       ,item       ,date_dim  where cs_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '1998-04-03'))   and  cs_sold_date_sk = d_date_sk  group by i_item_id),  ws_items as  (select i_item_id item_id         ,sum(ws_ext_sales_price) ws_item_rev   from web_sales       ,item       ,date_dim  where ws_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq =(select d_week_seq                                       from date_dim                                      where d_date = '1998-04-03'))   and ws_sold_date_sk   = d_date_sk  group by i_item_id)   select top (100) ss_items.item_id        ,ss_item_rev        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev        ,cs_item_rev        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev        ,ws_item_rev        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average  from ss_items,cs_items,ws_items  where ss_items.item_id=cs_items.item_id    and ss_items.item_id=ws_items.item_id     and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  order by item_id          ,ss_item_rev  ;", "predicates": {"date_dim": ["d_week_seq", "d_date"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_item_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "item": ["i_item_id", "i_item_sk"], "store_sales": ["ss_sold_date_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 59, "query_string": " with wss as   (select d_week_seq,         ss_store_sk,         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales  from store_sales,date_dim  where d_date_sk = ss_sold_date_sk  group by d_week_seq,ss_store_sk  )   select top (100) s_store_name1,s_store_id1,d_week_seq1        ,sun_sales1/sun_sales2,mon_sales1/mon_sales2        ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2        ,fri_sales1/fri_sales2,sat_sales1/sat_sales2  from  (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1         ,s_store_id s_store_id1,sun_sales sun_sales1         ,mon_sales mon_sales1,tue_sales tue_sales1         ,wed_sales wed_sales1,thu_sales thu_sales1         ,fri_sales fri_sales1,sat_sales sat_sales1   from wss,store,date_dim d   where d.d_week_seq = wss.d_week_seq and         ss_store_sk = s_store_sk and          d_month_seq between 1191 and 1191 + 11) y,  (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2         ,s_store_id s_store_id2,sun_sales sun_sales2         ,mon_sales mon_sales2,tue_sales tue_sales2         ,wed_sales wed_sales2,thu_sales thu_sales2         ,fri_sales fri_sales2,sat_sales sat_sales2   from wss,store,date_dim d   where d.d_week_seq = wss.d_week_seq and         ss_store_sk = s_store_sk and          d_month_seq between 1191+ 12 and 1191 + 23) x  where s_store_id1=s_store_id2    and d_week_seq1=d_week_seq2-52  order by s_store_name1,s_store_id1,d_week_seq1;", "predicates": {"date_dim": ["d_month_seq"], "store": ["s_store_id"]}, "payload": {"date_dim": ["d_date_sk", "d_week_seq", "d_day_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 60, "query_string": " with ss as (  select           i_item_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where          i_item_id in (select   i_item_id from  item where i_category in ('Children'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 10  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  cs as (  select           i_item_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Children'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 10  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  ws as (  select           i_item_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Children'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 10  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_item_id)   select top (100)     i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by i_item_id       ,total_sales  ;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_item_id", "i_category"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 61, "query_string": " select top (100) promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from   (select sum(ss_ext_sales_price) promotions    from  store_sales         ,store         ,promotion         ,date_dim         ,customer         ,customer_address          ,item    where ss_sold_date_sk = d_date_sk    and   ss_store_sk = s_store_sk    and   ss_promo_sk = p_promo_sk    and   ss_customer_sk= c_customer_sk    and   ca_address_sk = c_current_addr_sk    and   ss_item_sk = i_item_sk     and   ca_gmt_offset = -6    and   i_category = 'Books'    and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')    and   s_gmt_offset = -6    and   d_year = 2000    and   d_moy  = 12) promotional_sales,   (select sum(ss_ext_sales_price) total    from  store_sales         ,store         ,date_dim         ,customer         ,customer_address         ,item    where ss_sold_date_sk = d_date_sk    and   ss_store_sk = s_store_sk    and   ss_customer_sk= c_customer_sk    and   ca_address_sk = c_current_addr_sk    and   ss_item_sk = i_item_sk    and   ca_gmt_offset = -6    and   i_category = 'Books'    and   s_gmt_offset = -6    and   d_year = 2000    and   d_moy  = 12) all_sales order by promotions, total;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_category"], "promotion": ["p_channel_dmail", "p_channel_email", "p_channel_tv"], "store": ["s_gmt_offset"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_promo_sk", "ss_item_sk", "ss_ext_sales_price", "ss_customer_sk", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 62, "query_string": " select top (100)     substring(w_warehouse_name,1,20)   ,sm_type   ,web_name   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and                   (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and                   (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and                  (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    web_sales   ,warehouse   ,ship_mode   ,web_site   ,date_dim where     d_month_seq between 1222 and 1222 + 11 and ws_ship_date_sk   = d_date_sk and ws_warehouse_sk   = w_warehouse_sk and ws_ship_mode_sk   = sm_ship_mode_sk and ws_web_site_sk    = web_site_sk group by    substring(w_warehouse_name,1,20)   ,sm_type   ,web_name order by substring(w_warehouse_name,1,20)         ,sm_type        ,web_name;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "ship_mode": ["sm_type", "sm_ship_mode_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"], "web_sales": ["ws_ship_date_sk", "ws_ship_mode_sk", "ws_sold_date_sk", "ws_warehouse_sk", "ws_web_site_sk"], "web_site": ["web_name", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 63, "query_string": " select top (100) *  from (select i_manager_id              ,sum(ss_sales_price) sum_sales              ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales       from item           ,store_sales           ,date_dim           ,store       where ss_item_sk = i_item_sk         and ss_sold_date_sk = d_date_sk         and ss_store_sk = s_store_sk         and d_month_seq in (1222,1222+1,1222+2,1222+3,1222+4,1222+5,1222+6,1222+7,1222+8,1222+9,1222+10,1222+11)         and ((    i_category in ('Books','Children','Electronics')               and i_class in ('personal','portable','reference','self-help')               and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', \t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))            or(    i_category in ('Women','Music','Men')               and i_class in ('accessories','classical','fragrances','pants')               and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', \t\t                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id         ,avg_monthly_sales         ,sum_sales;", "predicates": {"date_dim": ["d_month_seq"], "item": ["i_brand", "i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_item_sk", "i_manager_id", "i_brand", "i_category", "i_class"], "store": ["s_store_sk"]}, "group_by": {}, "order_by": {"item": ["i_manager_id"]}}
{"id": 64, "query_string": " with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('pale','sky','purple','indian','burnished','sienna') and          i_current_price between 55 and 55 + 10 and          i_current_price between 55 + 1 and 55 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;", "predicates": {"customer_demographics": ["cd_marital_status"], "date_dim": ["d_year"], "item": ["i_color", "i_current_price"], "store": ["s_zip", "s_store_name"]}, "payload": {"household_demographics": ["hd_income_band_sk", "hd_demo_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 65, "query_string": " select top (100) \ts_store_name, \ti_item_desc, \tsc.revenue, \ti_current_price, \ti_wholesale_cost, \ti_brand  from store, item,      (select ss_store_sk, avg(revenue) as ave  \tfrom  \t    (select  ss_store_sk, ss_item_sk,   \t\t     sum(ss_sales_price) as revenue  \t\tfrom store_sales, date_dim  \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1222 and 1222+11  \t\tgroup by ss_store_sk, ss_item_sk) sa  \tgroup by ss_store_sk) sb,      (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue  \tfrom store_sales, date_dim  \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1222 and 1222+11  \tgroup by ss_store_sk, ss_item_sk) sc  where sb.ss_store_sk = sc.ss_store_sk and         sc.revenue <= 0.1 * sb.ave and        s_store_sk = sc.ss_store_sk and        i_item_sk = sc.ss_item_sk  order by s_store_name, i_item_desc;", "predicates": {"date_dim": ["d_month_seq"], "store_sales": ["ss_store_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_brand", "i_wholesale_cost", "i_item_desc"], "store": ["s_store_name", "s_store_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price", "ss_item_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_desc"], "store": ["s_store_name"]}}
{"id": 66, "query_string": " select top (100)            w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country         ,ship_carriers         ,year  \t,sum(jan_sales) as jan_sales  \t,sum(feb_sales) as feb_sales  \t,sum(mar_sales) as mar_sales  \t,sum(apr_sales) as apr_sales  \t,sum(may_sales) as may_sales  \t,sum(jun_sales) as jun_sales  \t,sum(jul_sales) as jul_sales  \t,sum(aug_sales) as aug_sales  \t,sum(sep_sales) as sep_sales  \t,sum(oct_sales) as oct_sales  \t,sum(nov_sales) as nov_sales  \t,sum(dec_sales) as dec_sales  \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot  \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot  \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot  \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot  \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot  \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot  \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot  \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot  \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot  \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot  \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot  \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot  \t,sum(jan_net) as jan_net  \t,sum(feb_net) as feb_net  \t,sum(mar_net) as mar_net  \t,sum(apr_net) as apr_net  \t,sum(may_net) as may_net  \t,sum(jun_net) as jun_net  \t,sum(jul_net) as jul_net  \t,sum(aug_net) as aug_net  \t,sum(sep_net) as sep_net  \t,sum(oct_net) as oct_net  \t,sum(nov_net) as nov_net  \t,sum(dec_net) as dec_net  from (      select   \tw_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,concat('TBS' , ',' , 'MSC') as ship_carriers        ,d_year as year  \t,sum(case when d_moy = 1   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jan_sales  \t,sum(case when d_moy = 2   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as feb_sales  \t,sum(case when d_moy = 3   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as mar_sales  \t,sum(case when d_moy = 4   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as apr_sales  \t,sum(case when d_moy = 5   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as may_sales  \t,sum(case when d_moy = 6   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jun_sales  \t,sum(case when d_moy = 7   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jul_sales  \t,sum(case when d_moy = 8   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as aug_sales  \t,sum(case when d_moy = 9   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as sep_sales  \t,sum(case when d_moy = 10   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as oct_sales  \t,sum(case when d_moy = 11  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as nov_sales  \t,sum(case when d_moy = 12  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as dec_sales  \t,sum(case when d_moy = 1   \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as jan_net  \t,sum(case when d_moy = 2  \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as feb_net  \t,sum(case when d_moy = 3   \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as mar_net  \t,sum(case when d_moy = 4   \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as apr_net  \t,sum(case when d_moy = 5   \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as may_net  \t,sum(case when d_moy = 6   \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as jun_net  \t,sum(case when d_moy = 7   \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as jul_net  \t,sum(case when d_moy = 8   \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as aug_net  \t,sum(case when d_moy = 9   \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as sep_net  \t,sum(case when d_moy = 10   \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as oct_net  \t,sum(case when d_moy = 11  \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as nov_net  \t,sum(case when d_moy = 12  \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as dec_net      from           web_sales          ,warehouse          ,date_dim          ,time_dim  \t  ,ship_mode      where             ws_warehouse_sk =  w_warehouse_sk         and ws_sold_date_sk = d_date_sk         and ws_sold_time_sk = t_time_sk  \tand ws_ship_mode_sk = sm_ship_mode_sk         and d_year = 2001  \tand t_time between 6927 and 6927+28800   \tand sm_carrier in ('TBS','MSC')      group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country        ,d_year  union all      select   \tw_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,concat('TBS', ',', 'MSC') as ship_carriers        ,d_year as year  \t,sum(case when d_moy = 1   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jan_sales  \t,sum(case when d_moy = 2   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as feb_sales  \t,sum(case when d_moy = 3   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as mar_sales  \t,sum(case when d_moy = 4   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as apr_sales  \t,sum(case when d_moy = 5   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as may_sales  \t,sum(case when d_moy = 6   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jun_sales  \t,sum(case when d_moy = 7   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jul_sales  \t,sum(case when d_moy = 8   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as aug_sales  \t,sum(case when d_moy = 9   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as sep_sales  \t,sum(case when d_moy = 10   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as oct_sales  \t,sum(case when d_moy = 11  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as nov_sales  \t,sum(case when d_moy = 12  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as dec_sales  \t,sum(case when d_moy = 1   \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jan_net  \t,sum(case when d_moy = 2   \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as feb_net  \t,sum(case when d_moy = 3   \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as mar_net  \t,sum(case when d_moy = 4   \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as apr_net  \t,sum(case when d_moy = 5   \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as may_net  \t,sum(case when d_moy = 6   \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jun_net  \t,sum(case when d_moy = 7   \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jul_net  \t,sum(case when d_moy = 8   \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as aug_net  \t,sum(case when d_moy = 9   \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as sep_net  \t,sum(case when d_moy = 10   \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as oct_net  \t,sum(case when d_moy = 11  \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as nov_net  \t,sum(case when d_moy = 12  \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as dec_net      from           catalog_sales          ,warehouse          ,date_dim          ,time_dim  \t ,ship_mode      where             cs_warehouse_sk =  w_warehouse_sk         and cs_sold_date_sk = d_date_sk         and cs_sold_time_sk = t_time_sk  \tand cs_ship_mode_sk = sm_ship_mode_sk         and d_year = 2001  \tand t_time between 6927 AND 6927+28800   \tand sm_carrier in ('TBS','MSC')      group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country        ,d_year  ) x  group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,ship_carriers        ,year  order by w_warehouse_name  ;", "predicates": {"date_dim": ["d_year"], "ship_mode": ["sm_carrier"], "time_dim": ["t_time"]}, "payload": {"catalog_sales": ["cs_warehouse_sk", "cs_ext_list_price", "cs_quantity", "cs_net_paid_inc_tax", "cs_ship_mode_sk", "cs_sold_date_sk", "cs_sold_time_sk"], "date_dim": ["d_date_sk", "d_moy", "d_year"], "ship_mode": ["sm_ship_mode_sk"], "time_dim": ["t_time_sk"], "web_sales": ["ws_ship_mode_sk", "ws_ext_list_price", "ws_sold_date_sk", "ws_quantity", "ws_sold_time_sk", "ws_warehouse_sk", "ws_net_paid"]}, "group_by": {}, "order_by": {}}
{"id": 67, "query_string": " select top (100) * from (select i_category             ,i_class             ,i_brand             ,i_product_name             ,d_year             ,d_qoy             ,d_moy             ,s_store_id             ,sumsales             ,rank() over (partition by i_category order by sumsales desc) rk       from (select i_category                   ,i_class                   ,i_brand                   ,i_product_name                   ,d_year                   ,d_qoy                   ,d_moy                   ,s_store_id                   ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales             from store_sales                 ,date_dim                 ,store                 ,item        where  ss_sold_date_sk=d_date_sk           and ss_item_sk=i_item_sk           and ss_store_sk = s_store_sk           and d_month_seq between 1222 and 1222+11        group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 order by i_category         ,i_class         ,i_brand         ,i_product_name         ,d_year         ,d_qoy         ,d_moy         ,s_store_id         ,sumsales         ,rk;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk", "d_moy", "d_qoy", "d_year"], "item": ["i_item_sk", "i_brand", "i_product_name", "i_category", "i_class"], "store": ["s_store_sk", "s_store_id"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_sales_price", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {"date_dim": ["d_moy", "d_qoy", "d_year"], "item": ["i_brand", "i_class", "i_product_name", "i_category"], "store": ["s_store_id"]}}
{"id": 68, "query_string": " select top (100) c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,extended_price        ,extended_tax        ,list_price  from (select ss_ticket_number              ,ss_customer_sk              ,ca_city bought_city              ,sum(ss_ext_sales_price) extended_price               ,sum(ss_ext_list_price) list_price              ,sum(ss_ext_tax) extended_tax         from store_sales            ,date_dim            ,store            ,household_demographics            ,customer_address         where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_store_sk = store.s_store_sk           and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk         and store_sales.ss_addr_sk = customer_address.ca_address_sk         and date_dim.d_dom between 1 and 2          and (household_demographics.hd_dep_count = 9 or              household_demographics.hd_vehicle_count= -1)         and date_dim.d_year in (1999,1999+1,1999+2)         and store.s_city in ('Fairview','Midway')        group by ss_ticket_number                ,ss_customer_sk                ,ss_addr_sk,ca_city) dn       ,customer       ,customer_address current_addr  where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name          ,ss_ticket_number  ;", "predicates": {"customer_address": ["ca_city"], "date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_city"]}, "payload": {"customer": ["c_current_addr_sk", "c_first_name", "c_last_name", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_city"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_ext_sales_price", "ss_addr_sk", "ss_customer_sk", "ss_ticket_number", "ss_ext_list_price", "ss_ext_tax", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 69, "query_string": " select top (100)    cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_state in ('TX','NC','OK') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2001 and                 d_moy between 3 and 3+2) and    (not exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 3 and 3+2) and     not exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 3 and 3+2))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  ;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 70, "query_string": " select top (100)      sum(ss_net_profit) as total_sum    ,s_state    ,s_county    ,grouping(s_state)+grouping(s_county) as lochierarchy    ,rank() over (  \tpartition by grouping(s_state)+grouping(s_county),  \tcase when grouping(s_county) = 0 then s_state end   \torder by sum(ss_net_profit) desc) as rank_within_parent  from     store_sales    ,date_dim       d1    ,store  where     d1.d_month_seq between 1222 and 1222+11  and d1.d_date_sk = ss_sold_date_sk  and s_store_sk  = ss_store_sk  and s_state in              ( select s_state                from  (select s_state as s_state,  \t\t\t    rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking                       from   store_sales, store, date_dim                       where  d_month_seq between 1222 and 1222+11  \t\t\t    and d_date_sk = ss_sold_date_sk  \t\t\t    and s_store_sk  = ss_store_sk                       group by s_state                      ) tmp1                 where ranking <= 5              )  group by rollup(s_state,s_county)  order by    lochierarchy desc   ,case when (grouping(s_state)+grouping(s_county)) = 0 then s_state end   ,rank_within_parent  ;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 71, "query_string": " select i_brand_id brand_id, i_brand brand,t_hour,t_minute,  \tsum(ext_price) ext_price  from item, (select ws_ext_sales_price as ext_price,                          ws_sold_date_sk as sold_date_sk,                         ws_item_sk as sold_item_sk,                         ws_sold_time_sk as time_sk                    from web_sales,date_dim                  where d_date_sk = ws_sold_date_sk                    and d_moy=11                    and d_year=2001                  union all                  select cs_ext_sales_price as ext_price,                         cs_sold_date_sk as sold_date_sk,                         cs_item_sk as sold_item_sk,                         cs_sold_time_sk as time_sk                  from catalog_sales,date_dim                  where d_date_sk = cs_sold_date_sk                    and d_moy=11                    and d_year=2001                  union all                  select ss_ext_sales_price as ext_price,                         ss_sold_date_sk as sold_date_sk,                         ss_item_sk as sold_item_sk,                         ss_sold_time_sk as time_sk                  from store_sales,date_dim                  where d_date_sk = ss_sold_date_sk                    and d_moy=11                    and d_year=2001                  ) tmp,time_dim  where    sold_item_sk = i_item_sk    and i_manager_id=1    and time_sk = t_time_sk    and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')  group by i_brand, i_brand_id,t_hour,t_minute  order by ext_price desc, i_brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"], "time_dim": ["t_meal_time"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_brand", "i_item_sk", "i_brand_id"], "time_dim": ["t_hour", "t_minute", "t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 72, "query_string": " select top (100) i_item_desc       ,w_warehouse_name       ,d1.d_week_seq       ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo       ,sum(case when p_promo_sk is not null then 1 else 0 end) promo       ,count(*) total_cnt from catalog_sales join inventory on (cs_item_sk = inv_item_sk) join warehouse on (w_warehouse_sk=inv_warehouse_sk) join item on (i_item_sk = cs_item_sk) join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk) join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk) join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk) join date_dim d2 on (inv_date_sk = d2.d_date_sk) join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk) left outer join promotion on (cs_promo_sk=p_promo_sk) left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number) where d1.d_week_seq = d2.d_week_seq   and inv_quantity_on_hand < cs_quantity    and d3.d_date > dateadd(day, 5, d1.d_date)   and hd_buy_potential = '501-1000'   and d1.d_year = 2002   and cd_marital_status = 'S' group by i_item_desc,w_warehouse_name,d1.d_week_seq order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq;", "predicates": {"customer_demographics": ["cd_marital_status"], "date_dim": ["d_date", "d_year"], "household_demographics": ["hd_buy_potential"], "inventory": ["inv_warehouse_sk"], "warehouse": ["w_warehouse_sk"]}, "payload": {"catalog_sales": ["cs_quantity", "cs_promo_sk", "cs_item_sk", "cs_ship_date_sk", "cs_bill_cdemo_sk", "cs_sold_date_sk", "cs_bill_hdemo_sk"], "customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "household_demographics": ["hd_demo_sk"], "item": ["i_item_sk", "i_item_desc"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {"date_dim": ["d_week_seq"], "item": ["i_item_desc"], "warehouse": ["w_warehouse_name"]}}
{"id": 73, "query_string": " select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '1001-5000' or          household_demographics.hd_buy_potential = '5001-10000')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;", "predicates": {"date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count", "hd_buy_potential"], "store": ["s_county"]}, "payload": {"customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_preferred_cust_flag"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 74, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,d_year as year        ,max(ss_net_paid) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk    and d_year in (1999,1999+1)  group by c_customer_id          ,c_first_name          ,c_last_name          ,d_year  union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,d_year as year        ,max(ws_net_paid) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk    and d_year in (1999,1999+1)  group by c_customer_id          ,c_first_name          ,c_last_name          ,d_year          )   select top (100)         t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id          and t_s_firstyear.customer_id = t_w_secyear.customer_id          and t_s_firstyear.customer_id = t_w_firstyear.customer_id          and t_s_firstyear.sale_type = 's'          and t_w_firstyear.sale_type = 'w'          and t_s_secyear.sale_type = 's'          and t_w_secyear.sale_type = 'w'          and t_s_firstyear.year = 1999          and t_s_secyear.year = 1999+1          and t_w_firstyear.year = 1999          and t_w_secyear.year = 1999+1          and t_s_firstyear.year_total > 0          and t_w_firstyear.year_total > 0          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end  order by 3,1,2;", "predicates": {"date_dim": ["d_year"]}, "payload": {"customer": ["c_customer_id", "c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_net_paid"], "web_sales": ["ws_net_paid", "ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_customer_id", "c_last_name", "c_first_name"]}}
{"id": 75, "query_string": " WITH all_sales AS (  SELECT d_year        ,i_brand_id        ,i_class_id        ,i_category_id        ,i_manufact_id        ,SUM(sales_cnt) AS sales_cnt        ,SUM(sales_amt) AS sales_amt  FROM (SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt              ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt        FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk                           JOIN date_dim ON d_date_sk=cs_sold_date_sk                           LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number                                                      AND cs_item_sk=cr_item_sk)        WHERE i_category='Books'        UNION        SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt              ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt        FROM store_sales JOIN item ON i_item_sk=ss_item_sk                         JOIN date_dim ON d_date_sk=ss_sold_date_sk                         LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number                                                  AND ss_item_sk=sr_item_sk)        WHERE i_category='Books'        UNION        SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt              ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt        FROM web_sales JOIN item ON i_item_sk=ws_item_sk                       JOIN date_dim ON d_date_sk=ws_sold_date_sk                       LEFT JOIN web_returns ON (ws_order_number=wr_order_number                                              AND ws_item_sk=wr_item_sk)        WHERE i_category='Books') sales_detail  GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)  SELECT top (100) prev_yr.d_year AS prev_year                           ,curr_yr.d_year AS year                           ,curr_yr.i_brand_id                           ,curr_yr.i_class_id                           ,curr_yr.i_category_id                           ,curr_yr.i_manufact_id                           ,prev_yr.sales_cnt AS prev_yr_cnt                           ,curr_yr.sales_cnt AS curr_yr_cnt                           ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff                           ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff  FROM all_sales curr_yr, all_sales prev_yr  WHERE curr_yr.i_brand_id=prev_yr.i_brand_id    AND curr_yr.i_class_id=prev_yr.i_class_id    AND curr_yr.i_category_id=prev_yr.i_category_id    AND curr_yr.i_manufact_id=prev_yr.i_manufact_id    AND curr_yr.d_year=1999    AND prev_yr.d_year=1999-1    AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9  ORDER BY sales_cnt_diff,sales_amt_diff  ;", "predicates": {"date_dim": ["d_year"], "item": ["i_category"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_quantity", "cr_return_amount"], "date_dim": ["d_date_sk", "d_year"], "item": ["i_class_id", "i_item_sk", "i_category_id", "i_brand_id", "i_manufact_id"], "store_returns": ["sr_return_amt", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_return_amt", "wr_return_quantity", "wr_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 76, "query_string": " select top (100) channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (         SELECT 'store' as channel, 'ss_promo_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price          FROM store_sales, item, date_dim          WHERE ss_promo_sk IS NULL            AND ss_sold_date_sk=d_date_sk            AND ss_item_sk=i_item_sk         UNION ALL         SELECT 'web' as channel, 'ws_ship_mode_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price          FROM web_sales, item, date_dim          WHERE ws_ship_mode_sk IS NULL            AND ws_sold_date_sk=d_date_sk            AND ws_item_sk=i_item_sk         UNION ALL         SELECT 'catalog' as channel, 'cs_promo_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price          FROM catalog_sales, item, date_dim          WHERE cs_promo_sk IS NULL            AND cs_sold_date_sk=d_date_sk            AND cs_item_sk=i_item_sk) foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category;", "predicates": {"catalog_sales": ["cs_ship_addr_sk"], "store_sales": ["ss_promo_sk"], "web_sales": ["ws_promo_sk"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_item_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_qoy", "d_year"], "item": ["i_item_sk", "i_category"], "store_sales": ["ss_sold_date_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 77, "query_string": " with ss as  (select s_store_sk,          sum(ss_ext_sales_price) as sales,          sum(ss_net_profit) as profit  from store_sales,       date_dim,       store  where ss_sold_date_sk = d_date_sk        and d_date between cast('1998-08-16' as date)                    and dateadd(day, 30, cast('1998-08-16' as date))         and ss_store_sk = s_store_sk  group by s_store_sk)  ,  sr as  (select s_store_sk,          sum(sr_return_amt) as returns,          sum(sr_net_loss) as profit_loss  from store_returns,       date_dim,       store  where sr_returned_date_sk = d_date_sk        and d_date between cast('1998-08-16' as date)                   and dateadd(day, 30, cast('1998-08-16' as date))        and sr_store_sk = s_store_sk  group by s_store_sk),   cs as  (select cs_call_center_sk,         sum(cs_ext_sales_price) as sales,         sum(cs_net_profit) as profit  from catalog_sales,       date_dim  where cs_sold_date_sk = d_date_sk        and d_date between cast('1998-08-16' as date)                   and dateadd(day, 30, cast('1998-08-16' as date))  group by cs_call_center_sk   ),   cr as  (select cr_call_center_sk,          sum(cr_return_amount) as returns,          sum(cr_net_loss) as profit_loss  from catalog_returns,       date_dim  where cr_returned_date_sk = d_date_sk        and d_date between cast('1998-08-16' as date)                   and dateadd(day, 30, cast('1998-08-16' as date))  group by cr_call_center_sk  ),   ws as  ( select wp_web_page_sk,         sum(ws_ext_sales_price) as sales,         sum(ws_net_profit) as profit  from web_sales,       date_dim,       web_page  where ws_sold_date_sk = d_date_sk        and d_date between cast('1998-08-16' as date)                   and dateadd(day, 30, cast('1998-08-16' as date))        and ws_web_page_sk = wp_web_page_sk  group by wp_web_page_sk),   wr as  (select wp_web_page_sk,         sum(wr_return_amt) as returns,         sum(wr_net_loss) as profit_loss  from web_returns,       date_dim,       web_page  where wr_returned_date_sk = d_date_sk        and d_date between cast('1998-08-16' as date)                   and dateadd(day, 30, cast('1998-08-16' as date))        and wr_web_page_sk = wp_web_page_sk  group by wp_web_page_sk)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , ss.s_store_sk as id         , sales         , coalesce(returns, 0) as returns         , (profit - coalesce(profit_loss,0)) as profit  from   ss left join sr         on  ss.s_store_sk = sr.s_store_sk  union all  select 'catalog channel' as channel         , cs_call_center_sk as id         , sales         , returns         , (profit - profit_loss) as profit  from  cs        , cr  union all  select 'web channel' as channel         , ws.wp_web_page_sk as id         , sales         , coalesce(returns, 0) returns         , (profit - coalesce(profit_loss,0)) as profit  from   ws left join wr         on  ws.wp_web_page_sk = wr.wp_web_page_sk  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_return_amount", "cr_call_center_sk"], "catalog_sales": ["cs_net_profit", "cs_sold_date_sk", "cs_call_center_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_net_loss"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit", "ss_ext_sales_price"], "web_page": ["wp_web_page_sk"], "web_returns": ["wr_web_page_sk", "wr_returned_date_sk", "wr_return_amt", "wr_net_loss"], "web_sales": ["ws_net_profit", "ws_ext_sales_price", "ws_web_page_sk", "ws_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 78, "query_string": " with ws as   (select d_year AS ws_sold_year, ws_item_sk,     ws_bill_customer_sk ws_customer_sk,     sum(ws_quantity) ws_qty,     sum(ws_wholesale_cost) ws_wc,     sum(ws_sales_price) ws_sp    from web_sales    left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk    join date_dim on ws_sold_date_sk = d_date_sk    where wr_order_number is null    group by d_year, ws_item_sk, ws_bill_customer_sk    ), cs as   (select d_year AS cs_sold_year, cs_item_sk,     cs_bill_customer_sk cs_customer_sk,     sum(cs_quantity) cs_qty,     sum(cs_wholesale_cost) cs_wc,     sum(cs_sales_price) cs_sp    from catalog_sales    left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk    join date_dim on cs_sold_date_sk = d_date_sk    where cr_order_number is null    group by d_year, cs_item_sk, cs_bill_customer_sk    ), ss as   (select d_year AS ss_sold_year, ss_item_sk,     ss_customer_sk,     sum(ss_quantity) ss_qty,     sum(ss_wholesale_cost) ss_wc,     sum(ss_sales_price) ss_sp    from store_sales    left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk    join date_dim on ss_sold_date_sk = d_date_sk    where sr_ticket_number is null    group by d_year, ss_item_sk, ss_customer_sk    )  select top (100) ss_sold_year, round(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk) where (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2001 order by    ss_sold_year,   ss_qty desc, ss_wc desc, ss_sp desc,   other_chan_qty,   other_chan_wholesale_cost,   other_chan_sales_price,   ratio;", "predicates": {"catalog_returns": ["cr_order_number"], "catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_year"], "store_returns": ["sr_ticket_number"], "store_sales": ["ss_customer_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_bill_customer_sk"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "store_returns": ["sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_item_sk", "ss_sales_price", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_wholesale_cost", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 79, "query_string": " select top (100)   c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,store.s_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (household_demographics.hd_dep_count = 9 or household_demographics.hd_vehicle_count > 2)     and date_dim.d_dow = 1     and date_dim.d_year in (2000,2000+1,2000+2)      and store.s_number_employees between 200 and 295     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer     where ss_customer_sk = c_customer_sk  order by c_last_name,c_first_name,substring(s_city,1,30), profit;", "predicates": {"date_dim": ["d_dow", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_number_employees"]}, "payload": {"customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_city", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_addr_sk", "ss_customer_sk", "ss_ticket_number", "ss_coupon_amt", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {"customer": ["c_last_name", "c_first_name"]}}
{"id": 80, "query_string": " with ssr as  (select  s_store_id as store_id,           sum(ss_ext_sales_price) as sales,           sum(coalesce(sr_return_amt, 0)) as returns,           sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit   from store_sales left outer join store_returns on          (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),      date_dim,      store,      item,      promotion  where ss_sold_date_sk = d_date_sk        and d_date between cast('1998-08-16' as date)                    and dateadd(day, 30, cast('1998-08-16' as date))        and ss_store_sk = s_store_sk        and ss_item_sk = i_item_sk        and i_current_price > 50        and ss_promo_sk = p_promo_sk        and p_channel_tv = 'N'  group by s_store_id)  ,  csr as  (select  cp_catalog_page_id as catalog_page_id,           sum(cs_ext_sales_price) as sales,           sum(coalesce(cr_return_amount, 0)) as returns,           sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit   from catalog_sales left outer join catalog_returns on          (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),      date_dim,      catalog_page,      item,      promotion  where cs_sold_date_sk = d_date_sk        and d_date between cast('1998-08-16' as date)                   and dateadd(day, 30, cast('1998-08-16' as date))         and cs_catalog_page_sk = cp_catalog_page_sk        and cs_item_sk = i_item_sk        and i_current_price > 50        and cs_promo_sk = p_promo_sk        and p_channel_tv = 'N' group by cp_catalog_page_id)  ,  wsr as  (select  web_site_id,           sum(ws_ext_sales_price) as sales,           sum(coalesce(wr_return_amt, 0)) as returns,           sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit   from web_sales left outer join web_returns on          (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),      date_dim,      web_site,      item,      promotion  where ws_sold_date_sk = d_date_sk        and d_date between cast('1998-08-16' as date)                   and dateadd(day, 30, cast('1998-08-16' as date))         and ws_web_site_sk = web_site_sk        and ws_item_sk = i_item_sk        and i_current_price > 50        and ws_promo_sk = p_promo_sk        and p_channel_tv = 'N' group by web_site_id)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , concat('store' , store_id) as id         , sales         , returns         , profit  from   ssr  union all  select 'catalog channel' as channel         , concat('catalog_page' , catalog_page_id) as id         , sales         , returns         , profit  from  csr  union all  select 'web channel' as channel         , concat('web_site' , web_site_id) as id         , sales         , returns         , profit  from   wsr  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"], "promotion": ["p_channel_tv"]}, "payload": {"catalog_page": ["cp_catalog_page_sk", "cp_catalog_page_id"], "catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_amount", "cr_net_loss"], "date_dim": ["d_date_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"], "store": ["s_store_sk", "s_store_id"], "store_returns": ["sr_return_amt", "sr_net_loss", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_net_loss", "wr_return_amt", "wr_order_number"], "web_site": ["web_site_id", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 81, "query_string": " with customer_total_return as  (select cr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   \tsum(cr_return_amt_inc_tax) as ctr_total_return  from catalog_returns      ,date_dim      ,customer_address  where cr_returned_date_sk = d_date_sk     and d_year =1998    and cr_returning_addr_sk = ca_address_sk   group by cr_returning_customer_sk          ,ca_state )   select top (100) c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  \t\t\t  from customer_total_return ctr2                    \t  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'WV'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  ;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_year"]}, "payload": {"catalog_returns": ["cr_returned_date_sk", "cr_returning_customer_sk", "cr_return_amt_inc_tax", "cr_returning_addr_sk"], "customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_current_addr_sk", "c_customer_id"], "customer_address": ["ca_street_type", "ca_county", "ca_street_name", "ca_zip", "ca_street_number", "ca_city", "ca_state", "ca_gmt_offset", "ca_location_type", "ca_address_sk", "ca_suite_number", "ca_country"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer": ["c_salutation", "c_customer_id", "c_last_name", "c_first_name"], "customer_address": ["ca_street_type", "ca_county", "ca_street_name", "ca_zip", "ca_street_number", "ca_city", "ca_gmt_offset", "ca_location_type", "ca_suite_number", "ca_country"]}}
{"id": 82, "query_string": " select top (100) i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, store_sales  where i_current_price between 56 and 56+30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('1999-03-03' as date) and dateadd(day, 60, cast('1999-03-03' as date))  and i_manufact_id in (471,688,823,696)  and inv_quantity_on_hand between 100 and 500  and ss_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  ;", "predicates": {"date_dim": ["d_date"], "inventory": ["inv_quantity_on_hand"], "item": ["i_current_price", "i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc", "i_current_price"]}, "group_by": {}, "order_by": {}}
{"id": 83, "query_string": " with sr_items as  (select i_item_id item_id,         sum(sr_return_quantity) sr_item_qty  from store_returns,       item,       date_dim  where sr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t  where d_date in ('1998-05-01','1998-10-11','1998-11-04')))  and   sr_returned_date_sk   = d_date_sk  group by i_item_id),  cr_items as  (select i_item_id item_id,         sum(cr_return_quantity) cr_item_qty  from catalog_returns,       item,       date_dim  where cr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t  where d_date in ('1998-05-01','1998-10-11','1998-11-04')))  and   cr_returned_date_sk   = d_date_sk  group by i_item_id),  wr_items as  (select i_item_id item_id,         sum(wr_return_quantity) wr_item_qty  from web_returns,       item,       date_dim  where wr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t\twhere d_date in ('1998-05-01','1998-10-11','1998-11-04')))  and   wr_returned_date_sk   = d_date_sk  group by i_item_id)   select top (100) sr_items.item_id        ,sr_item_qty        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev        ,cr_item_qty        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev        ,wr_item_qty        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average  from sr_items      ,cr_items      ,wr_items  where sr_items.item_id=cr_items.item_id    and sr_items.item_id=wr_items.item_id   order by sr_items.item_id          ,sr_item_qty  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_returned_date_sk", "cr_order_number", "cr_return_quantity"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "item": ["i_item_id", "i_item_sk"], "store_returns": ["sr_returned_date_sk", "sr_return_quantity", "sr_item_sk"], "web_returns": ["wr_item_sk", "wr_returned_date_sk", "wr_return_quantity"]}, "group_by": {}, "order_by": {}}
{"id": 84, "query_string": " select top (100) c_customer_id as customer_id        , concat(coalesce(c_last_name,'') , ', ' , coalesce(c_first_name,'')) as customername  from customer      ,customer_address      ,customer_demographics      ,household_demographics      ,income_band      ,store_returns  where ca_city\t        =  'Deerfield'    and c_current_addr_sk = ca_address_sk    and ib_lower_bound   >=  4495    and ib_upper_bound   <=  4495 + 50000    and ib_income_band_sk = hd_income_band_sk    and cd_demo_sk = c_current_cdemo_sk    and hd_demo_sk = c_current_hdemo_sk    and sr_cdemo_sk = cd_demo_sk  order by c_customer_id  ;", "predicates": {"customer": ["c_current_cdemo_sk"], "customer_address": ["ca_city"], "income_band": ["ib_upper_bound", "ib_lower_bound"]}, "payload": {"customer": ["c_last_name", "c_first_name", "c_current_cdemo_sk", "c_current_addr_sk", "c_customer_id", "c_current_hdemo_sk"], "customer_address": ["ca_address_sk"], "household_demographics": ["hd_income_band_sk", "hd_demo_sk"], "income_band": ["ib_income_band_sk"], "store_returns": ["sr_cdemo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 85, "query_string": " select top (100) substring(r_reason_desc,1,20)        ,avg(ws_quantity)        ,avg(wr_refunded_cash)        ,avg(wr_fee)  from web_sales, web_returns, web_page, customer_demographics cd1,       customer_demographics cd2, customer_address, date_dim, reason   where ws_web_page_sk = wp_web_page_sk    and ws_item_sk = wr_item_sk    and ws_order_number = wr_order_number    and ws_sold_date_sk = d_date_sk and d_year = 2000    and cd1.cd_demo_sk = wr_refunded_cdemo_sk     and cd2.cd_demo_sk = wr_returning_cdemo_sk    and ca_address_sk = wr_refunded_addr_sk    and r_reason_sk = wr_reason_sk    and    (     (      cd1.cd_marital_status = 'W'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Primary'      and       cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 100.00 and 150.00     )    or     (      cd1.cd_marital_status = 'D'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = '2 yr Degree'       and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 50.00 and 100.00     )    or     (      cd1.cd_marital_status = 'U'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Advanced Degree'      and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 150.00 and 200.00     )    )    and    (     (      ca_country = 'United States'      and      ca_state in ('TX', 'VA', 'TN')      and ws_net_profit between 100 and 200       )     or     (      ca_country = 'United States'      and      ca_state in ('WI', 'CO', 'MO')      and ws_net_profit between 150 and 300       )     or     (      ca_country = 'United States'      and      ca_state in ('GA', 'KS', 'PA')      and ws_net_profit between 50 and 250       )    ) group by r_reason_desc order by substring(r_reason_desc,1,20)         ,avg(ws_quantity)         ,avg(wr_refunded_cash)         ,avg(wr_fee);", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "web_sales": ["ws_net_profit", "ws_sales_price"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "reason": ["r_reason_desc", "r_reason_sk"], "web_page": ["wp_web_page_sk"], "web_returns": ["wr_returning_cdemo_sk", "wr_refunded_cdemo_sk", "wr_reason_sk", "wr_item_sk", "wr_refunded_cash", "wr_refunded_addr_sk", "wr_fee", "wr_order_number"], "web_sales": ["ws_net_profit", "ws_item_sk", "ws_sales_price", "ws_quantity", "ws_sold_date_sk", "ws_web_page_sk", "ws_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 86, "query_string": " select top (100)       sum(ws_net_paid) as total_sum    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  \tpartition by grouping(i_category)+grouping(i_class),  \tcase when grouping(i_class) = 0 then i_category end   \torder by sum(ws_net_paid) desc) as rank_within_parent  from     web_sales    ,date_dim       d1    ,item  where     d1.d_month_seq between 1222 and 1222+11  and d1.d_date_sk = ws_sold_date_sk  and i_item_sk  = ws_item_sk  group by rollup(i_category,i_class)  order by    lochierarchy desc,    case when (grouping(i_category)+grouping(i_class)) = 0 then i_category end,    rank_within_parent  ;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_class", "i_item_sk", "i_category"], "web_sales": ["ws_net_paid", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 87, "query_string": " select count(*)  from ((select distinct c_last_name, c_first_name, d_date        from store_sales, date_dim, customer        where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_customer_sk = customer.c_customer_sk          and d_month_seq between 1222 and 1222+11)        except       (select distinct c_last_name, c_first_name, d_date        from catalog_sales, date_dim, customer        where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk          and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk          and d_month_seq between 1222 and 1222+11)        except       (select distinct c_last_name, c_first_name, d_date        from web_sales, date_dim, customer        where web_sales.ws_sold_date_sk = date_dim.d_date_sk          and web_sales.ws_bill_customer_sk = customer.c_customer_sk          and d_month_seq between 1222 and 1222+11) ) cool_cust;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 88, "query_string": " select  * from  (select count(*) h8_30_to_9  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk         and ss_hdemo_sk = household_demographics.hd_demo_sk       and ss_store_sk = s_store_sk      and time_dim.t_hour = 8      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))       and store.s_store_name = 'ese') s1,  (select count(*) h9_to_9_30   from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk       and time_dim.t_hour = 9       and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))      and store.s_store_name = 'ese') s2,  (select count(*) h9_30_to_10   from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 9      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))      and store.s_store_name = 'ese') s3,  (select count(*) h10_to_10_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 10       and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))      and store.s_store_name = 'ese') s4,  (select count(*) h10_30_to_11  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 10       and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))      and store.s_store_name = 'ese') s5,  (select count(*) h11_to_11_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk       and time_dim.t_hour = 11      and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))      and store.s_store_name = 'ese') s6,  (select count(*) h11_30_to_12  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 11      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))      and store.s_store_name = 'ese') s7,  (select count(*) h12_to_12_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 12      and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))      and store.s_store_name = 'ese') s8;", "predicates": {"household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_store_name"], "time_dim": ["t_hour", "t_minute"]}, "payload": {"household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_sold_time_sk"], "time_dim": ["t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 89, "query_string": " select top (100) * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (2000) and         ((i_category in ('Women','Electronics','Shoes') and           i_class in ('swimwear','dvd/vcr players','womens')          )       or (i_category in ('Home','Children','Music') and           i_class in ('wallpaper','infants','country')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name;", "predicates": {"date_dim": ["d_year"], "item": ["i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_brand", "i_class", "i_item_sk", "i_category"], "store": ["s_store_name", "s_store_sk", "s_company_name"]}, "group_by": {}, "order_by": {"store": ["s_store_name"]}}
{"id": 90, "query_string": " select top (100) cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio  from ( select count(*) amc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 6 and 6+1          and household_demographics.hd_dep_count = 9          and web_page.wp_char_count between 5000 and 5200) at,       ( select count(*) pmc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 16 and 16+1          and household_demographics.hd_dep_count = 9          and web_page.wp_char_count between 5000 and 5200) pt  order by am_pm_ratio  ;", "predicates": {"household_demographics": ["hd_dep_count"], "time_dim": ["t_hour"], "web_page": ["wp_char_count"]}, "payload": {"household_demographics": ["hd_demo_sk"], "time_dim": ["t_time_sk"], "web_page": ["wp_web_page_sk"], "web_sales": ["ws_sold_time_sk", "ws_web_page_sk", "ws_ship_hdemo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 91, "query_string": " select           cc_call_center_id Call_Center,         cc_name Call_Center_Name,         cc_manager Manager,         sum(cr_net_loss) Returns_Loss from         call_center,         catalog_returns,         date_dim,         customer,         customer_address,         customer_demographics,         household_demographics where         cr_call_center_sk       = cc_call_center_sk and     cr_returned_date_sk     = d_date_sk and     cr_returning_customer_sk= c_customer_sk and     cd_demo_sk              = c_current_cdemo_sk and     hd_demo_sk              = c_current_hdemo_sk and     ca_address_sk           = c_current_addr_sk and     d_year                  = 2000  and     d_moy                   = 12 and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')         or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree')) and     hd_buy_potential like '1001-5000%' and     ca_gmt_offset           = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc;", "predicates": {"customer_address": ["ca_gmt_offset"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_moy", "d_year"], "household_demographics": ["hd_buy_potential"]}, "payload": {"call_center": ["cc_name", "cc_call_center_id", "cc_manager", "cc_call_center_sk"], "catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_returning_customer_sk", "cr_call_center_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk", "c_current_hdemo_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 92, "query_string": " select top (100)     sum(ws_ext_discount_amt)  as \"Excess Discount Amount\"  from      web_sales     ,item     ,date_dim where i_manufact_id = 750 and i_item_sk = ws_item_sk  and d_date between '1999-02-04' and          dateadd(day, 90, cast('1999-02-04' as date)) and d_date_sk = ws_sold_date_sk  and ws_ext_discount_amt        > (           SELECT              1.3 * avg(ws_ext_discount_amt)           FROM              web_sales             ,date_dim          WHERE                ws_item_sk = i_item_sk            and d_date between '1999-02-04' and                              dateadd(day, 90, cast('1999-02-04' as date))           and d_date_sk = ws_sold_date_sk        )  order by sum(ws_ext_discount_amt);", "predicates": {"date_dim": ["d_date"], "item": ["i_manufact_id"], "web_sales": ["ws_ext_discount_amt"]}, "payload": {"item": ["i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 93, "query_string": " select top (100) ss_customer_sk             ,sum(act_sales) sumsales       from (select ss_item_sk                   ,ss_ticket_number                   ,ss_customer_sk                   ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price                                                             else (ss_quantity*ss_sales_price) end act_sales             from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk                                                                and sr_ticket_number = ss_ticket_number)                 ,reason             where sr_reason_sk = r_reason_sk               and r_reason_desc = 'reason 48') t       group by ss_customer_sk       order by sumsales, ss_customer_sk;", "predicates": {"reason": ["r_reason_desc"]}, "payload": {"reason": ["r_reason_sk"], "store_returns": ["sr_reason_sk", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"]}, "group_by": {}, "order_by": {"store_sales": ["ss_customer_sk"]}}
{"id": 94, "query_string": " select top (100)     count(distinct ws_order_number) as \"order count\"   ,sum(ws_ext_ship_cost) as \"total shipping cost\"   ,sum(ws_net_profit) as \"total net profit\" from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2000-5-01' and             dateadd(day, 60, cast('2000-5-01' as date)) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'TX' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number);", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_date"], "web_site": ["web_company_name"]}, "payload": {"customer_address": ["ca_address_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_net_profit", "ws_ship_date_sk", "ws_ship_addr_sk", "ws_ext_ship_cost", "ws_warehouse_sk", "ws_order_number", "ws_web_site_sk"], "web_site": ["web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 95, "query_string": " with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select top (100)     count(distinct ws_order_number) as \"order count\"   ,sum(ws_ext_ship_cost) as \"total shipping cost\"   ,sum(ws_net_profit) as \"total net profit\" from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2000-5-01' and             dateadd(day, 60, cast('2000-5-01' as date)) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'TX' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number);", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_date"], "web_site": ["web_company_name"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_net_profit", "ws_ship_date_sk", "ws_item_sk", "ws_ship_addr_sk", "ws_ext_ship_cost", "ws_warehouse_sk", "ws_order_number", "ws_web_site_sk"], "web_site": ["web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 96, "query_string": " select top (100) count(*)  from store_sales     ,household_demographics      ,time_dim, store where ss_sold_time_sk = time_dim.t_time_sk        and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk     and time_dim.t_hour = 16     and time_dim.t_minute >= 30     and household_demographics.hd_dep_count = 0     and store.s_store_name = 'ese' order by count(*);", "predicates": {"household_demographics": ["hd_dep_count"], "store": ["s_store_name"], "time_dim": ["t_hour", "t_minute"]}, "payload": {"household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_sold_time_sk"], "time_dim": ["t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 97, "query_string": " with ssci as ( select ss_customer_sk customer_sk       ,ss_item_sk item_sk from store_sales,date_dim where ss_sold_date_sk = d_date_sk   and d_month_seq between 1222 and 1222 + 11 group by ss_customer_sk         ,ss_item_sk), csci as(  select cs_bill_customer_sk customer_sk       ,cs_item_sk item_sk from catalog_sales,date_dim where cs_sold_date_sk = d_date_sk   and d_month_seq between 1222 and 1222 + 11 group by cs_bill_customer_sk         ,cs_item_sk)  select top (100) sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only       ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only       ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk                                and ssci.item_sk = csci.item_sk);", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk", "cs_item_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 98, "query_string": " select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from\t \tstore_sales     \t,item      \t,date_dim where  \tss_item_sk = i_item_sk    \tand i_category in ('Jewelry', 'Shoes', 'Women')   \tand ss_sold_date_sk = d_date_sk \tand d_date between cast('1999-06-04' as date)  \t\t\t\tand dateadd(day, 30, cast('1999-06-04' as date)) group by  \ti_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  \ti_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"]}, "group_by": {}, "order_by": {}}
{"id": 99, "query_string": " select top (100)     substring(w_warehouse_name,1,20)   ,sm_type   ,cc_name   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and                   (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and                   (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and                  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    catalog_sales   ,warehouse   ,ship_mode   ,call_center   ,date_dim where     d_month_seq between 1222 and 1222 + 11 and cs_ship_date_sk   = d_date_sk and cs_warehouse_sk   = w_warehouse_sk and cs_ship_mode_sk   = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by    substring(w_warehouse_name,1,20)   ,sm_type   ,cc_name order by substring(w_warehouse_name,1,20)         ,sm_type         ,cc_name;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"call_center": ["cc_name", "cc_call_center_sk"], "catalog_sales": ["cs_warehouse_sk", "cs_call_center_sk", "cs_ship_date_sk", "cs_ship_mode_sk", "cs_sold_date_sk"], "date_dim": ["d_date_sk"], "ship_mode": ["sm_type", "sm_ship_mode_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 1, "query_string": " with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sum(SR_STORE_CREDIT) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1999 group by sr_customer_sk ,sr_store_sk)  select top (100) c_customer_id from customer_total_return ctr1 ,store ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'TN' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id;", "predicates": {"date_dim": ["d_year"], "store": ["s_state"], "store_returns": ["sr_store_sk"]}, "payload": {"customer": ["c_customer_id", "c_customer_sk"], "date_dim": ["d_date_sk"], "store": ["s_store_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_customer_id"]}}
{"id": 2, "query_string": " with wscs as  (select sold_date_sk         ,sales_price   from (select ws_sold_date_sk sold_date_sk               ,ws_ext_sales_price sales_price         from web_sales          union all         select cs_sold_date_sk sold_date_sk               ,cs_ext_sales_price sales_price         from catalog_sales) a),  wswscs as   (select d_week_seq,         sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales  from wscs      ,date_dim  where d_date_sk = sold_date_sk  group by d_week_seq)  select d_week_seq1        ,round(sun_sales1/sun_sales2,2)        ,round(mon_sales1/mon_sales2,2)        ,round(tue_sales1/tue_sales2,2)        ,round(wed_sales1/wed_sales2,2)        ,round(thu_sales1/thu_sales2,2)        ,round(fri_sales1/fri_sales2,2)        ,round(sat_sales1/sat_sales2,2)  from  (select wswscs.d_week_seq d_week_seq1         ,sun_sales sun_sales1         ,mon_sales mon_sales1         ,tue_sales tue_sales1         ,wed_sales wed_sales1         ,thu_sales thu_sales1         ,fri_sales fri_sales1         ,sat_sales sat_sales1   from wswscs,date_dim    where date_dim.d_week_seq = wswscs.d_week_seq and         d_year = 1999) y,  (select wswscs.d_week_seq d_week_seq2         ,sun_sales sun_sales2         ,mon_sales mon_sales2         ,tue_sales tue_sales2         ,wed_sales wed_sales2         ,thu_sales thu_sales2         ,fri_sales fri_sales2         ,sat_sales sat_sales2   from wswscs       ,date_dim    where date_dim.d_week_seq = wswscs.d_week_seq and         d_year = 1999+1) z  where d_week_seq1=d_week_seq2-53  order by d_week_seq1;", "predicates": {"date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_week_seq", "d_day_name"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 3, "query_string": " select top (100) dt.d_year         ,item.i_brand_id brand_id         ,item.i_brand brand        ,sum(ss_ext_sales_price) sum_agg  from  date_dim dt        ,store_sales       ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk    and store_sales.ss_item_sk = item.i_item_sk    and item.i_manufact_id = 171    and dt.d_moy=12  group by dt.d_year       ,item.i_brand       ,item.i_brand_id  order by dt.d_year          ,sum_agg desc          ,brand_id  ;", "predicates": {"date_dim": ["d_moy"], "item": ["i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"date_dim": ["d_year"], "item": ["i_brand_id"]}}
{"id": 4, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year  union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total        ,'c' sale_type  from customer      ,catalog_sales      ,date_dim  where c_customer_sk = cs_bill_customer_sk    and cs_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year          )   select top (100)                    t_s_secyear.customer_id                  ,t_s_secyear.customer_first_name                  ,t_s_secyear.customer_last_name                  ,t_s_secyear.customer_email_address  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_c_firstyear      ,year_total t_c_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id    and t_s_firstyear.customer_id = t_c_secyear.customer_id    and t_s_firstyear.customer_id = t_c_firstyear.customer_id    and t_s_firstyear.customer_id = t_w_firstyear.customer_id    and t_s_firstyear.customer_id = t_w_secyear.customer_id    and t_s_firstyear.sale_type = 's'    and t_c_firstyear.sale_type = 'c'    and t_w_firstyear.sale_type = 'w'    and t_s_secyear.sale_type = 's'    and t_c_secyear.sale_type = 'c'    and t_w_secyear.sale_type = 'w'    and t_s_firstyear.dyear =  1999    and t_s_secyear.dyear = 1999+1    and t_c_firstyear.dyear =  1999    and t_c_secyear.dyear =  1999+1    and t_w_firstyear.dyear = 1999    and t_w_secyear.dyear = 1999+1    and t_s_firstyear.year_total > 0    and t_c_firstyear.year_total > 0    and t_w_firstyear.year_total > 0    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end            > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end  order by t_s_secyear.customer_id          ,t_s_secyear.customer_first_name          ,t_s_secyear.customer_last_name          ,t_s_secyear.customer_email_address;", "predicates": {"date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_ext_list_price", "cs_ext_discount_amt", "cs_bill_customer_sk", "cs_ext_sales_price", "cs_ext_wholesale_cost", "cs_sold_date_sk"], "customer": ["c_login", "c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id"], "date_dim": ["d_date_sk"], "store_sales": ["ss_ext_discount_amt", "ss_ext_sales_price", "ss_ext_wholesale_cost", "ss_customer_sk", "ss_ext_list_price", "ss_sold_date_sk"], "web_sales": ["ws_ext_discount_amt", "ws_ext_wholesale_cost", "ws_ext_list_price", "ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 5, "query_string": " with ssr as  (select s_store_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  ss_store_sk as store_sk,             ss_sold_date_sk  as date_sk,             ss_ext_sales_price as sales_price,             ss_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from store_sales     union all     select sr_store_sk as store_sk,            sr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            sr_return_amt as return_amt,            sr_net_loss as net_loss     from store_returns    ) salesreturns,      date_dim,      store  where date_sk = d_date_sk        and d_date between cast('2001-08-15' as date)                    and dateadd(day, 14, cast('2001-08-15' as date))        and store_sk = s_store_sk  group by s_store_id)  ,  csr as  (select cp_catalog_page_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  cs_catalog_page_sk as page_sk,             cs_sold_date_sk  as date_sk,             cs_ext_sales_price as sales_price,             cs_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from catalog_sales     union all     select cr_catalog_page_sk as page_sk,            cr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            cr_return_amount as return_amt,            cr_net_loss as net_loss     from catalog_returns    ) salesreturns,      date_dim,      catalog_page  where date_sk = d_date_sk        and d_date between cast('2001-08-15' as date)                   and dateadd(day, 14, cast('2001-08-15' as date))        and page_sk = cp_catalog_page_sk  group by cp_catalog_page_id)  ,  wsr as  (select web_site_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  ws_web_site_sk as wsr_web_site_sk,             ws_sold_date_sk  as date_sk,             ws_ext_sales_price as sales_price,             ws_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from web_sales     union all     select ws_web_site_sk as wsr_web_site_sk,            wr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            wr_return_amt as return_amt,            wr_net_loss as net_loss     from web_returns left outer join web_sales on          ( wr_item_sk = ws_item_sk            and wr_order_number = ws_order_number)    ) salesreturns,      date_dim,      web_site  where date_sk = d_date_sk        and d_date between cast('2001-08-15' as date)                   and dateadd(day, 14, cast('2001-08-15' as date))        and wsr_web_site_sk = web_site_sk  group by web_site_id)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , concat('store' , s_store_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from   ssr  union all  select 'catalog channel' as channel         , concat('catalog_page' , cp_catalog_page_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from  csr  union all  select 'web channel' as channel         , concat('web_site' , web_site_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from   wsr  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_page": ["cp_catalog_page_sk", "cp_catalog_page_id"], "catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_return_amount", "cr_catalog_page_sk"], "catalog_sales": ["cs_catalog_page_sk", "cs_net_profit", "cs_sold_date_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_net_loss"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit", "ss_ext_sales_price"], "web_returns": ["wr_returned_date_sk", "wr_return_amt", "wr_net_loss", "wr_item_sk", "wr_order_number"], "web_sales": ["ws_net_profit", "ws_ext_sales_price", "ws_sold_date_sk", "ws_web_site_sk"], "web_site": ["web_site_id", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 6, "query_string": " select top (100) a.ca_state state, count(*) cnt  from customer_address a      ,customer c      ,store_sales s      ,date_dim d      ,item i  where       a.ca_address_sk = c.c_current_addr_sk  \tand c.c_customer_sk = s.ss_customer_sk  \tand s.ss_sold_date_sk = d.d_date_sk  \tand s.ss_item_sk = i.i_item_sk  \tand d.d_month_seq =   \t     (select distinct (d_month_seq)  \t      from date_dim                where d_year = 2001  \t        and d_moy = 7 )  \tand i.i_current_price > 1.2 *               (select avg(j.i_current_price)   \t     from item j   \t     where j.i_category = i.i_category)  group by a.ca_state  having count(*) >= 10  order by cnt, a.ca_state   ;", "predicates": {"date_dim": ["d_month_seq", "d_moy", "d_year"], "item": ["i_category", "i_current_price"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk", "d_month_seq"], "item": ["i_item_sk", "i_category", "i_current_price"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_item_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_state"]}}
{"id": 7, "query_string": " select top (100) i_item_id,          avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4   from store_sales, customer_demographics, date_dim, item, promotion  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_cdemo_sk = cd_demo_sk and        ss_promo_sk = p_promo_sk and        cd_gender = 'F' and         cd_marital_status = 'M' and        cd_education_status = 'Secondary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 2000   group by i_item_id  order by i_item_id  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "promotion": ["p_channel_event", "p_channel_email"]}, "payload": {"customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"], "promotion": ["p_promo_sk"], "store_sales": ["ss_promo_sk", "ss_item_sk", "ss_cdemo_sk", "ss_list_price", "ss_quantity", "ss_sales_price", "ss_coupon_amt", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 8, "query_string": " select top (100) s_store_name       ,sum(ss_net_profit)  from store_sales      ,date_dim      ,store,      (select ca_zip      from (       SELECT substring(ca_zip,1,5) ca_zip       FROM customer_address       WHERE substring(ca_zip,1,5) IN (                           '63904','21376','52098','93448','89949','75362',                           '76247','70728','34052','51341','55211',                           '57112','33670','83847','64669','99018',                           '20647','39973','92360','92752','13076',                           '35224','21450','10550','64993','29233',                           '87040','92544','79466','78597','88819',                           '65033','80300','55055','31220','46687',                           '15756','90759','47279','30153','20023',                           '47397','64967','85821','67541','45828',                           '70392','37440','43886','50156','99862',                           '23799','41570','32889','39394','89155',                           '23115','67259','81791','88886','86611',                           '42968','24991','29971','88621','66872',                           '19693','40109','55152','40897','39114',                           '10110','58808','16669','96583','41845',                           '18513','46004','89801','73239','68153',                           '23314','13059','39871','29497','17247',                           '21436','44143','58692','96703','56780',                           '35208','79182','50576','86612','13054',                           '14904','11621','19925','79252','61763',                           '96490','47966','16254','23717','74277',                           '76165','40606','57096','35260','82497',                           '24084','12815','51971','82220','16157',                           '61399','71753','60856','95542','98745',                           '12594','39064','67361','40770','84101',                           '39479','45323','58777','10597','72176',                           '60203','38060','27011','73105','57293',                           '35474','76345','19857','59359','61492',                           '70162','28517','56849','80612','27770',                           '61748','23256','43809','91474','66955',                           '67012','90549','50359','61533','82862',                           '65780','84552','64716','30440','97199',                           '31223','54422','10760','62256','75586',                           '90326','21360','98967','77492','79456',                           '84221','75570','40066','52501','25800',                           '33214','12610','97237','25090','58335',                           '82781','78248','48581','29254','86431',                           '35748','71720','23167','78606','60628',                           '11230','73546','54331','35339','15618',                           '62551','63168','44125','60818','79891',                           '26878','14853','90712','98521','98507',                           '46463','33828','79974','17112','37960',                           '25274','29193','74686','82592','51315',                           '95995','69060','32410','49218','29806',                           '71906','48225','45003','31254','71104',                           '64286','42196','44248','36892','75484',                           '41115','47907','71667','52828','19684',                           '52360','34563','80418','82585','55851',                           '46619','65297','25620','69063','59087',                           '44807','77820','14881','32933','58120',                           '48404','42926','16168','77242','39044',                           '21323','62623','48463','70647','19901',                           '51445','29005','66588','86390','97070',                           '21160','14127','48976','29829','87481',                           '36610','43677','59133','73277','97589',                           '92191','37938','62577','68547','21746',                           '20471','96009','29228','93994','54614',                           '33357','43742','27924','93714','30489',                           '85061','92590','61155','48795','86626',                           '45443','59724','64560','27012','59535',                           '21057','95620','86627','46787','81892',                           '85776','54363','51970','25988','37318',                           '66062','64623','47942','26675','59838',                           '93147','78473','79830','64472','90747',                           '40753','65170','55317','10854','32753',                           '71661','72586','67339','62931','74267',                           '87246','41614','54083','75747','16846',                           '66532','64486','84937','50625','88239',                           '85020','38561','23739','76361','43296',                           '22436','14977','12721','71938','92244',                           '82668','34857','85114','21306','17973',                           '48388','48137','86861','52091','86007',                           '79546','21013','13523','18945','83333',                           '44488','72161','77182','27637','72016',                           '82111','23491','11984','57970','66234',                           '18520','94305','92078','23278','53139',                           '26414','55150','72967','56113','29904',                           '95872','32921','25092','92053','45052',                           '61306','46264','27802','68796','26789',                           '85582','76571','26904','22420')      intersect       select ca_zip       from (SELECT substring(ca_zip,1,5) ca_zip,count(*) cnt             FROM customer_address, customer             WHERE ca_address_sk = c_current_addr_sk and                   c_preferred_cust_flag='Y'             group by ca_zip             having count(*) > 10)A1)A2) V1  where ss_store_sk = s_store_sk   and ss_sold_date_sk = d_date_sk   and d_qoy = 1 and d_year = 2001   and (substring(s_zip,1,2) = substring(V1.ca_zip,1,2))  group by s_store_name  order by s_store_name  ;", "predicates": {"customer": ["c_preferred_cust_flag"], "date_dim": ["d_qoy", "d_year"]}, "payload": {"customer": ["c_current_addr_sk"], "customer_address": ["ca_address_sk", "ca_zip"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 9, "query_string": " select case when (select count(*)                    from store_sales                    where ss_quantity between 1 and 20) > 13477             then (select avg(ss_ext_sales_price)                    from store_sales                    where ss_quantity between 1 and 20)              else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 1 and 20) end bucket1 ,        case when (select count(*)                   from store_sales                   where ss_quantity between 21 and 40) > 10534             then (select avg(ss_ext_sales_price)                   from store_sales                   where ss_quantity between 21 and 40)              else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 21 and 40) end bucket2,        case when (select count(*)                   from store_sales                   where ss_quantity between 41 and 60) > 47840             then (select avg(ss_ext_sales_price)                   from store_sales                   where ss_quantity between 41 and 60)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 41 and 60) end bucket3,        case when (select count(*)                   from store_sales                   where ss_quantity between 61 and 80) > 8763             then (select avg(ss_ext_sales_price)                   from store_sales                   where ss_quantity between 61 and 80)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 61 and 80) end bucket4,        case when (select count(*)                   from store_sales                   where ss_quantity between 81 and 100) > 43077             then (select avg(ss_ext_sales_price)                   from store_sales                   where ss_quantity between 81 and 100)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 81 and 100) end bucket5 from reason where r_reason_sk = 1;", "predicates": {"store_sales": ["ss_quantity"]}, "payload": {"store_sales": ["ss_ext_tax", "ss_net_paid_inc_tax"]}, "group_by": {}, "order_by": {}}
{"id": 10, "query_string": " select top (100)    cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3,   cd_dep_count,   count(*) cnt4,   cd_dep_employed_count,   count(*) cnt5,   cd_dep_college_count,   count(*) cnt6  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_county in ('Stark County','Plymouth County','Scott County','Cass County','Sedgwick County') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2001 and                 d_moy between 1 and 1+3) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 1 ANd 1+3) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 1 and 1+3))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count;", "predicates": {"customer_address": ["ca_county"], "date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 11, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag           ,c_birth_country          ,c_login          ,c_email_address          ,d_year   union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag           ,c_birth_country          ,c_login          ,c_email_address          ,d_year          )   select top (100)                    t_s_secyear.customer_id                  ,t_s_secyear.customer_first_name                  ,t_s_secyear.customer_last_name                  ,t_s_secyear.customer_email_address  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id          and t_s_firstyear.customer_id = t_w_secyear.customer_id          and t_s_firstyear.customer_id = t_w_firstyear.customer_id          and t_s_firstyear.sale_type = 's'          and t_w_firstyear.sale_type = 'w'          and t_s_secyear.sale_type = 's'          and t_w_secyear.sale_type = 'w'          and t_s_firstyear.dyear = 1999          and t_s_secyear.dyear = 1999+1          and t_w_firstyear.dyear = 1999          and t_w_secyear.dyear = 1999+1          and t_s_firstyear.year_total > 0          and t_w_firstyear.year_total > 0          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end              > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end  order by t_s_secyear.customer_id          ,t_s_secyear.customer_first_name          ,t_s_secyear.customer_last_name          ,t_s_secyear.customer_email_address;", "predicates": {"date_dim": ["d_year"]}, "payload": {"customer": ["c_login", "c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_ext_list_price", "ss_ext_discount_amt"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_discount_amt", "ws_ext_list_price"]}, "group_by": {}, "order_by": {}}
{"id": 12, "query_string": " select top (100) i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from\t \tweb_sales     \t,item      \t,date_dim where  \tws_item_sk = i_item_sk    \tand i_category in ('Children', 'Shoes', 'Books')   \tand ws_sold_date_sk = d_date_sk \tand d_date between cast('1998-03-10' as date)  \t\t\t\tand dateadd(day, 30, cast('1998-03-10' as date)) group by  \ti_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  \ti_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_desc", "i_class", "i_item_id", "i_category"]}}
{"id": 13, "query_string": " select avg(ss_quantity)        ,avg(ss_ext_sales_price)        ,avg(ss_ext_wholesale_cost)        ,sum(ss_ext_wholesale_cost)  from store_sales      ,store      ,customer_demographics      ,household_demographics      ,customer_address      ,date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2001  and((ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'M'   and cd_education_status = 'Advanced Degree'   and ss_sales_price between 100.00 and 150.00   and hd_dep_count = 3         )or      (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'S'   and cd_education_status = 'Secondary'   and ss_sales_price between 50.00 and 100.00      and hd_dep_count = 1      ) or       (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'W'   and cd_education_status = 'Unknown'   and ss_sales_price between 150.00 and 200.00    and hd_dep_count = 1        ))  and((ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('TX', 'ID', 'GA')   and ss_net_profit between 100 and 200        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('MI', 'OK', 'WA')   and ss_net_profit between 150 and 300        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('IN', 'CA', 'WI')   and ss_net_profit between 50 and 250        ));", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "household_demographics": ["hd_dep_count"], "store_sales": ["ss_sales_price", "ss_net_profit"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_dep_count", "hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_ext_sales_price", "ss_cdemo_sk", "ss_addr_sk", "ss_quantity", "ss_sales_price", "ss_ext_wholesale_cost", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 14, "query_string": " with  cross_items as  (select i_item_sk ss_item_sk  from item,  (select iss.i_brand_id brand_id      ,iss.i_class_id class_id      ,iss.i_category_id category_id  from store_sales      ,item iss      ,date_dim d1  where ss_item_sk = iss.i_item_sk    and ss_sold_date_sk = d1.d_date_sk    and d1.d_year between 1999 AND 1999 + 2  intersect   select ics.i_brand_id      ,ics.i_class_id      ,ics.i_category_id  from catalog_sales      ,item ics      ,date_dim d2  where cs_item_sk = ics.i_item_sk    and cs_sold_date_sk = d2.d_date_sk    and d2.d_year between 1999 AND 1999 + 2  intersect  select iws.i_brand_id      ,iws.i_class_id      ,iws.i_category_id  from web_sales      ,item iws      ,date_dim d3  where ws_item_sk = iws.i_item_sk    and ws_sold_date_sk = d3.d_date_sk    and d3.d_year between 1999 AND 1999 + 2) a  where i_brand_id = brand_id       and i_class_id = class_id       and i_category_id = category_id ),  avg_sales as  (select avg(quantity*list_price) average_sales   from (select ss_quantity quantity              ,ss_list_price list_price        from store_sales            ,date_dim        where ss_sold_date_sk = d_date_sk          and d_year between 1999 and 1999 + 2        union all         select cs_quantity quantity               ,cs_list_price list_price        from catalog_sales            ,date_dim        where cs_sold_date_sk = d_date_sk          and d_year between 1999 and 1999 + 2         union all        select ws_quantity quantity              ,ws_list_price list_price        from web_sales            ,date_dim        where ws_sold_date_sk = d_date_sk          and d_year between 1999 and 1999 + 2) x)   select top (100) channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)  from(        select 'store' channel, i_brand_id,i_class_id              ,i_category_id,sum(ss_quantity*ss_list_price) sales              , count(*) number_sales        from store_sales            ,item            ,date_dim        where ss_item_sk in (select ss_item_sk from cross_items)          and ss_item_sk = i_item_sk          and ss_sold_date_sk = d_date_sk          and d_year = 1999+2           and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)        union all        select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales        from catalog_sales            ,item            ,date_dim        where cs_item_sk in (select ss_item_sk from cross_items)          and cs_item_sk = i_item_sk          and cs_sold_date_sk = d_date_sk          and d_year = 1999+2           and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)        union all        select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales        from web_sales            ,item            ,date_dim        where ws_item_sk in (select ss_item_sk from cross_items)          and ws_item_sk = i_item_sk          and ws_sold_date_sk = d_date_sk          and d_year = 1999+2          and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)  ) y  group by rollup (channel, i_brand_id,i_class_id,i_category_id)  order by channel,i_brand_id,i_class_id,i_category_id  ; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_list_price", "cs_quantity"], "date_dim": ["d_date_sk"], "item": ["i_category_id", "i_class_id", "i_item_sk", "i_brand_id"], "store_sales": ["ss_sold_date_sk", "ss_list_price", "ss_quantity", "ss_item_sk"], "web_sales": ["ws_list_price", "ws_sold_date_sk", "ws_item_sk", "ws_quantity"]}, "group_by": {}, "order_by": {}}
{"id": 15, "query_string": " select top (100) ca_zip        ,sum(cs_sales_price)  from catalog_sales      ,customer      ,customer_address      ,date_dim  where cs_bill_customer_sk = c_customer_sk  \tand c_current_addr_sk = ca_address_sk   \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',                                    '85392', '85460', '80348', '81792')  \t      or ca_state in ('CA','WA','GA')  \t      or cs_sales_price > 500)  \tand cs_sold_date_sk = d_date_sk  \tand d_qoy = 2 and d_year = 2001  group by ca_zip  order by ca_zip  ;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"catalog_sales": ["cs_sales_price", "cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip", "ca_state"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_zip"]}}
{"id": 16, "query_string": " select top (100)     count(distinct cs_order_number) as \"order count\"   ,sum(cs_ext_ship_cost) as \"total shipping cost\"   ,sum(cs_net_profit) as \"total net profit\" from    catalog_sales cs1   ,date_dim   ,customer_address   ,call_center where     d_date between '2002-3-01' and             dateadd(day, 60, cast('2002-3-01' as date)) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'CO' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County',                   'Williamson County' ) and exists (select *             from catalog_sales cs2             where cs1.cs_order_number = cs2.cs_order_number               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select *                from catalog_returns cr1                where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number);", "predicates": {"call_center": ["cc_county"], "customer_address": ["ca_state"], "date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_order_number"], "catalog_sales": ["cs_order_number", "cs_warehouse_sk", "cs_ext_ship_cost", "cs_ship_addr_sk", "cs_net_profit", "cs_call_center_sk", "cs_ship_date_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 17, "query_string": " select top (100) i_item_id        ,i_item_desc        ,s_state        ,count(ss_quantity) as store_sales_quantitycount        ,avg(ss_quantity) as store_sales_quantityave        ,stdev(ss_quantity) as store_sales_quantitystdev        ,stdev(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov        ,count(sr_return_quantity) as store_returns_quantitycount        ,avg(sr_return_quantity) as store_returns_quantityave        ,stdev(sr_return_quantity) as store_returns_quantitystdev        ,stdev(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov        ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave        ,stdev(cs_quantity) as catalog_sales_quantitystdev        ,stdev(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov  from store_sales      ,store_returns      ,catalog_sales      ,date_dim d1      ,date_dim d2      ,date_dim d3      ,store      ,item  where d1.d_quarter_name = '2000Q1'    and d1.d_date_sk = ss_sold_date_sk    and i_item_sk = ss_item_sk    and s_store_sk = ss_store_sk    and ss_customer_sk = sr_customer_sk    and ss_item_sk = sr_item_sk    and ss_ticket_number = sr_ticket_number    and sr_returned_date_sk = d2.d_date_sk    and d2.d_quarter_name in ('2000Q1','2000Q2','2000Q3')    and sr_customer_sk = cs_bill_customer_sk    and sr_item_sk = cs_item_sk    and cs_sold_date_sk = d3.d_date_sk    and d3.d_quarter_name in ('2000Q1','2000Q2','2000Q3')  group by i_item_id          ,i_item_desc          ,s_state  order by i_item_id          ,i_item_desc          ,s_state;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_quarter_name"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_state", "s_store_sk"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_return_quantity", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 18, "query_string": " select top (100) i_item_id,         ca_country,         ca_state,          ca_county,         avg( cast(cs_quantity as decimal(12,2))) agg1,         avg( cast(cs_list_price as decimal(12,2))) agg2,         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,         avg( cast(cs_sales_price as decimal(12,2))) agg4,         avg( cast(cs_net_profit as decimal(12,2))) agg5,         avg( cast(c_birth_year as decimal(12,2))) agg6,         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7  from catalog_sales, customer_demographics cd1,        customer_demographics cd2, customer, customer_address, date_dim, item  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd1.cd_demo_sk and        cs_bill_customer_sk = c_customer_sk and        cd1.cd_gender = 'M' and         cd1.cd_education_status = 'Primary' and        c_current_cdemo_sk = cd2.cd_demo_sk and        c_current_addr_sk = ca_address_sk and        c_birth_month in (8,6,9,5,10,3) and        d_year = 1998 and        ca_state in ('NC','WA','UT'                    ,'MO','GA','WI','VT')  group by rollup (i_item_id, ca_country, ca_state, ca_county)  order by ca_country,         ca_state,          ca_county, \ti_item_id  ;", "predicates": {"customer": ["c_birth_month"], "customer_address": ["ca_state"], "customer_demographics": ["cd_education_status", "cd_gender"], "date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_quantity", "cs_sales_price", "cs_bill_customer_sk", "cs_item_sk", "cs_net_profit", "cs_list_price", "cs_coupon_amt", "cs_sold_date_sk", "cs_bill_cdemo_sk"], "customer": ["c_birth_year", "c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_county", "ca_country", "ca_state"], "customer_demographics": ["cd_demo_sk", "cd_dep_count"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_state", "ca_county", "ca_country"], "item": ["i_item_id"]}}
{"id": 19, "query_string": " select top (100) i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,  \tsum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item,customer,customer_address,store  where d_date_sk = ss_sold_date_sk    and ss_item_sk = i_item_sk    and i_manager_id=24    and d_moy=12    and d_year=2001    and ss_customer_sk = c_customer_sk     and c_current_addr_sk = ca_address_sk    and substring(ca_zip,1,5) <> substring(s_zip,1,5)     and ss_store_sk = s_store_sk   group by i_brand       ,i_brand_id       ,i_manufact_id       ,i_manufact  order by ext_price desc          ,i_brand          ,i_brand_id          ,i_manufact_id          ,i_manufact  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip"], "date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_brand_id", "i_manufact_id", "i_brand", "i_manufact"], "store": ["s_zip", "s_store_sk"]}, "group_by": {}, "order_by": {"item": ["i_brand", "i_manufact", "i_brand_id", "i_manufact_id"]}}
{"id": 20, "query_string": " select top (100) i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from\tcatalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Children', 'Shoes', 'Books')    and cs_sold_date_sk = d_date_sk  and d_date between cast('1998-03-10' as date)   \t\t\t\tand dateadd(day, 30, cast('1998-03-10' as date))  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"]}, "group_by": {}, "order_by": {"item": ["i_item_desc", "i_class", "i_item_id", "i_category"]}}
{"id": 21, "query_string": " select top (100) *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-24' as date)) \t                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-24' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between dateadd(day, -30, cast ('2001-02-24' as date))                     and dateadd(day, 30, cast ('2001-02-24' as date))    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  ;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"]}, "payload": {"date_dim": ["d_date_sk", "d_date"], "item": ["i_item_id", "i_item_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 22, "query_string": " select top (100) i_product_name              ,i_brand              ,i_class              ,i_category              ,avg(inv_quantity_on_hand) qoh        from inventory            ,date_dim            ,item        where inv_date_sk=d_date_sk               and inv_item_sk=i_item_sk               and d_month_seq between 1184 and 1184 + 11        group by rollup(i_product_name                        ,i_brand                        ,i_class                        ,i_category) order by qoh, i_product_name, i_brand, i_class, i_category;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_brand", "i_product_name", "i_category", "i_class"]}, "group_by": {}, "order_by": {"item": ["i_product_name", "i_class", "i_brand", "i_category"]}}
{"id": 23, "query_string": " with frequent_ss_items as   (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt   from store_sales       ,date_dim        ,item   where ss_sold_date_sk = d_date_sk     and ss_item_sk = i_item_sk      and d_year in (1998,1998+1,1998+2,1998+3)   group by substring(i_item_desc,1,30),i_item_sk,d_date   having count(*) >4),  max_store_sales as  (select max(csales) tpcds_cmax    from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales         from store_sales             ,customer             ,date_dim          where ss_customer_sk = c_customer_sk          and ss_sold_date_sk = d_date_sk          and d_year in (1998,1998+1,1998+2,1998+3)          group by c_customer_sk) a),  best_ss_customer as  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales   from store_sales       ,customer   where ss_customer_sk = c_customer_sk   group by c_customer_sk   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select   * from  max_store_sales))   select top (100) sum(sales)  from (select cs_quantity*cs_list_price sales        from catalog_sales            ,date_dim         where d_year = 1998           and d_moy = 5           and cs_sold_date_sk = d_date_sk           and cs_item_sk in (select item_sk from frequent_ss_items)          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)       union all       select ws_quantity*ws_list_price sales        from web_sales             ,date_dim         where d_year = 1998           and d_moy = 5           and ws_sold_date_sk = d_date_sk           and ws_item_sk in (select item_sk from frequent_ss_items)          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) b  ; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"customer": ["c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "item": ["i_item_sk", "i_item_desc"], "store_sales": ["ss_item_sk", "ss_sales_price", "ss_customer_sk", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 24, "query_string": " with ssales as (select c_last_name       ,c_first_name       ,s_store_name       ,ca_state       ,s_state       ,i_color       ,i_current_price       ,i_manager_id       ,i_units       ,i_size       ,sum(ss_net_profit) netpaid from store_sales     ,store_returns     ,store     ,item     ,customer     ,customer_address where ss_ticket_number = sr_ticket_number   and ss_item_sk = sr_item_sk   and ss_customer_sk = c_customer_sk   and ss_item_sk = i_item_sk   and ss_store_sk = s_store_sk   and c_current_addr_sk = ca_address_sk   and c_birth_country <> upper(ca_country)   and s_zip = ca_zip and s_market_id=10 group by c_last_name         ,c_first_name         ,s_store_name         ,ca_state         ,s_state         ,i_color         ,i_current_price         ,i_manager_id         ,i_units         ,i_size) select c_last_name       ,c_first_name       ,s_store_name       ,sum(netpaid) paid from ssales where i_color = 'deep' group by c_last_name         ,c_first_name         ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid)                                  from ssales) order by c_last_name         ,c_first_name         ,s_store_name; ", "predicates": {"item": ["i_color"], "store": ["s_market_id"]}, "payload": {"customer": ["c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_current_addr_sk"], "customer_address": ["ca_address_sk", "ca_country", "ca_zip", "ca_state"], "item": ["i_item_sk", "i_units", "i_manager_id", "i_current_price", "i_size"], "store": ["s_zip", "s_store_name", "s_state", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_net_paid_inc_tax"]}, "group_by": {}, "order_by": {}}
{"id": 25, "query_string": " select top (100)   i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  ,avg(ss_net_profit) as store_sales_profit  ,avg(sr_net_loss) as store_returns_loss  ,avg(cs_net_profit) as catalog_sales_profit  from  store_sales  ,store_returns  ,catalog_sales  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,item  where  d1.d_moy = 4  and d1.d_year = 2001  and d1.d_date_sk = ss_sold_date_sk  and i_item_sk = ss_item_sk  and s_store_sk = ss_store_sk  and ss_customer_sk = sr_customer_sk  and ss_item_sk = sr_item_sk  and ss_ticket_number = sr_ticket_number  and sr_returned_date_sk = d2.d_date_sk  and d2.d_moy               between 4 and  10  and d2.d_year              = 2001  and sr_customer_sk = cs_bill_customer_sk  and sr_item_sk = cs_item_sk  and cs_sold_date_sk = d3.d_date_sk  and d3.d_moy               between 4 and  10   and d3.d_year              = 2001  group by  i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  order by  i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  ;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_store_name", "s_store_sk", "s_store_id"], "store_returns": ["sr_returned_date_sk", "sr_net_loss", "sr_customer_sk", "sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 26, "query_string": " select top (100) i_item_id,          avg(cs_quantity) agg1,         avg(cs_list_price) agg2,         avg(cs_coupon_amt) agg3,         avg(cs_sales_price) agg4   from catalog_sales, customer_demographics, date_dim, item, promotion  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd_demo_sk and        cs_promo_sk = p_promo_sk and        cd_gender = 'F' and         cd_marital_status = 'M' and        cd_education_status = 'Secondary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 2000   group by i_item_id  order by i_item_id  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "promotion": ["p_channel_event", "p_channel_email"]}, "payload": {"item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 27, "query_string": " select top (100) i_item_id,         s_state, grouping(s_state) g_state,         avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4  from store_sales, customer_demographics, date_dim, store, item  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_store_sk = s_store_sk and        ss_cdemo_sk = cd_demo_sk and        cd_gender = 'M' and        cd_marital_status = 'M' and        cd_education_status = '4 yr Degree' and        d_year = 2001 and        s_state in ('TN','TN', 'TN', 'TN', 'TN', 'TN')  group by rollup (i_item_id, s_state)  order by i_item_id          ,s_state  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "store": ["s_state"]}, "payload": {"customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"], "store": ["s_state", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_cdemo_sk", "ss_list_price", "ss_quantity", "ss_sales_price", "ss_coupon_amt", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_id"], "store": ["s_state"]}}
{"id": 28, "query_string": " select top (100) * from (select avg(ss_list_price) B1_LP             ,count(ss_list_price) B1_CNT             ,count(distinct ss_list_price) B1_CNTD       from store_sales       where ss_quantity between 0 and 5         and (ss_list_price between 95 and 95+10               or ss_coupon_amt between 13961 and 13961+1000              or ss_wholesale_cost between 49 and 49+20)) B1,      (select avg(ss_list_price) B2_LP             ,count(ss_list_price) B2_CNT             ,count(distinct ss_list_price) B2_CNTD       from store_sales       where ss_quantity between 6 and 10         and (ss_list_price between 184 and 184+10           or ss_coupon_amt between 3157 and 3157+1000           or ss_wholesale_cost between 67 and 67+20)) B2,      (select avg(ss_list_price) B3_LP             ,count(ss_list_price) B3_CNT             ,count(distinct ss_list_price) B3_CNTD       from store_sales       where ss_quantity between 11 and 15         and (ss_list_price between 42 and 42+10           or ss_coupon_amt between 343 and 343+1000           or ss_wholesale_cost between 17 and 17+20)) B3,      (select avg(ss_list_price) B4_LP             ,count(ss_list_price) B4_CNT             ,count(distinct ss_list_price) B4_CNTD       from store_sales       where ss_quantity between 16 and 20         and (ss_list_price between 26 and 26+10           or ss_coupon_amt between 17068 and 17068+1000           or ss_wholesale_cost between 64 and 64+20)) B4,      (select avg(ss_list_price) B5_LP             ,count(ss_list_price) B5_CNT             ,count(distinct ss_list_price) B5_CNTD       from store_sales       where ss_quantity between 21 and 25         and (ss_list_price between 105 and 105+10           or ss_coupon_amt between 10999 and 10999+1000           or ss_wholesale_cost between 66 and 66+20)) B5,      (select avg(ss_list_price) B6_LP             ,count(ss_list_price) B6_CNT             ,count(distinct ss_list_price) B6_CNTD       from store_sales       where ss_quantity between 26 and 30         and (ss_list_price between 112 and 112+10           or ss_coupon_amt between 2469 and 2469+1000           or ss_wholesale_cost between 56 and 56+20)) B6;", "predicates": {"store_sales": ["ss_list_price", "ss_coupon_amt", "ss_quantity", "ss_wholesale_cost"]}, "payload": {"store_sales": ["ss_list_price"]}, "group_by": {}, "order_by": {}}
{"id": 29, "query_string": " select top (100)        i_item_id     ,i_item_desc     ,s_store_id     ,s_store_name     ,sum(ss_quantity)        as store_sales_quantity     ,sum(sr_return_quantity) as store_returns_quantity     ,sum(cs_quantity)        as catalog_sales_quantity  from     store_sales    ,store_returns    ,catalog_sales    ,date_dim             d1    ,date_dim             d2    ,date_dim             d3    ,store    ,item  where      d1.d_moy               = 4   and d1.d_year              = 1998  and d1.d_date_sk           = ss_sold_date_sk  and i_item_sk              = ss_item_sk  and s_store_sk             = ss_store_sk  and ss_customer_sk         = sr_customer_sk  and ss_item_sk             = sr_item_sk  and ss_ticket_number       = sr_ticket_number  and sr_returned_date_sk    = d2.d_date_sk  and d2.d_moy               between 4 and  4 + 3   and d2.d_year              = 1998  and sr_customer_sk         = cs_bill_customer_sk  and sr_item_sk             = cs_item_sk  and cs_sold_date_sk        = d3.d_date_sk       and d3.d_year              in (1998,1998+1,1998+2)  group by     i_item_id    ,i_item_desc    ,s_store_id    ,s_store_name  order by     i_item_id     ,i_item_desc    ,s_store_id    ,s_store_name  ;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_store_name", "s_store_sk", "s_store_id"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_return_quantity", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 30, "query_string": " with customer_total_return as  (select wr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   \tsum(wr_return_amt) as ctr_total_return  from web_returns      ,date_dim      ,customer_address  where wr_returned_date_sk = d_date_sk     and d_year =2002    and wr_returning_addr_sk = ca_address_sk   group by wr_returning_customer_sk          ,ca_state)   select top (100) c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag        ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address        ,c_last_review_date,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  \t\t\t  from customer_total_return ctr2                    \t  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'NC'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag                   ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address                   ,c_last_review_date,ctr_total_return;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_year"]}, "payload": {"customer": ["c_birth_year", "c_login", "c_customer_sk", "c_birth_month", "c_salutation", "c_birth_day", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_current_addr_sk", "c_email_address", "c_customer_id", "c_last_review_date"], "customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "web_returns": ["wr_return_amt", "wr_returning_addr_sk", "wr_returned_date_sk", "wr_returning_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_birth_year", "c_login", "c_birth_month", "c_birth_country", "c_salutation", "c_birth_day", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id", "c_last_review_date"]}}
{"id": 31, "query_string": " with ss as  (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales  from store_sales,date_dim,customer_address  where ss_sold_date_sk = d_date_sk   and ss_addr_sk=ca_address_sk  group by ca_county,d_qoy, d_year),  ws as  (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales  from web_sales,date_dim,customer_address  where ws_sold_date_sk = d_date_sk   and ws_bill_addr_sk=ca_address_sk  group by ca_county,d_qoy, d_year)  select          ss1.ca_county        ,ss1.d_year        ,ws2.web_sales/ws1.web_sales web_q1_q2_increase        ,ss2.store_sales/ss1.store_sales store_q1_q2_increase        ,ws3.web_sales/ws2.web_sales web_q2_q3_increase        ,ss3.store_sales/ss2.store_sales store_q2_q3_increase  from         ss ss1        ,ss ss2        ,ss ss3        ,ws ws1        ,ws ws2        ,ws ws3  where     ss1.d_qoy = 1     and ss1.d_year = 2001     and ss1.ca_county = ss2.ca_county     and ss2.d_qoy = 2     and ss2.d_year = 2001  and ss2.ca_county = ss3.ca_county     and ss3.d_qoy = 3     and ss3.d_year = 2001     and ss1.ca_county = ws1.ca_county     and ws1.d_qoy = 1     and ws1.d_year = 2001     and ws1.ca_county = ws2.ca_county     and ws2.d_qoy = 2     and ws2.d_year = 2001     and ws1.ca_county = ws3.ca_county     and ws3.d_qoy = 3     and ws3.d_year =2001     and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end         > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end     and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end        > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end  order by ss1.d_year;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"customer_address": ["ca_address_sk", "ca_county"], "date_dim": ["d_date_sk", "d_year"], "store_sales": ["ss_sold_date_sk", "ss_addr_sk", "ss_ext_sales_price"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_bill_addr_sk"]}, "group_by": {}, "order_by": {}}
{"id": 32, "query_string": " select top (100) sum(cs_ext_discount_amt)  as \"excess discount amount\"  from     catalog_sales     ,item     ,date_dim where i_manufact_id = 9 and i_item_sk = cs_item_sk  and d_date between '1998-03-04' and          dateadd(day, 90, cast('1998-03-04' as date)) and d_date_sk = cs_sold_date_sk  and cs_ext_discount_amt        > (           select              1.3 * avg(cs_ext_discount_amt)           from              catalog_sales             ,date_dim          where                cs_item_sk = i_item_sk            and d_date between '1998-03-04' and                              dateadd(day, 90, cast('1998-03-04' as date))           and d_date_sk = cs_sold_date_sk        ) ;", "predicates": {"catalog_sales": ["cs_ext_discount_amt"], "date_dim": ["d_date"], "item": ["i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 33, "query_string": " with ss as (  select           i_manufact_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id in (select   i_manufact_id from  item where i_category in ('Electronics'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 5  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  cs as (  select           i_manufact_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Electronics'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 5  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  ws as (  select           i_manufact_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Electronics'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 5  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_manufact_id)   select top (100) i_manufact_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_manufact_id  order by total_sales;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_category"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_addr_sk", "cs_item_sk", "cs_ext_sales_price"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_manufact_id"], "store_sales": ["ss_sold_date_sk", "ss_addr_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk", "ws_bill_addr_sk"]}, "group_by": {}, "order_by": {}}
{"id": 34, "query_string": " select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = 'Unknown')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  \tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  \telse null  \tend)  > 1.2     and date_dim.d_year in (2000,2000+1,2000+2)     and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',                            'Williamson County','Williamson County','Williamson County','Williamson County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;", "predicates": {"date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count", "hd_buy_potential"], "store": ["s_county"]}, "payload": {"customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_preferred_cust_flag"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 35, "query_string": " select top (100)     ca_state,   cd_gender,   cd_marital_status,   cd_dep_count,   count(*) cnt1,   sum(cd_dep_count),   sum(cd_dep_count),   max(cd_dep_count),   cd_dep_employed_count,   count(*) cnt2,   sum(cd_dep_employed_count),   sum(cd_dep_employed_count),   max(cd_dep_employed_count),   cd_dep_college_count,   count(*) cnt3,   sum(cd_dep_college_count),   sum(cd_dep_college_count),   max(cd_dep_college_count)  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2002 and                 d_qoy < 4) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_qoy < 4) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_qoy < 4))  group by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  ;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_state"], "customer_demographics": ["cd_dep_college_count", "cd_gender", "cd_demo_sk", "cd_dep_employed_count", "cd_dep_count", "cd_marital_status"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 36, "query_string": " select top (100)      sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  \tpartition by grouping(i_category)+grouping(i_class),  \tcase when grouping(i_class) = 0 then i_category end   \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent  from     store_sales    ,date_dim       d1    ,item    ,store  where     d1.d_year = 2001   and d1.d_date_sk = ss_sold_date_sk  and i_item_sk  = ss_item_sk   and s_store_sk  = ss_store_sk  and s_state in ('TN','TN','TN','TN',                  'TN','TN','TN','TN')  group by rollup(i_category,i_class)  order by    lochierarchy desc   ,case when (grouping(i_category)+grouping(i_class)) = 0 then i_category end   ,rank_within_parent   ;", "predicates": {"date_dim": ["d_year"], "store": ["s_state"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_class", "i_item_sk", "i_category"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_ext_sales_price", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 37, "query_string": " select top (100) i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 40 and 40 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2002-07-09' as date) and dateadd(day, 60, cast('2002-07-09' as date))  and i_manufact_id in (727,812,885,752)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  ;", "predicates": {"date_dim": ["d_date"], "inventory": ["inv_quantity_on_hand"], "item": ["i_current_price", "i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc", "i_current_price"]}, "group_by": {}, "order_by": {}}
{"id": 38, "query_string": " select top (100) count(*) from (     select distinct c_last_name, c_first_name, d_date     from store_sales, date_dim, customer           where store_sales.ss_sold_date_sk = date_dim.d_date_sk       and store_sales.ss_customer_sk = customer.c_customer_sk       and d_month_seq between 1184 and 1184 + 11   intersect     select distinct c_last_name, c_first_name, d_date     from catalog_sales, date_dim, customer           where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk       and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk       and d_month_seq between 1184 and 1184 + 11   intersect     select distinct c_last_name, c_first_name, d_date     from web_sales, date_dim, customer           where web_sales.ws_sold_date_sk = date_dim.d_date_sk       and web_sales.ws_bill_customer_sk = customer.c_customer_sk       and d_month_seq between 1184 and 1184 + 11 ) hot_cust;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk", "ws_item_sk", "ws_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 39, "query_string": " with inv as (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy        ,stdev,mean, case mean when 0 then null else stdev/mean end cov  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy             ,stdev(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean       from inventory           ,item           ,warehouse           ,date_dim       where inv_item_sk = i_item_sk         and inv_warehouse_sk = w_warehouse_sk         and inv_date_sk = d_date_sk         and d_year =2001       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo  where case mean when 0 then 0 else stdev/mean end > 1) select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov from inv inv1,inv inv2 where inv1.i_item_sk = inv2.i_item_sk   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk   and inv1.d_moy=2   and inv2.d_moy=2+1 order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov         ,inv2.d_moy,inv2.mean, inv2.cov; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_item_sk"], "warehouse": ["w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 40, "query_string": " select top (100)     w_state   ,i_item_id   ,sum(case when (cast(d_date as date) < cast ('2001-02-24' as date))   \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before   ,sum(case when (cast(d_date as date) >= cast ('2001-02-24' as date))   \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after  from    catalog_sales left outer join catalog_returns on        (cs_order_number = cr_order_number          and cs_item_sk = cr_item_sk)   ,warehouse    ,item   ,date_dim  where      i_current_price between 0.99 and 1.49  and i_item_sk          = cs_item_sk  and cs_warehouse_sk    = w_warehouse_sk   and cs_sold_date_sk    = d_date_sk  and d_date between dateadd(day, -30, cast ('2001-02-24' as date))                 and dateadd(day, 30, cast ('2001-02-24' as date))   group by     w_state,i_item_id  order by w_state,i_item_id;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_refunded_cash"], "date_dim": ["d_date_sk", "d_date"], "item": ["i_item_id", "i_item_sk"], "warehouse": ["w_state", "w_warehouse_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_id"], "warehouse": ["w_state"]}}
{"id": 41, "query_string": " select distinct top (100) i_product_name  from item i1  where i_manufact_id between 850 and 850+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'hot' or i_color = 'cornflower') and          (i_units = 'Tsp' or i_units = 'Bunch') and         (i_size = 'economy' or i_size = 'medium')         ) or         (i_category = 'Women' and         (i_color = 'cream' or i_color = 'sienna') and         (i_units = 'Pound' or i_units = 'Tbl') and         (i_size = 'extra large' or i_size = 'large')         ) or         (i_category = 'Men' and         (i_color = 'metallic' or i_color = 'goldenrod') and         (i_units = 'Unknown' or i_units = 'Oz') and         (i_size = 'small' or i_size = 'petite')         ) or         (i_category = 'Men' and         (i_color = 'navajo' or i_color = 'drab') and         (i_units = 'Ton' or i_units = 'Dozen') and         (i_size = 'economy' or i_size = 'medium')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'antique' or i_color = 'burlywood') and          (i_units = 'Gram' or i_units = 'Case') and         (i_size = 'economy' or i_size = 'medium')         ) or         (i_category = 'Women' and         (i_color = 'seashell' or i_color = 'mint') and         (i_units = 'Each' or i_units = 'N/A') and         (i_size = 'extra large' or i_size = 'large')         ) or         (i_category = 'Men' and         (i_color = 'red' or i_color = 'steel') and         (i_units = 'Pallet' or i_units = 'Lb') and         (i_size = 'small' or i_size = 'petite')         ) or         (i_category = 'Men' and         (i_color = 'lawn' or i_color = 'pink') and         (i_units = 'Bundle' or i_units = 'Cup') and         (i_size = 'economy' or i_size = 'medium')         )))) > 0  order by i_product_name  ;", "predicates": {"item": ["i_color", "i_units", "i_manufact_id", "i_category", "i_size", "i_manufact"]}, "payload": {"item": ["i_color", "i_units", "i_product_name", "i_category", "i_size", "i_manufact"]}, "group_by": {}, "order_by": {}}
{"id": 42, "query_string": " select top (100) dt.d_year  \t,item.i_category_id  \t,item.i_category  \t,sum(ss_ext_sales_price)  from \tdate_dim dt  \t,store_sales  \t,item  where dt.d_date_sk = store_sales.ss_sold_date_sk  \tand store_sales.ss_item_sk = item.i_item_sk  \tand item.i_manager_id = 1  \t  \tand dt.d_moy=12  \tand dt.d_year=2001  group by \tdt.d_year  \t\t,item.i_category_id  \t\t,item.i_category  order by       sum(ss_ext_sales_price) desc,dt.d_year  \t\t,item.i_category_id  \t\t,item.i_category  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_item_sk", "i_category", "i_category_id"]}, "group_by": {}, "order_by": {"item": ["i_category", "i_category_id"]}}
{"id": 43, "query_string": " select top (100) s_store_name, s_store_id,         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales  from date_dim, store_sales, store  where d_date_sk = ss_sold_date_sk and        s_store_sk = ss_store_sk and        s_gmt_offset = -5 and        d_year = 2001   group by s_store_name, s_store_id  order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales  ;", "predicates": {"date_dim": ["d_year"], "store": ["s_gmt_offset"]}, "payload": {"date_dim": ["d_date_sk", "d_day_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 44, "query_string": " select top (100) asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing from(select *      from (select item_sk,rank() over (order by rank_col asc) rnk            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col                   from store_sales ss1                  where ss_store_sk = 2                  group by ss_item_sk                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col                                                   from store_sales                                                   where ss_store_sk = 2                                                     and ss_addr_sk is null                                                   group by ss_store_sk))V1)V11      where rnk  < 11) asceding,     (select *      from (select item_sk,rank() over (order by rank_col desc) rnk            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col                  from store_sales ss1                  where ss_store_sk = 2                  group by ss_item_sk                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col                                                   from store_sales                                                   where ss_store_sk = 2                                                     and ss_addr_sk is null                                                   group by ss_store_sk))V2)V21      where rnk  < 11) descending, item i1, item i2 where asceding.rnk = descending.rnk    and i1.i_item_sk=asceding.item_sk   and i2.i_item_sk=descending.item_sk order by asceding.rnk;", "predicates": {"store_sales": ["ss_store_sk", "ss_customer_sk"]}, "payload": {"store_sales": ["ss_net_profit", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 45, "query_string": " select top (100) ca_zip, ca_city, sum(ws_sales_price)  from web_sales, customer, customer_address, date_dim, item  where ws_bill_customer_sk = c_customer_sk  \tand c_current_addr_sk = ca_address_sk   \tand ws_item_sk = i_item_sk   \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')  \t      or   \t      i_item_id in (select i_item_id                              from item                              where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)                              )  \t    )  \tand ws_sold_date_sk = d_date_sk  \tand d_qoy = 1 and d_year = 1999  group by ca_zip, ca_city  order by ca_zip, ca_city  ;", "predicates": {"customer_address": ["ca_zip"], "date_dim": ["d_qoy", "d_year"], "item": ["i_item_id"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip", "ca_city"], "date_dim": ["d_date_sk"], "web_sales": ["ws_sales_price", "ws_sold_date_sk", "ws_bill_customer_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 46, "query_string": " select top (100) c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,ca_city bought_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics,customer_address      where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and (household_demographics.hd_dep_count = 5 or          household_demographics.hd_vehicle_count= 0)     and date_dim.d_dow in (6,0)     and date_dim.d_year in (1999,1999+1,1999+2)      and store.s_city in ('Midway','Fairview','Midway','Fairview','Fairview')      group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr     where ss_customer_sk = c_customer_sk       and customer.c_current_addr_sk = current_addr.ca_address_sk       and current_addr.ca_city <> bought_city   order by c_last_name           ,c_first_name           ,ca_city           ,bought_city           ,ss_ticket_number   ;", "predicates": {"date_dim": ["d_dow", "d_year"], "household_demographics": ["hd_vehicle_count", "hd_dep_count"], "store": ["s_city"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk", "c_first_name", "c_last_name"], "customer_address": ["ca_city", "ca_address_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_addr_sk", "ss_coupon_amt", "ss_customer_sk", "ss_hdemo_sk", "ss_net_profit", "ss_sold_date_sk", "ss_store_sk", "ss_ticket_number"]}, "group_by": {}, "order_by": {}}
{"id": 47, "query_string": " with v1 as(  select i_category, i_brand,         s_store_name, s_company_name,         d_year, d_moy,         sum(ss_sales_price) sum_sales,         avg(sum(ss_sales_price)) over           (partition by i_category, i_brand,                      s_store_name, s_company_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      s_store_name, s_company_name            order by d_year, d_moy) rn  from item, store_sales, date_dim, store  where ss_item_sk = i_item_sk and        ss_sold_date_sk = d_date_sk and        ss_store_sk = s_store_sk and        (          d_year = 2000 or          ( d_year = 2000-1 and d_moy =12) or          ( d_year = 2000+1 and d_moy =1)        )  group by i_category, i_brand,           s_store_name, s_company_name,           d_year, d_moy),  v2 as(  select v1.s_company_name         ,v1.d_year, v1.d_moy         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1.s_store_name = v1_lag.s_store_name and        v1.s_store_name = v1_lead.s_store_name and        v1.s_company_name = v1_lag.s_company_name and        v1.s_company_name = v1_lead.s_company_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select top (100) *  from v2  where  d_year = 2000 and             avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, avg_monthly_sales  ;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk", "d_moy", "d_year"], "item": ["i_brand", "i_item_sk", "i_category"], "store": ["s_store_name", "s_store_sk", "s_company_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 48, "query_string": " select sum (ss_quantity)  from store_sales, store, customer_demographics, customer_address, date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2001  and    (   (    cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'M'    and     cd_education_status = 'Advanced Degree'    and     ss_sales_price between 100.00 and 150.00      )  or   (   cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'U'    and     cd_education_status = 'College'    and     ss_sales_price between 50.00 and 100.00      )  or   (   cd_demo_sk = ss_cdemo_sk   and     cd_marital_status = 'D'    and     cd_education_status = 'Secondary'    and     ss_sales_price between 150.00 and 200.00    )  )  and  (   (   ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('ND', 'NE', 'MI')   and ss_net_profit between 0 and 2000     )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('WI', 'VA', 'CO')   and ss_net_profit between 150 and 3000    )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('OH', 'MN', 'AK')   and ss_net_profit between 50 and 25000    )  );", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "store_sales": ["ss_sales_price", "ss_net_profit"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_cdemo_sk", "ss_addr_sk", "ss_quantity", "ss_sales_price", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 49, "query_string": " select top (100) channel, item, return_ratio, return_rank, currency_rank from  (select  'web' as channel  ,web.item  ,web.return_ratio  ,web.return_rank  ,web.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect ws.ws_item_sk as item  \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\t web_sales ws left outer join web_returns wr   \t\t\ton (ws.ws_order_number = wr.wr_order_number and   \t\t\tws.ws_item_sk = wr.wr_item_sk)                  ,date_dim  \t\twhere   \t\t\twr.wr_return_amt > 10000   \t\t\tand ws.ws_net_profit > 1                          and ws.ws_net_paid > 0                          and ws.ws_quantity > 0                          and ws_sold_date_sk = d_date_sk                          and d_year = 2001                          and d_moy = 12  \t\tgroup by ws.ws_item_sk  \t) in_web  ) web  where   (  web.return_rank <= 10  or  web.currency_rank <= 10  )  union  select   'catalog' as channel  ,catalog.item  ,catalog.return_ratio  ,catalog.return_rank  ,catalog.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect   \t\tcs.cs_item_sk as item  \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\tcatalog_sales cs left outer join catalog_returns cr  \t\t\ton (cs.cs_order_number = cr.cr_order_number and   \t\t\tcs.cs_item_sk = cr.cr_item_sk)                 ,date_dim  \t\twhere   \t\t\tcr.cr_return_amount > 10000   \t\t\tand cs.cs_net_profit > 1                          and cs.cs_net_paid > 0                          and cs.cs_quantity > 0                          and cs_sold_date_sk = d_date_sk                          and d_year = 2001                          and d_moy = 12                  group by cs.cs_item_sk  \t) in_cat  ) catalog  where   (  catalog.return_rank <= 10  or  catalog.currency_rank <=10  )  union  select   'store' as channel  ,store.item  ,store.return_ratio  ,store.return_rank  ,store.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect sts.ss_item_sk as item  \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\tstore_sales sts left outer join store_returns sr  \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)                 ,date_dim  \t\twhere   \t\t\tsr.sr_return_amt > 10000   \t\t\tand sts.ss_net_profit > 1                          and sts.ss_net_paid > 0                           and sts.ss_quantity > 0                          and ss_sold_date_sk = d_date_sk                          and d_year = 2001                          and d_moy = 12  \t\tgroup by sts.ss_item_sk  \t) in_store  ) store  where  (  store.return_rank <= 10  or   store.currency_rank <= 10  )  ) a  order by 1,4,5,2  ;", "predicates": {"catalog_returns": ["cr_return_amount"], "catalog_sales": ["cs_net_paid", "cs_net_profit", "cs_quantity"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_return_amt"], "store_sales": ["ss_net_paid", "ss_quantity", "ss_net_profit"], "web_returns": ["wr_return_amt"], "web_sales": ["ws_net_profit", "ws_net_paid", "ws_quantity"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_quantity", "cr_return_amount"], "store_returns": ["sr_return_amt", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_return_amt", "wr_return_quantity", "wr_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 50, "query_string": " select top (100)     s_store_name   ,s_company_id   ,s_street_number   ,s_street_name   ,s_street_type   ,s_suite_number   ,s_city   ,s_county   ,s_state   ,s_zip   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and                   (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and                   (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and                  (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    store_sales   ,store_returns   ,store   ,date_dim d1   ,date_dim d2 where     d2.d_year = 2001 and d2.d_moy  = 9 and ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_sold_date_sk   = d1.d_date_sk and sr_returned_date_sk   = d2.d_date_sk and ss_customer_sk = sr_customer_sk and ss_store_sk = s_store_sk group by    s_store_name   ,s_company_id   ,s_street_number   ,s_street_name   ,s_street_type   ,s_suite_number   ,s_city   ,s_county   ,s_state   ,s_zip order by s_store_name         ,s_company_id         ,s_street_number         ,s_street_name         ,s_street_type         ,s_suite_number         ,s_city         ,s_county         ,s_state         ,s_zip;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 51, "query_string": " WITH web_v1 as ( select   ws_item_sk item_sk, d_date,   sum(sum(ws_sales_price))       over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from web_sales     ,date_dim where ws_sold_date_sk=d_date_sk   and d_month_seq between 1184 and 1184+11   and ws_item_sk is not NULL group by ws_item_sk, d_date), store_v1 as ( select   ss_item_sk item_sk, d_date,   sum(sum(ss_sales_price))       over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from store_sales     ,date_dim where ss_sold_date_sk=d_date_sk   and d_month_seq between 1184 and 1184+11   and ss_item_sk is not NULL group by ss_item_sk, d_date)  select top (100) * from (select item_sk      ,d_date      ,web_sales      ,store_sales      ,max(web_sales)          over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative      ,max(store_sales)          over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative      from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk                  ,case when web.d_date is not null then web.d_date else store.d_date end d_date                  ,web.cume_sales web_sales                  ,store.cume_sales store_sales            from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk                                                           and web.d_date = store.d_date)           )x )y where web_cumulative > store_cumulative order by item_sk         ,d_date;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_sales_price", "ss_item_sk"], "web_sales": ["ws_sold_date_sk", "ws_sales_price", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 52, "query_string": " select top (100) dt.d_year  \t,item.i_brand_id brand_id  \t,item.i_brand brand  \t,sum(ss_ext_sales_price) ext_price  from date_dim dt      ,store_sales      ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=2001  group by dt.d_year  \t,item.i_brand  \t,item.i_brand_id  order by dt.d_year  \t,ext_price desc  \t,brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"item": ["i_brand_id"]}}
{"id": 53, "query_string": " select top (100) * from  (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1184,1184+1,1184+2,1184+3,1184+4,1184+5,1184+6,1184+7,1184+8,1184+9,1184+10,1184+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', \t\t'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', \t\t'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0  \tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales  \telse null end > 0.1 order by avg_quarterly_sales, \t sum_sales, \t i_manufact_id;", "predicates": {"date_dim": ["d_month_seq"], "item": ["i_brand", "i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_qoy"], "item": ["i_item_sk", "i_manufact_id", "i_brand", "i_category", "i_class"], "store": ["s_store_sk"]}, "group_by": {}, "order_by": {}}
{"id": 54, "query_string": " with my_customers as (  select distinct c_customer_sk         , c_current_addr_sk  from            ( select cs_sold_date_sk sold_date_sk,                  cs_bill_customer_sk customer_sk,                  cs_item_sk item_sk           from   catalog_sales           union all           select ws_sold_date_sk sold_date_sk,                  ws_bill_customer_sk customer_sk,                  ws_item_sk item_sk           from   web_sales          ) cs_or_ws_sales,          item,          date_dim,          customer  where   sold_date_sk = d_date_sk          and item_sk = i_item_sk          and i_category = 'Children'          and i_class = 'infants'          and c_customer_sk = cs_or_ws_sales.customer_sk          and d_moy = 5          and d_year = 2001  )  , my_revenue as (  select c_customer_sk,         sum(ss_ext_sales_price) as revenue  from   my_customers,         store_sales,         customer_address,         store,         date_dim  where  c_current_addr_sk = ca_address_sk         and ca_county = s_county         and ca_state = s_state         and ss_sold_date_sk = d_date_sk         and c_customer_sk = ss_customer_sk         and d_month_seq between (select distinct d_month_seq+1                                  from   date_dim where d_year = 2001 and d_moy = 5)                            and  (select distinct d_month_seq+3                                  from   date_dim where d_year = 2001 and d_moy = 5)  group by c_customer_sk  )  , segments as  (select cast((revenue/50) as int) as segment   from   my_revenue  )   select top (100) segment, count(*) as num_customers, segment*50 as segment_base  from segments  group by segment  order by segment, num_customers  ;", "predicates": {"date_dim": ["d_month_seq", "d_moy", "d_year"], "item": ["i_class", "i_category"]}, "payload": {"customer_address": ["ca_address_sk", "ca_county", "ca_state"], "date_dim": ["d_date_sk", "d_month_seq"], "item": ["i_item_sk"], "store": ["s_state", "s_county"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_ext_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 55, "query_string": " select top (100) i_brand_id brand_id, i_brand brand,  \tsum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item  where d_date_sk = ss_sold_date_sk  \tand ss_item_sk = i_item_sk  \tand i_manager_id=71  \tand d_moy=12  \tand d_year=2001  group by i_brand, i_brand_id  order by ext_price desc, i_brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"item": ["i_brand_id"]}}
{"id": 56, "query_string": " with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('green','cyan','honeydew'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 5  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('green','cyan','honeydew'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 5  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('green','cyan','honeydew'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 5  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_item_id)   select top (100) i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  ;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_color"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 57, "query_string": " with v1 as(  select i_category, i_brand,         cc_name,         d_year, d_moy,         sum(cs_sales_price) sum_sales,         avg(sum(cs_sales_price)) over           (partition by i_category, i_brand,                      cc_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      cc_name            order by d_year, d_moy) rn  from item, catalog_sales, date_dim, call_center  where cs_item_sk = i_item_sk and        cs_sold_date_sk = d_date_sk and        cc_call_center_sk= cs_call_center_sk and        (          d_year = 2000 or          ( d_year = 2000-1 and d_moy =12) or          ( d_year = 2000+1 and d_moy =1)        )  group by i_category, i_brand,           cc_name , d_year, d_moy),  v2 as(  select v1.i_category         ,v1.d_year, v1.d_moy         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1. cc_name = v1_lag. cc_name and        v1. cc_name = v1_lead. cc_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select top (100) *  from v2  where  d_year = 2000 and         avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, avg_monthly_sales  ;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"call_center": ["cc_name", "cc_call_center_sk"], "catalog_sales": ["cs_sales_price", "cs_sold_date_sk", "cs_call_center_sk", "cs_item_sk"], "date_dim": ["d_date_sk", "d_moy", "d_year"], "item": ["i_brand", "i_item_sk", "i_category"]}, "group_by": {}, "order_by": {}}
{"id": 58, "query_string": " with ss_items as  (select i_item_id item_id         ,sum(ss_ext_sales_price) ss_item_rev   from store_sales      ,item      ,date_dim  where ss_item_sk = i_item_sk    and d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2001-07-17'))    and ss_sold_date_sk   = d_date_sk  group by i_item_id),  cs_items as  (select i_item_id item_id         ,sum(cs_ext_sales_price) cs_item_rev   from catalog_sales       ,item       ,date_dim  where cs_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2001-07-17'))   and  cs_sold_date_sk = d_date_sk  group by i_item_id),  ws_items as  (select i_item_id item_id         ,sum(ws_ext_sales_price) ws_item_rev   from web_sales       ,item       ,date_dim  where ws_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq =(select d_week_seq                                       from date_dim                                      where d_date = '2001-07-17'))   and ws_sold_date_sk   = d_date_sk  group by i_item_id)   select top (100) ss_items.item_id        ,ss_item_rev        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev        ,cs_item_rev        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev        ,ws_item_rev        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average  from ss_items,cs_items,ws_items  where ss_items.item_id=cs_items.item_id    and ss_items.item_id=ws_items.item_id     and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  order by item_id          ,ss_item_rev  ;", "predicates": {"date_dim": ["d_week_seq", "d_date"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_item_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "item": ["i_item_id", "i_item_sk"], "store_sales": ["ss_sold_date_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 59, "query_string": " with wss as   (select d_week_seq,         ss_store_sk,         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales  from store_sales,date_dim  where d_date_sk = ss_sold_date_sk  group by d_week_seq,ss_store_sk  )   select top (100) s_store_name1,s_store_id1,d_week_seq1        ,sun_sales1/sun_sales2,mon_sales1/mon_sales2        ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2        ,fri_sales1/fri_sales2,sat_sales1/sat_sales2  from  (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1         ,s_store_id s_store_id1,sun_sales sun_sales1         ,mon_sales mon_sales1,tue_sales tue_sales1         ,wed_sales wed_sales1,thu_sales thu_sales1         ,fri_sales fri_sales1,sat_sales sat_sales1   from wss,store,date_dim d   where d.d_week_seq = wss.d_week_seq and         ss_store_sk = s_store_sk and          d_month_seq between 1187 and 1187 + 11) y,  (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2         ,s_store_id s_store_id2,sun_sales sun_sales2         ,mon_sales mon_sales2,tue_sales tue_sales2         ,wed_sales wed_sales2,thu_sales thu_sales2         ,fri_sales fri_sales2,sat_sales sat_sales2   from wss,store,date_dim d   where d.d_week_seq = wss.d_week_seq and         ss_store_sk = s_store_sk and          d_month_seq between 1187+ 12 and 1187 + 23) x  where s_store_id1=s_store_id2    and d_week_seq1=d_week_seq2-52  order by s_store_name1,s_store_id1,d_week_seq1;", "predicates": {"date_dim": ["d_month_seq"], "store": ["s_store_id"]}, "payload": {"date_dim": ["d_date_sk", "d_week_seq", "d_day_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 60, "query_string": " with ss as (  select           i_item_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where          i_item_id in (select   i_item_id from  item where i_category in ('Music'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 9  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -7   group by i_item_id),  cs as (  select           i_item_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Music'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 9  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -7   group by i_item_id),  ws as (  select           i_item_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Music'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 9  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -7  group by i_item_id)   select top (100)     i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by i_item_id       ,total_sales  ;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_item_id", "i_category"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 61, "query_string": " select top (100) promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from   (select sum(ss_ext_sales_price) promotions    from  store_sales         ,store         ,promotion         ,date_dim         ,customer         ,customer_address          ,item    where ss_sold_date_sk = d_date_sk    and   ss_store_sk = s_store_sk    and   ss_promo_sk = p_promo_sk    and   ss_customer_sk= c_customer_sk    and   ca_address_sk = c_current_addr_sk    and   ss_item_sk = i_item_sk     and   ca_gmt_offset = -7    and   i_category = 'Electronics'    and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')    and   s_gmt_offset = -7    and   d_year = 2001    and   d_moy  = 12) promotional_sales,   (select sum(ss_ext_sales_price) total    from  store_sales         ,store         ,date_dim         ,customer         ,customer_address         ,item    where ss_sold_date_sk = d_date_sk    and   ss_store_sk = s_store_sk    and   ss_customer_sk= c_customer_sk    and   ca_address_sk = c_current_addr_sk    and   ss_item_sk = i_item_sk    and   ca_gmt_offset = -7    and   i_category = 'Electronics'    and   s_gmt_offset = -7    and   d_year = 2001    and   d_moy  = 12) all_sales order by promotions, total;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_category"], "promotion": ["p_channel_dmail", "p_channel_email", "p_channel_tv"], "store": ["s_gmt_offset"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_promo_sk", "ss_item_sk", "ss_ext_sales_price", "ss_customer_sk", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 62, "query_string": " select top (100)     substring(w_warehouse_name,1,20)   ,sm_type   ,web_name   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and                   (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and                   (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and                  (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    web_sales   ,warehouse   ,ship_mode   ,web_site   ,date_dim where     d_month_seq between 1184 and 1184 + 11 and ws_ship_date_sk   = d_date_sk and ws_warehouse_sk   = w_warehouse_sk and ws_ship_mode_sk   = sm_ship_mode_sk and ws_web_site_sk    = web_site_sk group by    substring(w_warehouse_name,1,20)   ,sm_type   ,web_name order by substring(w_warehouse_name,1,20)         ,sm_type        ,web_name;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "ship_mode": ["sm_type", "sm_ship_mode_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"], "web_sales": ["ws_ship_date_sk", "ws_ship_mode_sk", "ws_sold_date_sk", "ws_warehouse_sk", "ws_web_site_sk"], "web_site": ["web_name", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 63, "query_string": " select top (100) *  from (select i_manager_id              ,sum(ss_sales_price) sum_sales              ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales       from item           ,store_sales           ,date_dim           ,store       where ss_item_sk = i_item_sk         and ss_sold_date_sk = d_date_sk         and ss_store_sk = s_store_sk         and d_month_seq in (1184,1184+1,1184+2,1184+3,1184+4,1184+5,1184+6,1184+7,1184+8,1184+9,1184+10,1184+11)         and ((    i_category in ('Books','Children','Electronics')               and i_class in ('personal','portable','reference','self-help')               and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', \t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))            or(    i_category in ('Women','Music','Men')               and i_class in ('accessories','classical','fragrances','pants')               and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', \t\t                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id         ,avg_monthly_sales         ,sum_sales;", "predicates": {"date_dim": ["d_month_seq"], "item": ["i_brand", "i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_item_sk", "i_manager_id", "i_brand", "i_category", "i_class"], "store": ["s_store_sk"]}, "group_by": {}, "order_by": {"item": ["i_manager_id"]}}
{"id": 64, "query_string": " with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('tomato','cream','maroon','chocolate','sky','sienna') and          i_current_price between 7 and 7 + 10 and          i_current_price between 7 + 1 and 7 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;", "predicates": {"customer_demographics": ["cd_marital_status"], "date_dim": ["d_year"], "item": ["i_color", "i_current_price"], "store": ["s_zip", "s_store_name"]}, "payload": {"household_demographics": ["hd_income_band_sk", "hd_demo_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 65, "query_string": " select top (100) \ts_store_name, \ti_item_desc, \tsc.revenue, \ti_current_price, \ti_wholesale_cost, \ti_brand  from store, item,      (select ss_store_sk, avg(revenue) as ave  \tfrom  \t    (select  ss_store_sk, ss_item_sk,   \t\t     sum(ss_sales_price) as revenue  \t\tfrom store_sales, date_dim  \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1184 and 1184+11  \t\tgroup by ss_store_sk, ss_item_sk) sa  \tgroup by ss_store_sk) sb,      (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue  \tfrom store_sales, date_dim  \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1184 and 1184+11  \tgroup by ss_store_sk, ss_item_sk) sc  where sb.ss_store_sk = sc.ss_store_sk and         sc.revenue <= 0.1 * sb.ave and        s_store_sk = sc.ss_store_sk and        i_item_sk = sc.ss_item_sk  order by s_store_name, i_item_desc;", "predicates": {"date_dim": ["d_month_seq"], "store_sales": ["ss_store_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_brand", "i_wholesale_cost", "i_item_desc"], "store": ["s_store_name", "s_store_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price", "ss_item_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_desc"], "store": ["s_store_name"]}}
{"id": 66, "query_string": " select top (100)            w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country         ,ship_carriers         ,year  \t,sum(jan_sales) as jan_sales  \t,sum(feb_sales) as feb_sales  \t,sum(mar_sales) as mar_sales  \t,sum(apr_sales) as apr_sales  \t,sum(may_sales) as may_sales  \t,sum(jun_sales) as jun_sales  \t,sum(jul_sales) as jul_sales  \t,sum(aug_sales) as aug_sales  \t,sum(sep_sales) as sep_sales  \t,sum(oct_sales) as oct_sales  \t,sum(nov_sales) as nov_sales  \t,sum(dec_sales) as dec_sales  \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot  \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot  \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot  \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot  \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot  \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot  \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot  \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot  \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot  \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot  \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot  \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot  \t,sum(jan_net) as jan_net  \t,sum(feb_net) as feb_net  \t,sum(mar_net) as mar_net  \t,sum(apr_net) as apr_net  \t,sum(may_net) as may_net  \t,sum(jun_net) as jun_net  \t,sum(jul_net) as jul_net  \t,sum(aug_net) as aug_net  \t,sum(sep_net) as sep_net  \t,sum(oct_net) as oct_net  \t,sum(nov_net) as nov_net  \t,sum(dec_net) as dec_net  from (      select   \tw_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,concat('BOXBUNDLES' , ',' , 'DIAMOND') as ship_carriers        ,d_year as year  \t,sum(case when d_moy = 1   \t\tthen ws_sales_price* ws_quantity else 0 end) as jan_sales  \t,sum(case when d_moy = 2   \t\tthen ws_sales_price* ws_quantity else 0 end) as feb_sales  \t,sum(case when d_moy = 3   \t\tthen ws_sales_price* ws_quantity else 0 end) as mar_sales  \t,sum(case when d_moy = 4   \t\tthen ws_sales_price* ws_quantity else 0 end) as apr_sales  \t,sum(case when d_moy = 5   \t\tthen ws_sales_price* ws_quantity else 0 end) as may_sales  \t,sum(case when d_moy = 6   \t\tthen ws_sales_price* ws_quantity else 0 end) as jun_sales  \t,sum(case when d_moy = 7   \t\tthen ws_sales_price* ws_quantity else 0 end) as jul_sales  \t,sum(case when d_moy = 8   \t\tthen ws_sales_price* ws_quantity else 0 end) as aug_sales  \t,sum(case when d_moy = 9   \t\tthen ws_sales_price* ws_quantity else 0 end) as sep_sales  \t,sum(case when d_moy = 10   \t\tthen ws_sales_price* ws_quantity else 0 end) as oct_sales  \t,sum(case when d_moy = 11  \t\tthen ws_sales_price* ws_quantity else 0 end) as nov_sales  \t,sum(case when d_moy = 12  \t\tthen ws_sales_price* ws_quantity else 0 end) as dec_sales  \t,sum(case when d_moy = 1   \t\tthen ws_net_paid * ws_quantity else 0 end) as jan_net  \t,sum(case when d_moy = 2  \t\tthen ws_net_paid * ws_quantity else 0 end) as feb_net  \t,sum(case when d_moy = 3   \t\tthen ws_net_paid * ws_quantity else 0 end) as mar_net  \t,sum(case when d_moy = 4   \t\tthen ws_net_paid * ws_quantity else 0 end) as apr_net  \t,sum(case when d_moy = 5   \t\tthen ws_net_paid * ws_quantity else 0 end) as may_net  \t,sum(case when d_moy = 6   \t\tthen ws_net_paid * ws_quantity else 0 end) as jun_net  \t,sum(case when d_moy = 7   \t\tthen ws_net_paid * ws_quantity else 0 end) as jul_net  \t,sum(case when d_moy = 8   \t\tthen ws_net_paid * ws_quantity else 0 end) as aug_net  \t,sum(case when d_moy = 9   \t\tthen ws_net_paid * ws_quantity else 0 end) as sep_net  \t,sum(case when d_moy = 10   \t\tthen ws_net_paid * ws_quantity else 0 end) as oct_net  \t,sum(case when d_moy = 11  \t\tthen ws_net_paid * ws_quantity else 0 end) as nov_net  \t,sum(case when d_moy = 12  \t\tthen ws_net_paid * ws_quantity else 0 end) as dec_net      from           web_sales          ,warehouse          ,date_dim          ,time_dim  \t  ,ship_mode      where             ws_warehouse_sk =  w_warehouse_sk         and ws_sold_date_sk = d_date_sk         and ws_sold_time_sk = t_time_sk  \tand ws_ship_mode_sk = sm_ship_mode_sk         and d_year = 2002  \tand t_time between 40739 and 40739+28800   \tand sm_carrier in ('BOXBUNDLES','DIAMOND')      group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country        ,d_year  union all      select   \tw_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,concat('BOXBUNDLES', ',', 'DIAMOND') as ship_carriers        ,d_year as year  \t,sum(case when d_moy = 1   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jan_sales  \t,sum(case when d_moy = 2   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as feb_sales  \t,sum(case when d_moy = 3   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as mar_sales  \t,sum(case when d_moy = 4   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as apr_sales  \t,sum(case when d_moy = 5   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as may_sales  \t,sum(case when d_moy = 6   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jun_sales  \t,sum(case when d_moy = 7   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jul_sales  \t,sum(case when d_moy = 8   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as aug_sales  \t,sum(case when d_moy = 9   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as sep_sales  \t,sum(case when d_moy = 10   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as oct_sales  \t,sum(case when d_moy = 11  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as nov_sales  \t,sum(case when d_moy = 12  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as dec_sales  \t,sum(case when d_moy = 1   \t\tthen cs_net_profit * cs_quantity else 0 end) as jan_net  \t,sum(case when d_moy = 2   \t\tthen cs_net_profit * cs_quantity else 0 end) as feb_net  \t,sum(case when d_moy = 3   \t\tthen cs_net_profit * cs_quantity else 0 end) as mar_net  \t,sum(case when d_moy = 4   \t\tthen cs_net_profit * cs_quantity else 0 end) as apr_net  \t,sum(case when d_moy = 5   \t\tthen cs_net_profit * cs_quantity else 0 end) as may_net  \t,sum(case when d_moy = 6   \t\tthen cs_net_profit * cs_quantity else 0 end) as jun_net  \t,sum(case when d_moy = 7   \t\tthen cs_net_profit * cs_quantity else 0 end) as jul_net  \t,sum(case when d_moy = 8   \t\tthen cs_net_profit * cs_quantity else 0 end) as aug_net  \t,sum(case when d_moy = 9   \t\tthen cs_net_profit * cs_quantity else 0 end) as sep_net  \t,sum(case when d_moy = 10   \t\tthen cs_net_profit * cs_quantity else 0 end) as oct_net  \t,sum(case when d_moy = 11  \t\tthen cs_net_profit * cs_quantity else 0 end) as nov_net  \t,sum(case when d_moy = 12  \t\tthen cs_net_profit * cs_quantity else 0 end) as dec_net      from           catalog_sales          ,warehouse          ,date_dim          ,time_dim  \t ,ship_mode      where             cs_warehouse_sk =  w_warehouse_sk         and cs_sold_date_sk = d_date_sk         and cs_sold_time_sk = t_time_sk  \tand cs_ship_mode_sk = sm_ship_mode_sk         and d_year = 2002  \tand t_time between 40739 AND 40739+28800   \tand sm_carrier in ('BOXBUNDLES','DIAMOND')      group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country        ,d_year  ) x  group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,ship_carriers        ,year  order by w_warehouse_name  ;", "predicates": {"date_dim": ["d_year"], "ship_mode": ["sm_carrier"], "time_dim": ["t_time"]}, "payload": {"catalog_sales": ["cs_warehouse_sk", "cs_ext_list_price", "cs_quantity", "cs_net_paid_inc_tax", "cs_ship_mode_sk", "cs_sold_date_sk", "cs_sold_time_sk"], "date_dim": ["d_date_sk", "d_moy", "d_year"], "ship_mode": ["sm_ship_mode_sk"], "time_dim": ["t_time_sk"], "web_sales": ["ws_ship_mode_sk", "ws_ext_list_price", "ws_sold_date_sk", "ws_quantity", "ws_sold_time_sk", "ws_warehouse_sk", "ws_net_paid"]}, "group_by": {}, "order_by": {}}
{"id": 67, "query_string": " select top (100) * from (select i_category             ,i_class             ,i_brand             ,i_product_name             ,d_year             ,d_qoy             ,d_moy             ,s_store_id             ,sumsales             ,rank() over (partition by i_category order by sumsales desc) rk       from (select i_category                   ,i_class                   ,i_brand                   ,i_product_name                   ,d_year                   ,d_qoy                   ,d_moy                   ,s_store_id                   ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales             from store_sales                 ,date_dim                 ,store                 ,item        where  ss_sold_date_sk=d_date_sk           and ss_item_sk=i_item_sk           and ss_store_sk = s_store_sk           and d_month_seq between 1184 and 1184+11        group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 order by i_category         ,i_class         ,i_brand         ,i_product_name         ,d_year         ,d_qoy         ,d_moy         ,s_store_id         ,sumsales         ,rk;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk", "d_moy", "d_qoy", "d_year"], "item": ["i_item_sk", "i_brand", "i_product_name", "i_category", "i_class"], "store": ["s_store_sk", "s_store_id"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_sales_price", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {"date_dim": ["d_moy", "d_qoy", "d_year"], "item": ["i_brand", "i_class", "i_product_name", "i_category"], "store": ["s_store_id"]}}
{"id": 68, "query_string": " select top (100) c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,extended_price        ,extended_tax        ,list_price  from (select ss_ticket_number              ,ss_customer_sk              ,ca_city bought_city              ,sum(ss_ext_sales_price) extended_price               ,sum(ss_ext_list_price) list_price              ,sum(ss_ext_tax) extended_tax         from store_sales            ,date_dim            ,store            ,household_demographics            ,customer_address         where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_store_sk = store.s_store_sk           and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk         and store_sales.ss_addr_sk = customer_address.ca_address_sk         and date_dim.d_dom between 1 and 2          and (household_demographics.hd_dep_count = 8 or              household_demographics.hd_vehicle_count= 2)         and date_dim.d_year in (2000,2000+1,2000+2)         and store.s_city in ('Fairview','Midway')        group by ss_ticket_number                ,ss_customer_sk                ,ss_addr_sk,ca_city) dn       ,customer       ,customer_address current_addr  where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name          ,ss_ticket_number  ;", "predicates": {"customer_address": ["ca_city"], "date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_city"]}, "payload": {"customer": ["c_current_addr_sk", "c_first_name", "c_last_name", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_city"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_ext_sales_price", "ss_addr_sk", "ss_customer_sk", "ss_ticket_number", "ss_ext_list_price", "ss_ext_tax", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 69, "query_string": " select top (100)    cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_state in ('MD','TX','UT') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2001 and                 d_moy between 3 and 3+2) and    (not exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 3 and 3+2) and     not exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 3 and 3+2))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  ;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 70, "query_string": " select top (100)      sum(ss_net_profit) as total_sum    ,s_state    ,s_county    ,grouping(s_state)+grouping(s_county) as lochierarchy    ,rank() over (  \tpartition by grouping(s_state)+grouping(s_county),  \tcase when grouping(s_county) = 0 then s_state end   \torder by sum(ss_net_profit) desc) as rank_within_parent  from     store_sales    ,date_dim       d1    ,store  where     d1.d_month_seq between 1184 and 1184+11  and d1.d_date_sk = ss_sold_date_sk  and s_store_sk  = ss_store_sk  and s_state in              ( select s_state                from  (select s_state as s_state,  \t\t\t    rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking                       from   store_sales, store, date_dim                       where  d_month_seq between 1184 and 1184+11  \t\t\t    and d_date_sk = ss_sold_date_sk  \t\t\t    and s_store_sk  = ss_store_sk                       group by s_state                      ) tmp1                 where ranking <= 5              )  group by rollup(s_state,s_county)  order by    lochierarchy desc   ,case when (grouping(s_state)+grouping(s_county)) = 0 then s_state end   ,rank_within_parent  ;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 71, "query_string": " select i_brand_id brand_id, i_brand brand,t_hour,t_minute,  \tsum(ext_price) ext_price  from item, (select ws_ext_sales_price as ext_price,                          ws_sold_date_sk as sold_date_sk,                         ws_item_sk as sold_item_sk,                         ws_sold_time_sk as time_sk                    from web_sales,date_dim                  where d_date_sk = ws_sold_date_sk                    and d_moy=12                    and d_year=2001                  union all                  select cs_ext_sales_price as ext_price,                         cs_sold_date_sk as sold_date_sk,                         cs_item_sk as sold_item_sk,                         cs_sold_time_sk as time_sk                  from catalog_sales,date_dim                  where d_date_sk = cs_sold_date_sk                    and d_moy=12                    and d_year=2001                  union all                  select ss_ext_sales_price as ext_price,                         ss_sold_date_sk as sold_date_sk,                         ss_item_sk as sold_item_sk,                         ss_sold_time_sk as time_sk                  from store_sales,date_dim                  where d_date_sk = ss_sold_date_sk                    and d_moy=12                    and d_year=2001                  ) tmp,time_dim  where    sold_item_sk = i_item_sk    and i_manager_id=1    and time_sk = t_time_sk    and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')  group by i_brand, i_brand_id,t_hour,t_minute  order by ext_price desc, i_brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"], "time_dim": ["t_meal_time"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_brand", "i_item_sk", "i_brand_id"], "time_dim": ["t_hour", "t_minute", "t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 72, "query_string": " select top (100) i_item_desc       ,w_warehouse_name       ,d1.d_week_seq       ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo       ,sum(case when p_promo_sk is not null then 1 else 0 end) promo       ,count(*) total_cnt from catalog_sales join inventory on (cs_item_sk = inv_item_sk) join warehouse on (w_warehouse_sk=inv_warehouse_sk) join item on (i_item_sk = cs_item_sk) join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk) join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk) join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk) join date_dim d2 on (inv_date_sk = d2.d_date_sk) join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk) left outer join promotion on (cs_promo_sk=p_promo_sk) left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number) where d1.d_week_seq = d2.d_week_seq   and inv_quantity_on_hand < cs_quantity    and d3.d_date > dateadd(day, 5, d1.d_date)   and hd_buy_potential = '501-1000'   and d1.d_year = 2001   and cd_marital_status = 'M' group by i_item_desc,w_warehouse_name,d1.d_week_seq order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq;", "predicates": {"customer_demographics": ["cd_marital_status"], "date_dim": ["d_date", "d_year"], "household_demographics": ["hd_buy_potential"], "inventory": ["inv_warehouse_sk"], "warehouse": ["w_warehouse_sk"]}, "payload": {"catalog_sales": ["cs_quantity", "cs_promo_sk", "cs_item_sk", "cs_ship_date_sk", "cs_bill_cdemo_sk", "cs_sold_date_sk", "cs_bill_hdemo_sk"], "customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "household_demographics": ["hd_demo_sk"], "item": ["i_item_sk", "i_item_desc"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {"date_dim": ["d_week_seq"], "item": ["i_item_desc"], "warehouse": ["w_warehouse_name"]}}
{"id": 73, "query_string": " select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = 'Unknown')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (2000,2000+1,2000+2)     and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;", "predicates": {"date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count", "hd_buy_potential"], "store": ["s_county"]}, "payload": {"customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_preferred_cust_flag"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 74, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,d_year as year        ,max(ss_net_paid) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk    and d_year in (1998,1998+1)  group by c_customer_id          ,c_first_name          ,c_last_name          ,d_year  union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,d_year as year        ,max(ws_net_paid) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk    and d_year in (1998,1998+1)  group by c_customer_id          ,c_first_name          ,c_last_name          ,d_year          )   select top (100)         t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id          and t_s_firstyear.customer_id = t_w_secyear.customer_id          and t_s_firstyear.customer_id = t_w_firstyear.customer_id          and t_s_firstyear.sale_type = 's'          and t_w_firstyear.sale_type = 'w'          and t_s_secyear.sale_type = 's'          and t_w_secyear.sale_type = 'w'          and t_s_firstyear.year = 1998          and t_s_secyear.year = 1998+1          and t_w_firstyear.year = 1998          and t_w_secyear.year = 1998+1          and t_s_firstyear.year_total > 0          and t_w_firstyear.year_total > 0          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end  order by 1,3,2;", "predicates": {"date_dim": ["d_year"]}, "payload": {"customer": ["c_customer_id", "c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_net_paid"], "web_sales": ["ws_net_paid", "ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_customer_id", "c_last_name", "c_first_name"]}}
{"id": 75, "query_string": " WITH all_sales AS (  SELECT d_year        ,i_brand_id        ,i_class_id        ,i_category_id        ,i_manufact_id        ,SUM(sales_cnt) AS sales_cnt        ,SUM(sales_amt) AS sales_amt  FROM (SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt              ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt        FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk                           JOIN date_dim ON d_date_sk=cs_sold_date_sk                           LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number                                                      AND cs_item_sk=cr_item_sk)        WHERE i_category='Shoes'        UNION        SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt              ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt        FROM store_sales JOIN item ON i_item_sk=ss_item_sk                         JOIN date_dim ON d_date_sk=ss_sold_date_sk                         LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number                                                  AND ss_item_sk=sr_item_sk)        WHERE i_category='Shoes'        UNION        SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt              ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt        FROM web_sales JOIN item ON i_item_sk=ws_item_sk                       JOIN date_dim ON d_date_sk=ws_sold_date_sk                       LEFT JOIN web_returns ON (ws_order_number=wr_order_number                                              AND ws_item_sk=wr_item_sk)        WHERE i_category='Shoes') sales_detail  GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)  SELECT top (100) prev_yr.d_year AS prev_year                           ,curr_yr.d_year AS year                           ,curr_yr.i_brand_id                           ,curr_yr.i_class_id                           ,curr_yr.i_category_id                           ,curr_yr.i_manufact_id                           ,prev_yr.sales_cnt AS prev_yr_cnt                           ,curr_yr.sales_cnt AS curr_yr_cnt                           ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff                           ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff  FROM all_sales curr_yr, all_sales prev_yr  WHERE curr_yr.i_brand_id=prev_yr.i_brand_id    AND curr_yr.i_class_id=prev_yr.i_class_id    AND curr_yr.i_category_id=prev_yr.i_category_id    AND curr_yr.i_manufact_id=prev_yr.i_manufact_id    AND curr_yr.d_year=2002    AND prev_yr.d_year=2002-1    AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9  ORDER BY sales_cnt_diff,sales_amt_diff  ;", "predicates": {"date_dim": ["d_year"], "item": ["i_category"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_quantity", "cr_return_amount"], "date_dim": ["d_date_sk", "d_year"], "item": ["i_class_id", "i_item_sk", "i_category_id", "i_brand_id", "i_manufact_id"], "store_returns": ["sr_return_amt", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_return_amt", "wr_return_quantity", "wr_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 76, "query_string": " select top (100) channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (         SELECT 'store' as channel, 'ss_promo_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price          FROM store_sales, item, date_dim          WHERE ss_promo_sk IS NULL            AND ss_sold_date_sk=d_date_sk            AND ss_item_sk=i_item_sk         UNION ALL         SELECT 'web' as channel, 'ws_warehouse_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price          FROM web_sales, item, date_dim          WHERE ws_warehouse_sk IS NULL            AND ws_sold_date_sk=d_date_sk            AND ws_item_sk=i_item_sk         UNION ALL         SELECT 'catalog' as channel, 'cs_warehouse_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price          FROM catalog_sales, item, date_dim          WHERE cs_warehouse_sk IS NULL            AND cs_sold_date_sk=d_date_sk            AND cs_item_sk=i_item_sk) foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category;", "predicates": {"catalog_sales": ["cs_ship_addr_sk"], "store_sales": ["ss_promo_sk"], "web_sales": ["ws_promo_sk"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_item_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_qoy", "d_year"], "item": ["i_item_sk", "i_category"], "store_sales": ["ss_sold_date_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 77, "query_string": " with ss as  (select s_store_sk,          sum(ss_ext_sales_price) as sales,          sum(ss_net_profit) as profit  from store_sales,       date_dim,       store  where ss_sold_date_sk = d_date_sk        and d_date between cast('2001-08-15' as date)                    and dateadd(day, 30, cast('2001-08-15' as date))         and ss_store_sk = s_store_sk  group by s_store_sk)  ,  sr as  (select s_store_sk,          sum(sr_return_amt) as returns,          sum(sr_net_loss) as profit_loss  from store_returns,       date_dim,       store  where sr_returned_date_sk = d_date_sk        and d_date between cast('2001-08-15' as date)                   and dateadd(day, 30, cast('2001-08-15' as date))        and sr_store_sk = s_store_sk  group by s_store_sk),   cs as  (select cs_call_center_sk,         sum(cs_ext_sales_price) as sales,         sum(cs_net_profit) as profit  from catalog_sales,       date_dim  where cs_sold_date_sk = d_date_sk        and d_date between cast('2001-08-15' as date)                   and dateadd(day, 30, cast('2001-08-15' as date))  group by cs_call_center_sk   ),   cr as  (select cr_call_center_sk,          sum(cr_return_amount) as returns,          sum(cr_net_loss) as profit_loss  from catalog_returns,       date_dim  where cr_returned_date_sk = d_date_sk        and d_date between cast('2001-08-15' as date)                   and dateadd(day, 30, cast('2001-08-15' as date))  group by cr_call_center_sk  ),   ws as  ( select wp_web_page_sk,         sum(ws_ext_sales_price) as sales,         sum(ws_net_profit) as profit  from web_sales,       date_dim,       web_page  where ws_sold_date_sk = d_date_sk        and d_date between cast('2001-08-15' as date)                   and dateadd(day, 30, cast('2001-08-15' as date))        and ws_web_page_sk = wp_web_page_sk  group by wp_web_page_sk),   wr as  (select wp_web_page_sk,         sum(wr_return_amt) as returns,         sum(wr_net_loss) as profit_loss  from web_returns,       date_dim,       web_page  where wr_returned_date_sk = d_date_sk        and d_date between cast('2001-08-15' as date)                   and dateadd(day, 30, cast('2001-08-15' as date))        and wr_web_page_sk = wp_web_page_sk  group by wp_web_page_sk)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , ss.s_store_sk as id         , sales         , coalesce(returns, 0) as returns         , (profit - coalesce(profit_loss,0)) as profit  from   ss left join sr         on  ss.s_store_sk = sr.s_store_sk  union all  select 'catalog channel' as channel         , cs_call_center_sk as id         , sales         , returns         , (profit - profit_loss) as profit  from  cs        , cr  union all  select 'web channel' as channel         , ws.wp_web_page_sk as id         , sales         , coalesce(returns, 0) returns         , (profit - coalesce(profit_loss,0)) as profit  from   ws left join wr         on  ws.wp_web_page_sk = wr.wp_web_page_sk  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_return_amount", "cr_call_center_sk"], "catalog_sales": ["cs_net_profit", "cs_sold_date_sk", "cs_call_center_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_net_loss"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit", "ss_ext_sales_price"], "web_page": ["wp_web_page_sk"], "web_returns": ["wr_web_page_sk", "wr_returned_date_sk", "wr_return_amt", "wr_net_loss"], "web_sales": ["ws_net_profit", "ws_ext_sales_price", "ws_web_page_sk", "ws_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 78, "query_string": " with ws as   (select d_year AS ws_sold_year, ws_item_sk,     ws_bill_customer_sk ws_customer_sk,     sum(ws_quantity) ws_qty,     sum(ws_wholesale_cost) ws_wc,     sum(ws_sales_price) ws_sp    from web_sales    left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk    join date_dim on ws_sold_date_sk = d_date_sk    where wr_order_number is null    group by d_year, ws_item_sk, ws_bill_customer_sk    ), cs as   (select d_year AS cs_sold_year, cs_item_sk,     cs_bill_customer_sk cs_customer_sk,     sum(cs_quantity) cs_qty,     sum(cs_wholesale_cost) cs_wc,     sum(cs_sales_price) cs_sp    from catalog_sales    left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk    join date_dim on cs_sold_date_sk = d_date_sk    where cr_order_number is null    group by d_year, cs_item_sk, cs_bill_customer_sk    ), ss as   (select d_year AS ss_sold_year, ss_item_sk,     ss_customer_sk,     sum(ss_quantity) ss_qty,     sum(ss_wholesale_cost) ss_wc,     sum(ss_sales_price) ss_sp    from store_sales    left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk    join date_dim on ss_sold_date_sk = d_date_sk    where sr_ticket_number is null    group by d_year, ss_item_sk, ss_customer_sk    )  select top (100) ss_sold_year, ss_item_sk, ss_customer_sk, round(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk) where (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2001 order by    ss_sold_year, ss_item_sk, ss_customer_sk,   ss_qty desc, ss_wc desc, ss_sp desc,   other_chan_qty,   other_chan_wholesale_cost,   other_chan_sales_price,   ratio;", "predicates": {"catalog_returns": ["cr_order_number"], "catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_year"], "store_returns": ["sr_ticket_number"], "store_sales": ["ss_customer_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_bill_customer_sk"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "store_returns": ["sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_item_sk", "ss_sales_price", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_wholesale_cost", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 79, "query_string": " select top (100)   c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,store.s_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (household_demographics.hd_dep_count = 8 or household_demographics.hd_vehicle_count > 3)     and date_dim.d_dow = 1     and date_dim.d_year in (2000,2000+1,2000+2)      and store.s_number_employees between 200 and 295     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer     where ss_customer_sk = c_customer_sk  order by c_last_name,c_first_name,substring(s_city,1,30), profit;", "predicates": {"date_dim": ["d_dow", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_number_employees"]}, "payload": {"customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_city", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_addr_sk", "ss_customer_sk", "ss_ticket_number", "ss_coupon_amt", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {"customer": ["c_last_name", "c_first_name"]}}
{"id": 80, "query_string": " with ssr as  (select  s_store_id as store_id,           sum(ss_ext_sales_price) as sales,           sum(coalesce(sr_return_amt, 0)) as returns,           sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit   from store_sales left outer join store_returns on          (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),      date_dim,      store,      item,      promotion  where ss_sold_date_sk = d_date_sk        and d_date between cast('2001-08-15' as date)                    and dateadd(day, 30, cast('2001-08-15' as date))        and ss_store_sk = s_store_sk        and ss_item_sk = i_item_sk        and i_current_price > 50        and ss_promo_sk = p_promo_sk        and p_channel_tv = 'N'  group by s_store_id)  ,  csr as  (select  cp_catalog_page_id as catalog_page_id,           sum(cs_ext_sales_price) as sales,           sum(coalesce(cr_return_amount, 0)) as returns,           sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit   from catalog_sales left outer join catalog_returns on          (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),      date_dim,      catalog_page,      item,      promotion  where cs_sold_date_sk = d_date_sk        and d_date between cast('2001-08-15' as date)                   and dateadd(day, 30, cast('2001-08-15' as date))         and cs_catalog_page_sk = cp_catalog_page_sk        and cs_item_sk = i_item_sk        and i_current_price > 50        and cs_promo_sk = p_promo_sk        and p_channel_tv = 'N' group by cp_catalog_page_id)  ,  wsr as  (select  web_site_id,           sum(ws_ext_sales_price) as sales,           sum(coalesce(wr_return_amt, 0)) as returns,           sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit   from web_sales left outer join web_returns on          (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),      date_dim,      web_site,      item,      promotion  where ws_sold_date_sk = d_date_sk        and d_date between cast('2001-08-15' as date)                   and dateadd(day, 30, cast('2001-08-15' as date))         and ws_web_site_sk = web_site_sk        and ws_item_sk = i_item_sk        and i_current_price > 50        and ws_promo_sk = p_promo_sk        and p_channel_tv = 'N' group by web_site_id)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , concat('store' , store_id) as id         , sales         , returns         , profit  from   ssr  union all  select 'catalog channel' as channel         , concat('catalog_page' , catalog_page_id) as id         , sales         , returns         , profit  from  csr  union all  select 'web channel' as channel         , concat('web_site' , web_site_id) as id         , sales         , returns         , profit  from   wsr  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"], "promotion": ["p_channel_tv"]}, "payload": {"catalog_page": ["cp_catalog_page_sk", "cp_catalog_page_id"], "catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_amount", "cr_net_loss"], "date_dim": ["d_date_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"], "store": ["s_store_sk", "s_store_id"], "store_returns": ["sr_return_amt", "sr_net_loss", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_net_loss", "wr_return_amt", "wr_order_number"], "web_site": ["web_site_id", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 81, "query_string": " with customer_total_return as  (select cr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   \tsum(cr_return_amt_inc_tax) as ctr_total_return  from catalog_returns      ,date_dim      ,customer_address  where cr_returned_date_sk = d_date_sk     and d_year =2001    and cr_returning_addr_sk = ca_address_sk   group by cr_returning_customer_sk          ,ca_state )   select top (100) c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  \t\t\t  from customer_total_return ctr2                    \t  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'NC'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  ;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_year"]}, "payload": {"catalog_returns": ["cr_returned_date_sk", "cr_returning_customer_sk", "cr_return_amt_inc_tax", "cr_returning_addr_sk"], "customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_current_addr_sk", "c_customer_id"], "customer_address": ["ca_street_type", "ca_county", "ca_street_name", "ca_zip", "ca_street_number", "ca_city", "ca_state", "ca_gmt_offset", "ca_location_type", "ca_address_sk", "ca_suite_number", "ca_country"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer": ["c_salutation", "c_customer_id", "c_last_name", "c_first_name"], "customer_address": ["ca_street_type", "ca_county", "ca_street_name", "ca_zip", "ca_street_number", "ca_city", "ca_gmt_offset", "ca_location_type", "ca_suite_number", "ca_country"]}}
{"id": 82, "query_string": " select top (100) i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, store_sales  where i_current_price between 53 and 53+30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('1999-07-02' as date) and dateadd(day, 60, cast('1999-07-02' as date))  and i_manufact_id in (550,238,641,910)  and inv_quantity_on_hand between 100 and 500  and ss_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  ;", "predicates": {"date_dim": ["d_date"], "inventory": ["inv_quantity_on_hand"], "item": ["i_current_price", "i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc", "i_current_price"]}, "group_by": {}, "order_by": {}}
{"id": 83, "query_string": " with sr_items as  (select i_item_id item_id,         sum(sr_return_quantity) sr_item_qty  from store_returns,       item,       date_dim  where sr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t  where d_date in ('2000-02-07','2000-09-14','2000-11-04')))  and   sr_returned_date_sk   = d_date_sk  group by i_item_id),  cr_items as  (select i_item_id item_id,         sum(cr_return_quantity) cr_item_qty  from catalog_returns,       item,       date_dim  where cr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t  where d_date in ('2000-02-07','2000-09-14','2000-11-04')))  and   cr_returned_date_sk   = d_date_sk  group by i_item_id),  wr_items as  (select i_item_id item_id,         sum(wr_return_quantity) wr_item_qty  from web_returns,       item,       date_dim  where wr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t\twhere d_date in ('2000-02-07','2000-09-14','2000-11-04')))  and   wr_returned_date_sk   = d_date_sk  group by i_item_id)   select top (100) sr_items.item_id        ,sr_item_qty        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev        ,cr_item_qty        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev        ,wr_item_qty        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average  from sr_items      ,cr_items      ,wr_items  where sr_items.item_id=cr_items.item_id    and sr_items.item_id=wr_items.item_id   order by sr_items.item_id          ,sr_item_qty  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_returned_date_sk", "cr_order_number", "cr_return_quantity"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "item": ["i_item_id", "i_item_sk"], "store_returns": ["sr_returned_date_sk", "sr_return_quantity", "sr_item_sk"], "web_returns": ["wr_item_sk", "wr_returned_date_sk", "wr_return_quantity"]}, "group_by": {}, "order_by": {}}
{"id": 84, "query_string": " select top (100) c_customer_id as customer_id        , concat(coalesce(c_last_name,'') , ', ' , coalesce(c_first_name,'')) as customername  from customer      ,customer_address      ,customer_demographics      ,household_demographics      ,income_band      ,store_returns  where ca_city\t        =  'Greenfield'    and c_current_addr_sk = ca_address_sk    and ib_lower_bound   >=  16718    and ib_upper_bound   <=  16718 + 50000    and ib_income_band_sk = hd_income_band_sk    and cd_demo_sk = c_current_cdemo_sk    and hd_demo_sk = c_current_hdemo_sk    and sr_cdemo_sk = cd_demo_sk  order by c_customer_id  ;", "predicates": {"customer": ["c_current_cdemo_sk"], "customer_address": ["ca_city"], "income_band": ["ib_upper_bound", "ib_lower_bound"]}, "payload": {"customer": ["c_last_name", "c_first_name", "c_current_cdemo_sk", "c_current_addr_sk", "c_customer_id", "c_current_hdemo_sk"], "customer_address": ["ca_address_sk"], "household_demographics": ["hd_income_band_sk", "hd_demo_sk"], "income_band": ["ib_income_band_sk"], "store_returns": ["sr_cdemo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 85, "query_string": " select top (100) substring(r_reason_desc,1,20)        ,avg(ws_quantity)        ,avg(wr_refunded_cash)        ,avg(wr_fee)  from web_sales, web_returns, web_page, customer_demographics cd1,       customer_demographics cd2, customer_address, date_dim, reason   where ws_web_page_sk = wp_web_page_sk    and ws_item_sk = wr_item_sk    and ws_order_number = wr_order_number    and ws_sold_date_sk = d_date_sk and d_year = 2001    and cd1.cd_demo_sk = wr_refunded_cdemo_sk     and cd2.cd_demo_sk = wr_returning_cdemo_sk    and ca_address_sk = wr_refunded_addr_sk    and r_reason_sk = wr_reason_sk    and    (     (      cd1.cd_marital_status = 'M'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Advanced Degree'      and       cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 100.00 and 150.00     )    or     (      cd1.cd_marital_status = 'U'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'College'       and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 50.00 and 100.00     )    or     (      cd1.cd_marital_status = 'D'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Secondary'      and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 150.00 and 200.00     )    )    and    (     (      ca_country = 'United States'      and      ca_state in ('ND', 'NE', 'MI')      and ws_net_profit between 100 and 200       )     or     (      ca_country = 'United States'      and      ca_state in ('WI', 'VA', 'CO')      and ws_net_profit between 150 and 300       )     or     (      ca_country = 'United States'      and      ca_state in ('OH', 'MN', 'AK')      and ws_net_profit between 50 and 250       )    ) group by r_reason_desc order by substring(r_reason_desc,1,20)         ,avg(ws_quantity)         ,avg(wr_refunded_cash)         ,avg(wr_fee);", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "web_sales": ["ws_net_profit", "ws_sales_price"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "reason": ["r_reason_desc", "r_reason_sk"], "web_page": ["wp_web_page_sk"], "web_returns": ["wr_returning_cdemo_sk", "wr_refunded_cdemo_sk", "wr_reason_sk", "wr_item_sk", "wr_refunded_cash", "wr_refunded_addr_sk", "wr_fee", "wr_order_number"], "web_sales": ["ws_net_profit", "ws_item_sk", "ws_sales_price", "ws_quantity", "ws_sold_date_sk", "ws_web_page_sk", "ws_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 86, "query_string": " select top (100)       sum(ws_net_paid) as total_sum    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  \tpartition by grouping(i_category)+grouping(i_class),  \tcase when grouping(i_class) = 0 then i_category end   \torder by sum(ws_net_paid) desc) as rank_within_parent  from     web_sales    ,date_dim       d1    ,item  where     d1.d_month_seq between 1184 and 1184+11  and d1.d_date_sk = ws_sold_date_sk  and i_item_sk  = ws_item_sk  group by rollup(i_category,i_class)  order by    lochierarchy desc,    case when (grouping(i_category)+grouping(i_class)) = 0 then i_category end,    rank_within_parent  ;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_class", "i_item_sk", "i_category"], "web_sales": ["ws_net_paid", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 87, "query_string": " select count(*)  from ((select distinct c_last_name, c_first_name, d_date        from store_sales, date_dim, customer        where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_customer_sk = customer.c_customer_sk          and d_month_seq between 1184 and 1184+11)        except       (select distinct c_last_name, c_first_name, d_date        from catalog_sales, date_dim, customer        where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk          and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk          and d_month_seq between 1184 and 1184+11)        except       (select distinct c_last_name, c_first_name, d_date        from web_sales, date_dim, customer        where web_sales.ws_sold_date_sk = date_dim.d_date_sk          and web_sales.ws_bill_customer_sk = customer.c_customer_sk          and d_month_seq between 1184 and 1184+11) ) cool_cust;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 88, "query_string": " select  * from  (select count(*) h8_30_to_9  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk         and ss_hdemo_sk = household_demographics.hd_demo_sk       and ss_store_sk = s_store_sk      and time_dim.t_hour = 8      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))       and store.s_store_name = 'ese') s1,  (select count(*) h9_to_9_30   from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk       and time_dim.t_hour = 9       and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))      and store.s_store_name = 'ese') s2,  (select count(*) h9_30_to_10   from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 9      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))      and store.s_store_name = 'ese') s3,  (select count(*) h10_to_10_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 10       and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))      and store.s_store_name = 'ese') s4,  (select count(*) h10_30_to_11  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 10       and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))      and store.s_store_name = 'ese') s5,  (select count(*) h11_to_11_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk       and time_dim.t_hour = 11      and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))      and store.s_store_name = 'ese') s6,  (select count(*) h11_30_to_12  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 11      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))      and store.s_store_name = 'ese') s7,  (select count(*) h12_to_12_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 12      and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2))      and store.s_store_name = 'ese') s8;", "predicates": {"household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_store_name"], "time_dim": ["t_hour", "t_minute"]}, "payload": {"household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_sold_time_sk"], "time_dim": ["t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 89, "query_string": " select top (100) * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (1998) and         ((i_category in ('Jewelry','Men','Home') and           i_class in ('rings','shirts','bathroom')          )       or (i_category in ('Music','Electronics','Sports') and           i_class in ('pop','memory','basketball')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name;", "predicates": {"date_dim": ["d_year"], "item": ["i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_brand", "i_class", "i_item_sk", "i_category"], "store": ["s_store_name", "s_store_sk", "s_company_name"]}, "group_by": {}, "order_by": {"store": ["s_store_name"]}}
{"id": 90, "query_string": " select top (100) cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio  from ( select count(*) amc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 10 and 10+1          and household_demographics.hd_dep_count = 8          and web_page.wp_char_count between 5000 and 5200) at,       ( select count(*) pmc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 14 and 14+1          and household_demographics.hd_dep_count = 8          and web_page.wp_char_count between 5000 and 5200) pt  order by am_pm_ratio  ;", "predicates": {"household_demographics": ["hd_dep_count"], "time_dim": ["t_hour"], "web_page": ["wp_char_count"]}, "payload": {"household_demographics": ["hd_demo_sk"], "time_dim": ["t_time_sk"], "web_page": ["wp_web_page_sk"], "web_sales": ["ws_sold_time_sk", "ws_web_page_sk", "ws_ship_hdemo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 91, "query_string": " select           cc_call_center_id Call_Center,         cc_name Call_Center_Name,         cc_manager Manager,         sum(cr_net_loss) Returns_Loss from         call_center,         catalog_returns,         date_dim,         customer,         customer_address,         customer_demographics,         household_demographics where         cr_call_center_sk       = cc_call_center_sk and     cr_returned_date_sk     = d_date_sk and     cr_returning_customer_sk= c_customer_sk and     cd_demo_sk              = c_current_cdemo_sk and     hd_demo_sk              = c_current_hdemo_sk and     ca_address_sk           = c_current_addr_sk and     d_year                  = 2001  and     d_moy                   = 12 and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')         or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree')) and     hd_buy_potential like '5001-10000%' and     ca_gmt_offset           = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc;", "predicates": {"customer_address": ["ca_gmt_offset"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_moy", "d_year"], "household_demographics": ["hd_buy_potential"]}, "payload": {"call_center": ["cc_name", "cc_call_center_id", "cc_manager", "cc_call_center_sk"], "catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_returning_customer_sk", "cr_call_center_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk", "c_current_hdemo_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 92, "query_string": " select top (100)     sum(ws_ext_discount_amt)  as \"Excess Discount Amount\"  from      web_sales     ,item     ,date_dim where i_manufact_id = 9 and i_item_sk = ws_item_sk  and d_date between '1998-03-04' and          dateadd(day, 90, cast('1998-03-04' as date)) and d_date_sk = ws_sold_date_sk  and ws_ext_discount_amt        > (           SELECT              1.3 * avg(ws_ext_discount_amt)           FROM              web_sales             ,date_dim          WHERE                ws_item_sk = i_item_sk            and d_date between '1998-03-04' and                              dateadd(day, 90, cast('1998-03-04' as date))           and d_date_sk = ws_sold_date_sk        )  order by sum(ws_ext_discount_amt);", "predicates": {"date_dim": ["d_date"], "item": ["i_manufact_id"], "web_sales": ["ws_ext_discount_amt"]}, "payload": {"item": ["i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 93, "query_string": " select top (100) ss_customer_sk             ,sum(act_sales) sumsales       from (select ss_item_sk                   ,ss_ticket_number                   ,ss_customer_sk                   ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price                                                             else (ss_quantity*ss_sales_price) end act_sales             from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk                                                                and sr_ticket_number = ss_ticket_number)                 ,reason             where sr_reason_sk = r_reason_sk               and r_reason_desc = 'reason 48') t       group by ss_customer_sk       order by sumsales, ss_customer_sk;", "predicates": {"reason": ["r_reason_desc"]}, "payload": {"reason": ["r_reason_sk"], "store_returns": ["sr_reason_sk", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"]}, "group_by": {}, "order_by": {"store_sales": ["ss_customer_sk"]}}
{"id": 94, "query_string": " select top (100)     count(distinct ws_order_number) as \"order count\"   ,sum(ws_ext_ship_cost) as \"total shipping cost\"   ,sum(ws_net_profit) as \"total net profit\" from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '1999-3-01' and             dateadd(day, 60, cast('1999-3-01' as date)) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'VA' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number);", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_date"], "web_site": ["web_company_name"]}, "payload": {"customer_address": ["ca_address_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_net_profit", "ws_ship_date_sk", "ws_ship_addr_sk", "ws_ext_ship_cost", "ws_warehouse_sk", "ws_order_number", "ws_web_site_sk"], "web_site": ["web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 95, "query_string": " with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select top (100)     count(distinct ws_order_number) as \"order count\"   ,sum(ws_ext_ship_cost) as \"total shipping cost\"   ,sum(ws_net_profit) as \"total net profit\" from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '1999-3-01' and             dateadd(day, 60, cast('1999-3-01' as date)) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'VA' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number);", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_date"], "web_site": ["web_company_name"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_net_profit", "ws_ship_date_sk", "ws_item_sk", "ws_ship_addr_sk", "ws_ext_ship_cost", "ws_warehouse_sk", "ws_order_number", "ws_web_site_sk"], "web_site": ["web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 96, "query_string": " select top (100) count(*)  from store_sales     ,household_demographics      ,time_dim, store where ss_sold_time_sk = time_dim.t_time_sk        and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk     and time_dim.t_hour = 15     and time_dim.t_minute >= 30     and household_demographics.hd_dep_count = 3     and store.s_store_name = 'ese' order by count(*);", "predicates": {"household_demographics": ["hd_dep_count"], "store": ["s_store_name"], "time_dim": ["t_hour", "t_minute"]}, "payload": {"household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_sold_time_sk"], "time_dim": ["t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 97, "query_string": " with ssci as ( select ss_customer_sk customer_sk       ,ss_item_sk item_sk from store_sales,date_dim where ss_sold_date_sk = d_date_sk   and d_month_seq between 1184 and 1184 + 11 group by ss_customer_sk         ,ss_item_sk), csci as(  select cs_bill_customer_sk customer_sk       ,cs_item_sk item_sk from catalog_sales,date_dim where cs_sold_date_sk = d_date_sk   and d_month_seq between 1184 and 1184 + 11 group by cs_bill_customer_sk         ,cs_item_sk)  select top (100) sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only       ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only       ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk                                and ssci.item_sk = csci.item_sk);", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk", "cs_item_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 98, "query_string": " select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from\t \tstore_sales     \t,item      \t,date_dim where  \tss_item_sk = i_item_sk    \tand i_category in ('Children', 'Shoes', 'Books')   \tand ss_sold_date_sk = d_date_sk \tand d_date between cast('1998-03-10' as date)  \t\t\t\tand dateadd(day, 30, cast('1998-03-10' as date)) group by  \ti_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  \ti_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"]}, "group_by": {}, "order_by": {}}
{"id": 99, "query_string": " select top (100)     substring(w_warehouse_name,1,20)   ,sm_type   ,cc_name   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and                   (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and                   (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and                  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    catalog_sales   ,warehouse   ,ship_mode   ,call_center   ,date_dim where     d_month_seq between 1184 and 1184 + 11 and cs_ship_date_sk   = d_date_sk and cs_warehouse_sk   = w_warehouse_sk and cs_ship_mode_sk   = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by    substring(w_warehouse_name,1,20)   ,sm_type   ,cc_name order by substring(w_warehouse_name,1,20)         ,sm_type         ,cc_name;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"call_center": ["cc_name", "cc_call_center_sk"], "catalog_sales": ["cs_warehouse_sk", "cs_call_center_sk", "cs_ship_date_sk", "cs_ship_mode_sk", "cs_sold_date_sk"], "date_dim": ["d_date_sk"], "ship_mode": ["sm_type", "sm_ship_mode_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 1, "query_string": " with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sum(SR_REFUNDED_CASH) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2000 group by sr_customer_sk ,sr_store_sk)  select top (100) c_customer_id from customer_total_return ctr1 ,store ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'TN' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id;", "predicates": {"date_dim": ["d_year"], "store": ["s_state"], "store_returns": ["sr_store_sk"]}, "payload": {"customer": ["c_customer_id", "c_customer_sk"], "date_dim": ["d_date_sk"], "store": ["s_store_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_customer_id"]}}
{"id": 2, "query_string": " with wscs as  (select sold_date_sk         ,sales_price   from (select ws_sold_date_sk sold_date_sk               ,ws_ext_sales_price sales_price         from web_sales          union all         select cs_sold_date_sk sold_date_sk               ,cs_ext_sales_price sales_price         from catalog_sales) a),  wswscs as   (select d_week_seq,         sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales  from wscs      ,date_dim  where d_date_sk = sold_date_sk  group by d_week_seq)  select d_week_seq1        ,round(sun_sales1/sun_sales2,2)        ,round(mon_sales1/mon_sales2,2)        ,round(tue_sales1/tue_sales2,2)        ,round(wed_sales1/wed_sales2,2)        ,round(thu_sales1/thu_sales2,2)        ,round(fri_sales1/fri_sales2,2)        ,round(sat_sales1/sat_sales2,2)  from  (select wswscs.d_week_seq d_week_seq1         ,sun_sales sun_sales1         ,mon_sales mon_sales1         ,tue_sales tue_sales1         ,wed_sales wed_sales1         ,thu_sales thu_sales1         ,fri_sales fri_sales1         ,sat_sales sat_sales1   from wswscs,date_dim    where date_dim.d_week_seq = wswscs.d_week_seq and         d_year = 1999) y,  (select wswscs.d_week_seq d_week_seq2         ,sun_sales sun_sales2         ,mon_sales mon_sales2         ,tue_sales tue_sales2         ,wed_sales wed_sales2         ,thu_sales thu_sales2         ,fri_sales fri_sales2         ,sat_sales sat_sales2   from wswscs       ,date_dim    where date_dim.d_week_seq = wswscs.d_week_seq and         d_year = 1999+1) z  where d_week_seq1=d_week_seq2-53  order by d_week_seq1;", "predicates": {"date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_week_seq", "d_day_name"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 3, "query_string": " select top (100) dt.d_year         ,item.i_brand_id brand_id         ,item.i_brand brand        ,sum(ss_net_profit) sum_agg  from  date_dim dt        ,store_sales       ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk    and store_sales.ss_item_sk = item.i_item_sk    and item.i_manufact_id = 344    and dt.d_moy=11  group by dt.d_year       ,item.i_brand       ,item.i_brand_id  order by dt.d_year          ,sum_agg desc          ,brand_id  ;", "predicates": {"date_dim": ["d_moy"], "item": ["i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"date_dim": ["d_year"], "item": ["i_brand_id"]}}
{"id": 4, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year  union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total        ,'c' sale_type  from customer      ,catalog_sales      ,date_dim  where c_customer_sk = cs_bill_customer_sk    and cs_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year          )   select top (100)                    t_s_secyear.customer_id                  ,t_s_secyear.customer_first_name                  ,t_s_secyear.customer_last_name                  ,t_s_secyear.customer_login  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_c_firstyear      ,year_total t_c_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id    and t_s_firstyear.customer_id = t_c_secyear.customer_id    and t_s_firstyear.customer_id = t_c_firstyear.customer_id    and t_s_firstyear.customer_id = t_w_firstyear.customer_id    and t_s_firstyear.customer_id = t_w_secyear.customer_id    and t_s_firstyear.sale_type = 's'    and t_c_firstyear.sale_type = 'c'    and t_w_firstyear.sale_type = 'w'    and t_s_secyear.sale_type = 's'    and t_c_secyear.sale_type = 'c'    and t_w_secyear.sale_type = 'w'    and t_s_firstyear.dyear =  1999    and t_s_secyear.dyear = 1999+1    and t_c_firstyear.dyear =  1999    and t_c_secyear.dyear =  1999+1    and t_w_firstyear.dyear = 1999    and t_w_secyear.dyear = 1999+1    and t_s_firstyear.year_total > 0    and t_c_firstyear.year_total > 0    and t_w_firstyear.year_total > 0    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end            > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end  order by t_s_secyear.customer_id          ,t_s_secyear.customer_first_name          ,t_s_secyear.customer_last_name          ,t_s_secyear.customer_login;", "predicates": {"date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_ext_list_price", "cs_ext_discount_amt", "cs_bill_customer_sk", "cs_ext_sales_price", "cs_ext_wholesale_cost", "cs_sold_date_sk"], "customer": ["c_login", "c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id"], "date_dim": ["d_date_sk"], "store_sales": ["ss_ext_discount_amt", "ss_ext_sales_price", "ss_ext_wholesale_cost", "ss_customer_sk", "ss_ext_list_price", "ss_sold_date_sk"], "web_sales": ["ws_ext_discount_amt", "ws_ext_wholesale_cost", "ws_ext_list_price", "ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 5, "query_string": " with ssr as  (select s_store_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  ss_store_sk as store_sk,             ss_sold_date_sk  as date_sk,             ss_ext_sales_price as sales_price,             ss_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from store_sales     union all     select sr_store_sk as store_sk,            sr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            sr_return_amt as return_amt,            sr_net_loss as net_loss     from store_returns    ) salesreturns,      date_dim,      store  where date_sk = d_date_sk        and d_date between cast('2002-08-25' as date)                    and dateadd(day, 14, cast('2002-08-25' as date))        and store_sk = s_store_sk  group by s_store_id)  ,  csr as  (select cp_catalog_page_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  cs_catalog_page_sk as page_sk,             cs_sold_date_sk  as date_sk,             cs_ext_sales_price as sales_price,             cs_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from catalog_sales     union all     select cr_catalog_page_sk as page_sk,            cr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            cr_return_amount as return_amt,            cr_net_loss as net_loss     from catalog_returns    ) salesreturns,      date_dim,      catalog_page  where date_sk = d_date_sk        and d_date between cast('2002-08-25' as date)                   and dateadd(day, 14, cast('2002-08-25' as date))        and page_sk = cp_catalog_page_sk  group by cp_catalog_page_id)  ,  wsr as  (select web_site_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  ws_web_site_sk as wsr_web_site_sk,             ws_sold_date_sk  as date_sk,             ws_ext_sales_price as sales_price,             ws_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from web_sales     union all     select ws_web_site_sk as wsr_web_site_sk,            wr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            wr_return_amt as return_amt,            wr_net_loss as net_loss     from web_returns left outer join web_sales on          ( wr_item_sk = ws_item_sk            and wr_order_number = ws_order_number)    ) salesreturns,      date_dim,      web_site  where date_sk = d_date_sk        and d_date between cast('2002-08-25' as date)                   and dateadd(day, 14, cast('2002-08-25' as date))        and wsr_web_site_sk = web_site_sk  group by web_site_id)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , concat('store' , s_store_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from   ssr  union all  select 'catalog channel' as channel         , concat('catalog_page' , cp_catalog_page_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from  csr  union all  select 'web channel' as channel         , concat('web_site' , web_site_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from   wsr  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_page": ["cp_catalog_page_sk", "cp_catalog_page_id"], "catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_return_amount", "cr_catalog_page_sk"], "catalog_sales": ["cs_catalog_page_sk", "cs_net_profit", "cs_sold_date_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_net_loss"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit", "ss_ext_sales_price"], "web_returns": ["wr_returned_date_sk", "wr_return_amt", "wr_net_loss", "wr_item_sk", "wr_order_number"], "web_sales": ["ws_net_profit", "ws_ext_sales_price", "ws_sold_date_sk", "ws_web_site_sk"], "web_site": ["web_site_id", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 6, "query_string": " select top (100) a.ca_state state, count(*) cnt  from customer_address a      ,customer c      ,store_sales s      ,date_dim d      ,item i  where       a.ca_address_sk = c.c_current_addr_sk  \tand c.c_customer_sk = s.ss_customer_sk  \tand s.ss_sold_date_sk = d.d_date_sk  \tand s.ss_item_sk = i.i_item_sk  \tand d.d_month_seq =   \t     (select distinct (d_month_seq)  \t      from date_dim                where d_year = 2002  \t        and d_moy = 5 )  \tand i.i_current_price > 1.2 *               (select avg(j.i_current_price)   \t     from item j   \t     where j.i_category = i.i_category)  group by a.ca_state  having count(*) >= 10  order by cnt, a.ca_state   ;", "predicates": {"date_dim": ["d_month_seq", "d_moy", "d_year"], "item": ["i_category", "i_current_price"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk", "d_month_seq"], "item": ["i_item_sk", "i_category", "i_current_price"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_item_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_state"]}}
{"id": 7, "query_string": " select top (100) i_item_id,          avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4   from store_sales, customer_demographics, date_dim, item, promotion  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_cdemo_sk = cd_demo_sk and        ss_promo_sk = p_promo_sk and        cd_gender = 'F' and         cd_marital_status = 'U' and        cd_education_status = 'Advanced Degree' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 2001   group by i_item_id  order by i_item_id  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "promotion": ["p_channel_event", "p_channel_email"]}, "payload": {"customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"], "promotion": ["p_promo_sk"], "store_sales": ["ss_promo_sk", "ss_item_sk", "ss_cdemo_sk", "ss_list_price", "ss_quantity", "ss_sales_price", "ss_coupon_amt", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 8, "query_string": " select top (100) s_store_name       ,sum(ss_net_profit)  from store_sales      ,date_dim      ,store,      (select ca_zip      from (       SELECT substring(ca_zip,1,5) ca_zip       FROM customer_address       WHERE substring(ca_zip,1,5) IN (                           '16226','26400','21666','97839','29926','24064',                           '60736','87153','60187','74634','94046',                           '50278','61467','76671','21855','68443',                           '58785','72485','70565','23822','11647',                           '54788','51238','52667','48447','86564',                           '14512','33581','99612','35215','16607',                           '90855','71074','62690','34824','62418',                           '36734','54784','90339','46152','76209',                           '70052','57914','78073','28853','46329',                           '24653','12520','51164','28539','52470',                           '66563','87802','79209','29810','94037',                           '30063','86054','81904','64735','19560',                           '35622','74004','77492','35447','67797',                           '63074','51362','10825','56576','51712',                           '37358','17565','96527','24704','11534',                           '98713','54896','89754','94684','74410',                           '10705','33072','28019','37338','76276',                           '35235','39500','94240','35332','83066',                           '89509','39108','38125','47145','13430',                           '82606','39494','96257','53118','50340',                           '97038','98108','53780','38292','59968',                           '24950','63415','44183','48287','41451',                           '97191','82600','32526','82354','28412',                           '38908','96553','39216','79158','88518',                           '30396','63939','28123','37617','69476',                           '76356','78676','58990','37523','60817',                           '38717','26214','44290','77140','37134',                           '79102','42883','56133','88259','89965',                           '83413','30303','40239','15435','77081',                           '84484','24203','29452','20049','63329',                           '74870','50943','55819','92564','63371',                           '24876','78941','65350','25650','96337',                           '21745','95872','50329','60371','91753',                           '85386','62492','77837','26220','45684',                           '44387','77658','51550','31775','82407',                           '84095','57674','56917','60388','25400',                           '21116','39526','14059','26652','86347',                           '19277','19469','82751','47704','67400',                           '55268','45395','22153','94539','53500',                           '50197','32191','57542','41247','99217',                           '90368','64503','96656','67646','34531',                           '48684','49184','96163','24566','84704',                           '80424','18581','21195','63667','16221',                           '94909','61071','76727','61111','81446',                           '37228','81923','47199','44584','45499',                           '37191','22759','88346','85013','91083',                           '65998','90533','58103','48051','10025',                           '76243','76634','45386','33171','32827',                           '37253','16419','89899','46788','26794',                           '12490','80886','69569','89718','36589',                           '84535','61873','59835','11272','42990',                           '34782','47250','84916','96630','36743',                           '23997','59375','40642','30968','43514',                           '96427','66132','11387','35278','39764',                           '45119','89093','48982','88532','40536',                           '28585','12630','70123','40524','46643',                           '28849','20410','87008','79995','17343',                           '66746','59447','99355','45148','37497',                           '99056','86146','17812','75553','13786',                           '17708','64655','70197','57897','42180',                           '76995','27980','81104','88667','63097',                           '67717','37289','89064','95779','39080',                           '29511','54671','76330','88268','99265',                           '10509','97215','48269','37083','70825',                           '98246','41675','10994','39438','13561',                           '38650','13534','34386','46673','82330',                           '72684','79493','99449','80873','52691',                           '58705','14422','78031','90499','86631',                           '65966','83753','57091','48108','35584',                           '29864','55651','42080','59156','83104',                           '20880','53730','58616','79982','43183',                           '56246','20080','51655','11247','65867',                           '30456','90945','33310','29899','64997',                           '83614','63321','51700','25316','50754',                           '14918','87831','87890','41914','15398',                           '32921','27410','28515','50354','35211',                           '88084','54092','26461','99255','25341',                           '80369','46865','44192','82643','24902',                           '69101','23045','49865','41546','81724',                           '51820','76602','44534','71854')      intersect       select ca_zip       from (SELECT substring(ca_zip,1,5) ca_zip,count(*) cnt             FROM customer_address, customer             WHERE ca_address_sk = c_current_addr_sk and                   c_preferred_cust_flag='Y'             group by ca_zip             having count(*) > 10)A1)A2) V1  where ss_store_sk = s_store_sk   and ss_sold_date_sk = d_date_sk   and d_qoy = 1 and d_year = 1998   and (substring(s_zip,1,2) = substring(V1.ca_zip,1,2))  group by s_store_name  order by s_store_name  ;", "predicates": {"customer": ["c_preferred_cust_flag"], "date_dim": ["d_qoy", "d_year"]}, "payload": {"customer": ["c_current_addr_sk"], "customer_address": ["ca_address_sk", "ca_zip"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 9, "query_string": " select case when (select count(*)                    from store_sales                    where ss_quantity between 1 and 20) > 3684             then (select avg(ss_ext_list_price)                    from store_sales                    where ss_quantity between 1 and 20)              else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 1 and 20) end bucket1 ,        case when (select count(*)                   from store_sales                   where ss_quantity between 21 and 40) > 30637             then (select avg(ss_ext_list_price)                   from store_sales                   where ss_quantity between 21 and 40)              else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 21 and 40) end bucket2,        case when (select count(*)                   from store_sales                   where ss_quantity between 41 and 60) > 45908             then (select avg(ss_ext_list_price)                   from store_sales                   where ss_quantity between 41 and 60)             else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 41 and 60) end bucket3,        case when (select count(*)                   from store_sales                   where ss_quantity between 61 and 80) > 53             then (select avg(ss_ext_list_price)                   from store_sales                   where ss_quantity between 61 and 80)             else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 61 and 80) end bucket4,        case when (select count(*)                   from store_sales                   where ss_quantity between 81 and 100) > 428             then (select avg(ss_ext_list_price)                   from store_sales                   where ss_quantity between 81 and 100)             else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 81 and 100) end bucket5 from reason where r_reason_sk = 1;", "predicates": {"store_sales": ["ss_quantity"]}, "payload": {"store_sales": ["ss_ext_tax", "ss_net_paid_inc_tax"]}, "group_by": {}, "order_by": {}}
{"id": 10, "query_string": " select top (100)    cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3,   cd_dep_count,   count(*) cnt4,   cd_dep_employed_count,   count(*) cnt5,   cd_dep_college_count,   count(*) cnt6  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_county in ('Johnson County','Oswego County','Henderson County','Cassia County','Venango County') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2001 and                 d_moy between 2 and 2+3) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 2 ANd 2+3) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 2 and 2+3))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count;", "predicates": {"customer_address": ["ca_county"], "date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 11, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag           ,c_birth_country          ,c_login          ,c_email_address          ,d_year   union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag           ,c_birth_country          ,c_login          ,c_email_address          ,d_year          )   select top (100)                    t_s_secyear.customer_id                  ,t_s_secyear.customer_first_name                  ,t_s_secyear.customer_last_name                  ,t_s_secyear.customer_login  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id          and t_s_firstyear.customer_id = t_w_secyear.customer_id          and t_s_firstyear.customer_id = t_w_firstyear.customer_id          and t_s_firstyear.sale_type = 's'          and t_w_firstyear.sale_type = 'w'          and t_s_secyear.sale_type = 's'          and t_w_secyear.sale_type = 'w'          and t_s_firstyear.dyear = 1999          and t_s_secyear.dyear = 1999+1          and t_w_firstyear.dyear = 1999          and t_w_secyear.dyear = 1999+1          and t_s_firstyear.year_total > 0          and t_w_firstyear.year_total > 0          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end              > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end  order by t_s_secyear.customer_id          ,t_s_secyear.customer_first_name          ,t_s_secyear.customer_last_name          ,t_s_secyear.customer_login;", "predicates": {"date_dim": ["d_year"]}, "payload": {"customer": ["c_login", "c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_ext_list_price", "ss_ext_discount_amt"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_discount_amt", "ws_ext_list_price"]}, "group_by": {}, "order_by": {}}
{"id": 12, "query_string": " select top (100) i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from\t \tweb_sales     \t,item      \t,date_dim where  \tws_item_sk = i_item_sk    \tand i_category in ('Sports', 'Children', 'Women')   \tand ws_sold_date_sk = d_date_sk \tand d_date between cast('1999-04-04' as date)  \t\t\t\tand dateadd(day, 30, cast('1999-04-04' as date)) group by  \ti_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  \ti_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_desc", "i_class", "i_item_id", "i_category"]}}
{"id": 13, "query_string": " select avg(ss_quantity)        ,avg(ss_ext_sales_price)        ,avg(ss_ext_wholesale_cost)        ,sum(ss_ext_wholesale_cost)  from store_sales      ,store      ,customer_demographics      ,household_demographics      ,customer_address      ,date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2001  and((ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'D'   and cd_education_status = '4 yr Degree'   and ss_sales_price between 100.00 and 150.00   and hd_dep_count = 3         )or      (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'S'   and cd_education_status = 'College'   and ss_sales_price between 50.00 and 100.00      and hd_dep_count = 1      ) or       (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'M'   and cd_education_status = 'Primary'   and ss_sales_price between 150.00 and 200.00    and hd_dep_count = 1        ))  and((ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('VA', 'OK', 'AR')   and ss_net_profit between 100 and 200        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('NC', 'SC', 'MS')   and ss_net_profit between 150 and 300        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('AL', 'KY', 'UT')   and ss_net_profit between 50 and 250        ));", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "household_demographics": ["hd_dep_count"], "store_sales": ["ss_sales_price", "ss_net_profit"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_dep_count", "hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_ext_sales_price", "ss_cdemo_sk", "ss_addr_sk", "ss_quantity", "ss_sales_price", "ss_ext_wholesale_cost", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 14, "query_string": " with  cross_items as  (select i_item_sk ss_item_sk  from item,  (select iss.i_brand_id brand_id      ,iss.i_class_id class_id      ,iss.i_category_id category_id  from store_sales      ,item iss      ,date_dim d1  where ss_item_sk = iss.i_item_sk    and ss_sold_date_sk = d1.d_date_sk    and d1.d_year between 2000 AND 2000 + 2  intersect   select ics.i_brand_id      ,ics.i_class_id      ,ics.i_category_id  from catalog_sales      ,item ics      ,date_dim d2  where cs_item_sk = ics.i_item_sk    and cs_sold_date_sk = d2.d_date_sk    and d2.d_year between 2000 AND 2000 + 2  intersect  select iws.i_brand_id      ,iws.i_class_id      ,iws.i_category_id  from web_sales      ,item iws      ,date_dim d3  where ws_item_sk = iws.i_item_sk    and ws_sold_date_sk = d3.d_date_sk    and d3.d_year between 2000 AND 2000 + 2) a  where i_brand_id = brand_id       and i_class_id = class_id       and i_category_id = category_id ),  avg_sales as  (select avg(quantity*list_price) average_sales   from (select ss_quantity quantity              ,ss_list_price list_price        from store_sales            ,date_dim        where ss_sold_date_sk = d_date_sk          and d_year between 2000 and 2000 + 2        union all         select cs_quantity quantity               ,cs_list_price list_price        from catalog_sales            ,date_dim        where cs_sold_date_sk = d_date_sk          and d_year between 2000 and 2000 + 2         union all        select ws_quantity quantity              ,ws_list_price list_price        from web_sales            ,date_dim        where ws_sold_date_sk = d_date_sk          and d_year between 2000 and 2000 + 2) x)   select top (100) channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)  from(        select 'store' channel, i_brand_id,i_class_id              ,i_category_id,sum(ss_quantity*ss_list_price) sales              , count(*) number_sales        from store_sales            ,item            ,date_dim        where ss_item_sk in (select ss_item_sk from cross_items)          and ss_item_sk = i_item_sk          and ss_sold_date_sk = d_date_sk          and d_year = 2000+2           and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)        union all        select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales        from catalog_sales            ,item            ,date_dim        where cs_item_sk in (select ss_item_sk from cross_items)          and cs_item_sk = i_item_sk          and cs_sold_date_sk = d_date_sk          and d_year = 2000+2           and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)        union all        select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales        from web_sales            ,item            ,date_dim        where ws_item_sk in (select ss_item_sk from cross_items)          and ws_item_sk = i_item_sk          and ws_sold_date_sk = d_date_sk          and d_year = 2000+2          and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)  ) y  group by rollup (channel, i_brand_id,i_class_id,i_category_id)  order by channel,i_brand_id,i_class_id,i_category_id  ; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_list_price", "cs_quantity"], "date_dim": ["d_date_sk"], "item": ["i_category_id", "i_class_id", "i_item_sk", "i_brand_id"], "store_sales": ["ss_sold_date_sk", "ss_list_price", "ss_quantity", "ss_item_sk"], "web_sales": ["ws_list_price", "ws_sold_date_sk", "ws_item_sk", "ws_quantity"]}, "group_by": {}, "order_by": {}}
{"id": 15, "query_string": " select top (100) ca_zip        ,sum(cs_sales_price)  from catalog_sales      ,customer      ,customer_address      ,date_dim  where cs_bill_customer_sk = c_customer_sk  \tand c_current_addr_sk = ca_address_sk   \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',                                    '85392', '85460', '80348', '81792')  \t      or ca_state in ('CA','WA','GA')  \t      or cs_sales_price > 500)  \tand cs_sold_date_sk = d_date_sk  \tand d_qoy = 1 and d_year = 2002  group by ca_zip  order by ca_zip  ;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"catalog_sales": ["cs_sales_price", "cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip", "ca_state"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_zip"]}}
{"id": 16, "query_string": " select top (100)     count(distinct cs_order_number) as \"order count\"   ,sum(cs_ext_ship_cost) as \"total shipping cost\"   ,sum(cs_net_profit) as \"total net profit\" from    catalog_sales cs1   ,date_dim   ,customer_address   ,call_center where     d_date between '1999-2-01' and             dateadd(day, 60, cast('1999-2-01' as date)) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'KY' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County',                   'Williamson County' ) and exists (select *             from catalog_sales cs2             where cs1.cs_order_number = cs2.cs_order_number               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select *                from catalog_returns cr1                where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number);", "predicates": {"call_center": ["cc_county"], "customer_address": ["ca_state"], "date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_order_number"], "catalog_sales": ["cs_order_number", "cs_warehouse_sk", "cs_ext_ship_cost", "cs_ship_addr_sk", "cs_net_profit", "cs_call_center_sk", "cs_ship_date_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 17, "query_string": " select top (100) i_item_id        ,i_item_desc        ,s_state        ,count(ss_quantity) as store_sales_quantitycount        ,avg(ss_quantity) as store_sales_quantityave        ,stdev(ss_quantity) as store_sales_quantitystdev        ,stdev(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov        ,count(sr_return_quantity) as store_returns_quantitycount        ,avg(sr_return_quantity) as store_returns_quantityave        ,stdev(sr_return_quantity) as store_returns_quantitystdev        ,stdev(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov        ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave        ,stdev(cs_quantity) as catalog_sales_quantitystdev        ,stdev(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov  from store_sales      ,store_returns      ,catalog_sales      ,date_dim d1      ,date_dim d2      ,date_dim d3      ,store      ,item  where d1.d_quarter_name = '2002Q1'    and d1.d_date_sk = ss_sold_date_sk    and i_item_sk = ss_item_sk    and s_store_sk = ss_store_sk    and ss_customer_sk = sr_customer_sk    and ss_item_sk = sr_item_sk    and ss_ticket_number = sr_ticket_number    and sr_returned_date_sk = d2.d_date_sk    and d2.d_quarter_name in ('2002Q1','2002Q2','2002Q3')    and sr_customer_sk = cs_bill_customer_sk    and sr_item_sk = cs_item_sk    and cs_sold_date_sk = d3.d_date_sk    and d3.d_quarter_name in ('2002Q1','2002Q2','2002Q3')  group by i_item_id          ,i_item_desc          ,s_state  order by i_item_id          ,i_item_desc          ,s_state;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_quarter_name"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_state", "s_store_sk"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_return_quantity", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 18, "query_string": " select top (100) i_item_id,         ca_country,         ca_state,          ca_county,         avg( cast(cs_quantity as decimal(12,2))) agg1,         avg( cast(cs_list_price as decimal(12,2))) agg2,         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,         avg( cast(cs_sales_price as decimal(12,2))) agg4,         avg( cast(cs_net_profit as decimal(12,2))) agg5,         avg( cast(c_birth_year as decimal(12,2))) agg6,         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7  from catalog_sales, customer_demographics cd1,        customer_demographics cd2, customer, customer_address, date_dim, item  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd1.cd_demo_sk and        cs_bill_customer_sk = c_customer_sk and        cd1.cd_gender = 'F' and         cd1.cd_education_status = 'Secondary' and        c_current_cdemo_sk = cd2.cd_demo_sk and        c_current_addr_sk = ca_address_sk and        c_birth_month in (1,8,9,7,11,10) and        d_year = 1999 and        ca_state in ('PA','MN','VA'                    ,'LA','NE','GA','MI')  group by rollup (i_item_id, ca_country, ca_state, ca_county)  order by ca_country,         ca_state,          ca_county, \ti_item_id  ;", "predicates": {"customer": ["c_birth_month"], "customer_address": ["ca_state"], "customer_demographics": ["cd_education_status", "cd_gender"], "date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_quantity", "cs_sales_price", "cs_bill_customer_sk", "cs_item_sk", "cs_net_profit", "cs_list_price", "cs_coupon_amt", "cs_sold_date_sk", "cs_bill_cdemo_sk"], "customer": ["c_birth_year", "c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_county", "ca_country", "ca_state"], "customer_demographics": ["cd_demo_sk", "cd_dep_count"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_state", "ca_county", "ca_country"], "item": ["i_item_id"]}}
{"id": 19, "query_string": " select top (100) i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,  \tsum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item,customer,customer_address,store  where d_date_sk = ss_sold_date_sk    and ss_item_sk = i_item_sk    and i_manager_id=22    and d_moy=11    and d_year=2001    and ss_customer_sk = c_customer_sk     and c_current_addr_sk = ca_address_sk    and substring(ca_zip,1,5) <> substring(s_zip,1,5)     and ss_store_sk = s_store_sk   group by i_brand       ,i_brand_id       ,i_manufact_id       ,i_manufact  order by ext_price desc          ,i_brand          ,i_brand_id          ,i_manufact_id          ,i_manufact  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip"], "date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_brand_id", "i_manufact_id", "i_brand", "i_manufact"], "store": ["s_zip", "s_store_sk"]}, "group_by": {}, "order_by": {"item": ["i_brand", "i_manufact", "i_brand_id", "i_manufact_id"]}}
{"id": 20, "query_string": " select top (100) i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from\tcatalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Sports', 'Children', 'Women')    and cs_sold_date_sk = d_date_sk  and d_date between cast('1999-04-04' as date)   \t\t\t\tand dateadd(day, 30, cast('1999-04-04' as date))  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"]}, "group_by": {}, "order_by": {"item": ["i_item_desc", "i_class", "i_item_id", "i_category"]}}
{"id": 21, "query_string": " select top (100) *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-06' as date)) \t                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-06' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between dateadd(day, -30, cast ('2002-03-06' as date))                     and dateadd(day, 30, cast ('2002-03-06' as date))    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  ;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"]}, "payload": {"date_dim": ["d_date_sk", "d_date"], "item": ["i_item_id", "i_item_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 22, "query_string": " select top (100) i_product_name              ,i_brand              ,i_class              ,i_category              ,avg(inv_quantity_on_hand) qoh        from inventory            ,date_dim            ,item        where inv_date_sk=d_date_sk               and inv_item_sk=i_item_sk               and d_month_seq between 1208 and 1208 + 11        group by rollup(i_product_name                        ,i_brand                        ,i_class                        ,i_category) order by qoh, i_product_name, i_brand, i_class, i_category;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_brand", "i_product_name", "i_category", "i_class"]}, "group_by": {}, "order_by": {"item": ["i_product_name", "i_class", "i_brand", "i_category"]}}
{"id": 23, "query_string": " with frequent_ss_items as   (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt   from store_sales       ,date_dim        ,item   where ss_sold_date_sk = d_date_sk     and ss_item_sk = i_item_sk      and d_year in (2000,2000+1,2000+2,2000+3)   group by substring(i_item_desc,1,30),i_item_sk,d_date   having count(*) >4),  max_store_sales as  (select max(csales) tpcds_cmax    from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales         from store_sales             ,customer             ,date_dim          where ss_customer_sk = c_customer_sk          and ss_sold_date_sk = d_date_sk          and d_year in (2000,2000+1,2000+2,2000+3)          group by c_customer_sk) a),  best_ss_customer as  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales   from store_sales       ,customer   where ss_customer_sk = c_customer_sk   group by c_customer_sk   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select   * from  max_store_sales))   select top (100) sum(sales)  from (select cs_quantity*cs_list_price sales        from catalog_sales            ,date_dim         where d_year = 2000           and d_moy = 1           and cs_sold_date_sk = d_date_sk           and cs_item_sk in (select item_sk from frequent_ss_items)          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)       union all       select ws_quantity*ws_list_price sales        from web_sales             ,date_dim         where d_year = 2000           and d_moy = 1           and ws_sold_date_sk = d_date_sk           and ws_item_sk in (select item_sk from frequent_ss_items)          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) b  ; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"customer": ["c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "item": ["i_item_sk", "i_item_desc"], "store_sales": ["ss_item_sk", "ss_sales_price", "ss_customer_sk", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 24, "query_string": " with ssales as (select c_last_name       ,c_first_name       ,s_store_name       ,ca_state       ,s_state       ,i_color       ,i_current_price       ,i_manager_id       ,i_units       ,i_size       ,sum(ss_sales_price) netpaid from store_sales     ,store_returns     ,store     ,item     ,customer     ,customer_address where ss_ticket_number = sr_ticket_number   and ss_item_sk = sr_item_sk   and ss_customer_sk = c_customer_sk   and ss_item_sk = i_item_sk   and ss_store_sk = s_store_sk   and c_current_addr_sk = ca_address_sk   and c_birth_country <> upper(ca_country)   and s_zip = ca_zip and s_market_id=9 group by c_last_name         ,c_first_name         ,s_store_name         ,ca_state         ,s_state         ,i_color         ,i_current_price         ,i_manager_id         ,i_units         ,i_size) select c_last_name       ,c_first_name       ,s_store_name       ,sum(netpaid) paid from ssales where i_color = 'lawn' group by c_last_name         ,c_first_name         ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid)                                  from ssales) order by c_last_name         ,c_first_name         ,s_store_name; ", "predicates": {"item": ["i_color"], "store": ["s_market_id"]}, "payload": {"customer": ["c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_current_addr_sk"], "customer_address": ["ca_address_sk", "ca_country", "ca_zip", "ca_state"], "item": ["i_item_sk", "i_units", "i_manager_id", "i_current_price", "i_size"], "store": ["s_zip", "s_store_name", "s_state", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_net_paid_inc_tax"]}, "group_by": {}, "order_by": {}}
{"id": 25, "query_string": " select top (100)   i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  ,stdev(ss_net_profit) as store_sales_profit  ,stdev(sr_net_loss) as store_returns_loss  ,stdev(cs_net_profit) as catalog_sales_profit  from  store_sales  ,store_returns  ,catalog_sales  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,item  where  d1.d_moy = 4  and d1.d_year = 2002  and d1.d_date_sk = ss_sold_date_sk  and i_item_sk = ss_item_sk  and s_store_sk = ss_store_sk  and ss_customer_sk = sr_customer_sk  and ss_item_sk = sr_item_sk  and ss_ticket_number = sr_ticket_number  and sr_returned_date_sk = d2.d_date_sk  and d2.d_moy               between 4 and  10  and d2.d_year              = 2002  and sr_customer_sk = cs_bill_customer_sk  and sr_item_sk = cs_item_sk  and cs_sold_date_sk = d3.d_date_sk  and d3.d_moy               between 4 and  10   and d3.d_year              = 2002  group by  i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  order by  i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  ;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_store_name", "s_store_sk", "s_store_id"], "store_returns": ["sr_returned_date_sk", "sr_net_loss", "sr_customer_sk", "sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 26, "query_string": " select top (100) i_item_id,          avg(cs_quantity) agg1,         avg(cs_list_price) agg2,         avg(cs_coupon_amt) agg3,         avg(cs_sales_price) agg4   from catalog_sales, customer_demographics, date_dim, item, promotion  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd_demo_sk and        cs_promo_sk = p_promo_sk and        cd_gender = 'F' and         cd_marital_status = 'U' and        cd_education_status = 'Advanced Degree' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 2001   group by i_item_id  order by i_item_id  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "promotion": ["p_channel_event", "p_channel_email"]}, "payload": {"item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 27, "query_string": " select top (100) i_item_id,         s_state, grouping(s_state) g_state,         avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4  from store_sales, customer_demographics, date_dim, store, item  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_store_sk = s_store_sk and        ss_cdemo_sk = cd_demo_sk and        cd_gender = 'M' and        cd_marital_status = 'D' and        cd_education_status = 'College' and        d_year = 1999 and        s_state in ('TN','TN', 'TN', 'TN', 'TN', 'TN')  group by rollup (i_item_id, s_state)  order by i_item_id          ,s_state  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "store": ["s_state"]}, "payload": {"customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"], "store": ["s_state", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_cdemo_sk", "ss_list_price", "ss_quantity", "ss_sales_price", "ss_coupon_amt", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_id"], "store": ["s_state"]}}
{"id": 28, "query_string": " select top (100) * from (select avg(ss_list_price) B1_LP             ,count(ss_list_price) B1_CNT             ,count(distinct ss_list_price) B1_CNTD       from store_sales       where ss_quantity between 0 and 5         and (ss_list_price between 73 and 73+10               or ss_coupon_amt between 7462 and 7462+1000              or ss_wholesale_cost between 34 and 34+20)) B1,      (select avg(ss_list_price) B2_LP             ,count(ss_list_price) B2_CNT             ,count(distinct ss_list_price) B2_CNTD       from store_sales       where ss_quantity between 6 and 10         and (ss_list_price between 68 and 68+10           or ss_coupon_amt between 4919 and 4919+1000           or ss_wholesale_cost between 70 and 70+20)) B2,      (select avg(ss_list_price) B3_LP             ,count(ss_list_price) B3_CNT             ,count(distinct ss_list_price) B3_CNTD       from store_sales       where ss_quantity between 11 and 15         and (ss_list_price between 146 and 146+10           or ss_coupon_amt between 16570 and 16570+1000           or ss_wholesale_cost between 22 and 22+20)) B3,      (select avg(ss_list_price) B4_LP             ,count(ss_list_price) B4_CNT             ,count(distinct ss_list_price) B4_CNTD       from store_sales       where ss_quantity between 16 and 20         and (ss_list_price between 32 and 32+10           or ss_coupon_amt between 4755 and 4755+1000           or ss_wholesale_cost between 77 and 77+20)) B4,      (select avg(ss_list_price) B5_LP             ,count(ss_list_price) B5_CNT             ,count(distinct ss_list_price) B5_CNTD       from store_sales       where ss_quantity between 21 and 25         and (ss_list_price between 19 and 19+10           or ss_coupon_amt between 5864 and 5864+1000           or ss_wholesale_cost between 53 and 53+20)) B5,      (select avg(ss_list_price) B6_LP             ,count(ss_list_price) B6_CNT             ,count(distinct ss_list_price) B6_CNTD       from store_sales       where ss_quantity between 26 and 30         and (ss_list_price between 36 and 36+10           or ss_coupon_amt between 6077 and 6077+1000           or ss_wholesale_cost between 56 and 56+20)) B6;", "predicates": {"store_sales": ["ss_list_price", "ss_coupon_amt", "ss_quantity", "ss_wholesale_cost"]}, "payload": {"store_sales": ["ss_list_price"]}, "group_by": {}, "order_by": {}}
{"id": 29, "query_string": " select top (100)        i_item_id     ,i_item_desc     ,s_store_id     ,s_store_name     ,avg(ss_quantity)        as store_sales_quantity     ,avg(sr_return_quantity) as store_returns_quantity     ,avg(cs_quantity)        as catalog_sales_quantity  from     store_sales    ,store_returns    ,catalog_sales    ,date_dim             d1    ,date_dim             d2    ,date_dim             d3    ,store    ,item  where      d1.d_moy               = 4   and d1.d_year              = 2000  and d1.d_date_sk           = ss_sold_date_sk  and i_item_sk              = ss_item_sk  and s_store_sk             = ss_store_sk  and ss_customer_sk         = sr_customer_sk  and ss_item_sk             = sr_item_sk  and ss_ticket_number       = sr_ticket_number  and sr_returned_date_sk    = d2.d_date_sk  and d2.d_moy               between 4 and  4 + 3   and d2.d_year              = 2000  and sr_customer_sk         = cs_bill_customer_sk  and sr_item_sk             = cs_item_sk  and cs_sold_date_sk        = d3.d_date_sk       and d3.d_year              in (2000,2000+1,2000+2)  group by     i_item_id    ,i_item_desc    ,s_store_id    ,s_store_name  order by     i_item_id     ,i_item_desc    ,s_store_id    ,s_store_name  ;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_store_name", "s_store_sk", "s_store_id"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_return_quantity", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 30, "query_string": " with customer_total_return as  (select wr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   \tsum(wr_return_amt) as ctr_total_return  from web_returns      ,date_dim      ,customer_address  where wr_returned_date_sk = d_date_sk     and d_year =2001    and wr_returning_addr_sk = ca_address_sk   group by wr_returning_customer_sk          ,ca_state)   select top (100) c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag        ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address        ,c_last_review_date,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  \t\t\t  from customer_total_return ctr2                    \t  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'MN'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag                   ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address                   ,c_last_review_date,ctr_total_return;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_year"]}, "payload": {"customer": ["c_birth_year", "c_login", "c_customer_sk", "c_birth_month", "c_salutation", "c_birth_day", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_current_addr_sk", "c_email_address", "c_customer_id", "c_last_review_date"], "customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "web_returns": ["wr_return_amt", "wr_returning_addr_sk", "wr_returned_date_sk", "wr_returning_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_birth_year", "c_login", "c_birth_month", "c_birth_country", "c_salutation", "c_birth_day", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id", "c_last_review_date"]}}
{"id": 31, "query_string": " with ss as  (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales  from store_sales,date_dim,customer_address  where ss_sold_date_sk = d_date_sk   and ss_addr_sk=ca_address_sk  group by ca_county,d_qoy, d_year),  ws as  (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales  from web_sales,date_dim,customer_address  where ws_sold_date_sk = d_date_sk   and ws_bill_addr_sk=ca_address_sk  group by ca_county,d_qoy, d_year)  select          ss1.ca_county        ,ss1.d_year        ,ws2.web_sales/ws1.web_sales web_q1_q2_increase        ,ss2.store_sales/ss1.store_sales store_q1_q2_increase        ,ws3.web_sales/ws2.web_sales web_q2_q3_increase        ,ss3.store_sales/ss2.store_sales store_q2_q3_increase  from         ss ss1        ,ss ss2        ,ss ss3        ,ws ws1        ,ws ws2        ,ws ws3  where     ss1.d_qoy = 1     and ss1.d_year = 2002     and ss1.ca_county = ss2.ca_county     and ss2.d_qoy = 2     and ss2.d_year = 2002  and ss2.ca_county = ss3.ca_county     and ss3.d_qoy = 3     and ss3.d_year = 2002     and ss1.ca_county = ws1.ca_county     and ws1.d_qoy = 1     and ws1.d_year = 2002     and ws1.ca_county = ws2.ca_county     and ws2.d_qoy = 2     and ws2.d_year = 2002     and ws1.ca_county = ws3.ca_county     and ws3.d_qoy = 3     and ws3.d_year =2002     and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end         > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end     and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end        > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end  order by web_q2_q3_increase;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"customer_address": ["ca_address_sk", "ca_county"], "date_dim": ["d_date_sk", "d_year"], "store_sales": ["ss_sold_date_sk", "ss_addr_sk", "ss_ext_sales_price"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_bill_addr_sk"]}, "group_by": {}, "order_by": {}}
{"id": 32, "query_string": " select top (100) sum(cs_ext_discount_amt)  as \"excess discount amount\"  from     catalog_sales     ,item     ,date_dim where i_manufact_id = 948 and i_item_sk = cs_item_sk  and d_date between '2001-03-15' and          dateadd(day, 90, cast('2001-03-15' as date)) and d_date_sk = cs_sold_date_sk  and cs_ext_discount_amt        > (           select              1.3 * avg(cs_ext_discount_amt)           from              catalog_sales             ,date_dim          where                cs_item_sk = i_item_sk            and d_date between '2001-03-15' and                              dateadd(day, 90, cast('2001-03-15' as date))           and d_date_sk = cs_sold_date_sk        ) ;", "predicates": {"catalog_sales": ["cs_ext_discount_amt"], "date_dim": ["d_date"], "item": ["i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 33, "query_string": " with ss as (  select           i_manufact_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id in (select   i_manufact_id from  item where i_category in ('Jewelry'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 5  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  cs as (  select           i_manufact_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Jewelry'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 5  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  ws as (  select           i_manufact_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Jewelry'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 5  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_manufact_id)   select top (100) i_manufact_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_manufact_id  order by total_sales;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_category"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_addr_sk", "cs_item_sk", "cs_ext_sales_price"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_manufact_id"], "store_sales": ["ss_sold_date_sk", "ss_addr_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk", "ws_bill_addr_sk"]}, "group_by": {}, "order_by": {}}
{"id": 34, "query_string": " select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '1001-5000' or          household_demographics.hd_buy_potential = 'Unknown')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  \tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  \telse null  \tend)  > 1.2     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',                            'Williamson County','Williamson County','Williamson County','Williamson County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;", "predicates": {"date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count", "hd_buy_potential"], "store": ["s_county"]}, "payload": {"customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_preferred_cust_flag"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 35, "query_string": " select top (100)     ca_state,   cd_gender,   cd_marital_status,   cd_dep_count,   count(*) cnt1,   stdev(cd_dep_count),   max(cd_dep_count),   avg(cd_dep_count),   cd_dep_employed_count,   count(*) cnt2,   stdev(cd_dep_employed_count),   max(cd_dep_employed_count),   avg(cd_dep_employed_count),   cd_dep_college_count,   count(*) cnt3,   stdev(cd_dep_college_count),   max(cd_dep_college_count),   avg(cd_dep_college_count)  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 1999 and                 d_qoy < 4) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 1999 and                   d_qoy < 4) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 1999 and                   d_qoy < 4))  group by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  ;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_state"], "customer_demographics": ["cd_dep_college_count", "cd_gender", "cd_demo_sk", "cd_dep_employed_count", "cd_dep_count", "cd_marital_status"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 36, "query_string": " select top (100)      sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  \tpartition by grouping(i_category)+grouping(i_class),  \tcase when grouping(i_class) = 0 then i_category end   \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent  from     store_sales    ,date_dim       d1    ,item    ,store  where     d1.d_year = 2002   and d1.d_date_sk = ss_sold_date_sk  and i_item_sk  = ss_item_sk   and s_store_sk  = ss_store_sk  and s_state in ('TN','TN','TN','TN',                  'TN','TN','TN','TN')  group by rollup(i_category,i_class)  order by    lochierarchy desc   ,case when (grouping(i_category)+grouping(i_class)) = 0 then i_category end   ,rank_within_parent   ;", "predicates": {"date_dim": ["d_year"], "store": ["s_state"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_class", "i_item_sk", "i_category"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_ext_sales_price", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 37, "query_string": " select top (100) i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 18 and 18 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('1998-03-23' as date) and dateadd(day, 60, cast('1998-03-23' as date))  and i_manufact_id in (973,987,742,846)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  ;", "predicates": {"date_dim": ["d_date"], "inventory": ["inv_quantity_on_hand"], "item": ["i_current_price", "i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc", "i_current_price"]}, "group_by": {}, "order_by": {}}
{"id": 38, "query_string": " select top (100) count(*) from (     select distinct c_last_name, c_first_name, d_date     from store_sales, date_dim, customer           where store_sales.ss_sold_date_sk = date_dim.d_date_sk       and store_sales.ss_customer_sk = customer.c_customer_sk       and d_month_seq between 1208 and 1208 + 11   intersect     select distinct c_last_name, c_first_name, d_date     from catalog_sales, date_dim, customer           where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk       and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk       and d_month_seq between 1208 and 1208 + 11   intersect     select distinct c_last_name, c_first_name, d_date     from web_sales, date_dim, customer           where web_sales.ws_sold_date_sk = date_dim.d_date_sk       and web_sales.ws_bill_customer_sk = customer.c_customer_sk       and d_month_seq between 1208 and 1208 + 11 ) hot_cust;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk", "ws_item_sk", "ws_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 39, "query_string": " with inv as (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy        ,stdev,mean, case mean when 0 then null else stdev/mean end cov  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy             ,stdev(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean       from inventory           ,item           ,warehouse           ,date_dim       where inv_item_sk = i_item_sk         and inv_warehouse_sk = w_warehouse_sk         and inv_date_sk = d_date_sk         and d_year =2002       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo  where case mean when 0 then 0 else stdev/mean end > 1) select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov from inv inv1,inv inv2 where inv1.i_item_sk = inv2.i_item_sk   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk   and inv1.d_moy=2   and inv2.d_moy=2+1 order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov         ,inv2.d_moy,inv2.mean, inv2.cov; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_item_sk"], "warehouse": ["w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 40, "query_string": " select top (100)     w_state   ,i_item_id   ,sum(case when (cast(d_date as date) < cast ('2002-03-06' as date))   \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before   ,sum(case when (cast(d_date as date) >= cast ('2002-03-06' as date))   \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after  from    catalog_sales left outer join catalog_returns on        (cs_order_number = cr_order_number          and cs_item_sk = cr_item_sk)   ,warehouse    ,item   ,date_dim  where      i_current_price between 0.99 and 1.49  and i_item_sk          = cs_item_sk  and cs_warehouse_sk    = w_warehouse_sk   and cs_sold_date_sk    = d_date_sk  and d_date between dateadd(day, -30, cast ('2002-03-06' as date))                 and dateadd(day, 30, cast ('2002-03-06' as date))   group by     w_state,i_item_id  order by w_state,i_item_id;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_refunded_cash"], "date_dim": ["d_date_sk", "d_date"], "item": ["i_item_id", "i_item_sk"], "warehouse": ["w_state", "w_warehouse_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_id"], "warehouse": ["w_state"]}}
{"id": 41, "query_string": " select distinct top (100) i_product_name  from item i1  where i_manufact_id between 732 and 732+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'bisque' or i_color = 'maroon') and          (i_units = 'Box' or i_units = 'Each') and         (i_size = 'extra large' or i_size = 'small')         ) or         (i_category = 'Women' and         (i_color = 'snow' or i_color = 'ivory') and         (i_units = 'Carton' or i_units = 'Dram') and         (i_size = 'medium' or i_size = 'large')         ) or         (i_category = 'Men' and         (i_color = 'yellow' or i_color = 'dark') and         (i_units = 'Bunch' or i_units = 'Tbl') and         (i_size = 'economy' or i_size = 'N/A')         ) or         (i_category = 'Men' and         (i_color = 'lace' or i_color = 'deep') and         (i_units = 'Ounce' or i_units = 'Pound') and         (i_size = 'extra large' or i_size = 'small')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'gainsboro' or i_color = 'light') and          (i_units = 'Bundle' or i_units = 'Cup') and         (i_size = 'extra large' or i_size = 'small')         ) or         (i_category = 'Women' and         (i_color = 'khaki' or i_color = 'floral') and         (i_units = 'Oz' or i_units = 'Ton') and         (i_size = 'medium' or i_size = 'large')         ) or         (i_category = 'Men' and         (i_color = 'chocolate' or i_color = 'sky') and         (i_units = 'Case' or i_units = 'Tsp') and         (i_size = 'economy' or i_size = 'N/A')         ) or         (i_category = 'Men' and         (i_color = 'lime' or i_color = 'tomato') and         (i_units = 'Unknown' or i_units = 'Dozen') and         (i_size = 'extra large' or i_size = 'small')         )))) > 0  order by i_product_name  ;", "predicates": {"item": ["i_color", "i_units", "i_manufact_id", "i_category", "i_size", "i_manufact"]}, "payload": {"item": ["i_color", "i_units", "i_product_name", "i_category", "i_size", "i_manufact"]}, "group_by": {}, "order_by": {}}
{"id": 42, "query_string": " select top (100) dt.d_year  \t,item.i_category_id  \t,item.i_category  \t,sum(ss_ext_sales_price)  from \tdate_dim dt  \t,store_sales  \t,item  where dt.d_date_sk = store_sales.ss_sold_date_sk  \tand store_sales.ss_item_sk = item.i_item_sk  \tand item.i_manager_id = 1  \t  \tand dt.d_moy=12  \tand dt.d_year=2002  group by \tdt.d_year  \t\t,item.i_category_id  \t\t,item.i_category  order by       sum(ss_ext_sales_price) desc,dt.d_year  \t\t,item.i_category_id  \t\t,item.i_category  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_item_sk", "i_category", "i_category_id"]}, "group_by": {}, "order_by": {"item": ["i_category", "i_category_id"]}}
{"id": 43, "query_string": " select top (100) s_store_name, s_store_id,         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales  from date_dim, store_sales, store  where d_date_sk = ss_sold_date_sk and        s_store_sk = ss_store_sk and        s_gmt_offset = -5 and        d_year = 2002   group by s_store_name, s_store_id  order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales  ;", "predicates": {"date_dim": ["d_year"], "store": ["s_gmt_offset"]}, "payload": {"date_dim": ["d_date_sk", "d_day_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 44, "query_string": " select top (100) asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing from(select *      from (select item_sk,rank() over (order by rank_col asc) rnk            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col                   from store_sales ss1                  where ss_store_sk = 5                  group by ss_item_sk                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col                                                   from store_sales                                                   where ss_store_sk = 5                                                     and ss_promo_sk is null                                                   group by ss_store_sk))V1)V11      where rnk  < 11) asceding,     (select *      from (select item_sk,rank() over (order by rank_col desc) rnk            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col                  from store_sales ss1                  where ss_store_sk = 5                  group by ss_item_sk                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col                                                   from store_sales                                                   where ss_store_sk = 5                                                     and ss_promo_sk is null                                                   group by ss_store_sk))V2)V21      where rnk  < 11) descending, item i1, item i2 where asceding.rnk = descending.rnk    and i1.i_item_sk=asceding.item_sk   and i2.i_item_sk=descending.item_sk order by asceding.rnk;", "predicates": {"store_sales": ["ss_store_sk", "ss_customer_sk"]}, "payload": {"store_sales": ["ss_net_profit", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 45, "query_string": " select top (100) ca_zip, ca_state, sum(ws_sales_price)  from web_sales, customer, customer_address, date_dim, item  where ws_bill_customer_sk = c_customer_sk  \tand c_current_addr_sk = ca_address_sk   \tand ws_item_sk = i_item_sk   \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')  \t      or   \t      i_item_id in (select i_item_id                              from item                              where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)                              )  \t    )  \tand ws_sold_date_sk = d_date_sk  \tand d_qoy = 2 and d_year = 2000  group by ca_zip, ca_state  order by ca_zip, ca_state  ;", "predicates": {"customer_address": ["ca_zip"], "date_dim": ["d_qoy", "d_year"], "item": ["i_item_id"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip", "ca_city"], "date_dim": ["d_date_sk"], "web_sales": ["ws_sales_price", "ws_sold_date_sk", "ws_bill_customer_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 46, "query_string": " select top (100) c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,ca_city bought_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics,customer_address      where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and (household_demographics.hd_dep_count = 3 or          household_demographics.hd_vehicle_count= 3)     and date_dim.d_dow in (6,0)     and date_dim.d_year in (1999,1999+1,1999+2)      and store.s_city in ('Fairview','Midway','Midway','Fairview','Fairview')      group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr     where ss_customer_sk = c_customer_sk       and customer.c_current_addr_sk = current_addr.ca_address_sk       and current_addr.ca_city <> bought_city   order by c_last_name           ,c_first_name           ,ca_city           ,bought_city           ,ss_ticket_number   ;", "predicates": {"date_dim": ["d_dow", "d_year"], "household_demographics": ["hd_vehicle_count", "hd_dep_count"], "store": ["s_city"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk", "c_first_name", "c_last_name"], "customer_address": ["ca_city", "ca_address_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_addr_sk", "ss_coupon_amt", "ss_customer_sk", "ss_hdemo_sk", "ss_net_profit", "ss_sold_date_sk", "ss_store_sk", "ss_ticket_number"]}, "group_by": {}, "order_by": {}}
{"id": 47, "query_string": " with v1 as(  select i_category, i_brand,         s_store_name, s_company_name,         d_year, d_moy,         sum(ss_sales_price) sum_sales,         avg(sum(ss_sales_price)) over           (partition by i_category, i_brand,                      s_store_name, s_company_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      s_store_name, s_company_name            order by d_year, d_moy) rn  from item, store_sales, date_dim, store  where ss_item_sk = i_item_sk and        ss_sold_date_sk = d_date_sk and        ss_store_sk = s_store_sk and        (          d_year = 1999 or          ( d_year = 1999-1 and d_moy =12) or          ( d_year = 1999+1 and d_moy =1)        )  group by i_category, i_brand,           s_store_name, s_company_name,           d_year, d_moy),  v2 as(  select v1.s_company_name         ,v1.d_year         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1.s_store_name = v1_lag.s_store_name and        v1.s_store_name = v1_lead.s_store_name and        v1.s_company_name = v1_lag.s_company_name and        v1.s_company_name = v1_lead.s_company_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select top (100) *  from v2  where  d_year = 1999 and             avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, avg_monthly_sales  ;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk", "d_moy", "d_year"], "item": ["i_brand", "i_item_sk", "i_category"], "store": ["s_store_name", "s_store_sk", "s_company_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 48, "query_string": " select sum (ss_quantity)  from store_sales, store, customer_demographics, customer_address, date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 1998  and    (   (    cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'M'    and     cd_education_status = 'Primary'    and     ss_sales_price between 100.00 and 150.00      )  or   (   cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'W'    and     cd_education_status = 'Secondary'    and     ss_sales_price between 50.00 and 100.00      )  or   (   cd_demo_sk = ss_cdemo_sk   and     cd_marital_status = 'D'    and     cd_education_status = 'Advanced Degree'    and     ss_sales_price between 150.00 and 200.00    )  )  and  (   (   ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('VA', 'KY', 'CT')   and ss_net_profit between 0 and 2000     )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('IL', 'ID', 'IA')   and ss_net_profit between 150 and 3000    )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('NY', 'WI', 'NV')   and ss_net_profit between 50 and 25000    )  );", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "store_sales": ["ss_sales_price", "ss_net_profit"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_cdemo_sk", "ss_addr_sk", "ss_quantity", "ss_sales_price", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 49, "query_string": " select top (100) channel, item, return_ratio, return_rank, currency_rank from  (select  'web' as channel  ,web.item  ,web.return_ratio  ,web.return_rank  ,web.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect ws.ws_item_sk as item  \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\t web_sales ws left outer join web_returns wr   \t\t\ton (ws.ws_order_number = wr.wr_order_number and   \t\t\tws.ws_item_sk = wr.wr_item_sk)                  ,date_dim  \t\twhere   \t\t\twr.wr_return_amt > 10000   \t\t\tand ws.ws_net_profit > 1                          and ws.ws_net_paid > 0                          and ws.ws_quantity > 0                          and ws_sold_date_sk = d_date_sk                          and d_year = 2002                          and d_moy = 11  \t\tgroup by ws.ws_item_sk  \t) in_web  ) web  where   (  web.return_rank <= 10  or  web.currency_rank <= 10  )  union  select   'catalog' as channel  ,catalog.item  ,catalog.return_ratio  ,catalog.return_rank  ,catalog.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect   \t\tcs.cs_item_sk as item  \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\tcatalog_sales cs left outer join catalog_returns cr  \t\t\ton (cs.cs_order_number = cr.cr_order_number and   \t\t\tcs.cs_item_sk = cr.cr_item_sk)                 ,date_dim  \t\twhere   \t\t\tcr.cr_return_amount > 10000   \t\t\tand cs.cs_net_profit > 1                          and cs.cs_net_paid > 0                          and cs.cs_quantity > 0                          and cs_sold_date_sk = d_date_sk                          and d_year = 2002                          and d_moy = 11                  group by cs.cs_item_sk  \t) in_cat  ) catalog  where   (  catalog.return_rank <= 10  or  catalog.currency_rank <=10  )  union  select   'store' as channel  ,store.item  ,store.return_ratio  ,store.return_rank  ,store.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect sts.ss_item_sk as item  \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\tstore_sales sts left outer join store_returns sr  \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)                 ,date_dim  \t\twhere   \t\t\tsr.sr_return_amt > 10000   \t\t\tand sts.ss_net_profit > 1                          and sts.ss_net_paid > 0                           and sts.ss_quantity > 0                          and ss_sold_date_sk = d_date_sk                          and d_year = 2002                          and d_moy = 11  \t\tgroup by sts.ss_item_sk  \t) in_store  ) store  where  (  store.return_rank <= 10  or   store.currency_rank <= 10  )  ) a  order by 1,4,5,2  ;", "predicates": {"catalog_returns": ["cr_return_amount"], "catalog_sales": ["cs_net_paid", "cs_net_profit", "cs_quantity"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_return_amt"], "store_sales": ["ss_net_paid", "ss_quantity", "ss_net_profit"], "web_returns": ["wr_return_amt"], "web_sales": ["ws_net_profit", "ws_net_paid", "ws_quantity"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_quantity", "cr_return_amount"], "store_returns": ["sr_return_amt", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_return_amt", "wr_return_quantity", "wr_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 50, "query_string": " select top (100)     s_store_name   ,s_company_id   ,s_street_number   ,s_street_name   ,s_street_type   ,s_suite_number   ,s_city   ,s_county   ,s_state   ,s_zip   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and                   (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and                   (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and                  (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    store_sales   ,store_returns   ,store   ,date_dim d1   ,date_dim d2 where     d2.d_year = 2002 and d2.d_moy  = 9 and ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_sold_date_sk   = d1.d_date_sk and sr_returned_date_sk   = d2.d_date_sk and ss_customer_sk = sr_customer_sk and ss_store_sk = s_store_sk group by    s_store_name   ,s_company_id   ,s_street_number   ,s_street_name   ,s_street_type   ,s_suite_number   ,s_city   ,s_county   ,s_state   ,s_zip order by s_store_name         ,s_company_id         ,s_street_number         ,s_street_name         ,s_street_type         ,s_suite_number         ,s_city         ,s_county         ,s_state         ,s_zip;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 51, "query_string": " WITH web_v1 as ( select   ws_item_sk item_sk, d_date,   sum(sum(ws_sales_price))       over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from web_sales     ,date_dim where ws_sold_date_sk=d_date_sk   and d_month_seq between 1208 and 1208+11   and ws_item_sk is not NULL group by ws_item_sk, d_date), store_v1 as ( select   ss_item_sk item_sk, d_date,   sum(sum(ss_sales_price))       over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from store_sales     ,date_dim where ss_sold_date_sk=d_date_sk   and d_month_seq between 1208 and 1208+11   and ss_item_sk is not NULL group by ss_item_sk, d_date)  select top (100) * from (select item_sk      ,d_date      ,web_sales      ,store_sales      ,max(web_sales)          over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative      ,max(store_sales)          over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative      from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk                  ,case when web.d_date is not null then web.d_date else store.d_date end d_date                  ,web.cume_sales web_sales                  ,store.cume_sales store_sales            from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk                                                           and web.d_date = store.d_date)           )x )y where web_cumulative > store_cumulative order by item_sk         ,d_date;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_sales_price", "ss_item_sk"], "web_sales": ["ws_sold_date_sk", "ws_sales_price", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 52, "query_string": " select top (100) dt.d_year  \t,item.i_brand_id brand_id  \t,item.i_brand brand  \t,sum(ss_ext_sales_price) ext_price  from date_dim dt      ,store_sales      ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=2002  group by dt.d_year  \t,item.i_brand  \t,item.i_brand_id  order by dt.d_year  \t,ext_price desc  \t,brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"item": ["i_brand_id"]}}
{"id": 53, "query_string": " select top (100) * from  (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1208,1208+1,1208+2,1208+3,1208+4,1208+5,1208+6,1208+7,1208+8,1208+9,1208+10,1208+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', \t\t'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', \t\t'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0  \tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales  \telse null end > 0.1 order by avg_quarterly_sales, \t sum_sales, \t i_manufact_id;", "predicates": {"date_dim": ["d_month_seq"], "item": ["i_brand", "i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_qoy"], "item": ["i_item_sk", "i_manufact_id", "i_brand", "i_category", "i_class"], "store": ["s_store_sk"]}, "group_by": {}, "order_by": {}}
{"id": 54, "query_string": " with my_customers as (  select distinct c_customer_sk         , c_current_addr_sk  from            ( select cs_sold_date_sk sold_date_sk,                  cs_bill_customer_sk customer_sk,                  cs_item_sk item_sk           from   catalog_sales           union all           select ws_sold_date_sk sold_date_sk,                  ws_bill_customer_sk customer_sk,                  ws_item_sk item_sk           from   web_sales          ) cs_or_ws_sales,          item,          date_dim,          customer  where   sold_date_sk = d_date_sk          and item_sk = i_item_sk          and i_category = 'Books'          and i_class = 'science'          and c_customer_sk = cs_or_ws_sales.customer_sk          and d_moy = 5          and d_year = 2001  )  , my_revenue as (  select c_customer_sk,         sum(ss_ext_sales_price) as revenue  from   my_customers,         store_sales,         customer_address,         store,         date_dim  where  c_current_addr_sk = ca_address_sk         and ca_county = s_county         and ca_state = s_state         and ss_sold_date_sk = d_date_sk         and c_customer_sk = ss_customer_sk         and d_month_seq between (select distinct d_month_seq+1                                  from   date_dim where d_year = 2001 and d_moy = 5)                            and  (select distinct d_month_seq+3                                  from   date_dim where d_year = 2001 and d_moy = 5)  group by c_customer_sk  )  , segments as  (select cast((revenue/50) as int) as segment   from   my_revenue  )   select top (100) segment, count(*) as num_customers, segment*50 as segment_base  from segments  group by segment  order by segment, num_customers  ;", "predicates": {"date_dim": ["d_month_seq", "d_moy", "d_year"], "item": ["i_class", "i_category"]}, "payload": {"customer_address": ["ca_address_sk", "ca_county", "ca_state"], "date_dim": ["d_date_sk", "d_month_seq"], "item": ["i_item_sk"], "store": ["s_state", "s_county"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_ext_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 55, "query_string": " select top (100) i_brand_id brand_id, i_brand brand,  \tsum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item  where d_date_sk = ss_sold_date_sk  \tand ss_item_sk = i_item_sk  \tand i_manager_id=44  \tand d_moy=11  \tand d_year=2000  group by i_brand, i_brand_id  order by ext_price desc, i_brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"item": ["i_brand_id"]}}
{"id": 56, "query_string": " with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('grey','green','almond'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 5  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('grey','green','almond'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 5  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('grey','green','almond'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 5  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_item_id)   select top (100) i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  ;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_color"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 57, "query_string": " with v1 as(  select i_category, i_brand,         cc_name,         d_year, d_moy,         sum(cs_sales_price) sum_sales,         avg(sum(cs_sales_price)) over           (partition by i_category, i_brand,                      cc_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      cc_name            order by d_year, d_moy) rn  from item, catalog_sales, date_dim, call_center  where cs_item_sk = i_item_sk and        cs_sold_date_sk = d_date_sk and        cc_call_center_sk= cs_call_center_sk and        (          d_year = 1999 or          ( d_year = 1999-1 and d_moy =12) or          ( d_year = 1999+1 and d_moy =1)        )  group by i_category, i_brand,           cc_name , d_year, d_moy),  v2 as(  select v1.i_category, v1.i_brand, v1.cc_name         ,v1.d_year         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1. cc_name = v1_lag. cc_name and        v1. cc_name = v1_lead. cc_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select top (100) *  from v2  where  d_year = 1999 and         avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, avg_monthly_sales  ;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"call_center": ["cc_name", "cc_call_center_sk"], "catalog_sales": ["cs_sales_price", "cs_sold_date_sk", "cs_call_center_sk", "cs_item_sk"], "date_dim": ["d_date_sk", "d_moy", "d_year"], "item": ["i_brand", "i_item_sk", "i_category"]}, "group_by": {}, "order_by": {}}
{"id": 58, "query_string": " with ss_items as  (select i_item_id item_id         ,sum(ss_ext_sales_price) ss_item_rev   from store_sales      ,item      ,date_dim  where ss_item_sk = i_item_sk    and d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2002-03-31'))    and ss_sold_date_sk   = d_date_sk  group by i_item_id),  cs_items as  (select i_item_id item_id         ,sum(cs_ext_sales_price) cs_item_rev   from catalog_sales       ,item       ,date_dim  where cs_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2002-03-31'))   and  cs_sold_date_sk = d_date_sk  group by i_item_id),  ws_items as  (select i_item_id item_id         ,sum(ws_ext_sales_price) ws_item_rev   from web_sales       ,item       ,date_dim  where ws_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq =(select d_week_seq                                       from date_dim                                      where d_date = '2002-03-31'))   and ws_sold_date_sk   = d_date_sk  group by i_item_id)   select top (100) ss_items.item_id        ,ss_item_rev        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev        ,cs_item_rev        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev        ,ws_item_rev        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average  from ss_items,cs_items,ws_items  where ss_items.item_id=cs_items.item_id    and ss_items.item_id=ws_items.item_id     and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  order by item_id          ,ss_item_rev  ;", "predicates": {"date_dim": ["d_week_seq", "d_date"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_item_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "item": ["i_item_id", "i_item_sk"], "store_sales": ["ss_sold_date_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 59, "query_string": " with wss as   (select d_week_seq,         ss_store_sk,         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales  from store_sales,date_dim  where d_date_sk = ss_sold_date_sk  group by d_week_seq,ss_store_sk  )   select top (100) s_store_name1,s_store_id1,d_week_seq1        ,sun_sales1/sun_sales2,mon_sales1/mon_sales2        ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2        ,fri_sales1/fri_sales2,sat_sales1/sat_sales2  from  (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1         ,s_store_id s_store_id1,sun_sales sun_sales1         ,mon_sales mon_sales1,tue_sales tue_sales1         ,wed_sales wed_sales1,thu_sales thu_sales1         ,fri_sales fri_sales1,sat_sales sat_sales1   from wss,store,date_dim d   where d.d_week_seq = wss.d_week_seq and         ss_store_sk = s_store_sk and          d_month_seq between 1191 and 1191 + 11) y,  (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2         ,s_store_id s_store_id2,sun_sales sun_sales2         ,mon_sales mon_sales2,tue_sales tue_sales2         ,wed_sales wed_sales2,thu_sales thu_sales2         ,fri_sales fri_sales2,sat_sales sat_sales2   from wss,store,date_dim d   where d.d_week_seq = wss.d_week_seq and         ss_store_sk = s_store_sk and          d_month_seq between 1191+ 12 and 1191 + 23) x  where s_store_id1=s_store_id2    and d_week_seq1=d_week_seq2-52  order by s_store_name1,s_store_id1,d_week_seq1;", "predicates": {"date_dim": ["d_month_seq"], "store": ["s_store_id"]}, "payload": {"date_dim": ["d_date_sk", "d_week_seq", "d_day_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 60, "query_string": " with ss as (  select           i_item_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where          i_item_id in (select   i_item_id from  item where i_category in ('Jewelry'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 9  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  cs as (  select           i_item_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Jewelry'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 9  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  ws as (  select           i_item_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Jewelry'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 9  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_item_id)   select top (100)     i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by i_item_id       ,total_sales  ;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_item_id", "i_category"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 61, "query_string": " select top (100) promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from   (select sum(ss_ext_sales_price) promotions    from  store_sales         ,store         ,promotion         ,date_dim         ,customer         ,customer_address          ,item    where ss_sold_date_sk = d_date_sk    and   ss_store_sk = s_store_sk    and   ss_promo_sk = p_promo_sk    and   ss_customer_sk= c_customer_sk    and   ca_address_sk = c_current_addr_sk    and   ss_item_sk = i_item_sk     and   ca_gmt_offset = -6    and   i_category = 'Jewelry'    and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')    and   s_gmt_offset = -6    and   d_year = 2001    and   d_moy  = 11) promotional_sales,   (select sum(ss_ext_sales_price) total    from  store_sales         ,store         ,date_dim         ,customer         ,customer_address         ,item    where ss_sold_date_sk = d_date_sk    and   ss_store_sk = s_store_sk    and   ss_customer_sk= c_customer_sk    and   ca_address_sk = c_current_addr_sk    and   ss_item_sk = i_item_sk    and   ca_gmt_offset = -6    and   i_category = 'Jewelry'    and   s_gmt_offset = -6    and   d_year = 2001    and   d_moy  = 11) all_sales order by promotions, total;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_category"], "promotion": ["p_channel_dmail", "p_channel_email", "p_channel_tv"], "store": ["s_gmt_offset"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_promo_sk", "ss_item_sk", "ss_ext_sales_price", "ss_customer_sk", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 62, "query_string": " select top (100)     substring(w_warehouse_name,1,20)   ,sm_type   ,web_name   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and                   (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and                   (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and                  (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    web_sales   ,warehouse   ,ship_mode   ,web_site   ,date_dim where     d_month_seq between 1208 and 1208 + 11 and ws_ship_date_sk   = d_date_sk and ws_warehouse_sk   = w_warehouse_sk and ws_ship_mode_sk   = sm_ship_mode_sk and ws_web_site_sk    = web_site_sk group by    substring(w_warehouse_name,1,20)   ,sm_type   ,web_name order by substring(w_warehouse_name,1,20)         ,sm_type        ,web_name;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "ship_mode": ["sm_type", "sm_ship_mode_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"], "web_sales": ["ws_ship_date_sk", "ws_ship_mode_sk", "ws_sold_date_sk", "ws_warehouse_sk", "ws_web_site_sk"], "web_site": ["web_name", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 63, "query_string": " select top (100) *  from (select i_manager_id              ,sum(ss_sales_price) sum_sales              ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales       from item           ,store_sales           ,date_dim           ,store       where ss_item_sk = i_item_sk         and ss_sold_date_sk = d_date_sk         and ss_store_sk = s_store_sk         and d_month_seq in (1208,1208+1,1208+2,1208+3,1208+4,1208+5,1208+6,1208+7,1208+8,1208+9,1208+10,1208+11)         and ((    i_category in ('Books','Children','Electronics')               and i_class in ('personal','portable','reference','self-help')               and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', \t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))            or(    i_category in ('Women','Music','Men')               and i_class in ('accessories','classical','fragrances','pants')               and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', \t\t                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id         ,avg_monthly_sales         ,sum_sales;", "predicates": {"date_dim": ["d_month_seq"], "item": ["i_brand", "i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_item_sk", "i_manager_id", "i_brand", "i_category", "i_class"], "store": ["s_store_sk"]}, "group_by": {}, "order_by": {"item": ["i_manager_id"]}}
{"id": 64, "query_string": " with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sky','green','dim','brown','firebrick','olive') and          i_current_price between 9 and 9 + 10 and          i_current_price between 9 + 1 and 9 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;", "predicates": {"customer_demographics": ["cd_marital_status"], "date_dim": ["d_year"], "item": ["i_color", "i_current_price"], "store": ["s_zip", "s_store_name"]}, "payload": {"household_demographics": ["hd_income_band_sk", "hd_demo_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 65, "query_string": " select top (100) \ts_store_name, \ti_item_desc, \tsc.revenue, \ti_current_price, \ti_wholesale_cost, \ti_brand  from store, item,      (select ss_store_sk, avg(revenue) as ave  \tfrom  \t    (select  ss_store_sk, ss_item_sk,   \t\t     sum(ss_sales_price) as revenue  \t\tfrom store_sales, date_dim  \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1208 and 1208+11  \t\tgroup by ss_store_sk, ss_item_sk) sa  \tgroup by ss_store_sk) sb,      (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue  \tfrom store_sales, date_dim  \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1208 and 1208+11  \tgroup by ss_store_sk, ss_item_sk) sc  where sb.ss_store_sk = sc.ss_store_sk and         sc.revenue <= 0.1 * sb.ave and        s_store_sk = sc.ss_store_sk and        i_item_sk = sc.ss_item_sk  order by s_store_name, i_item_desc;", "predicates": {"date_dim": ["d_month_seq"], "store_sales": ["ss_store_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_brand", "i_wholesale_cost", "i_item_desc"], "store": ["s_store_name", "s_store_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price", "ss_item_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_desc"], "store": ["s_store_name"]}}
{"id": 66, "query_string": " select top (100)            w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country         ,ship_carriers         ,year  \t,sum(jan_sales) as jan_sales  \t,sum(feb_sales) as feb_sales  \t,sum(mar_sales) as mar_sales  \t,sum(apr_sales) as apr_sales  \t,sum(may_sales) as may_sales  \t,sum(jun_sales) as jun_sales  \t,sum(jul_sales) as jul_sales  \t,sum(aug_sales) as aug_sales  \t,sum(sep_sales) as sep_sales  \t,sum(oct_sales) as oct_sales  \t,sum(nov_sales) as nov_sales  \t,sum(dec_sales) as dec_sales  \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot  \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot  \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot  \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot  \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot  \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot  \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot  \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot  \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot  \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot  \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot  \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot  \t,sum(jan_net) as jan_net  \t,sum(feb_net) as feb_net  \t,sum(mar_net) as mar_net  \t,sum(apr_net) as apr_net  \t,sum(may_net) as may_net  \t,sum(jun_net) as jun_net  \t,sum(jul_net) as jul_net  \t,sum(aug_net) as aug_net  \t,sum(sep_net) as sep_net  \t,sum(oct_net) as oct_net  \t,sum(nov_net) as nov_net  \t,sum(dec_net) as dec_net  from (      select   \tw_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,concat('DIAMOND' , ',' , 'GERMA') as ship_carriers        ,d_year as year  \t,sum(case when d_moy = 1   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jan_sales  \t,sum(case when d_moy = 2   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as feb_sales  \t,sum(case when d_moy = 3   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as mar_sales  \t,sum(case when d_moy = 4   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as apr_sales  \t,sum(case when d_moy = 5   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as may_sales  \t,sum(case when d_moy = 6   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jun_sales  \t,sum(case when d_moy = 7   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as jul_sales  \t,sum(case when d_moy = 8   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as aug_sales  \t,sum(case when d_moy = 9   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as sep_sales  \t,sum(case when d_moy = 10   \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as oct_sales  \t,sum(case when d_moy = 11  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as nov_sales  \t,sum(case when d_moy = 12  \t\tthen ws_ext_sales_price* ws_quantity else 0 end) as dec_sales  \t,sum(case when d_moy = 1   \t\tthen ws_net_paid * ws_quantity else 0 end) as jan_net  \t,sum(case when d_moy = 2  \t\tthen ws_net_paid * ws_quantity else 0 end) as feb_net  \t,sum(case when d_moy = 3   \t\tthen ws_net_paid * ws_quantity else 0 end) as mar_net  \t,sum(case when d_moy = 4   \t\tthen ws_net_paid * ws_quantity else 0 end) as apr_net  \t,sum(case when d_moy = 5   \t\tthen ws_net_paid * ws_quantity else 0 end) as may_net  \t,sum(case when d_moy = 6   \t\tthen ws_net_paid * ws_quantity else 0 end) as jun_net  \t,sum(case when d_moy = 7   \t\tthen ws_net_paid * ws_quantity else 0 end) as jul_net  \t,sum(case when d_moy = 8   \t\tthen ws_net_paid * ws_quantity else 0 end) as aug_net  \t,sum(case when d_moy = 9   \t\tthen ws_net_paid * ws_quantity else 0 end) as sep_net  \t,sum(case when d_moy = 10   \t\tthen ws_net_paid * ws_quantity else 0 end) as oct_net  \t,sum(case when d_moy = 11  \t\tthen ws_net_paid * ws_quantity else 0 end) as nov_net  \t,sum(case when d_moy = 12  \t\tthen ws_net_paid * ws_quantity else 0 end) as dec_net      from           web_sales          ,warehouse          ,date_dim          ,time_dim  \t  ,ship_mode      where             ws_warehouse_sk =  w_warehouse_sk         and ws_sold_date_sk = d_date_sk         and ws_sold_time_sk = t_time_sk  \tand ws_ship_mode_sk = sm_ship_mode_sk         and d_year = 1999  \tand t_time between 40222 and 40222+28800   \tand sm_carrier in ('DIAMOND','GERMA')      group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country        ,d_year  union all      select   \tw_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,concat('DIAMOND', ',', 'GERMA') as ship_carriers        ,d_year as year  \t,sum(case when d_moy = 1   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jan_sales  \t,sum(case when d_moy = 2   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as feb_sales  \t,sum(case when d_moy = 3   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as mar_sales  \t,sum(case when d_moy = 4   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as apr_sales  \t,sum(case when d_moy = 5   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as may_sales  \t,sum(case when d_moy = 6   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jun_sales  \t,sum(case when d_moy = 7   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jul_sales  \t,sum(case when d_moy = 8   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as aug_sales  \t,sum(case when d_moy = 9   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as sep_sales  \t,sum(case when d_moy = 10   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as oct_sales  \t,sum(case when d_moy = 11  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as nov_sales  \t,sum(case when d_moy = 12  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as dec_sales  \t,sum(case when d_moy = 1   \t\tthen cs_net_profit * cs_quantity else 0 end) as jan_net  \t,sum(case when d_moy = 2   \t\tthen cs_net_profit * cs_quantity else 0 end) as feb_net  \t,sum(case when d_moy = 3   \t\tthen cs_net_profit * cs_quantity else 0 end) as mar_net  \t,sum(case when d_moy = 4   \t\tthen cs_net_profit * cs_quantity else 0 end) as apr_net  \t,sum(case when d_moy = 5   \t\tthen cs_net_profit * cs_quantity else 0 end) as may_net  \t,sum(case when d_moy = 6   \t\tthen cs_net_profit * cs_quantity else 0 end) as jun_net  \t,sum(case when d_moy = 7   \t\tthen cs_net_profit * cs_quantity else 0 end) as jul_net  \t,sum(case when d_moy = 8   \t\tthen cs_net_profit * cs_quantity else 0 end) as aug_net  \t,sum(case when d_moy = 9   \t\tthen cs_net_profit * cs_quantity else 0 end) as sep_net  \t,sum(case when d_moy = 10   \t\tthen cs_net_profit * cs_quantity else 0 end) as oct_net  \t,sum(case when d_moy = 11  \t\tthen cs_net_profit * cs_quantity else 0 end) as nov_net  \t,sum(case when d_moy = 12  \t\tthen cs_net_profit * cs_quantity else 0 end) as dec_net      from           catalog_sales          ,warehouse          ,date_dim          ,time_dim  \t ,ship_mode      where             cs_warehouse_sk =  w_warehouse_sk         and cs_sold_date_sk = d_date_sk         and cs_sold_time_sk = t_time_sk  \tand cs_ship_mode_sk = sm_ship_mode_sk         and d_year = 1999  \tand t_time between 40222 AND 40222+28800   \tand sm_carrier in ('DIAMOND','GERMA')      group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country        ,d_year  ) x  group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,ship_carriers        ,year  order by w_warehouse_name  ;", "predicates": {"date_dim": ["d_year"], "ship_mode": ["sm_carrier"], "time_dim": ["t_time"]}, "payload": {"catalog_sales": ["cs_warehouse_sk", "cs_ext_list_price", "cs_quantity", "cs_net_paid_inc_tax", "cs_ship_mode_sk", "cs_sold_date_sk", "cs_sold_time_sk"], "date_dim": ["d_date_sk", "d_moy", "d_year"], "ship_mode": ["sm_ship_mode_sk"], "time_dim": ["t_time_sk"], "web_sales": ["ws_ship_mode_sk", "ws_ext_list_price", "ws_sold_date_sk", "ws_quantity", "ws_sold_time_sk", "ws_warehouse_sk", "ws_net_paid"]}, "group_by": {}, "order_by": {}}
{"id": 67, "query_string": " select top (100) * from (select i_category             ,i_class             ,i_brand             ,i_product_name             ,d_year             ,d_qoy             ,d_moy             ,s_store_id             ,sumsales             ,rank() over (partition by i_category order by sumsales desc) rk       from (select i_category                   ,i_class                   ,i_brand                   ,i_product_name                   ,d_year                   ,d_qoy                   ,d_moy                   ,s_store_id                   ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales             from store_sales                 ,date_dim                 ,store                 ,item        where  ss_sold_date_sk=d_date_sk           and ss_item_sk=i_item_sk           and ss_store_sk = s_store_sk           and d_month_seq between 1208 and 1208+11        group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 order by i_category         ,i_class         ,i_brand         ,i_product_name         ,d_year         ,d_qoy         ,d_moy         ,s_store_id         ,sumsales         ,rk;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk", "d_moy", "d_qoy", "d_year"], "item": ["i_item_sk", "i_brand", "i_product_name", "i_category", "i_class"], "store": ["s_store_sk", "s_store_id"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_sales_price", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {"date_dim": ["d_moy", "d_qoy", "d_year"], "item": ["i_brand", "i_class", "i_product_name", "i_category"], "store": ["s_store_id"]}}
{"id": 68, "query_string": " select top (100) c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,extended_price        ,extended_tax        ,list_price  from (select ss_ticket_number              ,ss_customer_sk              ,ca_city bought_city              ,sum(ss_ext_sales_price) extended_price               ,sum(ss_ext_list_price) list_price              ,sum(ss_ext_tax) extended_tax         from store_sales            ,date_dim            ,store            ,household_demographics            ,customer_address         where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_store_sk = store.s_store_sk           and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk         and store_sales.ss_addr_sk = customer_address.ca_address_sk         and date_dim.d_dom between 1 and 2          and (household_demographics.hd_dep_count = 6 or              household_demographics.hd_vehicle_count= 1)         and date_dim.d_year in (2000,2000+1,2000+2)         and store.s_city in ('Midway','Fairview')        group by ss_ticket_number                ,ss_customer_sk                ,ss_addr_sk,ca_city) dn       ,customer       ,customer_address current_addr  where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name          ,ss_ticket_number  ;", "predicates": {"customer_address": ["ca_city"], "date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_city"]}, "payload": {"customer": ["c_current_addr_sk", "c_first_name", "c_last_name", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_city"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_ext_sales_price", "ss_addr_sk", "ss_customer_sk", "ss_ticket_number", "ss_ext_list_price", "ss_ext_tax", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 69, "query_string": " select top (100)    cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_state in ('GA','AK','VA') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2002 and                 d_moy between 4 and 4+2) and    (not exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_moy between 4 and 4+2) and     not exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_moy between 4 and 4+2))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  ;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 70, "query_string": " select top (100)      sum(ss_net_profit) as total_sum    ,s_state    ,s_county    ,grouping(s_state)+grouping(s_county) as lochierarchy    ,rank() over (  \tpartition by grouping(s_state)+grouping(s_county),  \tcase when grouping(s_county) = 0 then s_state end   \torder by sum(ss_net_profit) desc) as rank_within_parent  from     store_sales    ,date_dim       d1    ,store  where     d1.d_month_seq between 1208 and 1208+11  and d1.d_date_sk = ss_sold_date_sk  and s_store_sk  = ss_store_sk  and s_state in              ( select s_state                from  (select s_state as s_state,  \t\t\t    rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking                       from   store_sales, store, date_dim                       where  d_month_seq between 1208 and 1208+11  \t\t\t    and d_date_sk = ss_sold_date_sk  \t\t\t    and s_store_sk  = ss_store_sk                       group by s_state                      ) tmp1                 where ranking <= 5              )  group by rollup(s_state,s_county)  order by    lochierarchy desc   ,case when (grouping(s_state)+grouping(s_county)) = 0 then s_state end   ,rank_within_parent  ;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 71, "query_string": " select i_brand_id brand_id, i_brand brand,t_hour,t_minute,  \tsum(ext_price) ext_price  from item, (select ws_ext_sales_price as ext_price,                          ws_sold_date_sk as sold_date_sk,                         ws_item_sk as sold_item_sk,                         ws_sold_time_sk as time_sk                    from web_sales,date_dim                  where d_date_sk = ws_sold_date_sk                    and d_moy=11                    and d_year=2002                  union all                  select cs_ext_sales_price as ext_price,                         cs_sold_date_sk as sold_date_sk,                         cs_item_sk as sold_item_sk,                         cs_sold_time_sk as time_sk                  from catalog_sales,date_dim                  where d_date_sk = cs_sold_date_sk                    and d_moy=11                    and d_year=2002                  union all                  select ss_ext_sales_price as ext_price,                         ss_sold_date_sk as sold_date_sk,                         ss_item_sk as sold_item_sk,                         ss_sold_time_sk as time_sk                  from store_sales,date_dim                  where d_date_sk = ss_sold_date_sk                    and d_moy=11                    and d_year=2002                  ) tmp,time_dim  where    sold_item_sk = i_item_sk    and i_manager_id=1    and time_sk = t_time_sk    and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')  group by i_brand, i_brand_id,t_hour,t_minute  order by ext_price desc, i_brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"], "time_dim": ["t_meal_time"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_brand", "i_item_sk", "i_brand_id"], "time_dim": ["t_hour", "t_minute", "t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 72, "query_string": " select top (100) i_item_desc       ,w_warehouse_name       ,d1.d_week_seq       ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo       ,sum(case when p_promo_sk is not null then 1 else 0 end) promo       ,count(*) total_cnt from catalog_sales join inventory on (cs_item_sk = inv_item_sk) join warehouse on (w_warehouse_sk=inv_warehouse_sk) join item on (i_item_sk = cs_item_sk) join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk) join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk) join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk) join date_dim d2 on (inv_date_sk = d2.d_date_sk) join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk) left outer join promotion on (cs_promo_sk=p_promo_sk) left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number) where d1.d_week_seq = d2.d_week_seq   and inv_quantity_on_hand < cs_quantity    and d3.d_date > dateadd(day, 5, d1.d_date)   and hd_buy_potential = '1001-5000'   and d1.d_year = 2000   and cd_marital_status = 'W' group by i_item_desc,w_warehouse_name,d1.d_week_seq order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq;", "predicates": {"customer_demographics": ["cd_marital_status"], "date_dim": ["d_date", "d_year"], "household_demographics": ["hd_buy_potential"], "inventory": ["inv_warehouse_sk"], "warehouse": ["w_warehouse_sk"]}, "payload": {"catalog_sales": ["cs_quantity", "cs_promo_sk", "cs_item_sk", "cs_ship_date_sk", "cs_bill_cdemo_sk", "cs_sold_date_sk", "cs_bill_hdemo_sk"], "customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "household_demographics": ["hd_demo_sk"], "item": ["i_item_sk", "i_item_desc"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {"date_dim": ["d_week_seq"], "item": ["i_item_desc"], "warehouse": ["w_warehouse_name"]}}
{"id": 73, "query_string": " select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '1001-5000' or          household_demographics.hd_buy_potential = 'Unknown')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;", "predicates": {"date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count", "hd_buy_potential"], "store": ["s_county"]}, "payload": {"customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_preferred_cust_flag"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 74, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,d_year as year        ,max(ss_net_paid) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk    and d_year in (1998,1998+1)  group by c_customer_id          ,c_first_name          ,c_last_name          ,d_year  union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,d_year as year        ,max(ws_net_paid) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk    and d_year in (1998,1998+1)  group by c_customer_id          ,c_first_name          ,c_last_name          ,d_year          )   select top (100)         t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id          and t_s_firstyear.customer_id = t_w_secyear.customer_id          and t_s_firstyear.customer_id = t_w_firstyear.customer_id          and t_s_firstyear.sale_type = 's'          and t_w_firstyear.sale_type = 'w'          and t_s_secyear.sale_type = 's'          and t_w_secyear.sale_type = 'w'          and t_s_firstyear.year = 1998          and t_s_secyear.year = 1998+1          and t_w_firstyear.year = 1998          and t_w_secyear.year = 1998+1          and t_s_firstyear.year_total > 0          and t_w_firstyear.year_total > 0          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end  order by 3,2,1;", "predicates": {"date_dim": ["d_year"]}, "payload": {"customer": ["c_customer_id", "c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_net_paid"], "web_sales": ["ws_net_paid", "ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_customer_id", "c_last_name", "c_first_name"]}}
{"id": 75, "query_string": " WITH all_sales AS (  SELECT d_year        ,i_brand_id        ,i_class_id        ,i_category_id        ,i_manufact_id        ,SUM(sales_cnt) AS sales_cnt        ,SUM(sales_amt) AS sales_amt  FROM (SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt              ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt        FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk                           JOIN date_dim ON d_date_sk=cs_sold_date_sk                           LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number                                                      AND cs_item_sk=cr_item_sk)        WHERE i_category='Electronics'        UNION        SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt              ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt        FROM store_sales JOIN item ON i_item_sk=ss_item_sk                         JOIN date_dim ON d_date_sk=ss_sold_date_sk                         LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number                                                  AND ss_item_sk=sr_item_sk)        WHERE i_category='Electronics'        UNION        SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt              ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt        FROM web_sales JOIN item ON i_item_sk=ws_item_sk                       JOIN date_dim ON d_date_sk=ws_sold_date_sk                       LEFT JOIN web_returns ON (ws_order_number=wr_order_number                                              AND ws_item_sk=wr_item_sk)        WHERE i_category='Electronics') sales_detail  GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)  SELECT top (100) prev_yr.d_year AS prev_year                           ,curr_yr.d_year AS year                           ,curr_yr.i_brand_id                           ,curr_yr.i_class_id                           ,curr_yr.i_category_id                           ,curr_yr.i_manufact_id                           ,prev_yr.sales_cnt AS prev_yr_cnt                           ,curr_yr.sales_cnt AS curr_yr_cnt                           ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff                           ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff  FROM all_sales curr_yr, all_sales prev_yr  WHERE curr_yr.i_brand_id=prev_yr.i_brand_id    AND curr_yr.i_class_id=prev_yr.i_class_id    AND curr_yr.i_category_id=prev_yr.i_category_id    AND curr_yr.i_manufact_id=prev_yr.i_manufact_id    AND curr_yr.d_year=2001    AND prev_yr.d_year=2001-1    AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9  ORDER BY sales_cnt_diff,sales_amt_diff  ;", "predicates": {"date_dim": ["d_year"], "item": ["i_category"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_quantity", "cr_return_amount"], "date_dim": ["d_date_sk", "d_year"], "item": ["i_class_id", "i_item_sk", "i_category_id", "i_brand_id", "i_manufact_id"], "store_returns": ["sr_return_amt", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_return_amt", "wr_return_quantity", "wr_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 76, "query_string": " select top (100) channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (         SELECT 'store' as channel, 'ss_customer_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price          FROM store_sales, item, date_dim          WHERE ss_customer_sk IS NULL            AND ss_sold_date_sk=d_date_sk            AND ss_item_sk=i_item_sk         UNION ALL         SELECT 'web' as channel, 'ws_promo_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price          FROM web_sales, item, date_dim          WHERE ws_promo_sk IS NULL            AND ws_sold_date_sk=d_date_sk            AND ws_item_sk=i_item_sk         UNION ALL         SELECT 'catalog' as channel, 'cs_ship_mode_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price          FROM catalog_sales, item, date_dim          WHERE cs_ship_mode_sk IS NULL            AND cs_sold_date_sk=d_date_sk            AND cs_item_sk=i_item_sk) foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category;", "predicates": {"catalog_sales": ["cs_ship_addr_sk"], "store_sales": ["ss_promo_sk"], "web_sales": ["ws_promo_sk"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_item_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_qoy", "d_year"], "item": ["i_item_sk", "i_category"], "store_sales": ["ss_sold_date_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 77, "query_string": " with ss as  (select s_store_sk,          sum(ss_ext_sales_price) as sales,          sum(ss_net_profit) as profit  from store_sales,       date_dim,       store  where ss_sold_date_sk = d_date_sk        and d_date between cast('2002-08-25' as date)                    and dateadd(day, 30, cast('2002-08-25' as date))         and ss_store_sk = s_store_sk  group by s_store_sk)  ,  sr as  (select s_store_sk,          sum(sr_return_amt) as returns,          sum(sr_net_loss) as profit_loss  from store_returns,       date_dim,       store  where sr_returned_date_sk = d_date_sk        and d_date between cast('2002-08-25' as date)                   and dateadd(day, 30, cast('2002-08-25' as date))        and sr_store_sk = s_store_sk  group by s_store_sk),   cs as  (select cs_call_center_sk,         sum(cs_ext_sales_price) as sales,         sum(cs_net_profit) as profit  from catalog_sales,       date_dim  where cs_sold_date_sk = d_date_sk        and d_date between cast('2002-08-25' as date)                   and dateadd(day, 30, cast('2002-08-25' as date))  group by cs_call_center_sk   ),   cr as  (select cr_call_center_sk,          sum(cr_return_amount) as returns,          sum(cr_net_loss) as profit_loss  from catalog_returns,       date_dim  where cr_returned_date_sk = d_date_sk        and d_date between cast('2002-08-25' as date)                   and dateadd(day, 30, cast('2002-08-25' as date))  group by cr_call_center_sk  ),   ws as  ( select wp_web_page_sk,         sum(ws_ext_sales_price) as sales,         sum(ws_net_profit) as profit  from web_sales,       date_dim,       web_page  where ws_sold_date_sk = d_date_sk        and d_date between cast('2002-08-25' as date)                   and dateadd(day, 30, cast('2002-08-25' as date))        and ws_web_page_sk = wp_web_page_sk  group by wp_web_page_sk),   wr as  (select wp_web_page_sk,         sum(wr_return_amt) as returns,         sum(wr_net_loss) as profit_loss  from web_returns,       date_dim,       web_page  where wr_returned_date_sk = d_date_sk        and d_date between cast('2002-08-25' as date)                   and dateadd(day, 30, cast('2002-08-25' as date))        and wr_web_page_sk = wp_web_page_sk  group by wp_web_page_sk)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , ss.s_store_sk as id         , sales         , coalesce(returns, 0) as returns         , (profit - coalesce(profit_loss,0)) as profit  from   ss left join sr         on  ss.s_store_sk = sr.s_store_sk  union all  select 'catalog channel' as channel         , cs_call_center_sk as id         , sales         , returns         , (profit - profit_loss) as profit  from  cs        , cr  union all  select 'web channel' as channel         , ws.wp_web_page_sk as id         , sales         , coalesce(returns, 0) returns         , (profit - coalesce(profit_loss,0)) as profit  from   ws left join wr         on  ws.wp_web_page_sk = wr.wp_web_page_sk  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_return_amount", "cr_call_center_sk"], "catalog_sales": ["cs_net_profit", "cs_sold_date_sk", "cs_call_center_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_net_loss"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit", "ss_ext_sales_price"], "web_page": ["wp_web_page_sk"], "web_returns": ["wr_web_page_sk", "wr_returned_date_sk", "wr_return_amt", "wr_net_loss"], "web_sales": ["ws_net_profit", "ws_ext_sales_price", "ws_web_page_sk", "ws_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 78, "query_string": " with ws as   (select d_year AS ws_sold_year, ws_item_sk,     ws_bill_customer_sk ws_customer_sk,     sum(ws_quantity) ws_qty,     sum(ws_wholesale_cost) ws_wc,     sum(ws_sales_price) ws_sp    from web_sales    left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk    join date_dim on ws_sold_date_sk = d_date_sk    where wr_order_number is null    group by d_year, ws_item_sk, ws_bill_customer_sk    ), cs as   (select d_year AS cs_sold_year, cs_item_sk,     cs_bill_customer_sk cs_customer_sk,     sum(cs_quantity) cs_qty,     sum(cs_wholesale_cost) cs_wc,     sum(cs_sales_price) cs_sp    from catalog_sales    left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk    join date_dim on cs_sold_date_sk = d_date_sk    where cr_order_number is null    group by d_year, cs_item_sk, cs_bill_customer_sk    ), ss as   (select d_year AS ss_sold_year, ss_item_sk,     ss_customer_sk,     sum(ss_quantity) ss_qty,     sum(ss_wholesale_cost) ss_wc,     sum(ss_sales_price) ss_sp    from store_sales    left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk    join date_dim on ss_sold_date_sk = d_date_sk    where sr_ticket_number is null    group by d_year, ss_item_sk, ss_customer_sk    )  select top (100) ss_customer_sk, round(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk) where (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2002 order by    ss_customer_sk,   ss_qty desc, ss_wc desc, ss_sp desc,   other_chan_qty,   other_chan_wholesale_cost,   other_chan_sales_price,   ratio;", "predicates": {"catalog_returns": ["cr_order_number"], "catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_year"], "store_returns": ["sr_ticket_number"], "store_sales": ["ss_customer_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_bill_customer_sk"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "store_returns": ["sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_item_sk", "ss_sales_price", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_wholesale_cost", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 79, "query_string": " select top (100)   c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,store.s_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (household_demographics.hd_dep_count = 7 or household_demographics.hd_vehicle_count > 4)     and date_dim.d_dow = 1     and date_dim.d_year in (1998,1998+1,1998+2)      and store.s_number_employees between 200 and 295     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer     where ss_customer_sk = c_customer_sk  order by c_last_name,c_first_name,substring(s_city,1,30), profit;", "predicates": {"date_dim": ["d_dow", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_number_employees"]}, "payload": {"customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_city", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_addr_sk", "ss_customer_sk", "ss_ticket_number", "ss_coupon_amt", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {"customer": ["c_last_name", "c_first_name"]}}
{"id": 80, "query_string": " with ssr as  (select  s_store_id as store_id,           sum(ss_ext_sales_price) as sales,           sum(coalesce(sr_return_amt, 0)) as returns,           sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit   from store_sales left outer join store_returns on          (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),      date_dim,      store,      item,      promotion  where ss_sold_date_sk = d_date_sk        and d_date between cast('2002-08-25' as date)                    and dateadd(day, 30, cast('2002-08-25' as date))        and ss_store_sk = s_store_sk        and ss_item_sk = i_item_sk        and i_current_price > 50        and ss_promo_sk = p_promo_sk        and p_channel_tv = 'N'  group by s_store_id)  ,  csr as  (select  cp_catalog_page_id as catalog_page_id,           sum(cs_ext_sales_price) as sales,           sum(coalesce(cr_return_amount, 0)) as returns,           sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit   from catalog_sales left outer join catalog_returns on          (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),      date_dim,      catalog_page,      item,      promotion  where cs_sold_date_sk = d_date_sk        and d_date between cast('2002-08-25' as date)                   and dateadd(day, 30, cast('2002-08-25' as date))         and cs_catalog_page_sk = cp_catalog_page_sk        and cs_item_sk = i_item_sk        and i_current_price > 50        and cs_promo_sk = p_promo_sk        and p_channel_tv = 'N' group by cp_catalog_page_id)  ,  wsr as  (select  web_site_id,           sum(ws_ext_sales_price) as sales,           sum(coalesce(wr_return_amt, 0)) as returns,           sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit   from web_sales left outer join web_returns on          (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),      date_dim,      web_site,      item,      promotion  where ws_sold_date_sk = d_date_sk        and d_date between cast('2002-08-25' as date)                   and dateadd(day, 30, cast('2002-08-25' as date))         and ws_web_site_sk = web_site_sk        and ws_item_sk = i_item_sk        and i_current_price > 50        and ws_promo_sk = p_promo_sk        and p_channel_tv = 'N' group by web_site_id)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , concat('store' , store_id) as id         , sales         , returns         , profit  from   ssr  union all  select 'catalog channel' as channel         , concat('catalog_page' , catalog_page_id) as id         , sales         , returns         , profit  from  csr  union all  select 'web channel' as channel         , concat('web_site' , web_site_id) as id         , sales         , returns         , profit  from   wsr  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"], "promotion": ["p_channel_tv"]}, "payload": {"catalog_page": ["cp_catalog_page_sk", "cp_catalog_page_id"], "catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_amount", "cr_net_loss"], "date_dim": ["d_date_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"], "store": ["s_store_sk", "s_store_id"], "store_returns": ["sr_return_amt", "sr_net_loss", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_net_loss", "wr_return_amt", "wr_order_number"], "web_site": ["web_site_id", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 81, "query_string": " with customer_total_return as  (select cr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   \tsum(cr_return_amt_inc_tax) as ctr_total_return  from catalog_returns      ,date_dim      ,customer_address  where cr_returned_date_sk = d_date_sk     and d_year =2002    and cr_returning_addr_sk = ca_address_sk   group by cr_returning_customer_sk          ,ca_state )   select top (100) c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  \t\t\t  from customer_total_return ctr2                    \t  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'MN'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  ;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_year"]}, "payload": {"catalog_returns": ["cr_returned_date_sk", "cr_returning_customer_sk", "cr_return_amt_inc_tax", "cr_returning_addr_sk"], "customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_current_addr_sk", "c_customer_id"], "customer_address": ["ca_street_type", "ca_county", "ca_street_name", "ca_zip", "ca_street_number", "ca_city", "ca_state", "ca_gmt_offset", "ca_location_type", "ca_address_sk", "ca_suite_number", "ca_country"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer": ["c_salutation", "c_customer_id", "c_last_name", "c_first_name"], "customer_address": ["ca_street_type", "ca_county", "ca_street_name", "ca_zip", "ca_street_number", "ca_city", "ca_gmt_offset", "ca_location_type", "ca_suite_number", "ca_country"]}}
{"id": 82, "query_string": " select top (100) i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, store_sales  where i_current_price between 54 and 54+30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('1999-06-26' as date) and dateadd(day, 60, cast('1999-06-26' as date))  and i_manufact_id in (588,925,524,711)  and inv_quantity_on_hand between 100 and 500  and ss_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  ;", "predicates": {"date_dim": ["d_date"], "inventory": ["inv_quantity_on_hand"], "item": ["i_current_price", "i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc", "i_current_price"]}, "group_by": {}, "order_by": {}}
{"id": 83, "query_string": " with sr_items as  (select i_item_id item_id,         sum(sr_return_quantity) sr_item_qty  from store_returns,       item,       date_dim  where sr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t  where d_date in ('2001-01-21','2001-10-06','2001-11-06')))  and   sr_returned_date_sk   = d_date_sk  group by i_item_id),  cr_items as  (select i_item_id item_id,         sum(cr_return_quantity) cr_item_qty  from catalog_returns,       item,       date_dim  where cr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t  where d_date in ('2001-01-21','2001-10-06','2001-11-06')))  and   cr_returned_date_sk   = d_date_sk  group by i_item_id),  wr_items as  (select i_item_id item_id,         sum(wr_return_quantity) wr_item_qty  from web_returns,       item,       date_dim  where wr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t\twhere d_date in ('2001-01-21','2001-10-06','2001-11-06')))  and   wr_returned_date_sk   = d_date_sk  group by i_item_id)   select top (100) sr_items.item_id        ,sr_item_qty        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev        ,cr_item_qty        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev        ,wr_item_qty        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average  from sr_items      ,cr_items      ,wr_items  where sr_items.item_id=cr_items.item_id    and sr_items.item_id=wr_items.item_id   order by sr_items.item_id          ,sr_item_qty  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_returned_date_sk", "cr_order_number", "cr_return_quantity"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "item": ["i_item_id", "i_item_sk"], "store_returns": ["sr_returned_date_sk", "sr_return_quantity", "sr_item_sk"], "web_returns": ["wr_item_sk", "wr_returned_date_sk", "wr_return_quantity"]}, "group_by": {}, "order_by": {}}
{"id": 84, "query_string": " select top (100) c_customer_id as customer_id        , concat(coalesce(c_last_name,'') , ', ' , coalesce(c_first_name,'')) as customername  from customer      ,customer_address      ,customer_demographics      ,household_demographics      ,income_band      ,store_returns  where ca_city\t        =  'Sunnyside'    and c_current_addr_sk = ca_address_sk    and ib_lower_bound   >=  5521    and ib_upper_bound   <=  5521 + 50000    and ib_income_band_sk = hd_income_band_sk    and cd_demo_sk = c_current_cdemo_sk    and hd_demo_sk = c_current_hdemo_sk    and sr_cdemo_sk = cd_demo_sk  order by c_customer_id  ;", "predicates": {"customer": ["c_current_cdemo_sk"], "customer_address": ["ca_city"], "income_band": ["ib_upper_bound", "ib_lower_bound"]}, "payload": {"customer": ["c_last_name", "c_first_name", "c_current_cdemo_sk", "c_current_addr_sk", "c_customer_id", "c_current_hdemo_sk"], "customer_address": ["ca_address_sk"], "household_demographics": ["hd_income_band_sk", "hd_demo_sk"], "income_band": ["ib_income_band_sk"], "store_returns": ["sr_cdemo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 85, "query_string": " select top (100) substring(r_reason_desc,1,20)        ,avg(ws_quantity)        ,avg(wr_refunded_cash)        ,avg(wr_fee)  from web_sales, web_returns, web_page, customer_demographics cd1,       customer_demographics cd2, customer_address, date_dim, reason   where ws_web_page_sk = wp_web_page_sk    and ws_item_sk = wr_item_sk    and ws_order_number = wr_order_number    and ws_sold_date_sk = d_date_sk and d_year = 1998    and cd1.cd_demo_sk = wr_refunded_cdemo_sk     and cd2.cd_demo_sk = wr_returning_cdemo_sk    and ca_address_sk = wr_refunded_addr_sk    and r_reason_sk = wr_reason_sk    and    (     (      cd1.cd_marital_status = 'M'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Primary'      and       cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 100.00 and 150.00     )    or     (      cd1.cd_marital_status = 'W'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Secondary'       and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 50.00 and 100.00     )    or     (      cd1.cd_marital_status = 'D'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Advanced Degree'      and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 150.00 and 200.00     )    )    and    (     (      ca_country = 'United States'      and      ca_state in ('VA', 'KY', 'CT')      and ws_net_profit between 100 and 200       )     or     (      ca_country = 'United States'      and      ca_state in ('IL', 'ID', 'IA')      and ws_net_profit between 150 and 300       )     or     (      ca_country = 'United States'      and      ca_state in ('NY', 'WI', 'NV')      and ws_net_profit between 50 and 250       )    ) group by r_reason_desc order by substring(r_reason_desc,1,20)         ,avg(ws_quantity)         ,avg(wr_refunded_cash)         ,avg(wr_fee);", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "web_sales": ["ws_net_profit", "ws_sales_price"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "reason": ["r_reason_desc", "r_reason_sk"], "web_page": ["wp_web_page_sk"], "web_returns": ["wr_returning_cdemo_sk", "wr_refunded_cdemo_sk", "wr_reason_sk", "wr_item_sk", "wr_refunded_cash", "wr_refunded_addr_sk", "wr_fee", "wr_order_number"], "web_sales": ["ws_net_profit", "ws_item_sk", "ws_sales_price", "ws_quantity", "ws_sold_date_sk", "ws_web_page_sk", "ws_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 86, "query_string": " select top (100)       sum(ws_net_paid) as total_sum    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  \tpartition by grouping(i_category)+grouping(i_class),  \tcase when grouping(i_class) = 0 then i_category end   \torder by sum(ws_net_paid) desc) as rank_within_parent  from     web_sales    ,date_dim       d1    ,item  where     d1.d_month_seq between 1208 and 1208+11  and d1.d_date_sk = ws_sold_date_sk  and i_item_sk  = ws_item_sk  group by rollup(i_category,i_class)  order by    lochierarchy desc,    case when (grouping(i_category)+grouping(i_class)) = 0 then i_category end,    rank_within_parent  ;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_class", "i_item_sk", "i_category"], "web_sales": ["ws_net_paid", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 87, "query_string": " select count(*)  from ((select distinct c_last_name, c_first_name, d_date        from store_sales, date_dim, customer        where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_customer_sk = customer.c_customer_sk          and d_month_seq between 1208 and 1208+11)        except       (select distinct c_last_name, c_first_name, d_date        from catalog_sales, date_dim, customer        where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk          and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk          and d_month_seq between 1208 and 1208+11)        except       (select distinct c_last_name, c_first_name, d_date        from web_sales, date_dim, customer        where web_sales.ws_sold_date_sk = date_dim.d_date_sk          and web_sales.ws_bill_customer_sk = customer.c_customer_sk          and d_month_seq between 1208 and 1208+11) ) cool_cust;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 88, "query_string": " select  * from  (select count(*) h8_30_to_9  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk         and ss_hdemo_sk = household_demographics.hd_demo_sk       and ss_store_sk = s_store_sk      and time_dim.t_hour = 8      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))       and store.s_store_name = 'ese') s1,  (select count(*) h9_to_9_30   from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk       and time_dim.t_hour = 9       and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))      and store.s_store_name = 'ese') s2,  (select count(*) h9_30_to_10   from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 9      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))      and store.s_store_name = 'ese') s3,  (select count(*) h10_to_10_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 10       and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))      and store.s_store_name = 'ese') s4,  (select count(*) h10_30_to_11  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 10       and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))      and store.s_store_name = 'ese') s5,  (select count(*) h11_to_11_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk       and time_dim.t_hour = 11      and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))      and store.s_store_name = 'ese') s6,  (select count(*) h11_30_to_12  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 11      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))      and store.s_store_name = 'ese') s7,  (select count(*) h12_to_12_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 12      and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))      and store.s_store_name = 'ese') s8;", "predicates": {"household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_store_name"], "time_dim": ["t_hour", "t_minute"]}, "payload": {"household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_sold_time_sk"], "time_dim": ["t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 89, "query_string": " select top (100) * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (1999) and         ((i_category in ('Music','Jewelry','Electronics') and           i_class in ('rock','jewelry boxes','audio')          )       or (i_category in ('Shoes','Books','Children') and           i_class in ('kids','business','school-uniforms')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name;", "predicates": {"date_dim": ["d_year"], "item": ["i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_brand", "i_class", "i_item_sk", "i_category"], "store": ["s_store_name", "s_store_sk", "s_company_name"]}, "group_by": {}, "order_by": {"store": ["s_store_name"]}}
{"id": 90, "query_string": " select top (100) cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio  from ( select count(*) amc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 6 and 6+1          and household_demographics.hd_dep_count = 7          and web_page.wp_char_count between 5000 and 5200) at,       ( select count(*) pmc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 21 and 21+1          and household_demographics.hd_dep_count = 7          and web_page.wp_char_count between 5000 and 5200) pt  order by am_pm_ratio  ;", "predicates": {"household_demographics": ["hd_dep_count"], "time_dim": ["t_hour"], "web_page": ["wp_char_count"]}, "payload": {"household_demographics": ["hd_demo_sk"], "time_dim": ["t_time_sk"], "web_page": ["wp_web_page_sk"], "web_sales": ["ws_sold_time_sk", "ws_web_page_sk", "ws_ship_hdemo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 91, "query_string": " select           cc_call_center_id Call_Center,         cc_name Call_Center_Name,         cc_manager Manager,         sum(cr_net_loss) Returns_Loss from         call_center,         catalog_returns,         date_dim,         customer,         customer_address,         customer_demographics,         household_demographics where         cr_call_center_sk       = cc_call_center_sk and     cr_returned_date_sk     = d_date_sk and     cr_returning_customer_sk= c_customer_sk and     cd_demo_sk              = c_current_cdemo_sk and     hd_demo_sk              = c_current_hdemo_sk and     ca_address_sk           = c_current_addr_sk and     d_year                  = 2001  and     d_moy                   = 11 and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')         or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree')) and     hd_buy_potential like '1001-5000%' and     ca_gmt_offset           = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc;", "predicates": {"customer_address": ["ca_gmt_offset"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_moy", "d_year"], "household_demographics": ["hd_buy_potential"]}, "payload": {"call_center": ["cc_name", "cc_call_center_id", "cc_manager", "cc_call_center_sk"], "catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_returning_customer_sk", "cr_call_center_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk", "c_current_hdemo_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 92, "query_string": " select top (100)     sum(ws_ext_discount_amt)  as \"Excess Discount Amount\"  from      web_sales     ,item     ,date_dim where i_manufact_id = 948 and i_item_sk = ws_item_sk  and d_date between '2001-03-15' and          dateadd(day, 90, cast('2001-03-15' as date)) and d_date_sk = ws_sold_date_sk  and ws_ext_discount_amt        > (           SELECT              1.3 * avg(ws_ext_discount_amt)           FROM              web_sales             ,date_dim          WHERE                ws_item_sk = i_item_sk            and d_date between '2001-03-15' and                              dateadd(day, 90, cast('2001-03-15' as date))           and d_date_sk = ws_sold_date_sk        )  order by sum(ws_ext_discount_amt);", "predicates": {"date_dim": ["d_date"], "item": ["i_manufact_id"], "web_sales": ["ws_ext_discount_amt"]}, "payload": {"item": ["i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 93, "query_string": " select top (100) ss_customer_sk             ,sum(act_sales) sumsales       from (select ss_item_sk                   ,ss_ticket_number                   ,ss_customer_sk                   ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price                                                             else (ss_quantity*ss_sales_price) end act_sales             from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk                                                                and sr_ticket_number = ss_ticket_number)                 ,reason             where sr_reason_sk = r_reason_sk               and r_reason_desc = 'reason 65') t       group by ss_customer_sk       order by sumsales, ss_customer_sk;", "predicates": {"reason": ["r_reason_desc"]}, "payload": {"reason": ["r_reason_sk"], "store_returns": ["sr_reason_sk", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"]}, "group_by": {}, "order_by": {"store_sales": ["ss_customer_sk"]}}
{"id": 94, "query_string": " select top (100)     count(distinct ws_order_number) as \"order count\"   ,sum(ws_ext_ship_cost) as \"total shipping cost\"   ,sum(ws_net_profit) as \"total net profit\" from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2002-4-01' and             dateadd(day, 60, cast('2002-4-01' as date)) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'TX' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number);", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_date"], "web_site": ["web_company_name"]}, "payload": {"customer_address": ["ca_address_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_net_profit", "ws_ship_date_sk", "ws_ship_addr_sk", "ws_ext_ship_cost", "ws_warehouse_sk", "ws_order_number", "ws_web_site_sk"], "web_site": ["web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 95, "query_string": " with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select top (100)     count(distinct ws_order_number) as \"order count\"   ,sum(ws_ext_ship_cost) as \"total shipping cost\"   ,sum(ws_net_profit) as \"total net profit\" from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2002-4-01' and             dateadd(day, 60, cast('2002-4-01' as date)) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'TX' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number);", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_date"], "web_site": ["web_company_name"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_net_profit", "ws_ship_date_sk", "ws_item_sk", "ws_ship_addr_sk", "ws_ext_ship_cost", "ws_warehouse_sk", "ws_order_number", "ws_web_site_sk"], "web_site": ["web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 96, "query_string": " select top (100) count(*)  from store_sales     ,household_demographics      ,time_dim, store where ss_sold_time_sk = time_dim.t_time_sk        and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk     and time_dim.t_hour = 15     and time_dim.t_minute >= 30     and household_demographics.hd_dep_count = 4     and store.s_store_name = 'ese' order by count(*);", "predicates": {"household_demographics": ["hd_dep_count"], "store": ["s_store_name"], "time_dim": ["t_hour", "t_minute"]}, "payload": {"household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_sold_time_sk"], "time_dim": ["t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 97, "query_string": " with ssci as ( select ss_customer_sk customer_sk       ,ss_item_sk item_sk from store_sales,date_dim where ss_sold_date_sk = d_date_sk   and d_month_seq between 1208 and 1208 + 11 group by ss_customer_sk         ,ss_item_sk), csci as(  select cs_bill_customer_sk customer_sk       ,cs_item_sk item_sk from catalog_sales,date_dim where cs_sold_date_sk = d_date_sk   and d_month_seq between 1208 and 1208 + 11 group by cs_bill_customer_sk         ,cs_item_sk)  select top (100) sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only       ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only       ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk                                and ssci.item_sk = csci.item_sk);", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk", "cs_item_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 98, "query_string": " select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from\t \tstore_sales     \t,item      \t,date_dim where  \tss_item_sk = i_item_sk    \tand i_category in ('Sports', 'Children', 'Women')   \tand ss_sold_date_sk = d_date_sk \tand d_date between cast('1999-04-04' as date)  \t\t\t\tand dateadd(day, 30, cast('1999-04-04' as date)) group by  \ti_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  \ti_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"]}, "group_by": {}, "order_by": {}}
{"id": 99, "query_string": " select top (100)     substring(w_warehouse_name,1,20)   ,sm_type   ,cc_name   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and                   (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and                   (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and                  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    catalog_sales   ,warehouse   ,ship_mode   ,call_center   ,date_dim where     d_month_seq between 1208 and 1208 + 11 and cs_ship_date_sk   = d_date_sk and cs_warehouse_sk   = w_warehouse_sk and cs_ship_mode_sk   = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by    substring(w_warehouse_name,1,20)   ,sm_type   ,cc_name order by substring(w_warehouse_name,1,20)         ,sm_type         ,cc_name;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"call_center": ["cc_name", "cc_call_center_sk"], "catalog_sales": ["cs_warehouse_sk", "cs_call_center_sk", "cs_ship_date_sk", "cs_ship_mode_sk", "cs_sold_date_sk"], "date_dim": ["d_date_sk"], "ship_mode": ["sm_type", "sm_ship_mode_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 1, "query_string": " with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sum(SR_STORE_CREDIT) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =1998 group by sr_customer_sk ,sr_store_sk)  select top (100) c_customer_id from customer_total_return ctr1 ,store ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'TN' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id;", "predicates": {"date_dim": ["d_year"], "store": ["s_state"], "store_returns": ["sr_store_sk"]}, "payload": {"customer": ["c_customer_id", "c_customer_sk"], "date_dim": ["d_date_sk"], "store": ["s_store_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_customer_id"]}}
{"id": 2, "query_string": " with wscs as  (select sold_date_sk         ,sales_price   from (select ws_sold_date_sk sold_date_sk               ,ws_ext_sales_price sales_price         from web_sales          union all         select cs_sold_date_sk sold_date_sk               ,cs_ext_sales_price sales_price         from catalog_sales) a),  wswscs as   (select d_week_seq,         sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales  from wscs      ,date_dim  where d_date_sk = sold_date_sk  group by d_week_seq)  select d_week_seq1        ,round(sun_sales1/sun_sales2,2)        ,round(mon_sales1/mon_sales2,2)        ,round(tue_sales1/tue_sales2,2)        ,round(wed_sales1/wed_sales2,2)        ,round(thu_sales1/thu_sales2,2)        ,round(fri_sales1/fri_sales2,2)        ,round(sat_sales1/sat_sales2,2)  from  (select wswscs.d_week_seq d_week_seq1         ,sun_sales sun_sales1         ,mon_sales mon_sales1         ,tue_sales tue_sales1         ,wed_sales wed_sales1         ,thu_sales thu_sales1         ,fri_sales fri_sales1         ,sat_sales sat_sales1   from wswscs,date_dim    where date_dim.d_week_seq = wswscs.d_week_seq and         d_year = 1999) y,  (select wswscs.d_week_seq d_week_seq2         ,sun_sales sun_sales2         ,mon_sales mon_sales2         ,tue_sales tue_sales2         ,wed_sales wed_sales2         ,thu_sales thu_sales2         ,fri_sales fri_sales2         ,sat_sales sat_sales2   from wswscs       ,date_dim    where date_dim.d_week_seq = wswscs.d_week_seq and         d_year = 1999+1) z  where d_week_seq1=d_week_seq2-53  order by d_week_seq1;", "predicates": {"date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_week_seq", "d_day_name"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 3, "query_string": " select top (100) dt.d_year         ,item.i_brand_id brand_id         ,item.i_brand brand        ,sum(ss_net_profit) sum_agg  from  date_dim dt        ,store_sales       ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk    and store_sales.ss_item_sk = item.i_item_sk    and item.i_manufact_id = 229    and dt.d_moy=11  group by dt.d_year       ,item.i_brand       ,item.i_brand_id  order by dt.d_year          ,sum_agg desc          ,brand_id  ;", "predicates": {"date_dim": ["d_moy"], "item": ["i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"date_dim": ["d_year"], "item": ["i_brand_id"]}}
{"id": 4, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year  union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total        ,'c' sale_type  from customer      ,catalog_sales      ,date_dim  where c_customer_sk = cs_bill_customer_sk    and cs_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year          )   select top (100)                    t_s_secyear.customer_id                  ,t_s_secyear.customer_first_name                  ,t_s_secyear.customer_last_name                  ,t_s_secyear.customer_email_address  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_c_firstyear      ,year_total t_c_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id    and t_s_firstyear.customer_id = t_c_secyear.customer_id    and t_s_firstyear.customer_id = t_c_firstyear.customer_id    and t_s_firstyear.customer_id = t_w_firstyear.customer_id    and t_s_firstyear.customer_id = t_w_secyear.customer_id    and t_s_firstyear.sale_type = 's'    and t_c_firstyear.sale_type = 'c'    and t_w_firstyear.sale_type = 'w'    and t_s_secyear.sale_type = 's'    and t_c_secyear.sale_type = 'c'    and t_w_secyear.sale_type = 'w'    and t_s_firstyear.dyear =  2000    and t_s_secyear.dyear = 2000+1    and t_c_firstyear.dyear =  2000    and t_c_secyear.dyear =  2000+1    and t_w_firstyear.dyear = 2000    and t_w_secyear.dyear = 2000+1    and t_s_firstyear.year_total > 0    and t_c_firstyear.year_total > 0    and t_w_firstyear.year_total > 0    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end            > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end  order by t_s_secyear.customer_id          ,t_s_secyear.customer_first_name          ,t_s_secyear.customer_last_name          ,t_s_secyear.customer_email_address;", "predicates": {"date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_ext_list_price", "cs_ext_discount_amt", "cs_bill_customer_sk", "cs_ext_sales_price", "cs_ext_wholesale_cost", "cs_sold_date_sk"], "customer": ["c_login", "c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id"], "date_dim": ["d_date_sk"], "store_sales": ["ss_ext_discount_amt", "ss_ext_sales_price", "ss_ext_wholesale_cost", "ss_customer_sk", "ss_ext_list_price", "ss_sold_date_sk"], "web_sales": ["ws_ext_discount_amt", "ws_ext_wholesale_cost", "ws_ext_list_price", "ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 5, "query_string": " with ssr as  (select s_store_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  ss_store_sk as store_sk,             ss_sold_date_sk  as date_sk,             ss_ext_sales_price as sales_price,             ss_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from store_sales     union all     select sr_store_sk as store_sk,            sr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            sr_return_amt as return_amt,            sr_net_loss as net_loss     from store_returns    ) salesreturns,      date_dim,      store  where date_sk = d_date_sk        and d_date between cast('1999-08-09' as date)                    and dateadd(day, 14, cast('1999-08-09' as date))        and store_sk = s_store_sk  group by s_store_id)  ,  csr as  (select cp_catalog_page_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  cs_catalog_page_sk as page_sk,             cs_sold_date_sk  as date_sk,             cs_ext_sales_price as sales_price,             cs_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from catalog_sales     union all     select cr_catalog_page_sk as page_sk,            cr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            cr_return_amount as return_amt,            cr_net_loss as net_loss     from catalog_returns    ) salesreturns,      date_dim,      catalog_page  where date_sk = d_date_sk        and d_date between cast('1999-08-09' as date)                   and dateadd(day, 14, cast('1999-08-09' as date))        and page_sk = cp_catalog_page_sk  group by cp_catalog_page_id)  ,  wsr as  (select web_site_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  ws_web_site_sk as wsr_web_site_sk,             ws_sold_date_sk  as date_sk,             ws_ext_sales_price as sales_price,             ws_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from web_sales     union all     select ws_web_site_sk as wsr_web_site_sk,            wr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            wr_return_amt as return_amt,            wr_net_loss as net_loss     from web_returns left outer join web_sales on          ( wr_item_sk = ws_item_sk            and wr_order_number = ws_order_number)    ) salesreturns,      date_dim,      web_site  where date_sk = d_date_sk        and d_date between cast('1999-08-09' as date)                   and dateadd(day, 14, cast('1999-08-09' as date))        and wsr_web_site_sk = web_site_sk  group by web_site_id)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , concat('store' , s_store_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from   ssr  union all  select 'catalog channel' as channel         , concat('catalog_page' , cp_catalog_page_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from  csr  union all  select 'web channel' as channel         , concat('web_site' , web_site_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from   wsr  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_page": ["cp_catalog_page_sk", "cp_catalog_page_id"], "catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_return_amount", "cr_catalog_page_sk"], "catalog_sales": ["cs_catalog_page_sk", "cs_net_profit", "cs_sold_date_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_net_loss"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit", "ss_ext_sales_price"], "web_returns": ["wr_returned_date_sk", "wr_return_amt", "wr_net_loss", "wr_item_sk", "wr_order_number"], "web_sales": ["ws_net_profit", "ws_ext_sales_price", "ws_sold_date_sk", "ws_web_site_sk"], "web_site": ["web_site_id", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 6, "query_string": " select top (100) a.ca_state state, count(*) cnt  from customer_address a      ,customer c      ,store_sales s      ,date_dim d      ,item i  where       a.ca_address_sk = c.c_current_addr_sk  \tand c.c_customer_sk = s.ss_customer_sk  \tand s.ss_sold_date_sk = d.d_date_sk  \tand s.ss_item_sk = i.i_item_sk  \tand d.d_month_seq =   \t     (select distinct (d_month_seq)  \t      from date_dim                where d_year = 2002  \t        and d_moy = 2 )  \tand i.i_current_price > 1.2 *               (select avg(j.i_current_price)   \t     from item j   \t     where j.i_category = i.i_category)  group by a.ca_state  having count(*) >= 10  order by cnt, a.ca_state   ;", "predicates": {"date_dim": ["d_month_seq", "d_moy", "d_year"], "item": ["i_category", "i_current_price"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk", "d_month_seq"], "item": ["i_item_sk", "i_category", "i_current_price"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_item_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_state"]}}
{"id": 7, "query_string": " select top (100) i_item_id,          avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4   from store_sales, customer_demographics, date_dim, item, promotion  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_cdemo_sk = cd_demo_sk and        ss_promo_sk = p_promo_sk and        cd_gender = 'M' and         cd_marital_status = 'M' and        cd_education_status = 'Secondary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 2001   group by i_item_id  order by i_item_id  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "promotion": ["p_channel_event", "p_channel_email"]}, "payload": {"customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"], "promotion": ["p_promo_sk"], "store_sales": ["ss_promo_sk", "ss_item_sk", "ss_cdemo_sk", "ss_list_price", "ss_quantity", "ss_sales_price", "ss_coupon_amt", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 8, "query_string": " select top (100) s_store_name       ,sum(ss_net_profit)  from store_sales      ,date_dim      ,store,      (select ca_zip      from (       SELECT substring(ca_zip,1,5) ca_zip       FROM customer_address       WHERE substring(ca_zip,1,5) IN (                           '66209','25252','31270','74890','97565','40540',                           '93425','50381','19545','93152','28644',                           '90319','41103','78927','17808','78538',                           '92302','91726','80720','25837','36776',                           '45797','89346','97536','71633','59057',                           '80045','55300','31117','39402','78876',                           '37017','62871','28970','37168','43793',                           '56561','55503','74364','12098','38662',                           '17188','69466','77883','43257','84534',                           '56031','48961','57236','39752','35117',                           '47475','96559','33893','85159','98835',                           '80980','64948','77060','79181','65129',                           '33756','38131','51494','84202','51586',                           '28040','53109','87215','46858','19653',                           '50043','30639','39207','76707','12344',                           '72168','63275','48484','31290','86732',                           '16760','97796','20377','24208','17175',                           '70748','66487','40332','86682','66880',                           '79987','64449','39395','50513','94913',                           '51300','64624','53719','39309','90657',                           '65783','69661','62263','44497','95575',                           '26273','99568','59473','25558','47221',                           '11802','54202','67008','64513','39256',                           '25014','36718','26492','26224','75653',                           '19136','98069','12492','93207','50172',                           '32766','25084','83027','24556','10522',                           '75504','28344','25125','27106','64738',                           '39560','98346','19880','76747','33289',                           '18819','10176','65384','76809','59313',                           '89244','66744','93998','79670','57495',                           '52744','57546','82983','28286','95901',                           '81822','37502','25200','10828','28087',                           '83423','37819','22466','33362','31831',                           '69381','39369','79117','29836','86763',                           '24031','31049','83453','44808','37556',                           '70035','74201','53214','33804','70967',                           '70161','33157','44966','12854','39160',                           '77875','10743','21389','68489','57908',                           '19019','59495','66258','65339','64136',                           '59031','80293','81992','41978','64237',                           '71922','95100','52689','30425','68701',                           '70464','64708','43652','63044','15321',                           '32319','57252','63798','39092','79227',                           '45499','63334','34386','91664','28630',                           '98208','44425','84367','79567','97898',                           '17165','62127','21757','17558','49301',                           '22067','69098','19487','96744','73178',                           '92990','70150','71338','98212','55934',                           '36153','43009','57933','34349','64004',                           '21257','56883','75363','26988','47647',                           '70952','23663','29846','32534','10499',                           '56449','74574','87563','67276','90241',                           '57748','51987','88007','44068','22397',                           '80241','53121','26880','75322','54984',                           '16546','89021','30045','74754','82936',                           '59801','90722','45556','70975','57171',                           '54577','79535','96144','80844','27134',                           '57145','35387','86548','60316','10322',                           '83328','54024','40020','59876','70139',                           '33556','46256','69793','15534','31127',                           '46121','32925','70466','71140','73390',                           '95695','73586','75793','52217','74575',                           '58592','71323','96525','17747','71479',                           '42960','85829','69708','37519','99229',                           '72778','48686','80100','53069','25362',                           '86256','22990','31581','55797','74015',                           '46081','76163','45996','19064','66284',                           '88491','18238','32897','80447','21898',                           '78533','16042','88749','95411','80680',                           '17951','90781','80959','58732','64280',                           '98174','15530','86934','89037','36558',                           '24484','35098','84113','52685','92669',                           '35996','32894','32596','43321','17783',                           '25579','84125','44723','99363','42482',                           '38226','54641','92865','40671','97001',                           '39734','69325','59762','28999','21719',                           '75446','44742','19636','99249','50420',                           '10021','18335','34260','81653','41475',                           '89105','48817','49636','90645','12530',                           '12778','91283','18457','72802')      intersect       select ca_zip       from (SELECT substring(ca_zip,1,5) ca_zip,count(*) cnt             FROM customer_address, customer             WHERE ca_address_sk = c_current_addr_sk and                   c_preferred_cust_flag='Y'             group by ca_zip             having count(*) > 10)A1)A2) V1  where ss_store_sk = s_store_sk   and ss_sold_date_sk = d_date_sk   and d_qoy = 1 and d_year = 2002   and (substring(s_zip,1,2) = substring(V1.ca_zip,1,2))  group by s_store_name  order by s_store_name  ;", "predicates": {"customer": ["c_preferred_cust_flag"], "date_dim": ["d_qoy", "d_year"]}, "payload": {"customer": ["c_current_addr_sk"], "customer_address": ["ca_address_sk", "ca_zip"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 9, "query_string": " select case when (select count(*)                    from store_sales                    where ss_quantity between 1 and 20) > 40721             then (select avg(ss_ext_sales_price)                    from store_sales                    where ss_quantity between 1 and 20)              else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 1 and 20) end bucket1 ,        case when (select count(*)                   from store_sales                   where ss_quantity between 21 and 40) > 40203             then (select avg(ss_ext_sales_price)                   from store_sales                   where ss_quantity between 21 and 40)              else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 21 and 40) end bucket2,        case when (select count(*)                   from store_sales                   where ss_quantity between 41 and 60) > 80             then (select avg(ss_ext_sales_price)                   from store_sales                   where ss_quantity between 41 and 60)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 41 and 60) end bucket3,        case when (select count(*)                   from store_sales                   where ss_quantity between 61 and 80) > 43994             then (select avg(ss_ext_sales_price)                   from store_sales                   where ss_quantity between 61 and 80)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 61 and 80) end bucket4,        case when (select count(*)                   from store_sales                   where ss_quantity between 81 and 100) > 31910             then (select avg(ss_ext_sales_price)                   from store_sales                   where ss_quantity between 81 and 100)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 81 and 100) end bucket5 from reason where r_reason_sk = 1;", "predicates": {"store_sales": ["ss_quantity"]}, "payload": {"store_sales": ["ss_ext_tax", "ss_net_paid_inc_tax"]}, "group_by": {}, "order_by": {}}
{"id": 10, "query_string": " select top (100)    cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3,   cd_dep_count,   count(*) cnt4,   cd_dep_employed_count,   count(*) cnt5,   cd_dep_college_count,   count(*) cnt6  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_county in ('Benzie County','Mercer County','Blaine County','Chippewa County','Hubbard County') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2001 and                 d_moy between 1 and 1+3) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 1 ANd 1+3) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 1 and 1+3))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count;", "predicates": {"customer_address": ["ca_county"], "date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 11, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag           ,c_birth_country          ,c_login          ,c_email_address          ,d_year   union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag           ,c_birth_country          ,c_login          ,c_email_address          ,d_year          )   select top (100)                    t_s_secyear.customer_id                  ,t_s_secyear.customer_first_name                  ,t_s_secyear.customer_last_name                  ,t_s_secyear.customer_email_address  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id          and t_s_firstyear.customer_id = t_w_secyear.customer_id          and t_s_firstyear.customer_id = t_w_firstyear.customer_id          and t_s_firstyear.sale_type = 's'          and t_w_firstyear.sale_type = 'w'          and t_s_secyear.sale_type = 's'          and t_w_secyear.sale_type = 'w'          and t_s_firstyear.dyear = 2000          and t_s_secyear.dyear = 2000+1          and t_w_firstyear.dyear = 2000          and t_w_secyear.dyear = 2000+1          and t_s_firstyear.year_total > 0          and t_w_firstyear.year_total > 0          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end              > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end  order by t_s_secyear.customer_id          ,t_s_secyear.customer_first_name          ,t_s_secyear.customer_last_name          ,t_s_secyear.customer_email_address;", "predicates": {"date_dim": ["d_year"]}, "payload": {"customer": ["c_login", "c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_ext_list_price", "ss_ext_discount_amt"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_discount_amt", "ws_ext_list_price"]}, "group_by": {}, "order_by": {}}
{"id": 12, "query_string": " select top (100) i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from\t \tweb_sales     \t,item      \t,date_dim where  \tws_item_sk = i_item_sk    \tand i_category in ('Music', 'Books', 'Sports')   \tand ws_sold_date_sk = d_date_sk \tand d_date between cast('1998-06-19' as date)  \t\t\t\tand dateadd(day, 30, cast('1998-06-19' as date)) group by  \ti_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  \ti_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_desc", "i_class", "i_item_id", "i_category"]}}
{"id": 13, "query_string": " select avg(ss_quantity)        ,avg(ss_ext_sales_price)        ,avg(ss_ext_wholesale_cost)        ,sum(ss_ext_wholesale_cost)  from store_sales      ,store      ,customer_demographics      ,household_demographics      ,customer_address      ,date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2001  and((ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'W'   and cd_education_status = 'Secondary'   and ss_sales_price between 100.00 and 150.00   and hd_dep_count = 3         )or      (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'D'   and cd_education_status = 'Advanced Degree'   and ss_sales_price between 50.00 and 100.00      and hd_dep_count = 1      ) or       (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'S'   and cd_education_status = 'Unknown'   and ss_sales_price between 150.00 and 200.00    and hd_dep_count = 1        ))  and((ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('MA', 'IA', 'TX')   and ss_net_profit between 100 and 200        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('MT', 'SD', 'CA')   and ss_net_profit between 150 and 300        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('VA', 'KS', 'WV')   and ss_net_profit between 50 and 250        ));", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "household_demographics": ["hd_dep_count"], "store_sales": ["ss_sales_price", "ss_net_profit"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_dep_count", "hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_ext_sales_price", "ss_cdemo_sk", "ss_addr_sk", "ss_quantity", "ss_sales_price", "ss_ext_wholesale_cost", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 14, "query_string": " with  cross_items as  (select i_item_sk ss_item_sk  from item,  (select iss.i_brand_id brand_id      ,iss.i_class_id class_id      ,iss.i_category_id category_id  from store_sales      ,item iss      ,date_dim d1  where ss_item_sk = iss.i_item_sk    and ss_sold_date_sk = d1.d_date_sk    and d1.d_year between 2000 AND 2000 + 2  intersect   select ics.i_brand_id      ,ics.i_class_id      ,ics.i_category_id  from catalog_sales      ,item ics      ,date_dim d2  where cs_item_sk = ics.i_item_sk    and cs_sold_date_sk = d2.d_date_sk    and d2.d_year between 2000 AND 2000 + 2  intersect  select iws.i_brand_id      ,iws.i_class_id      ,iws.i_category_id  from web_sales      ,item iws      ,date_dim d3  where ws_item_sk = iws.i_item_sk    and ws_sold_date_sk = d3.d_date_sk    and d3.d_year between 2000 AND 2000 + 2) a  where i_brand_id = brand_id       and i_class_id = class_id       and i_category_id = category_id ),  avg_sales as  (select avg(quantity*list_price) average_sales   from (select ss_quantity quantity              ,ss_list_price list_price        from store_sales            ,date_dim        where ss_sold_date_sk = d_date_sk          and d_year between 2000 and 2000 + 2        union all         select cs_quantity quantity               ,cs_list_price list_price        from catalog_sales            ,date_dim        where cs_sold_date_sk = d_date_sk          and d_year between 2000 and 2000 + 2         union all        select ws_quantity quantity              ,ws_list_price list_price        from web_sales            ,date_dim        where ws_sold_date_sk = d_date_sk          and d_year between 2000 and 2000 + 2) x)   select top (100) channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)  from(        select 'store' channel, i_brand_id,i_class_id              ,i_category_id,sum(ss_quantity*ss_list_price) sales              , count(*) number_sales        from store_sales            ,item            ,date_dim        where ss_item_sk in (select ss_item_sk from cross_items)          and ss_item_sk = i_item_sk          and ss_sold_date_sk = d_date_sk          and d_year = 2000+2           and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)        union all        select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales        from catalog_sales            ,item            ,date_dim        where cs_item_sk in (select ss_item_sk from cross_items)          and cs_item_sk = i_item_sk          and cs_sold_date_sk = d_date_sk          and d_year = 2000+2           and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)        union all        select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales        from web_sales            ,item            ,date_dim        where ws_item_sk in (select ss_item_sk from cross_items)          and ws_item_sk = i_item_sk          and ws_sold_date_sk = d_date_sk          and d_year = 2000+2          and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)  ) y  group by rollup (channel, i_brand_id,i_class_id,i_category_id)  order by channel,i_brand_id,i_class_id,i_category_id  ; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_list_price", "cs_quantity"], "date_dim": ["d_date_sk"], "item": ["i_category_id", "i_class_id", "i_item_sk", "i_brand_id"], "store_sales": ["ss_sold_date_sk", "ss_list_price", "ss_quantity", "ss_item_sk"], "web_sales": ["ws_list_price", "ws_sold_date_sk", "ws_item_sk", "ws_quantity"]}, "group_by": {}, "order_by": {}}
{"id": 15, "query_string": " select top (100) ca_zip        ,sum(cs_sales_price)  from catalog_sales      ,customer      ,customer_address      ,date_dim  where cs_bill_customer_sk = c_customer_sk  \tand c_current_addr_sk = ca_address_sk   \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',                                    '85392', '85460', '80348', '81792')  \t      or ca_state in ('CA','WA','GA')  \t      or cs_sales_price > 500)  \tand cs_sold_date_sk = d_date_sk  \tand d_qoy = 2 and d_year = 2002  group by ca_zip  order by ca_zip  ;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"catalog_sales": ["cs_sales_price", "cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip", "ca_state"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_zip"]}}
{"id": 16, "query_string": " select top (100)     count(distinct cs_order_number) as \"order count\"   ,sum(cs_ext_ship_cost) as \"total shipping cost\"   ,sum(cs_net_profit) as \"total net profit\" from    catalog_sales cs1   ,date_dim   ,customer_address   ,call_center where     d_date between '2002-5-01' and             dateadd(day, 60, cast('2002-5-01' as date)) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'AR' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County',                   'Williamson County' ) and exists (select *             from catalog_sales cs2             where cs1.cs_order_number = cs2.cs_order_number               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select *                from catalog_returns cr1                where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number);", "predicates": {"call_center": ["cc_county"], "customer_address": ["ca_state"], "date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_order_number"], "catalog_sales": ["cs_order_number", "cs_warehouse_sk", "cs_ext_ship_cost", "cs_ship_addr_sk", "cs_net_profit", "cs_call_center_sk", "cs_ship_date_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 17, "query_string": " select top (100) i_item_id        ,i_item_desc        ,s_state        ,count(ss_quantity) as store_sales_quantitycount        ,avg(ss_quantity) as store_sales_quantityave        ,stdev(ss_quantity) as store_sales_quantitystdev        ,stdev(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov        ,count(sr_return_quantity) as store_returns_quantitycount        ,avg(sr_return_quantity) as store_returns_quantityave        ,stdev(sr_return_quantity) as store_returns_quantitystdev        ,stdev(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov        ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave        ,stdev(cs_quantity) as catalog_sales_quantitystdev        ,stdev(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov  from store_sales      ,store_returns      ,catalog_sales      ,date_dim d1      ,date_dim d2      ,date_dim d3      ,store      ,item  where d1.d_quarter_name = '2000Q1'    and d1.d_date_sk = ss_sold_date_sk    and i_item_sk = ss_item_sk    and s_store_sk = ss_store_sk    and ss_customer_sk = sr_customer_sk    and ss_item_sk = sr_item_sk    and ss_ticket_number = sr_ticket_number    and sr_returned_date_sk = d2.d_date_sk    and d2.d_quarter_name in ('2000Q1','2000Q2','2000Q3')    and sr_customer_sk = cs_bill_customer_sk    and sr_item_sk = cs_item_sk    and cs_sold_date_sk = d3.d_date_sk    and d3.d_quarter_name in ('2000Q1','2000Q2','2000Q3')  group by i_item_id          ,i_item_desc          ,s_state  order by i_item_id          ,i_item_desc          ,s_state;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_quarter_name"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_state", "s_store_sk"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_return_quantity", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 18, "query_string": " select top (100) i_item_id,         ca_country,         ca_state,          ca_county,         avg( cast(cs_quantity as decimal(12,2))) agg1,         avg( cast(cs_list_price as decimal(12,2))) agg2,         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,         avg( cast(cs_sales_price as decimal(12,2))) agg4,         avg( cast(cs_net_profit as decimal(12,2))) agg5,         avg( cast(c_birth_year as decimal(12,2))) agg6,         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7  from catalog_sales, customer_demographics cd1,        customer_demographics cd2, customer, customer_address, date_dim, item  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd1.cd_demo_sk and        cs_bill_customer_sk = c_customer_sk and        cd1.cd_gender = 'F' and         cd1.cd_education_status = 'College' and        c_current_cdemo_sk = cd2.cd_demo_sk and        c_current_addr_sk = ca_address_sk and        c_birth_month in (8,5,11,10,6,4) and        d_year = 1999 and        ca_state in ('KS','SD','IN'                    ,'NY','NM','MO','NJ')  group by rollup (i_item_id, ca_country, ca_state, ca_county)  order by ca_country,         ca_state,          ca_county, \ti_item_id  ;", "predicates": {"customer": ["c_birth_month"], "customer_address": ["ca_state"], "customer_demographics": ["cd_education_status", "cd_gender"], "date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_quantity", "cs_sales_price", "cs_bill_customer_sk", "cs_item_sk", "cs_net_profit", "cs_list_price", "cs_coupon_amt", "cs_sold_date_sk", "cs_bill_cdemo_sk"], "customer": ["c_birth_year", "c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_county", "ca_country", "ca_state"], "customer_demographics": ["cd_demo_sk", "cd_dep_count"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_state", "ca_county", "ca_country"], "item": ["i_item_id"]}}
{"id": 19, "query_string": " select top (100) i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,  \tsum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item,customer,customer_address,store  where d_date_sk = ss_sold_date_sk    and ss_item_sk = i_item_sk    and i_manager_id=19    and d_moy=12    and d_year=1998    and ss_customer_sk = c_customer_sk     and c_current_addr_sk = ca_address_sk    and substring(ca_zip,1,5) <> substring(s_zip,1,5)     and ss_store_sk = s_store_sk   group by i_brand       ,i_brand_id       ,i_manufact_id       ,i_manufact  order by ext_price desc          ,i_brand          ,i_brand_id          ,i_manufact_id          ,i_manufact  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip"], "date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_brand_id", "i_manufact_id", "i_brand", "i_manufact"], "store": ["s_zip", "s_store_sk"]}, "group_by": {}, "order_by": {"item": ["i_brand", "i_manufact", "i_brand_id", "i_manufact_id"]}}
{"id": 20, "query_string": " select top (100) i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from\tcatalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Music', 'Books', 'Sports')    and cs_sold_date_sk = d_date_sk  and d_date between cast('1998-06-19' as date)   \t\t\t\tand dateadd(day, 30, cast('1998-06-19' as date))  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"]}, "group_by": {}, "order_by": {"item": ["i_item_desc", "i_class", "i_item_id", "i_category"]}}
{"id": 21, "query_string": " select top (100) *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-15' as date)) \t                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between dateadd(day, -30, cast ('1999-03-15' as date))                     and dateadd(day, 30, cast ('1999-03-15' as date))    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  ;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"]}, "payload": {"date_dim": ["d_date_sk", "d_date"], "item": ["i_item_id", "i_item_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 22, "query_string": " select top (100) i_product_name              ,i_brand              ,i_class              ,i_category              ,avg(inv_quantity_on_hand) qoh        from inventory            ,date_dim            ,item        where inv_date_sk=d_date_sk               and inv_item_sk=i_item_sk               and d_month_seq between 1220 and 1220 + 11        group by rollup(i_product_name                        ,i_brand                        ,i_class                        ,i_category) order by qoh, i_product_name, i_brand, i_class, i_category;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_brand", "i_product_name", "i_category", "i_class"]}, "group_by": {}, "order_by": {"item": ["i_product_name", "i_class", "i_brand", "i_category"]}}
{"id": 23, "query_string": " with frequent_ss_items as   (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt   from store_sales       ,date_dim        ,item   where ss_sold_date_sk = d_date_sk     and ss_item_sk = i_item_sk      and d_year in (2000,2000+1,2000+2,2000+3)   group by substring(i_item_desc,1,30),i_item_sk,d_date   having count(*) >4),  max_store_sales as  (select max(csales) tpcds_cmax    from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales         from store_sales             ,customer             ,date_dim          where ss_customer_sk = c_customer_sk          and ss_sold_date_sk = d_date_sk          and d_year in (2000,2000+1,2000+2,2000+3)          group by c_customer_sk) a),  best_ss_customer as  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales   from store_sales       ,customer   where ss_customer_sk = c_customer_sk   group by c_customer_sk   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select   * from  max_store_sales))   select top (100) sum(sales)  from (select cs_quantity*cs_list_price sales        from catalog_sales            ,date_dim         where d_year = 2000           and d_moy = 3           and cs_sold_date_sk = d_date_sk           and cs_item_sk in (select item_sk from frequent_ss_items)          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)       union all       select ws_quantity*ws_list_price sales        from web_sales             ,date_dim         where d_year = 2000           and d_moy = 3           and ws_sold_date_sk = d_date_sk           and ws_item_sk in (select item_sk from frequent_ss_items)          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) b  ; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"customer": ["c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "item": ["i_item_sk", "i_item_desc"], "store_sales": ["ss_item_sk", "ss_sales_price", "ss_customer_sk", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 24, "query_string": " with ssales as (select c_last_name       ,c_first_name       ,s_store_name       ,ca_state       ,s_state       ,i_color       ,i_current_price       ,i_manager_id       ,i_units       ,i_size       ,sum(ss_sales_price) netpaid from store_sales     ,store_returns     ,store     ,item     ,customer     ,customer_address where ss_ticket_number = sr_ticket_number   and ss_item_sk = sr_item_sk   and ss_customer_sk = c_customer_sk   and ss_item_sk = i_item_sk   and ss_store_sk = s_store_sk   and c_current_addr_sk = ca_address_sk   and c_birth_country <> upper(ca_country)   and s_zip = ca_zip and s_market_id=10 group by c_last_name         ,c_first_name         ,s_store_name         ,ca_state         ,s_state         ,i_color         ,i_current_price         ,i_manager_id         ,i_units         ,i_size) select c_last_name       ,c_first_name       ,s_store_name       ,sum(netpaid) paid from ssales where i_color = 'lace' group by c_last_name         ,c_first_name         ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid)                                  from ssales) order by c_last_name         ,c_first_name         ,s_store_name; ", "predicates": {"item": ["i_color"], "store": ["s_market_id"]}, "payload": {"customer": ["c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_current_addr_sk"], "customer_address": ["ca_address_sk", "ca_country", "ca_zip", "ca_state"], "item": ["i_item_sk", "i_units", "i_manager_id", "i_current_price", "i_size"], "store": ["s_zip", "s_store_name", "s_state", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_net_paid_inc_tax"]}, "group_by": {}, "order_by": {}}
{"id": 25, "query_string": " select top (100)   i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  ,min(ss_net_profit) as store_sales_profit  ,min(sr_net_loss) as store_returns_loss  ,min(cs_net_profit) as catalog_sales_profit  from  store_sales  ,store_returns  ,catalog_sales  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,item  where  d1.d_moy = 4  and d1.d_year = 2002  and d1.d_date_sk = ss_sold_date_sk  and i_item_sk = ss_item_sk  and s_store_sk = ss_store_sk  and ss_customer_sk = sr_customer_sk  and ss_item_sk = sr_item_sk  and ss_ticket_number = sr_ticket_number  and sr_returned_date_sk = d2.d_date_sk  and d2.d_moy               between 4 and  10  and d2.d_year              = 2002  and sr_customer_sk = cs_bill_customer_sk  and sr_item_sk = cs_item_sk  and cs_sold_date_sk = d3.d_date_sk  and d3.d_moy               between 4 and  10   and d3.d_year              = 2002  group by  i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  order by  i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  ;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_store_name", "s_store_sk", "s_store_id"], "store_returns": ["sr_returned_date_sk", "sr_net_loss", "sr_customer_sk", "sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 26, "query_string": " select top (100) i_item_id,          avg(cs_quantity) agg1,         avg(cs_list_price) agg2,         avg(cs_coupon_amt) agg3,         avg(cs_sales_price) agg4   from catalog_sales, customer_demographics, date_dim, item, promotion  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd_demo_sk and        cs_promo_sk = p_promo_sk and        cd_gender = 'M' and         cd_marital_status = 'M' and        cd_education_status = 'Secondary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 2001   group by i_item_id  order by i_item_id  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "promotion": ["p_channel_event", "p_channel_email"]}, "payload": {"item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 27, "query_string": " select top (100) i_item_id,         s_state, grouping(s_state) g_state,         avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4  from store_sales, customer_demographics, date_dim, store, item  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_store_sk = s_store_sk and        ss_cdemo_sk = cd_demo_sk and        cd_gender = 'M' and        cd_marital_status = 'U' and        cd_education_status = 'Secondary' and        d_year = 2000 and        s_state in ('TN','TN', 'TN', 'TN', 'TN', 'TN')  group by rollup (i_item_id, s_state)  order by i_item_id          ,s_state  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "store": ["s_state"]}, "payload": {"customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"], "store": ["s_state", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_cdemo_sk", "ss_list_price", "ss_quantity", "ss_sales_price", "ss_coupon_amt", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_id"], "store": ["s_state"]}}
{"id": 28, "query_string": " select top (100) * from (select avg(ss_list_price) B1_LP             ,count(ss_list_price) B1_CNT             ,count(distinct ss_list_price) B1_CNTD       from store_sales       where ss_quantity between 0 and 5         and (ss_list_price between 55 and 55+10               or ss_coupon_amt between 16242 and 16242+1000              or ss_wholesale_cost between 26 and 26+20)) B1,      (select avg(ss_list_price) B2_LP             ,count(ss_list_price) B2_CNT             ,count(distinct ss_list_price) B2_CNTD       from store_sales       where ss_quantity between 6 and 10         and (ss_list_price between 136 and 136+10           or ss_coupon_amt between 1027 and 1027+1000           or ss_wholesale_cost between 30 and 30+20)) B2,      (select avg(ss_list_price) B3_LP             ,count(ss_list_price) B3_CNT             ,count(distinct ss_list_price) B3_CNTD       from store_sales       where ss_quantity between 11 and 15         and (ss_list_price between 169 and 169+10           or ss_coupon_amt between 16546 and 16546+1000           or ss_wholesale_cost between 18 and 18+20)) B3,      (select avg(ss_list_price) B4_LP             ,count(ss_list_price) B4_CNT             ,count(distinct ss_list_price) B4_CNTD       from store_sales       where ss_quantity between 16 and 20         and (ss_list_price between 26 and 26+10           or ss_coupon_amt between 8132 and 8132+1000           or ss_wholesale_cost between 67 and 67+20)) B4,      (select avg(ss_list_price) B5_LP             ,count(ss_list_price) B5_CNT             ,count(distinct ss_list_price) B5_CNTD       from store_sales       where ss_quantity between 21 and 25         and (ss_list_price between 71 and 71+10           or ss_coupon_amt between 5500 and 5500+1000           or ss_wholesale_cost between 11 and 11+20)) B5,      (select avg(ss_list_price) B6_LP             ,count(ss_list_price) B6_CNT             ,count(distinct ss_list_price) B6_CNTD       from store_sales       where ss_quantity between 26 and 30         and (ss_list_price between 0 and 0+10           or ss_coupon_amt between 12581 and 12581+1000           or ss_wholesale_cost between 23 and 23+20)) B6;", "predicates": {"store_sales": ["ss_list_price", "ss_coupon_amt", "ss_quantity", "ss_wholesale_cost"]}, "payload": {"store_sales": ["ss_list_price"]}, "group_by": {}, "order_by": {}}
{"id": 29, "query_string": " select top (100)        i_item_id     ,i_item_desc     ,s_store_id     ,s_store_name     ,avg(ss_quantity)        as store_sales_quantity     ,avg(sr_return_quantity) as store_returns_quantity     ,avg(cs_quantity)        as catalog_sales_quantity  from     store_sales    ,store_returns    ,catalog_sales    ,date_dim             d1    ,date_dim             d2    ,date_dim             d3    ,store    ,item  where      d1.d_moy               = 4   and d1.d_year              = 2000  and d1.d_date_sk           = ss_sold_date_sk  and i_item_sk              = ss_item_sk  and s_store_sk             = ss_store_sk  and ss_customer_sk         = sr_customer_sk  and ss_item_sk             = sr_item_sk  and ss_ticket_number       = sr_ticket_number  and sr_returned_date_sk    = d2.d_date_sk  and d2.d_moy               between 4 and  4 + 3   and d2.d_year              = 2000  and sr_customer_sk         = cs_bill_customer_sk  and sr_item_sk             = cs_item_sk  and cs_sold_date_sk        = d3.d_date_sk       and d3.d_year              in (2000,2000+1,2000+2)  group by     i_item_id    ,i_item_desc    ,s_store_id    ,s_store_name  order by     i_item_id     ,i_item_desc    ,s_store_id    ,s_store_name  ;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_store_name", "s_store_sk", "s_store_id"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_return_quantity", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 30, "query_string": " with customer_total_return as  (select wr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   \tsum(wr_return_amt) as ctr_total_return  from web_returns      ,date_dim      ,customer_address  where wr_returned_date_sk = d_date_sk     and d_year =2002    and wr_returning_addr_sk = ca_address_sk   group by wr_returning_customer_sk          ,ca_state)   select top (100) c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag        ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address        ,c_last_review_date,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  \t\t\t  from customer_total_return ctr2                    \t  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'VA'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag                   ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address                   ,c_last_review_date,ctr_total_return;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_year"]}, "payload": {"customer": ["c_birth_year", "c_login", "c_customer_sk", "c_birth_month", "c_salutation", "c_birth_day", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_current_addr_sk", "c_email_address", "c_customer_id", "c_last_review_date"], "customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "web_returns": ["wr_return_amt", "wr_returning_addr_sk", "wr_returned_date_sk", "wr_returning_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_birth_year", "c_login", "c_birth_month", "c_birth_country", "c_salutation", "c_birth_day", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id", "c_last_review_date"]}}
{"id": 31, "query_string": " with ss as  (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales  from store_sales,date_dim,customer_address  where ss_sold_date_sk = d_date_sk   and ss_addr_sk=ca_address_sk  group by ca_county,d_qoy, d_year),  ws as  (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales  from web_sales,date_dim,customer_address  where ws_sold_date_sk = d_date_sk   and ws_bill_addr_sk=ca_address_sk  group by ca_county,d_qoy, d_year)  select          ss1.ca_county        ,ss1.d_year        ,ws2.web_sales/ws1.web_sales web_q1_q2_increase        ,ss2.store_sales/ss1.store_sales store_q1_q2_increase        ,ws3.web_sales/ws2.web_sales web_q2_q3_increase        ,ss3.store_sales/ss2.store_sales store_q2_q3_increase  from         ss ss1        ,ss ss2        ,ss ss3        ,ws ws1        ,ws ws2        ,ws ws3  where     ss1.d_qoy = 1     and ss1.d_year = 2002     and ss1.ca_county = ss2.ca_county     and ss2.d_qoy = 2     and ss2.d_year = 2002  and ss2.ca_county = ss3.ca_county     and ss3.d_qoy = 3     and ss3.d_year = 2002     and ss1.ca_county = ws1.ca_county     and ws1.d_qoy = 1     and ws1.d_year = 2002     and ws1.ca_county = ws2.ca_county     and ws2.d_qoy = 2     and ws2.d_year = 2002     and ws1.ca_county = ws3.ca_county     and ws3.d_qoy = 3     and ws3.d_year =2002     and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end         > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end     and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end        > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end  order by store_q1_q2_increase;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"customer_address": ["ca_address_sk", "ca_county"], "date_dim": ["d_date_sk", "d_year"], "store_sales": ["ss_sold_date_sk", "ss_addr_sk", "ss_ext_sales_price"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_bill_addr_sk"]}, "group_by": {}, "order_by": {}}
{"id": 32, "query_string": " select top (100) sum(cs_ext_discount_amt)  as \"excess discount amount\"  from     catalog_sales     ,item     ,date_dim where i_manufact_id = 724 and i_item_sk = cs_item_sk  and d_date between '2001-02-18' and          dateadd(day, 90, cast('2001-02-18' as date)) and d_date_sk = cs_sold_date_sk  and cs_ext_discount_amt        > (           select              1.3 * avg(cs_ext_discount_amt)           from              catalog_sales             ,date_dim          where                cs_item_sk = i_item_sk            and d_date between '2001-02-18' and                              dateadd(day, 90, cast('2001-02-18' as date))           and d_date_sk = cs_sold_date_sk        ) ;", "predicates": {"catalog_sales": ["cs_ext_discount_amt"], "date_dim": ["d_date"], "item": ["i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 33, "query_string": " with ss as (  select           i_manufact_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id in (select   i_manufact_id from  item where i_category in ('Jewelry'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 5  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  cs as (  select           i_manufact_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Jewelry'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 5  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  ws as (  select           i_manufact_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Jewelry'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 5  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_manufact_id)   select top (100) i_manufact_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_manufact_id  order by total_sales;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_category"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_addr_sk", "cs_item_sk", "cs_ext_sales_price"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_manufact_id"], "store_sales": ["ss_sold_date_sk", "ss_addr_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk", "ws_bill_addr_sk"]}, "group_by": {}, "order_by": {}}
{"id": 34, "query_string": " select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = 'Unknown')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  \tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  \telse null  \tend)  > 1.2     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',                            'Williamson County','Williamson County','Williamson County','Williamson County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;", "predicates": {"date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count", "hd_buy_potential"], "store": ["s_county"]}, "payload": {"customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_preferred_cust_flag"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 35, "query_string": " select top (100)     ca_state,   cd_gender,   cd_marital_status,   cd_dep_count,   count(*) cnt1,   sum(cd_dep_count),   stdev(cd_dep_count),   avg(cd_dep_count),   cd_dep_employed_count,   count(*) cnt2,   sum(cd_dep_employed_count),   stdev(cd_dep_employed_count),   avg(cd_dep_employed_count),   cd_dep_college_count,   count(*) cnt3,   sum(cd_dep_college_count),   stdev(cd_dep_college_count),   avg(cd_dep_college_count)  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2002 and                 d_qoy < 4) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_qoy < 4) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_qoy < 4))  group by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  ;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_state"], "customer_demographics": ["cd_dep_college_count", "cd_gender", "cd_demo_sk", "cd_dep_employed_count", "cd_dep_count", "cd_marital_status"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 36, "query_string": " select top (100)      sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  \tpartition by grouping(i_category)+grouping(i_class),  \tcase when grouping(i_class) = 0 then i_category end   \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent  from     store_sales    ,date_dim       d1    ,item    ,store  where     d1.d_year = 2002   and d1.d_date_sk = ss_sold_date_sk  and i_item_sk  = ss_item_sk   and s_store_sk  = ss_store_sk  and s_state in ('TN','TN','TN','TN',                  'TN','TN','TN','TN')  group by rollup(i_category,i_class)  order by    lochierarchy desc   ,case when (grouping(i_category)+grouping(i_class)) = 0 then i_category end   ,rank_within_parent   ;", "predicates": {"date_dim": ["d_year"], "store": ["s_state"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_class", "i_item_sk", "i_category"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_ext_sales_price", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 37, "query_string": " select top (100) i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 60 and 60 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('1998-01-03' as date) and dateadd(day, 60, cast('1998-01-03' as date))  and i_manufact_id in (702,811,687,968)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  ;", "predicates": {"date_dim": ["d_date"], "inventory": ["inv_quantity_on_hand"], "item": ["i_current_price", "i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc", "i_current_price"]}, "group_by": {}, "order_by": {}}
{"id": 38, "query_string": " select top (100) count(*) from (     select distinct c_last_name, c_first_name, d_date     from store_sales, date_dim, customer           where store_sales.ss_sold_date_sk = date_dim.d_date_sk       and store_sales.ss_customer_sk = customer.c_customer_sk       and d_month_seq between 1220 and 1220 + 11   intersect     select distinct c_last_name, c_first_name, d_date     from catalog_sales, date_dim, customer           where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk       and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk       and d_month_seq between 1220 and 1220 + 11   intersect     select distinct c_last_name, c_first_name, d_date     from web_sales, date_dim, customer           where web_sales.ws_sold_date_sk = date_dim.d_date_sk       and web_sales.ws_bill_customer_sk = customer.c_customer_sk       and d_month_seq between 1220 and 1220 + 11 ) hot_cust;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk", "ws_item_sk", "ws_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 39, "query_string": " with inv as (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy        ,stdev,mean, case mean when 0 then null else stdev/mean end cov  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy             ,stdev(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean       from inventory           ,item           ,warehouse           ,date_dim       where inv_item_sk = i_item_sk         and inv_warehouse_sk = w_warehouse_sk         and inv_date_sk = d_date_sk         and d_year =1999       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo  where case mean when 0 then 0 else stdev/mean end > 1) select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov from inv inv1,inv inv2 where inv1.i_item_sk = inv2.i_item_sk   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk   and inv1.d_moy=3   and inv2.d_moy=3+1 order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov         ,inv2.d_moy,inv2.mean, inv2.cov; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_item_sk"], "warehouse": ["w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 40, "query_string": " select top (100)     w_state   ,i_item_id   ,sum(case when (cast(d_date as date) < cast ('1999-03-15' as date))   \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before   ,sum(case when (cast(d_date as date) >= cast ('1999-03-15' as date))   \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after  from    catalog_sales left outer join catalog_returns on        (cs_order_number = cr_order_number          and cs_item_sk = cr_item_sk)   ,warehouse    ,item   ,date_dim  where      i_current_price between 0.99 and 1.49  and i_item_sk          = cs_item_sk  and cs_warehouse_sk    = w_warehouse_sk   and cs_sold_date_sk    = d_date_sk  and d_date between dateadd(day, -30, cast ('1999-03-15' as date))                 and dateadd(day, 30, cast ('1999-03-15' as date))   group by     w_state,i_item_id  order by w_state,i_item_id;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_refunded_cash"], "date_dim": ["d_date_sk", "d_date"], "item": ["i_item_id", "i_item_sk"], "warehouse": ["w_state", "w_warehouse_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_id"], "warehouse": ["w_state"]}}
{"id": 41, "query_string": " select distinct top (100) i_product_name  from item i1  where i_manufact_id between 901 and 901+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'rose' or i_color = 'drab') and          (i_units = 'Ounce' or i_units = 'Gross') and         (i_size = 'economy' or i_size = 'medium')         ) or         (i_category = 'Women' and         (i_color = 'magenta' or i_color = 'tomato') and         (i_units = 'Gram' or i_units = 'Carton') and         (i_size = 'petite' or i_size = 'large')         ) or         (i_category = 'Men' and         (i_color = 'ivory' or i_color = 'burnished') and         (i_units = 'Bundle' or i_units = 'Bunch') and         (i_size = 'small' or i_size = 'N/A')         ) or         (i_category = 'Men' and         (i_color = 'steel' or i_color = 'seashell') and         (i_units = 'Cup' or i_units = 'N/A') and         (i_size = 'economy' or i_size = 'medium')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'floral' or i_color = 'lawn') and          (i_units = 'Oz' or i_units = 'Tsp') and         (i_size = 'economy' or i_size = 'medium')         ) or         (i_category = 'Women' and         (i_color = 'plum' or i_color = 'cornsilk') and         (i_units = 'Ton' or i_units = 'Each') and         (i_size = 'petite' or i_size = 'large')         ) or         (i_category = 'Men' and         (i_color = 'orange' or i_color = 'lime') and         (i_units = 'Dram' or i_units = 'Unknown') and         (i_size = 'small' or i_size = 'N/A')         ) or         (i_category = 'Men' and         (i_color = 'lemon' or i_color = 'turquoise') and         (i_units = 'Dozen' or i_units = 'Pallet') and         (i_size = 'economy' or i_size = 'medium')         )))) > 0  order by i_product_name  ;", "predicates": {"item": ["i_color", "i_units", "i_manufact_id", "i_category", "i_size", "i_manufact"]}, "payload": {"item": ["i_color", "i_units", "i_product_name", "i_category", "i_size", "i_manufact"]}, "group_by": {}, "order_by": {}}
{"id": 42, "query_string": " select top (100) dt.d_year  \t,item.i_category_id  \t,item.i_category  \t,sum(ss_ext_sales_price)  from \tdate_dim dt  \t,store_sales  \t,item  where dt.d_date_sk = store_sales.ss_sold_date_sk  \tand store_sales.ss_item_sk = item.i_item_sk  \tand item.i_manager_id = 1  \t  \tand dt.d_moy=11  \tand dt.d_year=1999  group by \tdt.d_year  \t\t,item.i_category_id  \t\t,item.i_category  order by       sum(ss_ext_sales_price) desc,dt.d_year  \t\t,item.i_category_id  \t\t,item.i_category  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_item_sk", "i_category", "i_category_id"]}, "group_by": {}, "order_by": {"item": ["i_category", "i_category_id"]}}
{"id": 43, "query_string": " select top (100) s_store_name, s_store_id,         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales  from date_dim, store_sales, store  where d_date_sk = ss_sold_date_sk and        s_store_sk = ss_store_sk and        s_gmt_offset = -5 and        d_year = 1999   group by s_store_name, s_store_id  order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales  ;", "predicates": {"date_dim": ["d_year"], "store": ["s_gmt_offset"]}, "payload": {"date_dim": ["d_date_sk", "d_day_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 44, "query_string": " select top (100) asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing from(select *      from (select item_sk,rank() over (order by rank_col asc) rnk            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col                   from store_sales ss1                  where ss_store_sk = 4                  group by ss_item_sk                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col                                                   from store_sales                                                   where ss_store_sk = 4                                                     and ss_promo_sk is null                                                   group by ss_store_sk))V1)V11      where rnk  < 11) asceding,     (select *      from (select item_sk,rank() over (order by rank_col desc) rnk            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col                  from store_sales ss1                  where ss_store_sk = 4                  group by ss_item_sk                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col                                                   from store_sales                                                   where ss_store_sk = 4                                                     and ss_promo_sk is null                                                   group by ss_store_sk))V2)V21      where rnk  < 11) descending, item i1, item i2 where asceding.rnk = descending.rnk    and i1.i_item_sk=asceding.item_sk   and i2.i_item_sk=descending.item_sk order by asceding.rnk;", "predicates": {"store_sales": ["ss_store_sk", "ss_customer_sk"]}, "payload": {"store_sales": ["ss_net_profit", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 45, "query_string": " select top (100) ca_zip, ca_state, sum(ws_sales_price)  from web_sales, customer, customer_address, date_dim, item  where ws_bill_customer_sk = c_customer_sk  \tand c_current_addr_sk = ca_address_sk   \tand ws_item_sk = i_item_sk   \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')  \t      or   \t      i_item_id in (select i_item_id                              from item                              where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)                              )  \t    )  \tand ws_sold_date_sk = d_date_sk  \tand d_qoy = 1 and d_year = 1998  group by ca_zip, ca_state  order by ca_zip, ca_state  ;", "predicates": {"customer_address": ["ca_zip"], "date_dim": ["d_qoy", "d_year"], "item": ["i_item_id"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip", "ca_city"], "date_dim": ["d_date_sk"], "web_sales": ["ws_sales_price", "ws_sold_date_sk", "ws_bill_customer_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 46, "query_string": " select top (100) c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,ca_city bought_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics,customer_address      where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and (household_demographics.hd_dep_count = 0 or          household_demographics.hd_vehicle_count= -1)     and date_dim.d_dow in (6,0)     and date_dim.d_year in (1999,1999+1,1999+2)      and store.s_city in ('Midway','Fairview','Midway','Fairview','Fairview')      group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr     where ss_customer_sk = c_customer_sk       and customer.c_current_addr_sk = current_addr.ca_address_sk       and current_addr.ca_city <> bought_city   order by c_last_name           ,c_first_name           ,ca_city           ,bought_city           ,ss_ticket_number   ;", "predicates": {"date_dim": ["d_dow", "d_year"], "household_demographics": ["hd_vehicle_count", "hd_dep_count"], "store": ["s_city"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk", "c_first_name", "c_last_name"], "customer_address": ["ca_city", "ca_address_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_addr_sk", "ss_coupon_amt", "ss_customer_sk", "ss_hdemo_sk", "ss_net_profit", "ss_sold_date_sk", "ss_store_sk", "ss_ticket_number"]}, "group_by": {}, "order_by": {}}
{"id": 47, "query_string": " with v1 as(  select i_category, i_brand,         s_store_name, s_company_name,         d_year, d_moy,         sum(ss_sales_price) sum_sales,         avg(sum(ss_sales_price)) over           (partition by i_category, i_brand,                      s_store_name, s_company_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      s_store_name, s_company_name            order by d_year, d_moy) rn  from item, store_sales, date_dim, store  where ss_item_sk = i_item_sk and        ss_sold_date_sk = d_date_sk and        ss_store_sk = s_store_sk and        (          d_year = 2000 or          ( d_year = 2000-1 and d_moy =12) or          ( d_year = 2000+1 and d_moy =1)        )  group by i_category, i_brand,           s_store_name, s_company_name,           d_year, d_moy),  v2 as(  select v1.s_company_name         ,v1.d_year, v1.d_moy         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1.s_store_name = v1_lag.s_store_name and        v1.s_store_name = v1_lead.s_store_name and        v1.s_company_name = v1_lag.s_company_name and        v1.s_company_name = v1_lead.s_company_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select top (100) *  from v2  where  d_year = 2000 and             avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, psum  ;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk", "d_moy", "d_year"], "item": ["i_brand", "i_item_sk", "i_category"], "store": ["s_store_name", "s_store_sk", "s_company_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 48, "query_string": " select sum (ss_quantity)  from store_sales, store, customer_demographics, customer_address, date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2002  and    (   (    cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'S'    and     cd_education_status = 'Unknown'    and     ss_sales_price between 100.00 and 150.00      )  or   (   cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'D'    and     cd_education_status = 'Primary'    and     ss_sales_price between 50.00 and 100.00      )  or   (   cd_demo_sk = ss_cdemo_sk   and     cd_marital_status = 'M'    and     cd_education_status = 'Advanced Degree'    and     ss_sales_price between 150.00 and 200.00    )  )  and  (   (   ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('SD', 'MN', 'AK')   and ss_net_profit between 0 and 2000     )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('IA', 'NM', 'TN')   and ss_net_profit between 150 and 3000    )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('IN', 'NE', 'NC')   and ss_net_profit between 50 and 25000    )  );", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "store_sales": ["ss_sales_price", "ss_net_profit"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_cdemo_sk", "ss_addr_sk", "ss_quantity", "ss_sales_price", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 49, "query_string": " select top (100) channel, item, return_ratio, return_rank, currency_rank from  (select  'web' as channel  ,web.item  ,web.return_ratio  ,web.return_rank  ,web.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect ws.ws_item_sk as item  \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\t web_sales ws left outer join web_returns wr   \t\t\ton (ws.ws_order_number = wr.wr_order_number and   \t\t\tws.ws_item_sk = wr.wr_item_sk)                  ,date_dim  \t\twhere   \t\t\twr.wr_return_amt > 10000   \t\t\tand ws.ws_net_profit > 1                          and ws.ws_net_paid > 0                          and ws.ws_quantity > 0                          and ws_sold_date_sk = d_date_sk                          and d_year = 2002                          and d_moy = 12  \t\tgroup by ws.ws_item_sk  \t) in_web  ) web  where   (  web.return_rank <= 10  or  web.currency_rank <= 10  )  union  select   'catalog' as channel  ,catalog.item  ,catalog.return_ratio  ,catalog.return_rank  ,catalog.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect   \t\tcs.cs_item_sk as item  \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\tcatalog_sales cs left outer join catalog_returns cr  \t\t\ton (cs.cs_order_number = cr.cr_order_number and   \t\t\tcs.cs_item_sk = cr.cr_item_sk)                 ,date_dim  \t\twhere   \t\t\tcr.cr_return_amount > 10000   \t\t\tand cs.cs_net_profit > 1                          and cs.cs_net_paid > 0                          and cs.cs_quantity > 0                          and cs_sold_date_sk = d_date_sk                          and d_year = 2002                          and d_moy = 12                  group by cs.cs_item_sk  \t) in_cat  ) catalog  where   (  catalog.return_rank <= 10  or  catalog.currency_rank <=10  )  union  select   'store' as channel  ,store.item  ,store.return_ratio  ,store.return_rank  ,store.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect sts.ss_item_sk as item  \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\tstore_sales sts left outer join store_returns sr  \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)                 ,date_dim  \t\twhere   \t\t\tsr.sr_return_amt > 10000   \t\t\tand sts.ss_net_profit > 1                          and sts.ss_net_paid > 0                           and sts.ss_quantity > 0                          and ss_sold_date_sk = d_date_sk                          and d_year = 2002                          and d_moy = 12  \t\tgroup by sts.ss_item_sk  \t) in_store  ) store  where  (  store.return_rank <= 10  or   store.currency_rank <= 10  )  ) a  order by 1,4,5,2  ;", "predicates": {"catalog_returns": ["cr_return_amount"], "catalog_sales": ["cs_net_paid", "cs_net_profit", "cs_quantity"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_return_amt"], "store_sales": ["ss_net_paid", "ss_quantity", "ss_net_profit"], "web_returns": ["wr_return_amt"], "web_sales": ["ws_net_profit", "ws_net_paid", "ws_quantity"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_quantity", "cr_return_amount"], "store_returns": ["sr_return_amt", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_return_amt", "wr_return_quantity", "wr_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 50, "query_string": " select top (100)     s_store_name   ,s_company_id   ,s_street_number   ,s_street_name   ,s_street_type   ,s_suite_number   ,s_city   ,s_county   ,s_state   ,s_zip   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and                   (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and                   (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and                  (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    store_sales   ,store_returns   ,store   ,date_dim d1   ,date_dim d2 where     d2.d_year = 2002 and d2.d_moy  = 8 and ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_sold_date_sk   = d1.d_date_sk and sr_returned_date_sk   = d2.d_date_sk and ss_customer_sk = sr_customer_sk and ss_store_sk = s_store_sk group by    s_store_name   ,s_company_id   ,s_street_number   ,s_street_name   ,s_street_type   ,s_suite_number   ,s_city   ,s_county   ,s_state   ,s_zip order by s_store_name         ,s_company_id         ,s_street_number         ,s_street_name         ,s_street_type         ,s_suite_number         ,s_city         ,s_county         ,s_state         ,s_zip;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 51, "query_string": " WITH web_v1 as ( select   ws_item_sk item_sk, d_date,   sum(sum(ws_sales_price))       over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from web_sales     ,date_dim where ws_sold_date_sk=d_date_sk   and d_month_seq between 1220 and 1220+11   and ws_item_sk is not NULL group by ws_item_sk, d_date), store_v1 as ( select   ss_item_sk item_sk, d_date,   sum(sum(ss_sales_price))       over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from store_sales     ,date_dim where ss_sold_date_sk=d_date_sk   and d_month_seq between 1220 and 1220+11   and ss_item_sk is not NULL group by ss_item_sk, d_date)  select top (100) * from (select item_sk      ,d_date      ,web_sales      ,store_sales      ,max(web_sales)          over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative      ,max(store_sales)          over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative      from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk                  ,case when web.d_date is not null then web.d_date else store.d_date end d_date                  ,web.cume_sales web_sales                  ,store.cume_sales store_sales            from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk                                                           and web.d_date = store.d_date)           )x )y where web_cumulative > store_cumulative order by item_sk         ,d_date;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_sales_price", "ss_item_sk"], "web_sales": ["ws_sold_date_sk", "ws_sales_price", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 52, "query_string": " select top (100) dt.d_year  \t,item.i_brand_id brand_id  \t,item.i_brand brand  \t,sum(ss_ext_sales_price) ext_price  from date_dim dt      ,store_sales      ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=11     and dt.d_year=1999  group by dt.d_year  \t,item.i_brand  \t,item.i_brand_id  order by dt.d_year  \t,ext_price desc  \t,brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"item": ["i_brand_id"]}}
{"id": 53, "query_string": " select top (100) * from  (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1220,1220+1,1220+2,1220+3,1220+4,1220+5,1220+6,1220+7,1220+8,1220+9,1220+10,1220+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', \t\t'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', \t\t'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0  \tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales  \telse null end > 0.1 order by avg_quarterly_sales, \t sum_sales, \t i_manufact_id;", "predicates": {"date_dim": ["d_month_seq"], "item": ["i_brand", "i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_qoy"], "item": ["i_item_sk", "i_manufact_id", "i_brand", "i_category", "i_class"], "store": ["s_store_sk"]}, "group_by": {}, "order_by": {}}
{"id": 54, "query_string": " with my_customers as (  select distinct c_customer_sk         , c_current_addr_sk  from            ( select cs_sold_date_sk sold_date_sk,                  cs_bill_customer_sk customer_sk,                  cs_item_sk item_sk           from   catalog_sales           union all           select ws_sold_date_sk sold_date_sk,                  ws_bill_customer_sk customer_sk,                  ws_item_sk item_sk           from   web_sales          ) cs_or_ws_sales,          item,          date_dim,          customer  where   sold_date_sk = d_date_sk          and item_sk = i_item_sk          and i_category = 'Books'          and i_class = 'romance'          and c_customer_sk = cs_or_ws_sales.customer_sk          and d_moy = 5          and d_year = 1998  )  , my_revenue as (  select c_customer_sk,         sum(ss_ext_sales_price) as revenue  from   my_customers,         store_sales,         customer_address,         store,         date_dim  where  c_current_addr_sk = ca_address_sk         and ca_county = s_county         and ca_state = s_state         and ss_sold_date_sk = d_date_sk         and c_customer_sk = ss_customer_sk         and d_month_seq between (select distinct d_month_seq+1                                  from   date_dim where d_year = 1998 and d_moy = 5)                            and  (select distinct d_month_seq+3                                  from   date_dim where d_year = 1998 and d_moy = 5)  group by c_customer_sk  )  , segments as  (select cast((revenue/50) as int) as segment   from   my_revenue  )   select top (100) segment, count(*) as num_customers, segment*50 as segment_base  from segments  group by segment  order by segment, num_customers  ;", "predicates": {"date_dim": ["d_month_seq", "d_moy", "d_year"], "item": ["i_class", "i_category"]}, "payload": {"customer_address": ["ca_address_sk", "ca_county", "ca_state"], "date_dim": ["d_date_sk", "d_month_seq"], "item": ["i_item_sk"], "store": ["s_state", "s_county"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_ext_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 55, "query_string": " select top (100) i_brand_id brand_id, i_brand brand,  \tsum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item  where d_date_sk = ss_sold_date_sk  \tand ss_item_sk = i_item_sk  \tand i_manager_id=29  \tand d_moy=11  \tand d_year=2001  group by i_brand, i_brand_id  order by ext_price desc, i_brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"item": ["i_brand_id"]}}
{"id": 56, "query_string": " with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('blue','chartreuse','light'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 5  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('blue','chartreuse','light'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 5  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('blue','chartreuse','light'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 5  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_item_id)   select top (100) i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  ;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_color"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 57, "query_string": " with v1 as(  select i_category, i_brand,         cc_name,         d_year, d_moy,         sum(cs_sales_price) sum_sales,         avg(sum(cs_sales_price)) over           (partition by i_category, i_brand,                      cc_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      cc_name            order by d_year, d_moy) rn  from item, catalog_sales, date_dim, call_center  where cs_item_sk = i_item_sk and        cs_sold_date_sk = d_date_sk and        cc_call_center_sk= cs_call_center_sk and        (          d_year = 2000 or          ( d_year = 2000-1 and d_moy =12) or          ( d_year = 2000+1 and d_moy =1)        )  group by i_category, i_brand,           cc_name , d_year, d_moy),  v2 as(  select v1.i_category         ,v1.d_year, v1.d_moy         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1. cc_name = v1_lag. cc_name and        v1. cc_name = v1_lead. cc_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select top (100) *  from v2  where  d_year = 2000 and         avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, psum  ;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"call_center": ["cc_name", "cc_call_center_sk"], "catalog_sales": ["cs_sales_price", "cs_sold_date_sk", "cs_call_center_sk", "cs_item_sk"], "date_dim": ["d_date_sk", "d_moy", "d_year"], "item": ["i_brand", "i_item_sk", "i_category"]}, "group_by": {}, "order_by": {}}
{"id": 58, "query_string": " with ss_items as  (select i_item_id item_id         ,sum(ss_ext_sales_price) ss_item_rev   from store_sales      ,item      ,date_dim  where ss_item_sk = i_item_sk    and d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '1999-06-05'))    and ss_sold_date_sk   = d_date_sk  group by i_item_id),  cs_items as  (select i_item_id item_id         ,sum(cs_ext_sales_price) cs_item_rev   from catalog_sales       ,item       ,date_dim  where cs_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '1999-06-05'))   and  cs_sold_date_sk = d_date_sk  group by i_item_id),  ws_items as  (select i_item_id item_id         ,sum(ws_ext_sales_price) ws_item_rev   from web_sales       ,item       ,date_dim  where ws_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq =(select d_week_seq                                       from date_dim                                      where d_date = '1999-06-05'))   and ws_sold_date_sk   = d_date_sk  group by i_item_id)   select top (100) ss_items.item_id        ,ss_item_rev        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev        ,cs_item_rev        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev        ,ws_item_rev        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average  from ss_items,cs_items,ws_items  where ss_items.item_id=cs_items.item_id    and ss_items.item_id=ws_items.item_id     and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  order by item_id          ,ss_item_rev  ;", "predicates": {"date_dim": ["d_week_seq", "d_date"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_item_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "item": ["i_item_id", "i_item_sk"], "store_sales": ["ss_sold_date_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 59, "query_string": " with wss as   (select d_week_seq,         ss_store_sk,         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales  from store_sales,date_dim  where d_date_sk = ss_sold_date_sk  group by d_week_seq,ss_store_sk  )   select top (100) s_store_name1,s_store_id1,d_week_seq1        ,sun_sales1/sun_sales2,mon_sales1/mon_sales2        ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2        ,fri_sales1/fri_sales2,sat_sales1/sat_sales2  from  (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1         ,s_store_id s_store_id1,sun_sales sun_sales1         ,mon_sales mon_sales1,tue_sales tue_sales1         ,wed_sales wed_sales1,thu_sales thu_sales1         ,fri_sales fri_sales1,sat_sales sat_sales1   from wss,store,date_dim d   where d.d_week_seq = wss.d_week_seq and         ss_store_sk = s_store_sk and          d_month_seq between 1212 and 1212 + 11) y,  (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2         ,s_store_id s_store_id2,sun_sales sun_sales2         ,mon_sales mon_sales2,tue_sales tue_sales2         ,wed_sales wed_sales2,thu_sales thu_sales2         ,fri_sales fri_sales2,sat_sales sat_sales2   from wss,store,date_dim d   where d.d_week_seq = wss.d_week_seq and         ss_store_sk = s_store_sk and          d_month_seq between 1212+ 12 and 1212 + 23) x  where s_store_id1=s_store_id2    and d_week_seq1=d_week_seq2-52  order by s_store_name1,s_store_id1,d_week_seq1;", "predicates": {"date_dim": ["d_month_seq"], "store": ["s_store_id"]}, "payload": {"date_dim": ["d_date_sk", "d_week_seq", "d_day_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 60, "query_string": " with ss as (  select           i_item_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where          i_item_id in (select   i_item_id from  item where i_category in ('Jewelry'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 9  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  cs as (  select           i_item_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Jewelry'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 9  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  ws as (  select           i_item_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Jewelry'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 9  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_item_id)   select top (100)     i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by i_item_id       ,total_sales  ;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_item_id", "i_category"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 61, "query_string": " select top (100) promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from   (select sum(ss_ext_sales_price) promotions    from  store_sales         ,store         ,promotion         ,date_dim         ,customer         ,customer_address          ,item    where ss_sold_date_sk = d_date_sk    and   ss_store_sk = s_store_sk    and   ss_promo_sk = p_promo_sk    and   ss_customer_sk= c_customer_sk    and   ca_address_sk = c_current_addr_sk    and   ss_item_sk = i_item_sk     and   ca_gmt_offset = -7    and   i_category = 'Jewelry'    and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')    and   s_gmt_offset = -7    and   d_year = 1998    and   d_moy  = 12) promotional_sales,   (select sum(ss_ext_sales_price) total    from  store_sales         ,store         ,date_dim         ,customer         ,customer_address         ,item    where ss_sold_date_sk = d_date_sk    and   ss_store_sk = s_store_sk    and   ss_customer_sk= c_customer_sk    and   ca_address_sk = c_current_addr_sk    and   ss_item_sk = i_item_sk    and   ca_gmt_offset = -7    and   i_category = 'Jewelry'    and   s_gmt_offset = -7    and   d_year = 1998    and   d_moy  = 12) all_sales order by promotions, total;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_category"], "promotion": ["p_channel_dmail", "p_channel_email", "p_channel_tv"], "store": ["s_gmt_offset"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_promo_sk", "ss_item_sk", "ss_ext_sales_price", "ss_customer_sk", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 62, "query_string": " select top (100)     substring(w_warehouse_name,1,20)   ,sm_type   ,web_name   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and                   (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and                   (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and                  (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    web_sales   ,warehouse   ,ship_mode   ,web_site   ,date_dim where     d_month_seq between 1220 and 1220 + 11 and ws_ship_date_sk   = d_date_sk and ws_warehouse_sk   = w_warehouse_sk and ws_ship_mode_sk   = sm_ship_mode_sk and ws_web_site_sk    = web_site_sk group by    substring(w_warehouse_name,1,20)   ,sm_type   ,web_name order by substring(w_warehouse_name,1,20)         ,sm_type        ,web_name;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "ship_mode": ["sm_type", "sm_ship_mode_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"], "web_sales": ["ws_ship_date_sk", "ws_ship_mode_sk", "ws_sold_date_sk", "ws_warehouse_sk", "ws_web_site_sk"], "web_site": ["web_name", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 63, "query_string": " select top (100) *  from (select i_manager_id              ,sum(ss_sales_price) sum_sales              ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales       from item           ,store_sales           ,date_dim           ,store       where ss_item_sk = i_item_sk         and ss_sold_date_sk = d_date_sk         and ss_store_sk = s_store_sk         and d_month_seq in (1220,1220+1,1220+2,1220+3,1220+4,1220+5,1220+6,1220+7,1220+8,1220+9,1220+10,1220+11)         and ((    i_category in ('Books','Children','Electronics')               and i_class in ('personal','portable','reference','self-help')               and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', \t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))            or(    i_category in ('Women','Music','Men')               and i_class in ('accessories','classical','fragrances','pants')               and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', \t\t                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id         ,avg_monthly_sales         ,sum_sales;", "predicates": {"date_dim": ["d_month_seq"], "item": ["i_brand", "i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_item_sk", "i_manager_id", "i_brand", "i_category", "i_class"], "store": ["s_store_sk"]}, "group_by": {}, "order_by": {"item": ["i_manager_id"]}}
{"id": 64, "query_string": " with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('linen','beige','honeydew','chocolate','frosted','drab') and          i_current_price between 85 and 85 + 10 and          i_current_price between 85 + 1 and 85 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;", "predicates": {"customer_demographics": ["cd_marital_status"], "date_dim": ["d_year"], "item": ["i_color", "i_current_price"], "store": ["s_zip", "s_store_name"]}, "payload": {"household_demographics": ["hd_income_band_sk", "hd_demo_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 65, "query_string": " select top (100) \ts_store_name, \ti_item_desc, \tsc.revenue, \ti_current_price, \ti_wholesale_cost, \ti_brand  from store, item,      (select ss_store_sk, avg(revenue) as ave  \tfrom  \t    (select  ss_store_sk, ss_item_sk,   \t\t     sum(ss_sales_price) as revenue  \t\tfrom store_sales, date_dim  \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1220 and 1220+11  \t\tgroup by ss_store_sk, ss_item_sk) sa  \tgroup by ss_store_sk) sb,      (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue  \tfrom store_sales, date_dim  \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1220 and 1220+11  \tgroup by ss_store_sk, ss_item_sk) sc  where sb.ss_store_sk = sc.ss_store_sk and         sc.revenue <= 0.1 * sb.ave and        s_store_sk = sc.ss_store_sk and        i_item_sk = sc.ss_item_sk  order by s_store_name, i_item_desc;", "predicates": {"date_dim": ["d_month_seq"], "store_sales": ["ss_store_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_brand", "i_wholesale_cost", "i_item_desc"], "store": ["s_store_name", "s_store_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price", "ss_item_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_desc"], "store": ["s_store_name"]}}
{"id": 66, "query_string": " select top (100)            w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country         ,ship_carriers         ,year  \t,sum(jan_sales) as jan_sales  \t,sum(feb_sales) as feb_sales  \t,sum(mar_sales) as mar_sales  \t,sum(apr_sales) as apr_sales  \t,sum(may_sales) as may_sales  \t,sum(jun_sales) as jun_sales  \t,sum(jul_sales) as jul_sales  \t,sum(aug_sales) as aug_sales  \t,sum(sep_sales) as sep_sales  \t,sum(oct_sales) as oct_sales  \t,sum(nov_sales) as nov_sales  \t,sum(dec_sales) as dec_sales  \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot  \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot  \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot  \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot  \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot  \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot  \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot  \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot  \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot  \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot  \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot  \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot  \t,sum(jan_net) as jan_net  \t,sum(feb_net) as feb_net  \t,sum(mar_net) as mar_net  \t,sum(apr_net) as apr_net  \t,sum(may_net) as may_net  \t,sum(jun_net) as jun_net  \t,sum(jul_net) as jul_net  \t,sum(aug_net) as aug_net  \t,sum(sep_net) as sep_net  \t,sum(oct_net) as oct_net  \t,sum(nov_net) as nov_net  \t,sum(dec_net) as dec_net  from (      select   \tw_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,concat('RUPEKSA' , ',' , 'TBS') as ship_carriers        ,d_year as year  \t,sum(case when d_moy = 1   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as jan_sales  \t,sum(case when d_moy = 2   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as feb_sales  \t,sum(case when d_moy = 3   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as mar_sales  \t,sum(case when d_moy = 4   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as apr_sales  \t,sum(case when d_moy = 5   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as may_sales  \t,sum(case when d_moy = 6   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as jun_sales  \t,sum(case when d_moy = 7   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as jul_sales  \t,sum(case when d_moy = 8   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as aug_sales  \t,sum(case when d_moy = 9   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as sep_sales  \t,sum(case when d_moy = 10   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as oct_sales  \t,sum(case when d_moy = 11  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as nov_sales  \t,sum(case when d_moy = 12  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as dec_sales  \t,sum(case when d_moy = 1   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net  \t,sum(case when d_moy = 2  \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net  \t,sum(case when d_moy = 3   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net  \t,sum(case when d_moy = 4   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net  \t,sum(case when d_moy = 5   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net  \t,sum(case when d_moy = 6   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net  \t,sum(case when d_moy = 7   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net  \t,sum(case when d_moy = 8   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net  \t,sum(case when d_moy = 9   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net  \t,sum(case when d_moy = 10   \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net  \t,sum(case when d_moy = 11  \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net  \t,sum(case when d_moy = 12  \t\tthen ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net      from           web_sales          ,warehouse          ,date_dim          ,time_dim  \t  ,ship_mode      where             ws_warehouse_sk =  w_warehouse_sk         and ws_sold_date_sk = d_date_sk         and ws_sold_time_sk = t_time_sk  \tand ws_ship_mode_sk = sm_ship_mode_sk         and d_year = 1999  \tand t_time between 4683 and 4683+28800   \tand sm_carrier in ('RUPEKSA','TBS')      group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country        ,d_year  union all      select   \tw_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,concat('RUPEKSA', ',', 'TBS') as ship_carriers        ,d_year as year  \t,sum(case when d_moy = 1   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jan_sales  \t,sum(case when d_moy = 2   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as feb_sales  \t,sum(case when d_moy = 3   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as mar_sales  \t,sum(case when d_moy = 4   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as apr_sales  \t,sum(case when d_moy = 5   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as may_sales  \t,sum(case when d_moy = 6   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jun_sales  \t,sum(case when d_moy = 7   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jul_sales  \t,sum(case when d_moy = 8   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as aug_sales  \t,sum(case when d_moy = 9   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as sep_sales  \t,sum(case when d_moy = 10   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as oct_sales  \t,sum(case when d_moy = 11  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as nov_sales  \t,sum(case when d_moy = 12  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as dec_sales  \t,sum(case when d_moy = 1   \t\tthen cs_net_paid * cs_quantity else 0 end) as jan_net  \t,sum(case when d_moy = 2   \t\tthen cs_net_paid * cs_quantity else 0 end) as feb_net  \t,sum(case when d_moy = 3   \t\tthen cs_net_paid * cs_quantity else 0 end) as mar_net  \t,sum(case when d_moy = 4   \t\tthen cs_net_paid * cs_quantity else 0 end) as apr_net  \t,sum(case when d_moy = 5   \t\tthen cs_net_paid * cs_quantity else 0 end) as may_net  \t,sum(case when d_moy = 6   \t\tthen cs_net_paid * cs_quantity else 0 end) as jun_net  \t,sum(case when d_moy = 7   \t\tthen cs_net_paid * cs_quantity else 0 end) as jul_net  \t,sum(case when d_moy = 8   \t\tthen cs_net_paid * cs_quantity else 0 end) as aug_net  \t,sum(case when d_moy = 9   \t\tthen cs_net_paid * cs_quantity else 0 end) as sep_net  \t,sum(case when d_moy = 10   \t\tthen cs_net_paid * cs_quantity else 0 end) as oct_net  \t,sum(case when d_moy = 11  \t\tthen cs_net_paid * cs_quantity else 0 end) as nov_net  \t,sum(case when d_moy = 12  \t\tthen cs_net_paid * cs_quantity else 0 end) as dec_net      from           catalog_sales          ,warehouse          ,date_dim          ,time_dim  \t ,ship_mode      where             cs_warehouse_sk =  w_warehouse_sk         and cs_sold_date_sk = d_date_sk         and cs_sold_time_sk = t_time_sk  \tand cs_ship_mode_sk = sm_ship_mode_sk         and d_year = 1999  \tand t_time between 4683 AND 4683+28800   \tand sm_carrier in ('RUPEKSA','TBS')      group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country        ,d_year  ) x  group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,ship_carriers        ,year  order by w_warehouse_name  ;", "predicates": {"date_dim": ["d_year"], "ship_mode": ["sm_carrier"], "time_dim": ["t_time"]}, "payload": {"catalog_sales": ["cs_warehouse_sk", "cs_ext_list_price", "cs_quantity", "cs_net_paid_inc_tax", "cs_ship_mode_sk", "cs_sold_date_sk", "cs_sold_time_sk"], "date_dim": ["d_date_sk", "d_moy", "d_year"], "ship_mode": ["sm_ship_mode_sk"], "time_dim": ["t_time_sk"], "web_sales": ["ws_ship_mode_sk", "ws_ext_list_price", "ws_sold_date_sk", "ws_quantity", "ws_sold_time_sk", "ws_warehouse_sk", "ws_net_paid"]}, "group_by": {}, "order_by": {}}
{"id": 67, "query_string": " select top (100) * from (select i_category             ,i_class             ,i_brand             ,i_product_name             ,d_year             ,d_qoy             ,d_moy             ,s_store_id             ,sumsales             ,rank() over (partition by i_category order by sumsales desc) rk       from (select i_category                   ,i_class                   ,i_brand                   ,i_product_name                   ,d_year                   ,d_qoy                   ,d_moy                   ,s_store_id                   ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales             from store_sales                 ,date_dim                 ,store                 ,item        where  ss_sold_date_sk=d_date_sk           and ss_item_sk=i_item_sk           and ss_store_sk = s_store_sk           and d_month_seq between 1220 and 1220+11        group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 order by i_category         ,i_class         ,i_brand         ,i_product_name         ,d_year         ,d_qoy         ,d_moy         ,s_store_id         ,sumsales         ,rk;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk", "d_moy", "d_qoy", "d_year"], "item": ["i_item_sk", "i_brand", "i_product_name", "i_category", "i_class"], "store": ["s_store_sk", "s_store_id"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_sales_price", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {"date_dim": ["d_moy", "d_qoy", "d_year"], "item": ["i_brand", "i_class", "i_product_name", "i_category"], "store": ["s_store_id"]}}
{"id": 68, "query_string": " select top (100) c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,extended_price        ,extended_tax        ,list_price  from (select ss_ticket_number              ,ss_customer_sk              ,ca_city bought_city              ,sum(ss_ext_sales_price) extended_price               ,sum(ss_ext_list_price) list_price              ,sum(ss_ext_tax) extended_tax         from store_sales            ,date_dim            ,store            ,household_demographics            ,customer_address         where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_store_sk = store.s_store_sk           and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk         and store_sales.ss_addr_sk = customer_address.ca_address_sk         and date_dim.d_dom between 1 and 2          and (household_demographics.hd_dep_count = 2 or              household_demographics.hd_vehicle_count= 3)         and date_dim.d_year in (1999,1999+1,1999+2)         and store.s_city in ('Fairview','Midway')        group by ss_ticket_number                ,ss_customer_sk                ,ss_addr_sk,ca_city) dn       ,customer       ,customer_address current_addr  where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name          ,ss_ticket_number  ;", "predicates": {"customer_address": ["ca_city"], "date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_city"]}, "payload": {"customer": ["c_current_addr_sk", "c_first_name", "c_last_name", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_city"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_ext_sales_price", "ss_addr_sk", "ss_customer_sk", "ss_ticket_number", "ss_ext_list_price", "ss_ext_tax", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 69, "query_string": " select top (100)    cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_state in ('ND','AR','KS') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2004 and                 d_moy between 4 and 4+2) and    (not exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2004 and                   d_moy between 4 and 4+2) and     not exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2004 and                   d_moy between 4 and 4+2))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  ;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 70, "query_string": " select top (100)      sum(ss_net_profit) as total_sum    ,s_state    ,s_county    ,grouping(s_state)+grouping(s_county) as lochierarchy    ,rank() over (  \tpartition by grouping(s_state)+grouping(s_county),  \tcase when grouping(s_county) = 0 then s_state end   \torder by sum(ss_net_profit) desc) as rank_within_parent  from     store_sales    ,date_dim       d1    ,store  where     d1.d_month_seq between 1220 and 1220+11  and d1.d_date_sk = ss_sold_date_sk  and s_store_sk  = ss_store_sk  and s_state in              ( select s_state                from  (select s_state as s_state,  \t\t\t    rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking                       from   store_sales, store, date_dim                       where  d_month_seq between 1220 and 1220+11  \t\t\t    and d_date_sk = ss_sold_date_sk  \t\t\t    and s_store_sk  = ss_store_sk                       group by s_state                      ) tmp1                 where ranking <= 5              )  group by rollup(s_state,s_county)  order by    lochierarchy desc   ,case when (grouping(s_state)+grouping(s_county)) = 0 then s_state end   ,rank_within_parent  ;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 71, "query_string": " select i_brand_id brand_id, i_brand brand,t_hour,t_minute,  \tsum(ext_price) ext_price  from item, (select ws_ext_sales_price as ext_price,                          ws_sold_date_sk as sold_date_sk,                         ws_item_sk as sold_item_sk,                         ws_sold_time_sk as time_sk                    from web_sales,date_dim                  where d_date_sk = ws_sold_date_sk                    and d_moy=12                    and d_year=2002                  union all                  select cs_ext_sales_price as ext_price,                         cs_sold_date_sk as sold_date_sk,                         cs_item_sk as sold_item_sk,                         cs_sold_time_sk as time_sk                  from catalog_sales,date_dim                  where d_date_sk = cs_sold_date_sk                    and d_moy=12                    and d_year=2002                  union all                  select ss_ext_sales_price as ext_price,                         ss_sold_date_sk as sold_date_sk,                         ss_item_sk as sold_item_sk,                         ss_sold_time_sk as time_sk                  from store_sales,date_dim                  where d_date_sk = ss_sold_date_sk                    and d_moy=12                    and d_year=2002                  ) tmp,time_dim  where    sold_item_sk = i_item_sk    and i_manager_id=1    and time_sk = t_time_sk    and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')  group by i_brand, i_brand_id,t_hour,t_minute  order by ext_price desc, i_brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"], "time_dim": ["t_meal_time"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_brand", "i_item_sk", "i_brand_id"], "time_dim": ["t_hour", "t_minute", "t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 72, "query_string": " select top (100) i_item_desc       ,w_warehouse_name       ,d1.d_week_seq       ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo       ,sum(case when p_promo_sk is not null then 1 else 0 end) promo       ,count(*) total_cnt from catalog_sales join inventory on (cs_item_sk = inv_item_sk) join warehouse on (w_warehouse_sk=inv_warehouse_sk) join item on (i_item_sk = cs_item_sk) join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk) join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk) join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk) join date_dim d2 on (inv_date_sk = d2.d_date_sk) join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk) left outer join promotion on (cs_promo_sk=p_promo_sk) left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number) where d1.d_week_seq = d2.d_week_seq   and inv_quantity_on_hand < cs_quantity    and d3.d_date > dateadd(day, 5, d1.d_date)   and hd_buy_potential = '>10000'   and d1.d_year = 2001   and cd_marital_status = 'W' group by i_item_desc,w_warehouse_name,d1.d_week_seq order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq;", "predicates": {"customer_demographics": ["cd_marital_status"], "date_dim": ["d_date", "d_year"], "household_demographics": ["hd_buy_potential"], "inventory": ["inv_warehouse_sk"], "warehouse": ["w_warehouse_sk"]}, "payload": {"catalog_sales": ["cs_quantity", "cs_promo_sk", "cs_item_sk", "cs_ship_date_sk", "cs_bill_cdemo_sk", "cs_sold_date_sk", "cs_bill_hdemo_sk"], "customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "household_demographics": ["hd_demo_sk"], "item": ["i_item_sk", "i_item_desc"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {"date_dim": ["d_week_seq"], "item": ["i_item_desc"], "warehouse": ["w_warehouse_name"]}}
{"id": 73, "query_string": " select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = 'Unknown')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;", "predicates": {"date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count", "hd_buy_potential"], "store": ["s_county"]}, "payload": {"customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_preferred_cust_flag"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 74, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,d_year as year        ,min(ss_net_paid) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk    and d_year in (1998,1998+1)  group by c_customer_id          ,c_first_name          ,c_last_name          ,d_year  union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,d_year as year        ,min(ws_net_paid) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk    and d_year in (1998,1998+1)  group by c_customer_id          ,c_first_name          ,c_last_name          ,d_year          )   select top (100)         t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id          and t_s_firstyear.customer_id = t_w_secyear.customer_id          and t_s_firstyear.customer_id = t_w_firstyear.customer_id          and t_s_firstyear.sale_type = 's'          and t_w_firstyear.sale_type = 'w'          and t_s_secyear.sale_type = 's'          and t_w_secyear.sale_type = 'w'          and t_s_firstyear.year = 1998          and t_s_secyear.year = 1998+1          and t_w_firstyear.year = 1998          and t_w_secyear.year = 1998+1          and t_s_firstyear.year_total > 0          and t_w_firstyear.year_total > 0          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end  order by 1,3,2;", "predicates": {"date_dim": ["d_year"]}, "payload": {"customer": ["c_customer_id", "c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_net_paid"], "web_sales": ["ws_net_paid", "ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_customer_id", "c_last_name", "c_first_name"]}}
{"id": 75, "query_string": " WITH all_sales AS (  SELECT d_year        ,i_brand_id        ,i_class_id        ,i_category_id        ,i_manufact_id        ,SUM(sales_cnt) AS sales_cnt        ,SUM(sales_amt) AS sales_amt  FROM (SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt              ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt        FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk                           JOIN date_dim ON d_date_sk=cs_sold_date_sk                           LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number                                                      AND cs_item_sk=cr_item_sk)        WHERE i_category='Music'        UNION        SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt              ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt        FROM store_sales JOIN item ON i_item_sk=ss_item_sk                         JOIN date_dim ON d_date_sk=ss_sold_date_sk                         LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number                                                  AND ss_item_sk=sr_item_sk)        WHERE i_category='Music'        UNION        SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt              ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt        FROM web_sales JOIN item ON i_item_sk=ws_item_sk                       JOIN date_dim ON d_date_sk=ws_sold_date_sk                       LEFT JOIN web_returns ON (ws_order_number=wr_order_number                                              AND ws_item_sk=wr_item_sk)        WHERE i_category='Music') sales_detail  GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)  SELECT top (100) prev_yr.d_year AS prev_year                           ,curr_yr.d_year AS year                           ,curr_yr.i_brand_id                           ,curr_yr.i_class_id                           ,curr_yr.i_category_id                           ,curr_yr.i_manufact_id                           ,prev_yr.sales_cnt AS prev_yr_cnt                           ,curr_yr.sales_cnt AS curr_yr_cnt                           ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff                           ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff  FROM all_sales curr_yr, all_sales prev_yr  WHERE curr_yr.i_brand_id=prev_yr.i_brand_id    AND curr_yr.i_class_id=prev_yr.i_class_id    AND curr_yr.i_category_id=prev_yr.i_category_id    AND curr_yr.i_manufact_id=prev_yr.i_manufact_id    AND curr_yr.d_year=2002    AND prev_yr.d_year=2002-1    AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9  ORDER BY sales_cnt_diff,sales_amt_diff  ;", "predicates": {"date_dim": ["d_year"], "item": ["i_category"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_quantity", "cr_return_amount"], "date_dim": ["d_date_sk", "d_year"], "item": ["i_class_id", "i_item_sk", "i_category_id", "i_brand_id", "i_manufact_id"], "store_returns": ["sr_return_amt", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_return_amt", "wr_return_quantity", "wr_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 76, "query_string": " select top (100) channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (         SELECT 'store' as channel, 'ss_store_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price          FROM store_sales, item, date_dim          WHERE ss_store_sk IS NULL            AND ss_sold_date_sk=d_date_sk            AND ss_item_sk=i_item_sk         UNION ALL         SELECT 'web' as channel, 'ws_ship_cdemo_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price          FROM web_sales, item, date_dim          WHERE ws_ship_cdemo_sk IS NULL            AND ws_sold_date_sk=d_date_sk            AND ws_item_sk=i_item_sk         UNION ALL         SELECT 'catalog' as channel, 'cs_ship_customer_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price          FROM catalog_sales, item, date_dim          WHERE cs_ship_customer_sk IS NULL            AND cs_sold_date_sk=d_date_sk            AND cs_item_sk=i_item_sk) foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category;", "predicates": {"catalog_sales": ["cs_ship_addr_sk"], "store_sales": ["ss_promo_sk"], "web_sales": ["ws_promo_sk"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_item_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_qoy", "d_year"], "item": ["i_item_sk", "i_category"], "store_sales": ["ss_sold_date_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 77, "query_string": " with ss as  (select s_store_sk,          sum(ss_ext_sales_price) as sales,          sum(ss_net_profit) as profit  from store_sales,       date_dim,       store  where ss_sold_date_sk = d_date_sk        and d_date between cast('1999-08-09' as date)                    and dateadd(day, 30, cast('1999-08-09' as date))         and ss_store_sk = s_store_sk  group by s_store_sk)  ,  sr as  (select s_store_sk,          sum(sr_return_amt) as returns,          sum(sr_net_loss) as profit_loss  from store_returns,       date_dim,       store  where sr_returned_date_sk = d_date_sk        and d_date between cast('1999-08-09' as date)                   and dateadd(day, 30, cast('1999-08-09' as date))        and sr_store_sk = s_store_sk  group by s_store_sk),   cs as  (select cs_call_center_sk,         sum(cs_ext_sales_price) as sales,         sum(cs_net_profit) as profit  from catalog_sales,       date_dim  where cs_sold_date_sk = d_date_sk        and d_date between cast('1999-08-09' as date)                   and dateadd(day, 30, cast('1999-08-09' as date))  group by cs_call_center_sk   ),   cr as  (select cr_call_center_sk,          sum(cr_return_amount) as returns,          sum(cr_net_loss) as profit_loss  from catalog_returns,       date_dim  where cr_returned_date_sk = d_date_sk        and d_date between cast('1999-08-09' as date)                   and dateadd(day, 30, cast('1999-08-09' as date))  group by cr_call_center_sk  ),   ws as  ( select wp_web_page_sk,         sum(ws_ext_sales_price) as sales,         sum(ws_net_profit) as profit  from web_sales,       date_dim,       web_page  where ws_sold_date_sk = d_date_sk        and d_date between cast('1999-08-09' as date)                   and dateadd(day, 30, cast('1999-08-09' as date))        and ws_web_page_sk = wp_web_page_sk  group by wp_web_page_sk),   wr as  (select wp_web_page_sk,         sum(wr_return_amt) as returns,         sum(wr_net_loss) as profit_loss  from web_returns,       date_dim,       web_page  where wr_returned_date_sk = d_date_sk        and d_date between cast('1999-08-09' as date)                   and dateadd(day, 30, cast('1999-08-09' as date))        and wr_web_page_sk = wp_web_page_sk  group by wp_web_page_sk)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , ss.s_store_sk as id         , sales         , coalesce(returns, 0) as returns         , (profit - coalesce(profit_loss,0)) as profit  from   ss left join sr         on  ss.s_store_sk = sr.s_store_sk  union all  select 'catalog channel' as channel         , cs_call_center_sk as id         , sales         , returns         , (profit - profit_loss) as profit  from  cs        , cr  union all  select 'web channel' as channel         , ws.wp_web_page_sk as id         , sales         , coalesce(returns, 0) returns         , (profit - coalesce(profit_loss,0)) as profit  from   ws left join wr         on  ws.wp_web_page_sk = wr.wp_web_page_sk  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_return_amount", "cr_call_center_sk"], "catalog_sales": ["cs_net_profit", "cs_sold_date_sk", "cs_call_center_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_net_loss"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit", "ss_ext_sales_price"], "web_page": ["wp_web_page_sk"], "web_returns": ["wr_web_page_sk", "wr_returned_date_sk", "wr_return_amt", "wr_net_loss"], "web_sales": ["ws_net_profit", "ws_ext_sales_price", "ws_web_page_sk", "ws_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 78, "query_string": " with ws as   (select d_year AS ws_sold_year, ws_item_sk,     ws_bill_customer_sk ws_customer_sk,     sum(ws_quantity) ws_qty,     sum(ws_wholesale_cost) ws_wc,     sum(ws_sales_price) ws_sp    from web_sales    left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk    join date_dim on ws_sold_date_sk = d_date_sk    where wr_order_number is null    group by d_year, ws_item_sk, ws_bill_customer_sk    ), cs as   (select d_year AS cs_sold_year, cs_item_sk,     cs_bill_customer_sk cs_customer_sk,     sum(cs_quantity) cs_qty,     sum(cs_wholesale_cost) cs_wc,     sum(cs_sales_price) cs_sp    from catalog_sales    left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk    join date_dim on cs_sold_date_sk = d_date_sk    where cr_order_number is null    group by d_year, cs_item_sk, cs_bill_customer_sk    ), ss as   (select d_year AS ss_sold_year, ss_item_sk,     ss_customer_sk,     sum(ss_quantity) ss_qty,     sum(ss_wholesale_cost) ss_wc,     sum(ss_sales_price) ss_sp    from store_sales    left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk    join date_dim on ss_sold_date_sk = d_date_sk    where sr_ticket_number is null    group by d_year, ss_item_sk, ss_customer_sk    )  select top (100) ss_sold_year, ss_item_sk, ss_customer_sk, round(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk) where (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2002 order by    ss_sold_year, ss_item_sk, ss_customer_sk,   ss_qty desc, ss_wc desc, ss_sp desc,   other_chan_qty,   other_chan_wholesale_cost,   other_chan_sales_price,   ratio;", "predicates": {"catalog_returns": ["cr_order_number"], "catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_year"], "store_returns": ["sr_ticket_number"], "store_sales": ["ss_customer_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_bill_customer_sk"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "store_returns": ["sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_item_sk", "ss_sales_price", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_wholesale_cost", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 79, "query_string": " select top (100)   c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,store.s_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (household_demographics.hd_dep_count = 3 or household_demographics.hd_vehicle_count > 3)     and date_dim.d_dow = 1     and date_dim.d_year in (1999,1999+1,1999+2)      and store.s_number_employees between 200 and 295     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer     where ss_customer_sk = c_customer_sk  order by c_last_name,c_first_name,substring(s_city,1,30), profit;", "predicates": {"date_dim": ["d_dow", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_number_employees"]}, "payload": {"customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_city", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_addr_sk", "ss_customer_sk", "ss_ticket_number", "ss_coupon_amt", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {"customer": ["c_last_name", "c_first_name"]}}
{"id": 80, "query_string": " with ssr as  (select  s_store_id as store_id,           sum(ss_ext_sales_price) as sales,           sum(coalesce(sr_return_amt, 0)) as returns,           sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit   from store_sales left outer join store_returns on          (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),      date_dim,      store,      item,      promotion  where ss_sold_date_sk = d_date_sk        and d_date between cast('1999-08-09' as date)                    and dateadd(day, 30, cast('1999-08-09' as date))        and ss_store_sk = s_store_sk        and ss_item_sk = i_item_sk        and i_current_price > 50        and ss_promo_sk = p_promo_sk        and p_channel_tv = 'N'  group by s_store_id)  ,  csr as  (select  cp_catalog_page_id as catalog_page_id,           sum(cs_ext_sales_price) as sales,           sum(coalesce(cr_return_amount, 0)) as returns,           sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit   from catalog_sales left outer join catalog_returns on          (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),      date_dim,      catalog_page,      item,      promotion  where cs_sold_date_sk = d_date_sk        and d_date between cast('1999-08-09' as date)                   and dateadd(day, 30, cast('1999-08-09' as date))         and cs_catalog_page_sk = cp_catalog_page_sk        and cs_item_sk = i_item_sk        and i_current_price > 50        and cs_promo_sk = p_promo_sk        and p_channel_tv = 'N' group by cp_catalog_page_id)  ,  wsr as  (select  web_site_id,           sum(ws_ext_sales_price) as sales,           sum(coalesce(wr_return_amt, 0)) as returns,           sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit   from web_sales left outer join web_returns on          (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),      date_dim,      web_site,      item,      promotion  where ws_sold_date_sk = d_date_sk        and d_date between cast('1999-08-09' as date)                   and dateadd(day, 30, cast('1999-08-09' as date))         and ws_web_site_sk = web_site_sk        and ws_item_sk = i_item_sk        and i_current_price > 50        and ws_promo_sk = p_promo_sk        and p_channel_tv = 'N' group by web_site_id)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , concat('store' , store_id) as id         , sales         , returns         , profit  from   ssr  union all  select 'catalog channel' as channel         , concat('catalog_page' , catalog_page_id) as id         , sales         , returns         , profit  from  csr  union all  select 'web channel' as channel         , concat('web_site' , web_site_id) as id         , sales         , returns         , profit  from   wsr  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"], "promotion": ["p_channel_tv"]}, "payload": {"catalog_page": ["cp_catalog_page_sk", "cp_catalog_page_id"], "catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_amount", "cr_net_loss"], "date_dim": ["d_date_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"], "store": ["s_store_sk", "s_store_id"], "store_returns": ["sr_return_amt", "sr_net_loss", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_net_loss", "wr_return_amt", "wr_order_number"], "web_site": ["web_site_id", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 81, "query_string": " with customer_total_return as  (select cr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   \tsum(cr_return_amt_inc_tax) as ctr_total_return  from catalog_returns      ,date_dim      ,customer_address  where cr_returned_date_sk = d_date_sk     and d_year =1999    and cr_returning_addr_sk = ca_address_sk   group by cr_returning_customer_sk          ,ca_state )   select top (100) c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  \t\t\t  from customer_total_return ctr2                    \t  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'VA'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  ;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_year"]}, "payload": {"catalog_returns": ["cr_returned_date_sk", "cr_returning_customer_sk", "cr_return_amt_inc_tax", "cr_returning_addr_sk"], "customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_current_addr_sk", "c_customer_id"], "customer_address": ["ca_street_type", "ca_county", "ca_street_name", "ca_zip", "ca_street_number", "ca_city", "ca_state", "ca_gmt_offset", "ca_location_type", "ca_address_sk", "ca_suite_number", "ca_country"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer": ["c_salutation", "c_customer_id", "c_last_name", "c_first_name"], "customer_address": ["ca_street_type", "ca_county", "ca_street_name", "ca_zip", "ca_street_number", "ca_city", "ca_gmt_offset", "ca_location_type", "ca_suite_number", "ca_country"]}}
{"id": 82, "query_string": " select top (100) i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, store_sales  where i_current_price between 14 and 14+30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2002-03-27' as date) and dateadd(day, 60, cast('2002-03-27' as date))  and i_manufact_id in (285,595,897,527)  and inv_quantity_on_hand between 100 and 500  and ss_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  ;", "predicates": {"date_dim": ["d_date"], "inventory": ["inv_quantity_on_hand"], "item": ["i_current_price", "i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc", "i_current_price"]}, "group_by": {}, "order_by": {}}
{"id": 83, "query_string": " with sr_items as  (select i_item_id item_id,         sum(sr_return_quantity) sr_item_qty  from store_returns,       item,       date_dim  where sr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t  where d_date in ('2001-01-24','2001-10-06','2001-11-11')))  and   sr_returned_date_sk   = d_date_sk  group by i_item_id),  cr_items as  (select i_item_id item_id,         sum(cr_return_quantity) cr_item_qty  from catalog_returns,       item,       date_dim  where cr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t  where d_date in ('2001-01-24','2001-10-06','2001-11-11')))  and   cr_returned_date_sk   = d_date_sk  group by i_item_id),  wr_items as  (select i_item_id item_id,         sum(wr_return_quantity) wr_item_qty  from web_returns,       item,       date_dim  where wr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t\twhere d_date in ('2001-01-24','2001-10-06','2001-11-11')))  and   wr_returned_date_sk   = d_date_sk  group by i_item_id)   select top (100) sr_items.item_id        ,sr_item_qty        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev        ,cr_item_qty        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev        ,wr_item_qty        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average  from sr_items      ,cr_items      ,wr_items  where sr_items.item_id=cr_items.item_id    and sr_items.item_id=wr_items.item_id   order by sr_items.item_id          ,sr_item_qty  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_returned_date_sk", "cr_order_number", "cr_return_quantity"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "item": ["i_item_id", "i_item_sk"], "store_returns": ["sr_returned_date_sk", "sr_return_quantity", "sr_item_sk"], "web_returns": ["wr_item_sk", "wr_returned_date_sk", "wr_return_quantity"]}, "group_by": {}, "order_by": {}}
{"id": 84, "query_string": " select top (100) c_customer_id as customer_id        , concat(coalesce(c_last_name,'') , ', ' , coalesce(c_first_name,'')) as customername  from customer      ,customer_address      ,customer_demographics      ,household_demographics      ,income_band      ,store_returns  where ca_city\t        =  'Harmony'    and c_current_addr_sk = ca_address_sk    and ib_lower_bound   >=  44138    and ib_upper_bound   <=  44138 + 50000    and ib_income_band_sk = hd_income_band_sk    and cd_demo_sk = c_current_cdemo_sk    and hd_demo_sk = c_current_hdemo_sk    and sr_cdemo_sk = cd_demo_sk  order by c_customer_id  ;", "predicates": {"customer": ["c_current_cdemo_sk"], "customer_address": ["ca_city"], "income_band": ["ib_upper_bound", "ib_lower_bound"]}, "payload": {"customer": ["c_last_name", "c_first_name", "c_current_cdemo_sk", "c_current_addr_sk", "c_customer_id", "c_current_hdemo_sk"], "customer_address": ["ca_address_sk"], "household_demographics": ["hd_income_band_sk", "hd_demo_sk"], "income_band": ["ib_income_band_sk"], "store_returns": ["sr_cdemo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 85, "query_string": " select top (100) substring(r_reason_desc,1,20)        ,avg(ws_quantity)        ,avg(wr_refunded_cash)        ,avg(wr_fee)  from web_sales, web_returns, web_page, customer_demographics cd1,       customer_demographics cd2, customer_address, date_dim, reason   where ws_web_page_sk = wp_web_page_sk    and ws_item_sk = wr_item_sk    and ws_order_number = wr_order_number    and ws_sold_date_sk = d_date_sk and d_year = 2002    and cd1.cd_demo_sk = wr_refunded_cdemo_sk     and cd2.cd_demo_sk = wr_returning_cdemo_sk    and ca_address_sk = wr_refunded_addr_sk    and r_reason_sk = wr_reason_sk    and    (     (      cd1.cd_marital_status = 'S'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Unknown'      and       cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 100.00 and 150.00     )    or     (      cd1.cd_marital_status = 'D'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Primary'       and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 50.00 and 100.00     )    or     (      cd1.cd_marital_status = 'M'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Advanced Degree'      and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 150.00 and 200.00     )    )    and    (     (      ca_country = 'United States'      and      ca_state in ('SD', 'MN', 'AK')      and ws_net_profit between 100 and 200       )     or     (      ca_country = 'United States'      and      ca_state in ('IA', 'NM', 'TN')      and ws_net_profit between 150 and 300       )     or     (      ca_country = 'United States'      and      ca_state in ('IN', 'NE', 'NC')      and ws_net_profit between 50 and 250       )    ) group by r_reason_desc order by substring(r_reason_desc,1,20)         ,avg(ws_quantity)         ,avg(wr_refunded_cash)         ,avg(wr_fee);", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "web_sales": ["ws_net_profit", "ws_sales_price"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "reason": ["r_reason_desc", "r_reason_sk"], "web_page": ["wp_web_page_sk"], "web_returns": ["wr_returning_cdemo_sk", "wr_refunded_cdemo_sk", "wr_reason_sk", "wr_item_sk", "wr_refunded_cash", "wr_refunded_addr_sk", "wr_fee", "wr_order_number"], "web_sales": ["ws_net_profit", "ws_item_sk", "ws_sales_price", "ws_quantity", "ws_sold_date_sk", "ws_web_page_sk", "ws_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 86, "query_string": " select top (100)       sum(ws_net_paid) as total_sum    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  \tpartition by grouping(i_category)+grouping(i_class),  \tcase when grouping(i_class) = 0 then i_category end   \torder by sum(ws_net_paid) desc) as rank_within_parent  from     web_sales    ,date_dim       d1    ,item  where     d1.d_month_seq between 1220 and 1220+11  and d1.d_date_sk = ws_sold_date_sk  and i_item_sk  = ws_item_sk  group by rollup(i_category,i_class)  order by    lochierarchy desc,    case when (grouping(i_category)+grouping(i_class)) = 0 then i_category end,    rank_within_parent  ;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_class", "i_item_sk", "i_category"], "web_sales": ["ws_net_paid", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 87, "query_string": " select count(*)  from ((select distinct c_last_name, c_first_name, d_date        from store_sales, date_dim, customer        where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_customer_sk = customer.c_customer_sk          and d_month_seq between 1220 and 1220+11)        except       (select distinct c_last_name, c_first_name, d_date        from catalog_sales, date_dim, customer        where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk          and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk          and d_month_seq between 1220 and 1220+11)        except       (select distinct c_last_name, c_first_name, d_date        from web_sales, date_dim, customer        where web_sales.ws_sold_date_sk = date_dim.d_date_sk          and web_sales.ws_bill_customer_sk = customer.c_customer_sk          and d_month_seq between 1220 and 1220+11) ) cool_cust;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 88, "query_string": " select  * from  (select count(*) h8_30_to_9  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk         and ss_hdemo_sk = household_demographics.hd_demo_sk       and ss_store_sk = s_store_sk      and time_dim.t_hour = 8      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2))       and store.s_store_name = 'ese') s1,  (select count(*) h9_to_9_30   from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk       and time_dim.t_hour = 9       and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2))      and store.s_store_name = 'ese') s2,  (select count(*) h9_30_to_10   from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 9      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2))      and store.s_store_name = 'ese') s3,  (select count(*) h10_to_10_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 10       and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2))      and store.s_store_name = 'ese') s4,  (select count(*) h10_30_to_11  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 10       and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2))      and store.s_store_name = 'ese') s5,  (select count(*) h11_to_11_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk       and time_dim.t_hour = 11      and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2))      and store.s_store_name = 'ese') s6,  (select count(*) h11_30_to_12  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 11      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2))      and store.s_store_name = 'ese') s7,  (select count(*) h12_to_12_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 12      and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2))      and store.s_store_name = 'ese') s8;", "predicates": {"household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_store_name"], "time_dim": ["t_hour", "t_minute"]}, "payload": {"household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_sold_time_sk"], "time_dim": ["t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 89, "query_string": " select top (100) * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (1998) and         ((i_category in ('Music','Electronics','Books') and           i_class in ('pop','camcorders','self-help')          )       or (i_category in ('Children','Home','Men') and           i_class in ('toddlers','bedding','sports-apparel')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name;", "predicates": {"date_dim": ["d_year"], "item": ["i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_brand", "i_class", "i_item_sk", "i_category"], "store": ["s_store_name", "s_store_sk", "s_company_name"]}, "group_by": {}, "order_by": {"store": ["s_store_name"]}}
{"id": 90, "query_string": " select top (100) cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio  from ( select count(*) amc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 8 and 8+1          and household_demographics.hd_dep_count = 3          and web_page.wp_char_count between 5000 and 5200) at,       ( select count(*) pmc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 14 and 14+1          and household_demographics.hd_dep_count = 3          and web_page.wp_char_count between 5000 and 5200) pt  order by am_pm_ratio  ;", "predicates": {"household_demographics": ["hd_dep_count"], "time_dim": ["t_hour"], "web_page": ["wp_char_count"]}, "payload": {"household_demographics": ["hd_demo_sk"], "time_dim": ["t_time_sk"], "web_page": ["wp_web_page_sk"], "web_sales": ["ws_sold_time_sk", "ws_web_page_sk", "ws_ship_hdemo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 91, "query_string": " select           cc_call_center_id Call_Center,         cc_name Call_Center_Name,         cc_manager Manager,         sum(cr_net_loss) Returns_Loss from         call_center,         catalog_returns,         date_dim,         customer,         customer_address,         customer_demographics,         household_demographics where         cr_call_center_sk       = cc_call_center_sk and     cr_returned_date_sk     = d_date_sk and     cr_returning_customer_sk= c_customer_sk and     cd_demo_sk              = c_current_cdemo_sk and     hd_demo_sk              = c_current_hdemo_sk and     ca_address_sk           = c_current_addr_sk and     d_year                  = 1998  and     d_moy                   = 12 and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')         or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree')) and     hd_buy_potential like '0-500%' and     ca_gmt_offset           = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc;", "predicates": {"customer_address": ["ca_gmt_offset"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_moy", "d_year"], "household_demographics": ["hd_buy_potential"]}, "payload": {"call_center": ["cc_name", "cc_call_center_id", "cc_manager", "cc_call_center_sk"], "catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_returning_customer_sk", "cr_call_center_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk", "c_current_hdemo_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 92, "query_string": " select top (100)     sum(ws_ext_discount_amt)  as \"Excess Discount Amount\"  from      web_sales     ,item     ,date_dim where i_manufact_id = 724 and i_item_sk = ws_item_sk  and d_date between '2001-02-18' and          dateadd(day, 90, cast('2001-02-18' as date)) and d_date_sk = ws_sold_date_sk  and ws_ext_discount_amt        > (           SELECT              1.3 * avg(ws_ext_discount_amt)           FROM              web_sales             ,date_dim          WHERE                ws_item_sk = i_item_sk            and d_date between '2001-02-18' and                              dateadd(day, 90, cast('2001-02-18' as date))           and d_date_sk = ws_sold_date_sk        )  order by sum(ws_ext_discount_amt);", "predicates": {"date_dim": ["d_date"], "item": ["i_manufact_id"], "web_sales": ["ws_ext_discount_amt"]}, "payload": {"item": ["i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 93, "query_string": " select top (100) ss_customer_sk             ,sum(act_sales) sumsales       from (select ss_item_sk                   ,ss_ticket_number                   ,ss_customer_sk                   ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price                                                             else (ss_quantity*ss_sales_price) end act_sales             from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk                                                                and sr_ticket_number = ss_ticket_number)                 ,reason             where sr_reason_sk = r_reason_sk               and r_reason_desc = 'reason 23') t       group by ss_customer_sk       order by sumsales, ss_customer_sk;", "predicates": {"reason": ["r_reason_desc"]}, "payload": {"reason": ["r_reason_sk"], "store_returns": ["sr_reason_sk", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"]}, "group_by": {}, "order_by": {"store_sales": ["ss_customer_sk"]}}
{"id": 94, "query_string": " select top (100)     count(distinct ws_order_number) as \"order count\"   ,sum(ws_ext_ship_cost) as \"total shipping cost\"   ,sum(ws_net_profit) as \"total net profit\" from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2002-4-01' and             dateadd(day, 60, cast('2002-4-01' as date)) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'ID' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number);", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_date"], "web_site": ["web_company_name"]}, "payload": {"customer_address": ["ca_address_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_net_profit", "ws_ship_date_sk", "ws_ship_addr_sk", "ws_ext_ship_cost", "ws_warehouse_sk", "ws_order_number", "ws_web_site_sk"], "web_site": ["web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 95, "query_string": " with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select top (100)     count(distinct ws_order_number) as \"order count\"   ,sum(ws_ext_ship_cost) as \"total shipping cost\"   ,sum(ws_net_profit) as \"total net profit\" from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2002-4-01' and             dateadd(day, 60, cast('2002-4-01' as date)) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'ID' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number);", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_date"], "web_site": ["web_company_name"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_net_profit", "ws_ship_date_sk", "ws_item_sk", "ws_ship_addr_sk", "ws_ext_ship_cost", "ws_warehouse_sk", "ws_order_number", "ws_web_site_sk"], "web_site": ["web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 96, "query_string": " select top (100) count(*)  from store_sales     ,household_demographics      ,time_dim, store where ss_sold_time_sk = time_dim.t_time_sk        and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk     and time_dim.t_hour = 16     and time_dim.t_minute >= 30     and household_demographics.hd_dep_count = 1     and store.s_store_name = 'ese' order by count(*);", "predicates": {"household_demographics": ["hd_dep_count"], "store": ["s_store_name"], "time_dim": ["t_hour", "t_minute"]}, "payload": {"household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_sold_time_sk"], "time_dim": ["t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 97, "query_string": " with ssci as ( select ss_customer_sk customer_sk       ,ss_item_sk item_sk from store_sales,date_dim where ss_sold_date_sk = d_date_sk   and d_month_seq between 1220 and 1220 + 11 group by ss_customer_sk         ,ss_item_sk), csci as(  select cs_bill_customer_sk customer_sk       ,cs_item_sk item_sk from catalog_sales,date_dim where cs_sold_date_sk = d_date_sk   and d_month_seq between 1220 and 1220 + 11 group by cs_bill_customer_sk         ,cs_item_sk)  select top (100) sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only       ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only       ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk                                and ssci.item_sk = csci.item_sk);", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk", "cs_item_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 98, "query_string": " select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from\t \tstore_sales     \t,item      \t,date_dim where  \tss_item_sk = i_item_sk    \tand i_category in ('Music', 'Books', 'Sports')   \tand ss_sold_date_sk = d_date_sk \tand d_date between cast('1998-06-19' as date)  \t\t\t\tand dateadd(day, 30, cast('1998-06-19' as date)) group by  \ti_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  \ti_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"]}, "group_by": {}, "order_by": {}}
{"id": 99, "query_string": " select top (100)     substring(w_warehouse_name,1,20)   ,sm_type   ,cc_name   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and                   (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and                   (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and                  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    catalog_sales   ,warehouse   ,ship_mode   ,call_center   ,date_dim where     d_month_seq between 1220 and 1220 + 11 and cs_ship_date_sk   = d_date_sk and cs_warehouse_sk   = w_warehouse_sk and cs_ship_mode_sk   = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by    substring(w_warehouse_name,1,20)   ,sm_type   ,cc_name order by substring(w_warehouse_name,1,20)         ,sm_type         ,cc_name;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"call_center": ["cc_name", "cc_call_center_sk"], "catalog_sales": ["cs_warehouse_sk", "cs_call_center_sk", "cs_ship_date_sk", "cs_ship_mode_sk", "cs_sold_date_sk"], "date_dim": ["d_date_sk"], "ship_mode": ["sm_type", "sm_ship_mode_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 1, "query_string": " with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sum(SR_REFUNDED_CASH) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 group by sr_customer_sk ,sr_store_sk)  select top (100) c_customer_id from customer_total_return ctr1 ,store ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'TN' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id;", "predicates": {"date_dim": ["d_year"], "store": ["s_state"], "store_returns": ["sr_store_sk"]}, "payload": {"customer": ["c_customer_id", "c_customer_sk"], "date_dim": ["d_date_sk"], "store": ["s_store_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_customer_id"]}}
{"id": 2, "query_string": " with wscs as  (select sold_date_sk         ,sales_price   from (select ws_sold_date_sk sold_date_sk               ,ws_ext_sales_price sales_price         from web_sales          union all         select cs_sold_date_sk sold_date_sk               ,cs_ext_sales_price sales_price         from catalog_sales) a),  wswscs as   (select d_week_seq,         sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales  from wscs      ,date_dim  where d_date_sk = sold_date_sk  group by d_week_seq)  select d_week_seq1        ,round(sun_sales1/sun_sales2,2)        ,round(mon_sales1/mon_sales2,2)        ,round(tue_sales1/tue_sales2,2)        ,round(wed_sales1/wed_sales2,2)        ,round(thu_sales1/thu_sales2,2)        ,round(fri_sales1/fri_sales2,2)        ,round(sat_sales1/sat_sales2,2)  from  (select wswscs.d_week_seq d_week_seq1         ,sun_sales sun_sales1         ,mon_sales mon_sales1         ,tue_sales tue_sales1         ,wed_sales wed_sales1         ,thu_sales thu_sales1         ,fri_sales fri_sales1         ,sat_sales sat_sales1   from wswscs,date_dim    where date_dim.d_week_seq = wswscs.d_week_seq and         d_year = 2001) y,  (select wswscs.d_week_seq d_week_seq2         ,sun_sales sun_sales2         ,mon_sales mon_sales2         ,tue_sales tue_sales2         ,wed_sales wed_sales2         ,thu_sales thu_sales2         ,fri_sales fri_sales2         ,sat_sales sat_sales2   from wswscs       ,date_dim    where date_dim.d_week_seq = wswscs.d_week_seq and         d_year = 2001+1) z  where d_week_seq1=d_week_seq2-53  order by d_week_seq1;", "predicates": {"date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_week_seq", "d_day_name"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 3, "query_string": " select top (100) dt.d_year         ,item.i_brand_id brand_id         ,item.i_brand brand        ,sum(ss_ext_sales_price) sum_agg  from  date_dim dt        ,store_sales       ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk    and store_sales.ss_item_sk = item.i_item_sk    and item.i_manufact_id = 208    and dt.d_moy=12  group by dt.d_year       ,item.i_brand       ,item.i_brand_id  order by dt.d_year          ,sum_agg desc          ,brand_id  ;", "predicates": {"date_dim": ["d_moy"], "item": ["i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"date_dim": ["d_year"], "item": ["i_brand_id"]}}
{"id": 4, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year  union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total        ,'c' sale_type  from customer      ,catalog_sales      ,date_dim  where c_customer_sk = cs_bill_customer_sk    and cs_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year          )   select top (100)                    t_s_secyear.customer_id                  ,t_s_secyear.customer_first_name                  ,t_s_secyear.customer_last_name                  ,t_s_secyear.customer_login  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_c_firstyear      ,year_total t_c_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id    and t_s_firstyear.customer_id = t_c_secyear.customer_id    and t_s_firstyear.customer_id = t_c_firstyear.customer_id    and t_s_firstyear.customer_id = t_w_firstyear.customer_id    and t_s_firstyear.customer_id = t_w_secyear.customer_id    and t_s_firstyear.sale_type = 's'    and t_c_firstyear.sale_type = 'c'    and t_w_firstyear.sale_type = 'w'    and t_s_secyear.sale_type = 's'    and t_c_secyear.sale_type = 'c'    and t_w_secyear.sale_type = 'w'    and t_s_firstyear.dyear =  1998    and t_s_secyear.dyear = 1998+1    and t_c_firstyear.dyear =  1998    and t_c_secyear.dyear =  1998+1    and t_w_firstyear.dyear = 1998    and t_w_secyear.dyear = 1998+1    and t_s_firstyear.year_total > 0    and t_c_firstyear.year_total > 0    and t_w_firstyear.year_total > 0    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end            > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end  order by t_s_secyear.customer_id          ,t_s_secyear.customer_first_name          ,t_s_secyear.customer_last_name          ,t_s_secyear.customer_login;", "predicates": {"date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_ext_list_price", "cs_ext_discount_amt", "cs_bill_customer_sk", "cs_ext_sales_price", "cs_ext_wholesale_cost", "cs_sold_date_sk"], "customer": ["c_login", "c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id"], "date_dim": ["d_date_sk"], "store_sales": ["ss_ext_discount_amt", "ss_ext_sales_price", "ss_ext_wholesale_cost", "ss_customer_sk", "ss_ext_list_price", "ss_sold_date_sk"], "web_sales": ["ws_ext_discount_amt", "ws_ext_wholesale_cost", "ws_ext_list_price", "ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 5, "query_string": " with ssr as  (select s_store_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  ss_store_sk as store_sk,             ss_sold_date_sk  as date_sk,             ss_ext_sales_price as sales_price,             ss_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from store_sales     union all     select sr_store_sk as store_sk,            sr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            sr_return_amt as return_amt,            sr_net_loss as net_loss     from store_returns    ) salesreturns,      date_dim,      store  where date_sk = d_date_sk        and d_date between cast('1998-08-13' as date)                    and dateadd(day, 14, cast('1998-08-13' as date))        and store_sk = s_store_sk  group by s_store_id)  ,  csr as  (select cp_catalog_page_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  cs_catalog_page_sk as page_sk,             cs_sold_date_sk  as date_sk,             cs_ext_sales_price as sales_price,             cs_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from catalog_sales     union all     select cr_catalog_page_sk as page_sk,            cr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            cr_return_amount as return_amt,            cr_net_loss as net_loss     from catalog_returns    ) salesreturns,      date_dim,      catalog_page  where date_sk = d_date_sk        and d_date between cast('1998-08-13' as date)                   and dateadd(day, 14, cast('1998-08-13' as date))        and page_sk = cp_catalog_page_sk  group by cp_catalog_page_id)  ,  wsr as  (select web_site_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  ws_web_site_sk as wsr_web_site_sk,             ws_sold_date_sk  as date_sk,             ws_ext_sales_price as sales_price,             ws_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from web_sales     union all     select ws_web_site_sk as wsr_web_site_sk,            wr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            wr_return_amt as return_amt,            wr_net_loss as net_loss     from web_returns left outer join web_sales on          ( wr_item_sk = ws_item_sk            and wr_order_number = ws_order_number)    ) salesreturns,      date_dim,      web_site  where date_sk = d_date_sk        and d_date between cast('1998-08-13' as date)                   and dateadd(day, 14, cast('1998-08-13' as date))        and wsr_web_site_sk = web_site_sk  group by web_site_id)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , concat('store' , s_store_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from   ssr  union all  select 'catalog channel' as channel         , concat('catalog_page' , cp_catalog_page_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from  csr  union all  select 'web channel' as channel         , concat('web_site' , web_site_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from   wsr  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_page": ["cp_catalog_page_sk", "cp_catalog_page_id"], "catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_return_amount", "cr_catalog_page_sk"], "catalog_sales": ["cs_catalog_page_sk", "cs_net_profit", "cs_sold_date_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_net_loss"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit", "ss_ext_sales_price"], "web_returns": ["wr_returned_date_sk", "wr_return_amt", "wr_net_loss", "wr_item_sk", "wr_order_number"], "web_sales": ["ws_net_profit", "ws_ext_sales_price", "ws_sold_date_sk", "ws_web_site_sk"], "web_site": ["web_site_id", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 6, "query_string": " select top (100) a.ca_state state, count(*) cnt  from customer_address a      ,customer c      ,store_sales s      ,date_dim d      ,item i  where       a.ca_address_sk = c.c_current_addr_sk  \tand c.c_customer_sk = s.ss_customer_sk  \tand s.ss_sold_date_sk = d.d_date_sk  \tand s.ss_item_sk = i.i_item_sk  \tand d.d_month_seq =   \t     (select distinct (d_month_seq)  \t      from date_dim                where d_year = 2002  \t        and d_moy = 4 )  \tand i.i_current_price > 1.2 *               (select avg(j.i_current_price)   \t     from item j   \t     where j.i_category = i.i_category)  group by a.ca_state  having count(*) >= 10  order by cnt, a.ca_state   ;", "predicates": {"date_dim": ["d_month_seq", "d_moy", "d_year"], "item": ["i_category", "i_current_price"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk", "d_month_seq"], "item": ["i_item_sk", "i_category", "i_current_price"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_item_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_state"]}}
{"id": 7, "query_string": " select top (100) i_item_id,          avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4   from store_sales, customer_demographics, date_dim, item, promotion  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_cdemo_sk = cd_demo_sk and        ss_promo_sk = p_promo_sk and        cd_gender = 'M' and         cd_marital_status = 'D' and        cd_education_status = '2 yr Degree' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 2000   group by i_item_id  order by i_item_id  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "promotion": ["p_channel_event", "p_channel_email"]}, "payload": {"customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"], "promotion": ["p_promo_sk"], "store_sales": ["ss_promo_sk", "ss_item_sk", "ss_cdemo_sk", "ss_list_price", "ss_quantity", "ss_sales_price", "ss_coupon_amt", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 8, "query_string": " select top (100) s_store_name       ,sum(ss_net_profit)  from store_sales      ,date_dim      ,store,      (select ca_zip      from (       SELECT substring(ca_zip,1,5) ca_zip       FROM customer_address       WHERE substring(ca_zip,1,5) IN (                           '85982','74340','77509','47811','66316','46960',                           '17784','49802','81200','51582','94854',                           '15492','77584','15353','27302','95631',                           '34072','62364','44554','69246','63032',                           '54346','84286','85346','53980','96625',                           '35052','83219','96022','95783','70911',                           '58022','71090','92639','24784','92224',                           '64846','92657','10121','50516','77129',                           '83912','52963','61635','44552','19349',                           '56269','45888','68236','10017','35918',                           '95114','32208','51212','22169','11233',                           '65426','78207','53845','54673','82043',                           '62216','46049','15581','50331','43201',                           '52007','52960','60079','83467','64733',                           '54975','14250','79645','11430','22918',                           '22399','14437','23763','98607','55505',                           '55239','45483','75319','28608','19548',                           '25457','60652','97410','68791','35831',                           '49203','69999','47717','93191','60738',                           '64165','89070','89673','79106','61801',                           '53368','93718','37286','79942','95459',                           '26560','86242','49433','76241','92721',                           '41366','94035','52744','52211','71305',                           '37158','58849','55967','76230','95301',                           '69604','20434','39396','32074','96975',                           '98648','68434','66816','10445','74398',                           '73514','64857','54625','33415','24954',                           '67144','17317','82256','83494','23385',                           '94232','44467','77866','50136','11621',                           '93995','16230','52027','42989','99354',                           '99955','88843','99454','31127','13484',                           '98773','42556','29035','20048','90149',                           '93971','77638','36440','91302','29710',                           '81295','58303','38087','41974','44972',                           '13829','78162','88769','67517','94537',                           '79351','82905','20310','62492','27363',                           '22516','78167','15526','99145','86754',                           '59633','89914','34325','53437','91560',                           '15537','17681','62406','89912','11931',                           '46523','68191','18460','60686','67430',                           '36166','23080','60779','47620','78044',                           '82797','60956','36261','69886','60664',                           '82640','14018','32346','62854','18282',                           '15072','29714','70337','54904','76394',                           '74673','56383','97820','77811','89501',                           '96890','33421','55474','17216','46600',                           '55513','45811','90981','37306','81843',                           '75334','55457','22843','95001','49087',                           '54510','56023','68869','48110','93220',                           '79956','91168','99692','44969','62995',                           '53176','63325','42584','28082','39105',                           '80323','31733','21927','55140','88604',                           '32389','12616','31274','62396','56430',                           '93988','13893','24101','69573','49298',                           '74594','34476','70766','10538','81258',                           '88790','84528','16085','75871','98519',                           '84800','59018','33257','93441','90766',                           '96547','28202','91397','35578','95344',                           '28700','93514','22817','77876','87863',                           '83632','18097','71826','12645','97785',                           '12201','51001','87328','73320','34676',                           '99667','60049','37930','33818','94730',                           '16311','10051','33209','59612','11435',                           '79969','85453','18193','80203','10022',                           '84007','62716','34149','89975','74462',                           '95244','83717','36058','75014','40463',                           '78222','43793','41147','89799','71279',                           '73125','63258','90125','94238','60269',                           '24018','85559','76385','42077','52914',                           '27020','61338','51820','78282','11747',                           '42593','22646','27195','76631','65787',                           '56173','59854','31240','46481','16234',                           '65418','90820','78343','96341','27343',                           '26882','68772','61878','26055','23306',                           '54466','58406','77470','10250','57348',                           '63403','66047','60622','75244','19660',                           '51037','66524','59906','50598','52800',                           '18928','12349','78144','83360','27533',                           '85636','90395','48829','48226','42792',                           '67651','80553','99914','53509')      intersect       select ca_zip       from (SELECT substring(ca_zip,1,5) ca_zip,count(*) cnt             FROM customer_address, customer             WHERE ca_address_sk = c_current_addr_sk and                   c_preferred_cust_flag='Y'             group by ca_zip             having count(*) > 10)A1)A2) V1  where ss_store_sk = s_store_sk   and ss_sold_date_sk = d_date_sk   and d_qoy = 1 and d_year = 2000   and (substring(s_zip,1,2) = substring(V1.ca_zip,1,2))  group by s_store_name  order by s_store_name  ;", "predicates": {"customer": ["c_preferred_cust_flag"], "date_dim": ["d_qoy", "d_year"]}, "payload": {"customer": ["c_current_addr_sk"], "customer_address": ["ca_address_sk", "ca_zip"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 9, "query_string": " select case when (select count(*)                    from store_sales                    where ss_quantity between 1 and 20) > 29859             then (select avg(ss_ext_discount_amt)                    from store_sales                    where ss_quantity between 1 and 20)              else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 1 and 20) end bucket1 ,        case when (select count(*)                   from store_sales                   where ss_quantity between 21 and 40) > 27460             then (select avg(ss_ext_discount_amt)                   from store_sales                   where ss_quantity between 21 and 40)              else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 21 and 40) end bucket2,        case when (select count(*)                   from store_sales                   where ss_quantity between 41 and 60) > 1836             then (select avg(ss_ext_discount_amt)                   from store_sales                   where ss_quantity between 41 and 60)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 41 and 60) end bucket3,        case when (select count(*)                   from store_sales                   where ss_quantity between 61 and 80) > 7529             then (select avg(ss_ext_discount_amt)                   from store_sales                   where ss_quantity between 61 and 80)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 61 and 80) end bucket4,        case when (select count(*)                   from store_sales                   where ss_quantity between 81 and 100) > 26859             then (select avg(ss_ext_discount_amt)                   from store_sales                   where ss_quantity between 81 and 100)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 81 and 100) end bucket5 from reason where r_reason_sk = 1;", "predicates": {"store_sales": ["ss_quantity"]}, "payload": {"store_sales": ["ss_ext_tax", "ss_net_paid_inc_tax"]}, "group_by": {}, "order_by": {}}
{"id": 10, "query_string": " select top (100)    cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3,   cd_dep_count,   count(*) cnt4,   cd_dep_employed_count,   count(*) cnt5,   cd_dep_college_count,   count(*) cnt6  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_county in ('Montgomery County','Glades County','Henderson County','Mason County','Kimball County') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2001 and                 d_moy between 1 and 1+3) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 1 ANd 1+3) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 1 and 1+3))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count;", "predicates": {"customer_address": ["ca_county"], "date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 11, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag           ,c_birth_country          ,c_login          ,c_email_address          ,d_year   union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag           ,c_birth_country          ,c_login          ,c_email_address          ,d_year          )   select top (100)                    t_s_secyear.customer_id                  ,t_s_secyear.customer_first_name                  ,t_s_secyear.customer_last_name                  ,t_s_secyear.customer_login  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id          and t_s_firstyear.customer_id = t_w_secyear.customer_id          and t_s_firstyear.customer_id = t_w_firstyear.customer_id          and t_s_firstyear.sale_type = 's'          and t_w_firstyear.sale_type = 'w'          and t_s_secyear.sale_type = 's'          and t_w_secyear.sale_type = 'w'          and t_s_firstyear.dyear = 1998          and t_s_secyear.dyear = 1998+1          and t_w_firstyear.dyear = 1998          and t_w_secyear.dyear = 1998+1          and t_s_firstyear.year_total > 0          and t_w_firstyear.year_total > 0          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end              > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end  order by t_s_secyear.customer_id          ,t_s_secyear.customer_first_name          ,t_s_secyear.customer_last_name          ,t_s_secyear.customer_login;", "predicates": {"date_dim": ["d_year"]}, "payload": {"customer": ["c_login", "c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_ext_list_price", "ss_ext_discount_amt"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_discount_amt", "ws_ext_list_price"]}, "group_by": {}, "order_by": {}}
{"id": 12, "query_string": " select top (100) i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from\t \tweb_sales     \t,item      \t,date_dim where  \tws_item_sk = i_item_sk    \tand i_category in ('Men', 'Children', 'Books')   \tand ws_sold_date_sk = d_date_sk \tand d_date between cast('1998-03-17' as date)  \t\t\t\tand dateadd(day, 30, cast('1998-03-17' as date)) group by  \ti_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  \ti_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_desc", "i_class", "i_item_id", "i_category"]}}
{"id": 13, "query_string": " select avg(ss_quantity)        ,avg(ss_ext_sales_price)        ,avg(ss_ext_wholesale_cost)        ,sum(ss_ext_wholesale_cost)  from store_sales      ,store      ,customer_demographics      ,household_demographics      ,customer_address      ,date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2001  and((ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'M'   and cd_education_status = 'Advanced Degree'   and ss_sales_price between 100.00 and 150.00   and hd_dep_count = 3         )or      (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'W'   and cd_education_status = 'Unknown'   and ss_sales_price between 50.00 and 100.00      and hd_dep_count = 1      ) or       (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'U'   and cd_education_status = 'Primary'   and ss_sales_price between 150.00 and 200.00    and hd_dep_count = 1        ))  and((ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('TN', 'TX', 'MN')   and ss_net_profit between 100 and 200        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('MI', 'VA', 'CA')   and ss_net_profit between 150 and 300        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('RI', 'NE', 'WI')   and ss_net_profit between 50 and 250        ));", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "household_demographics": ["hd_dep_count"], "store_sales": ["ss_sales_price", "ss_net_profit"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_dep_count", "hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_ext_sales_price", "ss_cdemo_sk", "ss_addr_sk", "ss_quantity", "ss_sales_price", "ss_ext_wholesale_cost", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 14, "query_string": " with  cross_items as  (select i_item_sk ss_item_sk  from item,  (select iss.i_brand_id brand_id      ,iss.i_class_id class_id      ,iss.i_category_id category_id  from store_sales      ,item iss      ,date_dim d1  where ss_item_sk = iss.i_item_sk    and ss_sold_date_sk = d1.d_date_sk    and d1.d_year between 1998 AND 1998 + 2  intersect   select ics.i_brand_id      ,ics.i_class_id      ,ics.i_category_id  from catalog_sales      ,item ics      ,date_dim d2  where cs_item_sk = ics.i_item_sk    and cs_sold_date_sk = d2.d_date_sk    and d2.d_year between 1998 AND 1998 + 2  intersect  select iws.i_brand_id      ,iws.i_class_id      ,iws.i_category_id  from web_sales      ,item iws      ,date_dim d3  where ws_item_sk = iws.i_item_sk    and ws_sold_date_sk = d3.d_date_sk    and d3.d_year between 1998 AND 1998 + 2) a  where i_brand_id = brand_id       and i_class_id = class_id       and i_category_id = category_id ),  avg_sales as  (select avg(quantity*list_price) average_sales   from (select ss_quantity quantity              ,ss_list_price list_price        from store_sales            ,date_dim        where ss_sold_date_sk = d_date_sk          and d_year between 1998 and 1998 + 2        union all         select cs_quantity quantity               ,cs_list_price list_price        from catalog_sales            ,date_dim        where cs_sold_date_sk = d_date_sk          and d_year between 1998 and 1998 + 2         union all        select ws_quantity quantity              ,ws_list_price list_price        from web_sales            ,date_dim        where ws_sold_date_sk = d_date_sk          and d_year between 1998 and 1998 + 2) x)   select top (100) channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)  from(        select 'store' channel, i_brand_id,i_class_id              ,i_category_id,sum(ss_quantity*ss_list_price) sales              , count(*) number_sales        from store_sales            ,item            ,date_dim        where ss_item_sk in (select ss_item_sk from cross_items)          and ss_item_sk = i_item_sk          and ss_sold_date_sk = d_date_sk          and d_year = 1998+2           and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)        union all        select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales        from catalog_sales            ,item            ,date_dim        where cs_item_sk in (select ss_item_sk from cross_items)          and cs_item_sk = i_item_sk          and cs_sold_date_sk = d_date_sk          and d_year = 1998+2           and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)        union all        select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales        from web_sales            ,item            ,date_dim        where ws_item_sk in (select ss_item_sk from cross_items)          and ws_item_sk = i_item_sk          and ws_sold_date_sk = d_date_sk          and d_year = 1998+2          and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)  ) y  group by rollup (channel, i_brand_id,i_class_id,i_category_id)  order by channel,i_brand_id,i_class_id,i_category_id  ; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_list_price", "cs_quantity"], "date_dim": ["d_date_sk"], "item": ["i_category_id", "i_class_id", "i_item_sk", "i_brand_id"], "store_sales": ["ss_sold_date_sk", "ss_list_price", "ss_quantity", "ss_item_sk"], "web_sales": ["ws_list_price", "ws_sold_date_sk", "ws_item_sk", "ws_quantity"]}, "group_by": {}, "order_by": {}}
{"id": 15, "query_string": " select top (100) ca_zip        ,sum(cs_sales_price)  from catalog_sales      ,customer      ,customer_address      ,date_dim  where cs_bill_customer_sk = c_customer_sk  \tand c_current_addr_sk = ca_address_sk   \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',                                    '85392', '85460', '80348', '81792')  \t      or ca_state in ('CA','WA','GA')  \t      or cs_sales_price > 500)  \tand cs_sold_date_sk = d_date_sk  \tand d_qoy = 1 and d_year = 2002  group by ca_zip  order by ca_zip  ;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"catalog_sales": ["cs_sales_price", "cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip", "ca_state"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_zip"]}}
{"id": 16, "query_string": " select top (100)     count(distinct cs_order_number) as \"order count\"   ,sum(cs_ext_ship_cost) as \"total shipping cost\"   ,sum(cs_net_profit) as \"total net profit\" from    catalog_sales cs1   ,date_dim   ,customer_address   ,call_center where     d_date between '2002-3-01' and             dateadd(day, 60, cast('2002-3-01' as date)) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'MO' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County',                   'Williamson County' ) and exists (select *             from catalog_sales cs2             where cs1.cs_order_number = cs2.cs_order_number               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select *                from catalog_returns cr1                where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number);", "predicates": {"call_center": ["cc_county"], "customer_address": ["ca_state"], "date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_order_number"], "catalog_sales": ["cs_order_number", "cs_warehouse_sk", "cs_ext_ship_cost", "cs_ship_addr_sk", "cs_net_profit", "cs_call_center_sk", "cs_ship_date_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 17, "query_string": " select top (100) i_item_id        ,i_item_desc        ,s_state        ,count(ss_quantity) as store_sales_quantitycount        ,avg(ss_quantity) as store_sales_quantityave        ,stdev(ss_quantity) as store_sales_quantitystdev        ,stdev(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov        ,count(sr_return_quantity) as store_returns_quantitycount        ,avg(sr_return_quantity) as store_returns_quantityave        ,stdev(sr_return_quantity) as store_returns_quantitystdev        ,stdev(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov        ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave        ,stdev(cs_quantity) as catalog_sales_quantitystdev        ,stdev(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov  from store_sales      ,store_returns      ,catalog_sales      ,date_dim d1      ,date_dim d2      ,date_dim d3      ,store      ,item  where d1.d_quarter_name = '1999Q1'    and d1.d_date_sk = ss_sold_date_sk    and i_item_sk = ss_item_sk    and s_store_sk = ss_store_sk    and ss_customer_sk = sr_customer_sk    and ss_item_sk = sr_item_sk    and ss_ticket_number = sr_ticket_number    and sr_returned_date_sk = d2.d_date_sk    and d2.d_quarter_name in ('1999Q1','1999Q2','1999Q3')    and sr_customer_sk = cs_bill_customer_sk    and sr_item_sk = cs_item_sk    and cs_sold_date_sk = d3.d_date_sk    and d3.d_quarter_name in ('1999Q1','1999Q2','1999Q3')  group by i_item_id          ,i_item_desc          ,s_state  order by i_item_id          ,i_item_desc          ,s_state;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_quarter_name"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_state", "s_store_sk"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_return_quantity", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 18, "query_string": " select top (100) i_item_id,         ca_country,         ca_state,          ca_county,         avg( cast(cs_quantity as decimal(12,2))) agg1,         avg( cast(cs_list_price as decimal(12,2))) agg2,         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,         avg( cast(cs_sales_price as decimal(12,2))) agg4,         avg( cast(cs_net_profit as decimal(12,2))) agg5,         avg( cast(c_birth_year as decimal(12,2))) agg6,         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7  from catalog_sales, customer_demographics cd1,        customer_demographics cd2, customer, customer_address, date_dim, item  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd1.cd_demo_sk and        cs_bill_customer_sk = c_customer_sk and        cd1.cd_gender = 'F' and         cd1.cd_education_status = '2 yr Degree' and        c_current_cdemo_sk = cd2.cd_demo_sk and        c_current_addr_sk = ca_address_sk and        c_birth_month in (9,11,10,3,4,7) and        d_year = 2002 and        ca_state in ('WA','WI','NE'                    ,'SD','UT','OK','GA')  group by rollup (i_item_id, ca_country, ca_state, ca_county)  order by ca_country,         ca_state,          ca_county, \ti_item_id  ;", "predicates": {"customer": ["c_birth_month"], "customer_address": ["ca_state"], "customer_demographics": ["cd_education_status", "cd_gender"], "date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_quantity", "cs_sales_price", "cs_bill_customer_sk", "cs_item_sk", "cs_net_profit", "cs_list_price", "cs_coupon_amt", "cs_sold_date_sk", "cs_bill_cdemo_sk"], "customer": ["c_birth_year", "c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_county", "ca_country", "ca_state"], "customer_demographics": ["cd_demo_sk", "cd_dep_count"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_state", "ca_county", "ca_country"], "item": ["i_item_id"]}}
{"id": 19, "query_string": " select top (100) i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,  \tsum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item,customer,customer_address,store  where d_date_sk = ss_sold_date_sk    and ss_item_sk = i_item_sk    and i_manager_id=37    and d_moy=12    and d_year=2002    and ss_customer_sk = c_customer_sk     and c_current_addr_sk = ca_address_sk    and substring(ca_zip,1,5) <> substring(s_zip,1,5)     and ss_store_sk = s_store_sk   group by i_brand       ,i_brand_id       ,i_manufact_id       ,i_manufact  order by ext_price desc          ,i_brand          ,i_brand_id          ,i_manufact_id          ,i_manufact  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip"], "date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_brand_id", "i_manufact_id", "i_brand", "i_manufact"], "store": ["s_zip", "s_store_sk"]}, "group_by": {}, "order_by": {"item": ["i_brand", "i_manufact", "i_brand_id", "i_manufact_id"]}}
{"id": 20, "query_string": " select top (100) i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from\tcatalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Men', 'Children', 'Books')    and cs_sold_date_sk = d_date_sk  and d_date between cast('1998-03-17' as date)   \t\t\t\tand dateadd(day, 30, cast('1998-03-17' as date))  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"]}, "group_by": {}, "order_by": {"item": ["i_item_desc", "i_class", "i_item_id", "i_category"]}}
{"id": 21, "query_string": " select top (100) *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-29' as date)) \t                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between dateadd(day, -30, cast ('1998-06-29' as date))                     and dateadd(day, 30, cast ('1998-06-29' as date))    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  ;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"]}, "payload": {"date_dim": ["d_date_sk", "d_date"], "item": ["i_item_id", "i_item_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 22, "query_string": " select top (100) i_product_name              ,i_brand              ,i_class              ,i_category              ,avg(inv_quantity_on_hand) qoh        from inventory            ,date_dim            ,item        where inv_date_sk=d_date_sk               and inv_item_sk=i_item_sk               and d_month_seq between 1205 and 1205 + 11        group by rollup(i_product_name                        ,i_brand                        ,i_class                        ,i_category) order by qoh, i_product_name, i_brand, i_class, i_category;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_brand", "i_product_name", "i_category", "i_class"]}, "group_by": {}, "order_by": {"item": ["i_product_name", "i_class", "i_brand", "i_category"]}}
{"id": 23, "query_string": " with frequent_ss_items as   (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt   from store_sales       ,date_dim        ,item   where ss_sold_date_sk = d_date_sk     and ss_item_sk = i_item_sk      and d_year in (1999,1999+1,1999+2,1999+3)   group by substring(i_item_desc,1,30),i_item_sk,d_date   having count(*) >4),  max_store_sales as  (select max(csales) tpcds_cmax    from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales         from store_sales             ,customer             ,date_dim          where ss_customer_sk = c_customer_sk          and ss_sold_date_sk = d_date_sk          and d_year in (1999,1999+1,1999+2,1999+3)          group by c_customer_sk) a),  best_ss_customer as  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales   from store_sales       ,customer   where ss_customer_sk = c_customer_sk   group by c_customer_sk   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select   * from  max_store_sales))   select top (100) sum(sales)  from (select cs_quantity*cs_list_price sales        from catalog_sales            ,date_dim         where d_year = 1999           and d_moy = 6           and cs_sold_date_sk = d_date_sk           and cs_item_sk in (select item_sk from frequent_ss_items)          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)       union all       select ws_quantity*ws_list_price sales        from web_sales             ,date_dim         where d_year = 1999           and d_moy = 6           and ws_sold_date_sk = d_date_sk           and ws_item_sk in (select item_sk from frequent_ss_items)          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) b  ; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"customer": ["c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "item": ["i_item_sk", "i_item_desc"], "store_sales": ["ss_item_sk", "ss_sales_price", "ss_customer_sk", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 24, "query_string": " with ssales as (select c_last_name       ,c_first_name       ,s_store_name       ,ca_state       ,s_state       ,i_color       ,i_current_price       ,i_manager_id       ,i_units       ,i_size       ,sum(ss_sales_price) netpaid from store_sales     ,store_returns     ,store     ,item     ,customer     ,customer_address where ss_ticket_number = sr_ticket_number   and ss_item_sk = sr_item_sk   and ss_customer_sk = c_customer_sk   and ss_item_sk = i_item_sk   and ss_store_sk = s_store_sk   and c_current_addr_sk = ca_address_sk   and c_birth_country <> upper(ca_country)   and s_zip = ca_zip and s_market_id=9 group by c_last_name         ,c_first_name         ,s_store_name         ,ca_state         ,s_state         ,i_color         ,i_current_price         ,i_manager_id         ,i_units         ,i_size) select c_last_name       ,c_first_name       ,s_store_name       ,sum(netpaid) paid from ssales where i_color = 'spring' group by c_last_name         ,c_first_name         ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid)                                  from ssales) order by c_last_name         ,c_first_name         ,s_store_name; ", "predicates": {"item": ["i_color"], "store": ["s_market_id"]}, "payload": {"customer": ["c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_current_addr_sk"], "customer_address": ["ca_address_sk", "ca_country", "ca_zip", "ca_state"], "item": ["i_item_sk", "i_units", "i_manager_id", "i_current_price", "i_size"], "store": ["s_zip", "s_store_name", "s_state", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_net_paid_inc_tax"]}, "group_by": {}, "order_by": {}}
{"id": 25, "query_string": " select top (100)   i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  ,sum(ss_net_profit) as store_sales_profit  ,sum(sr_net_loss) as store_returns_loss  ,sum(cs_net_profit) as catalog_sales_profit  from  store_sales  ,store_returns  ,catalog_sales  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,item  where  d1.d_moy = 4  and d1.d_year = 2002  and d1.d_date_sk = ss_sold_date_sk  and i_item_sk = ss_item_sk  and s_store_sk = ss_store_sk  and ss_customer_sk = sr_customer_sk  and ss_item_sk = sr_item_sk  and ss_ticket_number = sr_ticket_number  and sr_returned_date_sk = d2.d_date_sk  and d2.d_moy               between 4 and  10  and d2.d_year              = 2002  and sr_customer_sk = cs_bill_customer_sk  and sr_item_sk = cs_item_sk  and cs_sold_date_sk = d3.d_date_sk  and d3.d_moy               between 4 and  10   and d3.d_year              = 2002  group by  i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  order by  i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  ;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_store_name", "s_store_sk", "s_store_id"], "store_returns": ["sr_returned_date_sk", "sr_net_loss", "sr_customer_sk", "sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 26, "query_string": " select top (100) i_item_id,          avg(cs_quantity) agg1,         avg(cs_list_price) agg2,         avg(cs_coupon_amt) agg3,         avg(cs_sales_price) agg4   from catalog_sales, customer_demographics, date_dim, item, promotion  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd_demo_sk and        cs_promo_sk = p_promo_sk and        cd_gender = 'M' and         cd_marital_status = 'D' and        cd_education_status = '2 yr Degree' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 2000   group by i_item_id  order by i_item_id  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "promotion": ["p_channel_event", "p_channel_email"]}, "payload": {"item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 27, "query_string": " select top (100) i_item_id,         s_state, grouping(s_state) g_state,         avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4  from store_sales, customer_demographics, date_dim, store, item  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_store_sk = s_store_sk and        ss_cdemo_sk = cd_demo_sk and        cd_gender = 'M' and        cd_marital_status = 'S' and        cd_education_status = '2 yr Degree' and        d_year = 1999 and        s_state in ('TN','TN', 'TN', 'TN', 'TN', 'TN')  group by rollup (i_item_id, s_state)  order by i_item_id          ,s_state  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "store": ["s_state"]}, "payload": {"customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"], "store": ["s_state", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_cdemo_sk", "ss_list_price", "ss_quantity", "ss_sales_price", "ss_coupon_amt", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_id"], "store": ["s_state"]}}
{"id": 28, "query_string": " select top (100) * from (select avg(ss_list_price) B1_LP             ,count(ss_list_price) B1_CNT             ,count(distinct ss_list_price) B1_CNTD       from store_sales       where ss_quantity between 0 and 5         and (ss_list_price between 30 and 30+10               or ss_coupon_amt between 15120 and 15120+1000              or ss_wholesale_cost between 37 and 37+20)) B1,      (select avg(ss_list_price) B2_LP             ,count(ss_list_price) B2_CNT             ,count(distinct ss_list_price) B2_CNTD       from store_sales       where ss_quantity between 6 and 10         and (ss_list_price between 48 and 48+10           or ss_coupon_amt between 4553 and 4553+1000           or ss_wholesale_cost between 51 and 51+20)) B2,      (select avg(ss_list_price) B3_LP             ,count(ss_list_price) B3_CNT             ,count(distinct ss_list_price) B3_CNTD       from store_sales       where ss_quantity between 11 and 15         and (ss_list_price between 158 and 158+10           or ss_coupon_amt between 5008 and 5008+1000           or ss_wholesale_cost between 43 and 43+20)) B3,      (select avg(ss_list_price) B4_LP             ,count(ss_list_price) B4_CNT             ,count(distinct ss_list_price) B4_CNTD       from store_sales       where ss_quantity between 16 and 20         and (ss_list_price between 64 and 64+10           or ss_coupon_amt between 1485 and 1485+1000           or ss_wholesale_cost between 40 and 40+20)) B4,      (select avg(ss_list_price) B5_LP             ,count(ss_list_price) B5_CNT             ,count(distinct ss_list_price) B5_CNTD       from store_sales       where ss_quantity between 21 and 25         and (ss_list_price between 188 and 188+10           or ss_coupon_amt between 17566 and 17566+1000           or ss_wholesale_cost between 50 and 50+20)) B5,      (select avg(ss_list_price) B6_LP             ,count(ss_list_price) B6_CNT             ,count(distinct ss_list_price) B6_CNTD       from store_sales       where ss_quantity between 26 and 30         and (ss_list_price between 163 and 163+10           or ss_coupon_amt between 10657 and 10657+1000           or ss_wholesale_cost between 46 and 46+20)) B6;", "predicates": {"store_sales": ["ss_list_price", "ss_coupon_amt", "ss_quantity", "ss_wholesale_cost"]}, "payload": {"store_sales": ["ss_list_price"]}, "group_by": {}, "order_by": {}}
{"id": 29, "query_string": " select top (100)        i_item_id     ,i_item_desc     ,s_store_id     ,s_store_name     ,max(ss_quantity)        as store_sales_quantity     ,max(sr_return_quantity) as store_returns_quantity     ,max(cs_quantity)        as catalog_sales_quantity  from     store_sales    ,store_returns    ,catalog_sales    ,date_dim             d1    ,date_dim             d2    ,date_dim             d3    ,store    ,item  where      d1.d_moy               = 4   and d1.d_year              = 1999  and d1.d_date_sk           = ss_sold_date_sk  and i_item_sk              = ss_item_sk  and s_store_sk             = ss_store_sk  and ss_customer_sk         = sr_customer_sk  and ss_item_sk             = sr_item_sk  and ss_ticket_number       = sr_ticket_number  and sr_returned_date_sk    = d2.d_date_sk  and d2.d_moy               between 4 and  4 + 3   and d2.d_year              = 1999  and sr_customer_sk         = cs_bill_customer_sk  and sr_item_sk             = cs_item_sk  and cs_sold_date_sk        = d3.d_date_sk       and d3.d_year              in (1999,1999+1,1999+2)  group by     i_item_id    ,i_item_desc    ,s_store_id    ,s_store_name  order by     i_item_id     ,i_item_desc    ,s_store_id    ,s_store_name  ;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_store_name", "s_store_sk", "s_store_id"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_return_quantity", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 30, "query_string": " with customer_total_return as  (select wr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   \tsum(wr_return_amt) as ctr_total_return  from web_returns      ,date_dim      ,customer_address  where wr_returned_date_sk = d_date_sk     and d_year =2001    and wr_returning_addr_sk = ca_address_sk   group by wr_returning_customer_sk          ,ca_state)   select top (100) c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag        ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address        ,c_last_review_date,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  \t\t\t  from customer_total_return ctr2                    \t  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'SC'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag                   ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address                   ,c_last_review_date,ctr_total_return;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_year"]}, "payload": {"customer": ["c_birth_year", "c_login", "c_customer_sk", "c_birth_month", "c_salutation", "c_birth_day", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_current_addr_sk", "c_email_address", "c_customer_id", "c_last_review_date"], "customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "web_returns": ["wr_return_amt", "wr_returning_addr_sk", "wr_returned_date_sk", "wr_returning_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_birth_year", "c_login", "c_birth_month", "c_birth_country", "c_salutation", "c_birth_day", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id", "c_last_review_date"]}}
{"id": 31, "query_string": " with ss as  (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales  from store_sales,date_dim,customer_address  where ss_sold_date_sk = d_date_sk   and ss_addr_sk=ca_address_sk  group by ca_county,d_qoy, d_year),  ws as  (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales  from web_sales,date_dim,customer_address  where ws_sold_date_sk = d_date_sk   and ws_bill_addr_sk=ca_address_sk  group by ca_county,d_qoy, d_year)  select          ss1.ca_county        ,ss1.d_year        ,ws2.web_sales/ws1.web_sales web_q1_q2_increase        ,ss2.store_sales/ss1.store_sales store_q1_q2_increase        ,ws3.web_sales/ws2.web_sales web_q2_q3_increase        ,ss3.store_sales/ss2.store_sales store_q2_q3_increase  from         ss ss1        ,ss ss2        ,ss ss3        ,ws ws1        ,ws ws2        ,ws ws3  where     ss1.d_qoy = 1     and ss1.d_year = 2002     and ss1.ca_county = ss2.ca_county     and ss2.d_qoy = 2     and ss2.d_year = 2002  and ss2.ca_county = ss3.ca_county     and ss3.d_qoy = 3     and ss3.d_year = 2002     and ss1.ca_county = ws1.ca_county     and ws1.d_qoy = 1     and ws1.d_year = 2002     and ws1.ca_county = ws2.ca_county     and ws2.d_qoy = 2     and ws2.d_year = 2002     and ws1.ca_county = ws3.ca_county     and ws3.d_qoy = 3     and ws3.d_year =2002     and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end         > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end     and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end        > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end  order by web_q1_q2_increase;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"customer_address": ["ca_address_sk", "ca_county"], "date_dim": ["d_date_sk", "d_year"], "store_sales": ["ss_sold_date_sk", "ss_addr_sk", "ss_ext_sales_price"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_bill_addr_sk"]}, "group_by": {}, "order_by": {}}
{"id": 32, "query_string": " select top (100) sum(cs_ext_discount_amt)  as \"excess discount amount\"  from     catalog_sales     ,item     ,date_dim where i_manufact_id = 645 and i_item_sk = cs_item_sk  and d_date between '2000-01-05' and          dateadd(day, 90, cast('2000-01-05' as date)) and d_date_sk = cs_sold_date_sk  and cs_ext_discount_amt        > (           select              1.3 * avg(cs_ext_discount_amt)           from              catalog_sales             ,date_dim          where                cs_item_sk = i_item_sk            and d_date between '2000-01-05' and                              dateadd(day, 90, cast('2000-01-05' as date))           and d_date_sk = cs_sold_date_sk        ) ;", "predicates": {"catalog_sales": ["cs_ext_discount_amt"], "date_dim": ["d_date"], "item": ["i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 33, "query_string": " with ss as (  select           i_manufact_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id in (select   i_manufact_id from  item where i_category in ('Electronics'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 2  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  cs as (  select           i_manufact_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Electronics'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 2  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  ws as (  select           i_manufact_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Electronics'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 2  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_manufact_id)   select top (100) i_manufact_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_manufact_id  order by total_sales;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_category"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_addr_sk", "cs_item_sk", "cs_ext_sales_price"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_manufact_id"], "store_sales": ["ss_sold_date_sk", "ss_addr_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk", "ws_bill_addr_sk"]}, "group_by": {}, "order_by": {}}
{"id": 34, "query_string": " select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = 'Unknown')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  \tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  \telse null  \tend)  > 1.2     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',                            'Williamson County','Williamson County','Williamson County','Williamson County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;", "predicates": {"date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count", "hd_buy_potential"], "store": ["s_county"]}, "payload": {"customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_preferred_cust_flag"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 35, "query_string": " select top (100)     ca_state,   cd_gender,   cd_marital_status,   cd_dep_count,   count(*) cnt1,   max(cd_dep_count),   max(cd_dep_count),   max(cd_dep_count),   cd_dep_employed_count,   count(*) cnt2,   max(cd_dep_employed_count),   max(cd_dep_employed_count),   max(cd_dep_employed_count),   cd_dep_college_count,   count(*) cnt3,   max(cd_dep_college_count),   max(cd_dep_college_count),   max(cd_dep_college_count)  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2002 and                 d_qoy < 4) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_qoy < 4) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_qoy < 4))  group by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  ;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_state"], "customer_demographics": ["cd_dep_college_count", "cd_gender", "cd_demo_sk", "cd_dep_employed_count", "cd_dep_count", "cd_marital_status"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 36, "query_string": " select top (100)      sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  \tpartition by grouping(i_category)+grouping(i_class),  \tcase when grouping(i_class) = 0 then i_category end   \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent  from     store_sales    ,date_dim       d1    ,item    ,store  where     d1.d_year = 2002   and d1.d_date_sk = ss_sold_date_sk  and i_item_sk  = ss_item_sk   and s_store_sk  = ss_store_sk  and s_state in ('TN','TN','TN','TN',                  'TN','TN','TN','TN')  group by rollup(i_category,i_class)  order by    lochierarchy desc   ,case when (grouping(i_category)+grouping(i_class)) = 0 then i_category end   ,rank_within_parent   ;", "predicates": {"date_dim": ["d_year"], "store": ["s_state"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_class", "i_item_sk", "i_category"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_ext_sales_price", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 37, "query_string": " select top (100) i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 15 and 15 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2001-04-15' as date) and dateadd(day, 60, cast('2001-04-15' as date))  and i_manufact_id in (770,1000,711,795)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  ;", "predicates": {"date_dim": ["d_date"], "inventory": ["inv_quantity_on_hand"], "item": ["i_current_price", "i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc", "i_current_price"]}, "group_by": {}, "order_by": {}}
{"id": 38, "query_string": " select top (100) count(*) from (     select distinct c_last_name, c_first_name, d_date     from store_sales, date_dim, customer           where store_sales.ss_sold_date_sk = date_dim.d_date_sk       and store_sales.ss_customer_sk = customer.c_customer_sk       and d_month_seq between 1205 and 1205 + 11   intersect     select distinct c_last_name, c_first_name, d_date     from catalog_sales, date_dim, customer           where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk       and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk       and d_month_seq between 1205 and 1205 + 11   intersect     select distinct c_last_name, c_first_name, d_date     from web_sales, date_dim, customer           where web_sales.ws_sold_date_sk = date_dim.d_date_sk       and web_sales.ws_bill_customer_sk = customer.c_customer_sk       and d_month_seq between 1205 and 1205 + 11 ) hot_cust;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk", "ws_item_sk", "ws_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 39, "query_string": " with inv as (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy        ,stdev,mean, case mean when 0 then null else stdev/mean end cov  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy             ,stdev(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean       from inventory           ,item           ,warehouse           ,date_dim       where inv_item_sk = i_item_sk         and inv_warehouse_sk = w_warehouse_sk         and inv_date_sk = d_date_sk         and d_year =1998       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo  where case mean when 0 then 0 else stdev/mean end > 1) select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov from inv inv1,inv inv2 where inv1.i_item_sk = inv2.i_item_sk   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk   and inv1.d_moy=1   and inv2.d_moy=1+1 order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov         ,inv2.d_moy,inv2.mean, inv2.cov; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_item_sk"], "warehouse": ["w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 40, "query_string": " select top (100)     w_state   ,i_item_id   ,sum(case when (cast(d_date as date) < cast ('1998-06-29' as date))   \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before   ,sum(case when (cast(d_date as date) >= cast ('1998-06-29' as date))   \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after  from    catalog_sales left outer join catalog_returns on        (cs_order_number = cr_order_number          and cs_item_sk = cr_item_sk)   ,warehouse    ,item   ,date_dim  where      i_current_price between 0.99 and 1.49  and i_item_sk          = cs_item_sk  and cs_warehouse_sk    = w_warehouse_sk   and cs_sold_date_sk    = d_date_sk  and d_date between dateadd(day, -30, cast ('1998-06-29' as date))                 and dateadd(day, 30, cast ('1998-06-29' as date))   group by     w_state,i_item_id  order by w_state,i_item_id;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_refunded_cash"], "date_dim": ["d_date_sk", "d_date"], "item": ["i_item_id", "i_item_sk"], "warehouse": ["w_state", "w_warehouse_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_id"], "warehouse": ["w_state"]}}
{"id": 41, "query_string": " select distinct top (100) i_product_name  from item i1  where i_manufact_id between 875 and 875+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'salmon' or i_color = 'green') and          (i_units = 'Tbl' or i_units = 'Box') and         (i_size = 'N/A' or i_size = 'petite')         ) or         (i_category = 'Women' and         (i_color = 'honeydew' or i_color = 'burnished') and         (i_units = 'Carton' or i_units = 'Pallet') and         (i_size = 'large' or i_size = 'extra large')         ) or         (i_category = 'Men' and         (i_color = 'grey' or i_color = 'aquamarine') and         (i_units = 'Cup' or i_units = 'Ton') and         (i_size = 'economy' or i_size = 'small')         ) or         (i_category = 'Men' and         (i_color = 'cyan' or i_color = 'rosy') and         (i_units = 'Each' or i_units = 'Gram') and         (i_size = 'N/A' or i_size = 'petite')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'tan' or i_color = 'black') and          (i_units = 'Bundle' or i_units = 'Pound') and         (i_size = 'N/A' or i_size = 'petite')         ) or         (i_category = 'Women' and         (i_color = 'lime' or i_color = 'blue') and         (i_units = 'Tsp' or i_units = 'Bunch') and         (i_size = 'large' or i_size = 'extra large')         ) or         (i_category = 'Men' and         (i_color = 'purple' or i_color = 'lemon') and         (i_units = 'Ounce' or i_units = 'N/A') and         (i_size = 'economy' or i_size = 'small')         ) or         (i_category = 'Men' and         (i_color = 'seashell' or i_color = 'cream') and         (i_units = 'Unknown' or i_units = 'Gross') and         (i_size = 'N/A' or i_size = 'petite')         )))) > 0  order by i_product_name  ;", "predicates": {"item": ["i_color", "i_units", "i_manufact_id", "i_category", "i_size", "i_manufact"]}, "payload": {"item": ["i_color", "i_units", "i_product_name", "i_category", "i_size", "i_manufact"]}, "group_by": {}, "order_by": {}}
{"id": 42, "query_string": " select top (100) dt.d_year  \t,item.i_category_id  \t,item.i_category  \t,sum(ss_ext_sales_price)  from \tdate_dim dt  \t,store_sales  \t,item  where dt.d_date_sk = store_sales.ss_sold_date_sk  \tand store_sales.ss_item_sk = item.i_item_sk  \tand item.i_manager_id = 1  \t  \tand dt.d_moy=11  \tand dt.d_year=1998  group by \tdt.d_year  \t\t,item.i_category_id  \t\t,item.i_category  order by       sum(ss_ext_sales_price) desc,dt.d_year  \t\t,item.i_category_id  \t\t,item.i_category  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_item_sk", "i_category", "i_category_id"]}, "group_by": {}, "order_by": {"item": ["i_category", "i_category_id"]}}
{"id": 43, "query_string": " select top (100) s_store_name, s_store_id,         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales  from date_dim, store_sales, store  where d_date_sk = ss_sold_date_sk and        s_store_sk = ss_store_sk and        s_gmt_offset = -5 and        d_year = 1998   group by s_store_name, s_store_id  order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales  ;", "predicates": {"date_dim": ["d_year"], "store": ["s_gmt_offset"]}, "payload": {"date_dim": ["d_date_sk", "d_day_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 44, "query_string": " select top (100) asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing from(select *      from (select item_sk,rank() over (order by rank_col asc) rnk            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col                   from store_sales ss1                  where ss_store_sk = 3                  group by ss_item_sk                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col                                                   from store_sales                                                   where ss_store_sk = 3                                                     and ss_promo_sk is null                                                   group by ss_store_sk))V1)V11      where rnk  < 11) asceding,     (select *      from (select item_sk,rank() over (order by rank_col desc) rnk            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col                  from store_sales ss1                  where ss_store_sk = 3                  group by ss_item_sk                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col                                                   from store_sales                                                   where ss_store_sk = 3                                                     and ss_promo_sk is null                                                   group by ss_store_sk))V2)V21      where rnk  < 11) descending, item i1, item i2 where asceding.rnk = descending.rnk    and i1.i_item_sk=asceding.item_sk   and i2.i_item_sk=descending.item_sk order by asceding.rnk;", "predicates": {"store_sales": ["ss_store_sk", "ss_customer_sk"]}, "payload": {"store_sales": ["ss_net_profit", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 45, "query_string": " select top (100) ca_zip, ca_county, sum(ws_sales_price)  from web_sales, customer, customer_address, date_dim, item  where ws_bill_customer_sk = c_customer_sk  \tand c_current_addr_sk = ca_address_sk   \tand ws_item_sk = i_item_sk   \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')  \t      or   \t      i_item_id in (select i_item_id                              from item                              where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)                              )  \t    )  \tand ws_sold_date_sk = d_date_sk  \tand d_qoy = 2 and d_year = 2002  group by ca_zip, ca_county  order by ca_zip, ca_county  ;", "predicates": {"customer_address": ["ca_zip"], "date_dim": ["d_qoy", "d_year"], "item": ["i_item_id"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip", "ca_city"], "date_dim": ["d_date_sk"], "web_sales": ["ws_sales_price", "ws_sold_date_sk", "ws_bill_customer_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 46, "query_string": " select top (100) c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,ca_city bought_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics,customer_address      where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and (household_demographics.hd_dep_count = 8 or          household_demographics.hd_vehicle_count= 4)     and date_dim.d_dow in (6,0)     and date_dim.d_year in (2000,2000+1,2000+2)      and store.s_city in ('Fairview','Midway','Midway','Fairview','Fairview')      group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr     where ss_customer_sk = c_customer_sk       and customer.c_current_addr_sk = current_addr.ca_address_sk       and current_addr.ca_city <> bought_city   order by c_last_name           ,c_first_name           ,ca_city           ,bought_city           ,ss_ticket_number   ;", "predicates": {"date_dim": ["d_dow", "d_year"], "household_demographics": ["hd_vehicle_count", "hd_dep_count"], "store": ["s_city"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk", "c_first_name", "c_last_name"], "customer_address": ["ca_city", "ca_address_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_addr_sk", "ss_coupon_amt", "ss_customer_sk", "ss_hdemo_sk", "ss_net_profit", "ss_sold_date_sk", "ss_store_sk", "ss_ticket_number"]}, "group_by": {}, "order_by": {}}
{"id": 47, "query_string": " with v1 as(  select i_category, i_brand,         s_store_name, s_company_name,         d_year, d_moy,         sum(ss_sales_price) sum_sales,         avg(sum(ss_sales_price)) over           (partition by i_category, i_brand,                      s_store_name, s_company_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      s_store_name, s_company_name            order by d_year, d_moy) rn  from item, store_sales, date_dim, store  where ss_item_sk = i_item_sk and        ss_sold_date_sk = d_date_sk and        ss_store_sk = s_store_sk and        (          d_year = 2000 or          ( d_year = 2000-1 and d_moy =12) or          ( d_year = 2000+1 and d_moy =1)        )  group by i_category, i_brand,           s_store_name, s_company_name,           d_year, d_moy),  v2 as(  select v1.i_brand         ,v1.d_year         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1.s_store_name = v1_lag.s_store_name and        v1.s_store_name = v1_lead.s_store_name and        v1.s_company_name = v1_lag.s_company_name and        v1.s_company_name = v1_lead.s_company_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select top (100) *  from v2  where  d_year = 2000 and             avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, psum  ;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk", "d_moy", "d_year"], "item": ["i_brand", "i_item_sk", "i_category"], "store": ["s_store_name", "s_store_sk", "s_company_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 48, "query_string": " select sum (ss_quantity)  from store_sales, store, customer_demographics, customer_address, date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2000  and    (   (    cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'S'    and     cd_education_status = '2 yr Degree'    and     ss_sales_price between 100.00 and 150.00      )  or   (   cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'D'    and     cd_education_status = 'Unknown'    and     ss_sales_price between 50.00 and 100.00      )  or   (   cd_demo_sk = ss_cdemo_sk   and     cd_marital_status = 'W'    and     cd_education_status = 'Secondary'    and     ss_sales_price between 150.00 and 200.00    )  )  and  (   (   ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('MS', 'FL', 'VA')   and ss_net_profit between 0 and 2000     )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('NC', 'TX', 'VT')   and ss_net_profit between 150 and 3000    )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('TN', 'AR', 'MN')   and ss_net_profit between 50 and 25000    )  );", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "store_sales": ["ss_sales_price", "ss_net_profit"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_cdemo_sk", "ss_addr_sk", "ss_quantity", "ss_sales_price", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 49, "query_string": " select top (100) channel, item, return_ratio, return_rank, currency_rank from  (select  'web' as channel  ,web.item  ,web.return_ratio  ,web.return_rank  ,web.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect ws.ws_item_sk as item  \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\t web_sales ws left outer join web_returns wr   \t\t\ton (ws.ws_order_number = wr.wr_order_number and   \t\t\tws.ws_item_sk = wr.wr_item_sk)                  ,date_dim  \t\twhere   \t\t\twr.wr_return_amt > 10000   \t\t\tand ws.ws_net_profit > 1                          and ws.ws_net_paid > 0                          and ws.ws_quantity > 0                          and ws_sold_date_sk = d_date_sk                          and d_year = 2002                          and d_moy = 11  \t\tgroup by ws.ws_item_sk  \t) in_web  ) web  where   (  web.return_rank <= 10  or  web.currency_rank <= 10  )  union  select   'catalog' as channel  ,catalog.item  ,catalog.return_ratio  ,catalog.return_rank  ,catalog.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect   \t\tcs.cs_item_sk as item  \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\tcatalog_sales cs left outer join catalog_returns cr  \t\t\ton (cs.cs_order_number = cr.cr_order_number and   \t\t\tcs.cs_item_sk = cr.cr_item_sk)                 ,date_dim  \t\twhere   \t\t\tcr.cr_return_amount > 10000   \t\t\tand cs.cs_net_profit > 1                          and cs.cs_net_paid > 0                          and cs.cs_quantity > 0                          and cs_sold_date_sk = d_date_sk                          and d_year = 2002                          and d_moy = 11                  group by cs.cs_item_sk  \t) in_cat  ) catalog  where   (  catalog.return_rank <= 10  or  catalog.currency_rank <=10  )  union  select   'store' as channel  ,store.item  ,store.return_ratio  ,store.return_rank  ,store.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect sts.ss_item_sk as item  \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\tstore_sales sts left outer join store_returns sr  \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)                 ,date_dim  \t\twhere   \t\t\tsr.sr_return_amt > 10000   \t\t\tand sts.ss_net_profit > 1                          and sts.ss_net_paid > 0                           and sts.ss_quantity > 0                          and ss_sold_date_sk = d_date_sk                          and d_year = 2002                          and d_moy = 11  \t\tgroup by sts.ss_item_sk  \t) in_store  ) store  where  (  store.return_rank <= 10  or   store.currency_rank <= 10  )  ) a  order by 1,4,5,2  ;", "predicates": {"catalog_returns": ["cr_return_amount"], "catalog_sales": ["cs_net_paid", "cs_net_profit", "cs_quantity"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_return_amt"], "store_sales": ["ss_net_paid", "ss_quantity", "ss_net_profit"], "web_returns": ["wr_return_amt"], "web_sales": ["ws_net_profit", "ws_net_paid", "ws_quantity"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_quantity", "cr_return_amount"], "store_returns": ["sr_return_amt", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_return_amt", "wr_return_quantity", "wr_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 50, "query_string": " select top (100)     s_store_name   ,s_company_id   ,s_street_number   ,s_street_name   ,s_street_type   ,s_suite_number   ,s_city   ,s_county   ,s_state   ,s_zip   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and                   (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and                   (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and                  (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    store_sales   ,store_returns   ,store   ,date_dim d1   ,date_dim d2 where     d2.d_year = 2002 and d2.d_moy  = 10 and ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_sold_date_sk   = d1.d_date_sk and sr_returned_date_sk   = d2.d_date_sk and ss_customer_sk = sr_customer_sk and ss_store_sk = s_store_sk group by    s_store_name   ,s_company_id   ,s_street_number   ,s_street_name   ,s_street_type   ,s_suite_number   ,s_city   ,s_county   ,s_state   ,s_zip order by s_store_name         ,s_company_id         ,s_street_number         ,s_street_name         ,s_street_type         ,s_suite_number         ,s_city         ,s_county         ,s_state         ,s_zip;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 51, "query_string": " WITH web_v1 as ( select   ws_item_sk item_sk, d_date,   sum(sum(ws_sales_price))       over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from web_sales     ,date_dim where ws_sold_date_sk=d_date_sk   and d_month_seq between 1205 and 1205+11   and ws_item_sk is not NULL group by ws_item_sk, d_date), store_v1 as ( select   ss_item_sk item_sk, d_date,   sum(sum(ss_sales_price))       over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from store_sales     ,date_dim where ss_sold_date_sk=d_date_sk   and d_month_seq between 1205 and 1205+11   and ss_item_sk is not NULL group by ss_item_sk, d_date)  select top (100) * from (select item_sk      ,d_date      ,web_sales      ,store_sales      ,max(web_sales)          over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative      ,max(store_sales)          over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative      from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk                  ,case when web.d_date is not null then web.d_date else store.d_date end d_date                  ,web.cume_sales web_sales                  ,store.cume_sales store_sales            from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk                                                           and web.d_date = store.d_date)           )x )y where web_cumulative > store_cumulative order by item_sk         ,d_date;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_sales_price", "ss_item_sk"], "web_sales": ["ws_sold_date_sk", "ws_sales_price", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 52, "query_string": " select top (100) dt.d_year  \t,item.i_brand_id brand_id  \t,item.i_brand brand  \t,sum(ss_ext_sales_price) ext_price  from date_dim dt      ,store_sales      ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=11     and dt.d_year=1998  group by dt.d_year  \t,item.i_brand  \t,item.i_brand_id  order by dt.d_year  \t,ext_price desc  \t,brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"item": ["i_brand_id"]}}
{"id": 53, "query_string": " select top (100) * from  (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1205,1205+1,1205+2,1205+3,1205+4,1205+5,1205+6,1205+7,1205+8,1205+9,1205+10,1205+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', \t\t'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', \t\t'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0  \tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales  \telse null end > 0.1 order by avg_quarterly_sales, \t sum_sales, \t i_manufact_id;", "predicates": {"date_dim": ["d_month_seq"], "item": ["i_brand", "i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_qoy"], "item": ["i_item_sk", "i_manufact_id", "i_brand", "i_category", "i_class"], "store": ["s_store_sk"]}, "group_by": {}, "order_by": {}}
{"id": 54, "query_string": " with my_customers as (  select distinct c_customer_sk         , c_current_addr_sk  from            ( select cs_sold_date_sk sold_date_sk,                  cs_bill_customer_sk customer_sk,                  cs_item_sk item_sk           from   catalog_sales           union all           select ws_sold_date_sk sold_date_sk,                  ws_bill_customer_sk customer_sk,                  ws_item_sk item_sk           from   web_sales          ) cs_or_ws_sales,          item,          date_dim,          customer  where   sold_date_sk = d_date_sk          and item_sk = i_item_sk          and i_category = 'Children'          and i_class = 'toddlers'          and c_customer_sk = cs_or_ws_sales.customer_sk          and d_moy = 2          and d_year = 2002  )  , my_revenue as (  select c_customer_sk,         sum(ss_ext_sales_price) as revenue  from   my_customers,         store_sales,         customer_address,         store,         date_dim  where  c_current_addr_sk = ca_address_sk         and ca_county = s_county         and ca_state = s_state         and ss_sold_date_sk = d_date_sk         and c_customer_sk = ss_customer_sk         and d_month_seq between (select distinct d_month_seq+1                                  from   date_dim where d_year = 2002 and d_moy = 2)                            and  (select distinct d_month_seq+3                                  from   date_dim where d_year = 2002 and d_moy = 2)  group by c_customer_sk  )  , segments as  (select cast((revenue/50) as int) as segment   from   my_revenue  )   select top (100) segment, count(*) as num_customers, segment*50 as segment_base  from segments  group by segment  order by segment, num_customers  ;", "predicates": {"date_dim": ["d_month_seq", "d_moy", "d_year"], "item": ["i_class", "i_category"]}, "payload": {"customer_address": ["ca_address_sk", "ca_county", "ca_state"], "date_dim": ["d_date_sk", "d_month_seq"], "item": ["i_item_sk"], "store": ["s_state", "s_county"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_ext_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 55, "query_string": " select top (100) i_brand_id brand_id, i_brand brand,  \tsum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item  where d_date_sk = ss_sold_date_sk  \tand ss_item_sk = i_item_sk  \tand i_manager_id=8  \tand d_moy=12  \tand d_year=2002  group by i_brand, i_brand_id  order by ext_price desc, i_brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"item": ["i_brand_id"]}}
{"id": 56, "query_string": " with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('salmon','cyan','navy'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 3  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -7   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('salmon','cyan','navy'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 3  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -7   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('salmon','cyan','navy'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 3  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -7  group by i_item_id)   select top (100) i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  ;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_color"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 57, "query_string": " with v1 as(  select i_category, i_brand,         cc_name,         d_year, d_moy,         sum(cs_sales_price) sum_sales,         avg(sum(cs_sales_price)) over           (partition by i_category, i_brand,                      cc_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      cc_name            order by d_year, d_moy) rn  from item, catalog_sales, date_dim, call_center  where cs_item_sk = i_item_sk and        cs_sold_date_sk = d_date_sk and        cc_call_center_sk= cs_call_center_sk and        (          d_year = 2000 or          ( d_year = 2000-1 and d_moy =12) or          ( d_year = 2000+1 and d_moy =1)        )  group by i_category, i_brand,           cc_name , d_year, d_moy),  v2 as(  select v1.i_category, v1.i_brand         ,v1.d_year         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1. cc_name = v1_lag. cc_name and        v1. cc_name = v1_lead. cc_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select top (100) *  from v2  where  d_year = 2000 and         avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, psum  ;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"call_center": ["cc_name", "cc_call_center_sk"], "catalog_sales": ["cs_sales_price", "cs_sold_date_sk", "cs_call_center_sk", "cs_item_sk"], "date_dim": ["d_date_sk", "d_moy", "d_year"], "item": ["i_brand", "i_item_sk", "i_category"]}, "group_by": {}, "order_by": {}}
{"id": 58, "query_string": " with ss_items as  (select i_item_id item_id         ,sum(ss_ext_sales_price) ss_item_rev   from store_sales      ,item      ,date_dim  where ss_item_sk = i_item_sk    and d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '1998-01-23'))    and ss_sold_date_sk   = d_date_sk  group by i_item_id),  cs_items as  (select i_item_id item_id         ,sum(cs_ext_sales_price) cs_item_rev   from catalog_sales       ,item       ,date_dim  where cs_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '1998-01-23'))   and  cs_sold_date_sk = d_date_sk  group by i_item_id),  ws_items as  (select i_item_id item_id         ,sum(ws_ext_sales_price) ws_item_rev   from web_sales       ,item       ,date_dim  where ws_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq =(select d_week_seq                                       from date_dim                                      where d_date = '1998-01-23'))   and ws_sold_date_sk   = d_date_sk  group by i_item_id)   select top (100) ss_items.item_id        ,ss_item_rev        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev        ,cs_item_rev        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev        ,ws_item_rev        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average  from ss_items,cs_items,ws_items  where ss_items.item_id=cs_items.item_id    and ss_items.item_id=ws_items.item_id     and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  order by item_id          ,ss_item_rev  ;", "predicates": {"date_dim": ["d_week_seq", "d_date"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_item_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "item": ["i_item_id", "i_item_sk"], "store_sales": ["ss_sold_date_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 59, "query_string": " with wss as   (select d_week_seq,         ss_store_sk,         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales  from store_sales,date_dim  where d_date_sk = ss_sold_date_sk  group by d_week_seq,ss_store_sk  )   select top (100) s_store_name1,s_store_id1,d_week_seq1        ,sun_sales1/sun_sales2,mon_sales1/mon_sales2        ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2        ,fri_sales1/fri_sales2,sat_sales1/sat_sales2  from  (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1         ,s_store_id s_store_id1,sun_sales sun_sales1         ,mon_sales mon_sales1,tue_sales tue_sales1         ,wed_sales wed_sales1,thu_sales thu_sales1         ,fri_sales fri_sales1,sat_sales sat_sales1   from wss,store,date_dim d   where d.d_week_seq = wss.d_week_seq and         ss_store_sk = s_store_sk and          d_month_seq between 1203 and 1203 + 11) y,  (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2         ,s_store_id s_store_id2,sun_sales sun_sales2         ,mon_sales mon_sales2,tue_sales tue_sales2         ,wed_sales wed_sales2,thu_sales thu_sales2         ,fri_sales fri_sales2,sat_sales sat_sales2   from wss,store,date_dim d   where d.d_week_seq = wss.d_week_seq and         ss_store_sk = s_store_sk and          d_month_seq between 1203+ 12 and 1203 + 23) x  where s_store_id1=s_store_id2    and d_week_seq1=d_week_seq2-52  order by s_store_name1,s_store_id1,d_week_seq1;", "predicates": {"date_dim": ["d_month_seq"], "store": ["s_store_id"]}, "payload": {"date_dim": ["d_date_sk", "d_week_seq", "d_day_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 60, "query_string": " with ss as (  select           i_item_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where          i_item_id in (select   i_item_id from  item where i_category in ('Music'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 9  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  cs as (  select           i_item_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Music'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 9  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  ws as (  select           i_item_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Music'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 9  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_item_id)   select top (100)     i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by i_item_id       ,total_sales  ;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_item_id", "i_category"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 61, "query_string": " select top (100) promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from   (select sum(ss_ext_sales_price) promotions    from  store_sales         ,store         ,promotion         ,date_dim         ,customer         ,customer_address          ,item    where ss_sold_date_sk = d_date_sk    and   ss_store_sk = s_store_sk    and   ss_promo_sk = p_promo_sk    and   ss_customer_sk= c_customer_sk    and   ca_address_sk = c_current_addr_sk    and   ss_item_sk = i_item_sk     and   ca_gmt_offset = -6    and   i_category = 'Electronics'    and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')    and   s_gmt_offset = -6    and   d_year = 2002    and   d_moy  = 12) promotional_sales,   (select sum(ss_ext_sales_price) total    from  store_sales         ,store         ,date_dim         ,customer         ,customer_address         ,item    where ss_sold_date_sk = d_date_sk    and   ss_store_sk = s_store_sk    and   ss_customer_sk= c_customer_sk    and   ca_address_sk = c_current_addr_sk    and   ss_item_sk = i_item_sk    and   ca_gmt_offset = -6    and   i_category = 'Electronics'    and   s_gmt_offset = -6    and   d_year = 2002    and   d_moy  = 12) all_sales order by promotions, total;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_category"], "promotion": ["p_channel_dmail", "p_channel_email", "p_channel_tv"], "store": ["s_gmt_offset"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_promo_sk", "ss_item_sk", "ss_ext_sales_price", "ss_customer_sk", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 62, "query_string": " select top (100)     substring(w_warehouse_name,1,20)   ,sm_type   ,web_name   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and                   (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and                   (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and                  (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    web_sales   ,warehouse   ,ship_mode   ,web_site   ,date_dim where     d_month_seq between 1205 and 1205 + 11 and ws_ship_date_sk   = d_date_sk and ws_warehouse_sk   = w_warehouse_sk and ws_ship_mode_sk   = sm_ship_mode_sk and ws_web_site_sk    = web_site_sk group by    substring(w_warehouse_name,1,20)   ,sm_type   ,web_name order by substring(w_warehouse_name,1,20)         ,sm_type        ,web_name;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "ship_mode": ["sm_type", "sm_ship_mode_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"], "web_sales": ["ws_ship_date_sk", "ws_ship_mode_sk", "ws_sold_date_sk", "ws_warehouse_sk", "ws_web_site_sk"], "web_site": ["web_name", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 63, "query_string": " select top (100) *  from (select i_manager_id              ,sum(ss_sales_price) sum_sales              ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales       from item           ,store_sales           ,date_dim           ,store       where ss_item_sk = i_item_sk         and ss_sold_date_sk = d_date_sk         and ss_store_sk = s_store_sk         and d_month_seq in (1205,1205+1,1205+2,1205+3,1205+4,1205+5,1205+6,1205+7,1205+8,1205+9,1205+10,1205+11)         and ((    i_category in ('Books','Children','Electronics')               and i_class in ('personal','portable','reference','self-help')               and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', \t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))            or(    i_category in ('Women','Music','Men')               and i_class in ('accessories','classical','fragrances','pants')               and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', \t\t                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id         ,avg_monthly_sales         ,sum_sales;", "predicates": {"date_dim": ["d_month_seq"], "item": ["i_brand", "i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_item_sk", "i_manager_id", "i_brand", "i_category", "i_class"], "store": ["s_store_sk"]}, "group_by": {}, "order_by": {"item": ["i_manager_id"]}}
{"id": 64, "query_string": " with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('thistle','hot','antique','deep','red','linen') and          i_current_price between 56 and 56 + 10 and          i_current_price between 56 + 1 and 56 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;", "predicates": {"customer_demographics": ["cd_marital_status"], "date_dim": ["d_year"], "item": ["i_color", "i_current_price"], "store": ["s_zip", "s_store_name"]}, "payload": {"household_demographics": ["hd_income_band_sk", "hd_demo_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 65, "query_string": " select top (100) \ts_store_name, \ti_item_desc, \tsc.revenue, \ti_current_price, \ti_wholesale_cost, \ti_brand  from store, item,      (select ss_store_sk, avg(revenue) as ave  \tfrom  \t    (select  ss_store_sk, ss_item_sk,   \t\t     sum(ss_sales_price) as revenue  \t\tfrom store_sales, date_dim  \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1205 and 1205+11  \t\tgroup by ss_store_sk, ss_item_sk) sa  \tgroup by ss_store_sk) sb,      (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue  \tfrom store_sales, date_dim  \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1205 and 1205+11  \tgroup by ss_store_sk, ss_item_sk) sc  where sb.ss_store_sk = sc.ss_store_sk and         sc.revenue <= 0.1 * sb.ave and        s_store_sk = sc.ss_store_sk and        i_item_sk = sc.ss_item_sk  order by s_store_name, i_item_desc;", "predicates": {"date_dim": ["d_month_seq"], "store_sales": ["ss_store_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_brand", "i_wholesale_cost", "i_item_desc"], "store": ["s_store_name", "s_store_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price", "ss_item_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_desc"], "store": ["s_store_name"]}}
{"id": 66, "query_string": " select top (100)            w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country         ,ship_carriers         ,year  \t,sum(jan_sales) as jan_sales  \t,sum(feb_sales) as feb_sales  \t,sum(mar_sales) as mar_sales  \t,sum(apr_sales) as apr_sales  \t,sum(may_sales) as may_sales  \t,sum(jun_sales) as jun_sales  \t,sum(jul_sales) as jul_sales  \t,sum(aug_sales) as aug_sales  \t,sum(sep_sales) as sep_sales  \t,sum(oct_sales) as oct_sales  \t,sum(nov_sales) as nov_sales  \t,sum(dec_sales) as dec_sales  \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot  \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot  \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot  \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot  \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot  \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot  \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot  \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot  \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot  \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot  \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot  \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot  \t,sum(jan_net) as jan_net  \t,sum(feb_net) as feb_net  \t,sum(mar_net) as mar_net  \t,sum(apr_net) as apr_net  \t,sum(may_net) as may_net  \t,sum(jun_net) as jun_net  \t,sum(jul_net) as jul_net  \t,sum(aug_net) as aug_net  \t,sum(sep_net) as sep_net  \t,sum(oct_net) as oct_net  \t,sum(nov_net) as nov_net  \t,sum(dec_net) as dec_net  from (      select   \tw_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,concat('TBS' , ',' , 'FEDEX') as ship_carriers        ,d_year as year  \t,sum(case when d_moy = 1   \t\tthen ws_sales_price* ws_quantity else 0 end) as jan_sales  \t,sum(case when d_moy = 2   \t\tthen ws_sales_price* ws_quantity else 0 end) as feb_sales  \t,sum(case when d_moy = 3   \t\tthen ws_sales_price* ws_quantity else 0 end) as mar_sales  \t,sum(case when d_moy = 4   \t\tthen ws_sales_price* ws_quantity else 0 end) as apr_sales  \t,sum(case when d_moy = 5   \t\tthen ws_sales_price* ws_quantity else 0 end) as may_sales  \t,sum(case when d_moy = 6   \t\tthen ws_sales_price* ws_quantity else 0 end) as jun_sales  \t,sum(case when d_moy = 7   \t\tthen ws_sales_price* ws_quantity else 0 end) as jul_sales  \t,sum(case when d_moy = 8   \t\tthen ws_sales_price* ws_quantity else 0 end) as aug_sales  \t,sum(case when d_moy = 9   \t\tthen ws_sales_price* ws_quantity else 0 end) as sep_sales  \t,sum(case when d_moy = 10   \t\tthen ws_sales_price* ws_quantity else 0 end) as oct_sales  \t,sum(case when d_moy = 11  \t\tthen ws_sales_price* ws_quantity else 0 end) as nov_sales  \t,sum(case when d_moy = 12  \t\tthen ws_sales_price* ws_quantity else 0 end) as dec_sales  \t,sum(case when d_moy = 1   \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as jan_net  \t,sum(case when d_moy = 2  \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as feb_net  \t,sum(case when d_moy = 3   \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as mar_net  \t,sum(case when d_moy = 4   \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as apr_net  \t,sum(case when d_moy = 5   \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as may_net  \t,sum(case when d_moy = 6   \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as jun_net  \t,sum(case when d_moy = 7   \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as jul_net  \t,sum(case when d_moy = 8   \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as aug_net  \t,sum(case when d_moy = 9   \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as sep_net  \t,sum(case when d_moy = 10   \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as oct_net  \t,sum(case when d_moy = 11  \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as nov_net  \t,sum(case when d_moy = 12  \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as dec_net      from           web_sales          ,warehouse          ,date_dim          ,time_dim  \t  ,ship_mode      where             ws_warehouse_sk =  w_warehouse_sk         and ws_sold_date_sk = d_date_sk         and ws_sold_time_sk = t_time_sk  \tand ws_ship_mode_sk = sm_ship_mode_sk         and d_year = 1998  \tand t_time between 10508 and 10508+28800   \tand sm_carrier in ('TBS','FEDEX')      group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country        ,d_year  union all      select   \tw_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,concat('TBS', ',', 'FEDEX') as ship_carriers        ,d_year as year  \t,sum(case when d_moy = 1   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jan_sales  \t,sum(case when d_moy = 2   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as feb_sales  \t,sum(case when d_moy = 3   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as mar_sales  \t,sum(case when d_moy = 4   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as apr_sales  \t,sum(case when d_moy = 5   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as may_sales  \t,sum(case when d_moy = 6   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jun_sales  \t,sum(case when d_moy = 7   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jul_sales  \t,sum(case when d_moy = 8   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as aug_sales  \t,sum(case when d_moy = 9   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as sep_sales  \t,sum(case when d_moy = 10   \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as oct_sales  \t,sum(case when d_moy = 11  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as nov_sales  \t,sum(case when d_moy = 12  \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as dec_sales  \t,sum(case when d_moy = 1   \t\tthen cs_net_paid * cs_quantity else 0 end) as jan_net  \t,sum(case when d_moy = 2   \t\tthen cs_net_paid * cs_quantity else 0 end) as feb_net  \t,sum(case when d_moy = 3   \t\tthen cs_net_paid * cs_quantity else 0 end) as mar_net  \t,sum(case when d_moy = 4   \t\tthen cs_net_paid * cs_quantity else 0 end) as apr_net  \t,sum(case when d_moy = 5   \t\tthen cs_net_paid * cs_quantity else 0 end) as may_net  \t,sum(case when d_moy = 6   \t\tthen cs_net_paid * cs_quantity else 0 end) as jun_net  \t,sum(case when d_moy = 7   \t\tthen cs_net_paid * cs_quantity else 0 end) as jul_net  \t,sum(case when d_moy = 8   \t\tthen cs_net_paid * cs_quantity else 0 end) as aug_net  \t,sum(case when d_moy = 9   \t\tthen cs_net_paid * cs_quantity else 0 end) as sep_net  \t,sum(case when d_moy = 10   \t\tthen cs_net_paid * cs_quantity else 0 end) as oct_net  \t,sum(case when d_moy = 11  \t\tthen cs_net_paid * cs_quantity else 0 end) as nov_net  \t,sum(case when d_moy = 12  \t\tthen cs_net_paid * cs_quantity else 0 end) as dec_net      from           catalog_sales          ,warehouse          ,date_dim          ,time_dim  \t ,ship_mode      where             cs_warehouse_sk =  w_warehouse_sk         and cs_sold_date_sk = d_date_sk         and cs_sold_time_sk = t_time_sk  \tand cs_ship_mode_sk = sm_ship_mode_sk         and d_year = 1998  \tand t_time between 10508 AND 10508+28800   \tand sm_carrier in ('TBS','FEDEX')      group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country        ,d_year  ) x  group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,ship_carriers        ,year  order by w_warehouse_name  ;", "predicates": {"date_dim": ["d_year"], "ship_mode": ["sm_carrier"], "time_dim": ["t_time"]}, "payload": {"catalog_sales": ["cs_warehouse_sk", "cs_ext_list_price", "cs_quantity", "cs_net_paid_inc_tax", "cs_ship_mode_sk", "cs_sold_date_sk", "cs_sold_time_sk"], "date_dim": ["d_date_sk", "d_moy", "d_year"], "ship_mode": ["sm_ship_mode_sk"], "time_dim": ["t_time_sk"], "web_sales": ["ws_ship_mode_sk", "ws_ext_list_price", "ws_sold_date_sk", "ws_quantity", "ws_sold_time_sk", "ws_warehouse_sk", "ws_net_paid"]}, "group_by": {}, "order_by": {}}
{"id": 67, "query_string": " select top (100) * from (select i_category             ,i_class             ,i_brand             ,i_product_name             ,d_year             ,d_qoy             ,d_moy             ,s_store_id             ,sumsales             ,rank() over (partition by i_category order by sumsales desc) rk       from (select i_category                   ,i_class                   ,i_brand                   ,i_product_name                   ,d_year                   ,d_qoy                   ,d_moy                   ,s_store_id                   ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales             from store_sales                 ,date_dim                 ,store                 ,item        where  ss_sold_date_sk=d_date_sk           and ss_item_sk=i_item_sk           and ss_store_sk = s_store_sk           and d_month_seq between 1205 and 1205+11        group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 order by i_category         ,i_class         ,i_brand         ,i_product_name         ,d_year         ,d_qoy         ,d_moy         ,s_store_id         ,sumsales         ,rk;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk", "d_moy", "d_qoy", "d_year"], "item": ["i_item_sk", "i_brand", "i_product_name", "i_category", "i_class"], "store": ["s_store_sk", "s_store_id"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_sales_price", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {"date_dim": ["d_moy", "d_qoy", "d_year"], "item": ["i_brand", "i_class", "i_product_name", "i_category"], "store": ["s_store_id"]}}
{"id": 68, "query_string": " select top (100) c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,extended_price        ,extended_tax        ,list_price  from (select ss_ticket_number              ,ss_customer_sk              ,ca_city bought_city              ,sum(ss_ext_sales_price) extended_price               ,sum(ss_ext_list_price) list_price              ,sum(ss_ext_tax) extended_tax         from store_sales            ,date_dim            ,store            ,household_demographics            ,customer_address         where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_store_sk = store.s_store_sk           and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk         and store_sales.ss_addr_sk = customer_address.ca_address_sk         and date_dim.d_dom between 1 and 2          and (household_demographics.hd_dep_count = 1 or              household_demographics.hd_vehicle_count= 1)         and date_dim.d_year in (2000,2000+1,2000+2)         and store.s_city in ('Fairview','Midway')        group by ss_ticket_number                ,ss_customer_sk                ,ss_addr_sk,ca_city) dn       ,customer       ,customer_address current_addr  where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name          ,ss_ticket_number  ;", "predicates": {"customer_address": ["ca_city"], "date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_city"]}, "payload": {"customer": ["c_current_addr_sk", "c_first_name", "c_last_name", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_city"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_ext_sales_price", "ss_addr_sk", "ss_customer_sk", "ss_ticket_number", "ss_ext_list_price", "ss_ext_tax", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 69, "query_string": " select top (100)    cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_state in ('TX','LA','SD') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2003 and                 d_moy between 1 and 1+2) and    (not exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2003 and                   d_moy between 1 and 1+2) and     not exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2003 and                   d_moy between 1 and 1+2))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  ;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 70, "query_string": " select top (100)      sum(ss_net_profit) as total_sum    ,s_state    ,s_county    ,grouping(s_state)+grouping(s_county) as lochierarchy    ,rank() over (  \tpartition by grouping(s_state)+grouping(s_county),  \tcase when grouping(s_county) = 0 then s_state end   \torder by sum(ss_net_profit) desc) as rank_within_parent  from     store_sales    ,date_dim       d1    ,store  where     d1.d_month_seq between 1205 and 1205+11  and d1.d_date_sk = ss_sold_date_sk  and s_store_sk  = ss_store_sk  and s_state in              ( select s_state                from  (select s_state as s_state,  \t\t\t    rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking                       from   store_sales, store, date_dim                       where  d_month_seq between 1205 and 1205+11  \t\t\t    and d_date_sk = ss_sold_date_sk  \t\t\t    and s_store_sk  = ss_store_sk                       group by s_state                      ) tmp1                 where ranking <= 5              )  group by rollup(s_state,s_county)  order by    lochierarchy desc   ,case when (grouping(s_state)+grouping(s_county)) = 0 then s_state end   ,rank_within_parent  ;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 71, "query_string": " select i_brand_id brand_id, i_brand brand,t_hour,t_minute,  \tsum(ext_price) ext_price  from item, (select ws_ext_sales_price as ext_price,                          ws_sold_date_sk as sold_date_sk,                         ws_item_sk as sold_item_sk,                         ws_sold_time_sk as time_sk                    from web_sales,date_dim                  where d_date_sk = ws_sold_date_sk                    and d_moy=11                    and d_year=2002                  union all                  select cs_ext_sales_price as ext_price,                         cs_sold_date_sk as sold_date_sk,                         cs_item_sk as sold_item_sk,                         cs_sold_time_sk as time_sk                  from catalog_sales,date_dim                  where d_date_sk = cs_sold_date_sk                    and d_moy=11                    and d_year=2002                  union all                  select ss_ext_sales_price as ext_price,                         ss_sold_date_sk as sold_date_sk,                         ss_item_sk as sold_item_sk,                         ss_sold_time_sk as time_sk                  from store_sales,date_dim                  where d_date_sk = ss_sold_date_sk                    and d_moy=11                    and d_year=2002                  ) tmp,time_dim  where    sold_item_sk = i_item_sk    and i_manager_id=1    and time_sk = t_time_sk    and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')  group by i_brand, i_brand_id,t_hour,t_minute  order by ext_price desc, i_brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"], "time_dim": ["t_meal_time"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_brand", "i_item_sk", "i_brand_id"], "time_dim": ["t_hour", "t_minute", "t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 72, "query_string": " select top (100) i_item_desc       ,w_warehouse_name       ,d1.d_week_seq       ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo       ,sum(case when p_promo_sk is not null then 1 else 0 end) promo       ,count(*) total_cnt from catalog_sales join inventory on (cs_item_sk = inv_item_sk) join warehouse on (w_warehouse_sk=inv_warehouse_sk) join item on (i_item_sk = cs_item_sk) join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk) join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk) join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk) join date_dim d2 on (inv_date_sk = d2.d_date_sk) join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk) left outer join promotion on (cs_promo_sk=p_promo_sk) left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number) where d1.d_week_seq = d2.d_week_seq   and inv_quantity_on_hand < cs_quantity    and d3.d_date > dateadd(day, 5, d1.d_date)   and hd_buy_potential = '501-1000'   and d1.d_year = 2002   and cd_marital_status = 'D' group by i_item_desc,w_warehouse_name,d1.d_week_seq order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq;", "predicates": {"customer_demographics": ["cd_marital_status"], "date_dim": ["d_date", "d_year"], "household_demographics": ["hd_buy_potential"], "inventory": ["inv_warehouse_sk"], "warehouse": ["w_warehouse_sk"]}, "payload": {"catalog_sales": ["cs_quantity", "cs_promo_sk", "cs_item_sk", "cs_ship_date_sk", "cs_bill_cdemo_sk", "cs_sold_date_sk", "cs_bill_hdemo_sk"], "customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "household_demographics": ["hd_demo_sk"], "item": ["i_item_sk", "i_item_desc"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {"date_dim": ["d_week_seq"], "item": ["i_item_desc"], "warehouse": ["w_warehouse_name"]}}
{"id": 73, "query_string": " select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = 'Unknown')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;", "predicates": {"date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count", "hd_buy_potential"], "store": ["s_county"]}, "payload": {"customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_preferred_cust_flag"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 74, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,d_year as year        ,stdev(ss_net_paid) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk    and d_year in (2001,2001+1)  group by c_customer_id          ,c_first_name          ,c_last_name          ,d_year  union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,d_year as year        ,stdev(ws_net_paid) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk    and d_year in (2001,2001+1)  group by c_customer_id          ,c_first_name          ,c_last_name          ,d_year          )   select top (100)         t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id          and t_s_firstyear.customer_id = t_w_secyear.customer_id          and t_s_firstyear.customer_id = t_w_firstyear.customer_id          and t_s_firstyear.sale_type = 's'          and t_w_firstyear.sale_type = 'w'          and t_s_secyear.sale_type = 's'          and t_w_secyear.sale_type = 'w'          and t_s_firstyear.year = 2001          and t_s_secyear.year = 2001+1          and t_w_firstyear.year = 2001          and t_w_secyear.year = 2001+1          and t_s_firstyear.year_total > 0          and t_w_firstyear.year_total > 0          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end  order by 1,2,3;", "predicates": {"date_dim": ["d_year"]}, "payload": {"customer": ["c_customer_id", "c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_net_paid"], "web_sales": ["ws_net_paid", "ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_customer_id", "c_last_name", "c_first_name"]}}
{"id": 75, "query_string": " WITH all_sales AS (  SELECT d_year        ,i_brand_id        ,i_class_id        ,i_category_id        ,i_manufact_id        ,SUM(sales_cnt) AS sales_cnt        ,SUM(sales_amt) AS sales_amt  FROM (SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt              ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt        FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk                           JOIN date_dim ON d_date_sk=cs_sold_date_sk                           LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number                                                      AND cs_item_sk=cr_item_sk)        WHERE i_category='Music'        UNION        SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt              ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt        FROM store_sales JOIN item ON i_item_sk=ss_item_sk                         JOIN date_dim ON d_date_sk=ss_sold_date_sk                         LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number                                                  AND ss_item_sk=sr_item_sk)        WHERE i_category='Music'        UNION        SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt              ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt        FROM web_sales JOIN item ON i_item_sk=ws_item_sk                       JOIN date_dim ON d_date_sk=ws_sold_date_sk                       LEFT JOIN web_returns ON (ws_order_number=wr_order_number                                              AND ws_item_sk=wr_item_sk)        WHERE i_category='Music') sales_detail  GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)  SELECT top (100) prev_yr.d_year AS prev_year                           ,curr_yr.d_year AS year                           ,curr_yr.i_brand_id                           ,curr_yr.i_class_id                           ,curr_yr.i_category_id                           ,curr_yr.i_manufact_id                           ,prev_yr.sales_cnt AS prev_yr_cnt                           ,curr_yr.sales_cnt AS curr_yr_cnt                           ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff                           ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff  FROM all_sales curr_yr, all_sales prev_yr  WHERE curr_yr.i_brand_id=prev_yr.i_brand_id    AND curr_yr.i_class_id=prev_yr.i_class_id    AND curr_yr.i_category_id=prev_yr.i_category_id    AND curr_yr.i_manufact_id=prev_yr.i_manufact_id    AND curr_yr.d_year=2001    AND prev_yr.d_year=2001-1    AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9  ORDER BY sales_cnt_diff,sales_amt_diff  ;", "predicates": {"date_dim": ["d_year"], "item": ["i_category"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_quantity", "cr_return_amount"], "date_dim": ["d_date_sk", "d_year"], "item": ["i_class_id", "i_item_sk", "i_category_id", "i_brand_id", "i_manufact_id"], "store_returns": ["sr_return_amt", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_return_amt", "wr_return_quantity", "wr_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 76, "query_string": " select top (100) channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (         SELECT 'store' as channel, 'ss_promo_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price          FROM store_sales, item, date_dim          WHERE ss_promo_sk IS NULL            AND ss_sold_date_sk=d_date_sk            AND ss_item_sk=i_item_sk         UNION ALL         SELECT 'web' as channel, 'ws_web_page_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price          FROM web_sales, item, date_dim          WHERE ws_web_page_sk IS NULL            AND ws_sold_date_sk=d_date_sk            AND ws_item_sk=i_item_sk         UNION ALL         SELECT 'catalog' as channel, 'cs_ship_cdemo_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price          FROM catalog_sales, item, date_dim          WHERE cs_ship_cdemo_sk IS NULL            AND cs_sold_date_sk=d_date_sk            AND cs_item_sk=i_item_sk) foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category;", "predicates": {"catalog_sales": ["cs_ship_addr_sk"], "store_sales": ["ss_promo_sk"], "web_sales": ["ws_promo_sk"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_item_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_qoy", "d_year"], "item": ["i_item_sk", "i_category"], "store_sales": ["ss_sold_date_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 77, "query_string": " with ss as  (select s_store_sk,          sum(ss_ext_sales_price) as sales,          sum(ss_net_profit) as profit  from store_sales,       date_dim,       store  where ss_sold_date_sk = d_date_sk        and d_date between cast('1998-08-13' as date)                    and dateadd(day, 30, cast('1998-08-13' as date))         and ss_store_sk = s_store_sk  group by s_store_sk)  ,  sr as  (select s_store_sk,          sum(sr_return_amt) as returns,          sum(sr_net_loss) as profit_loss  from store_returns,       date_dim,       store  where sr_returned_date_sk = d_date_sk        and d_date between cast('1998-08-13' as date)                   and dateadd(day, 30, cast('1998-08-13' as date))        and sr_store_sk = s_store_sk  group by s_store_sk),   cs as  (select cs_call_center_sk,         sum(cs_ext_sales_price) as sales,         sum(cs_net_profit) as profit  from catalog_sales,       date_dim  where cs_sold_date_sk = d_date_sk        and d_date between cast('1998-08-13' as date)                   and dateadd(day, 30, cast('1998-08-13' as date))  group by cs_call_center_sk   ),   cr as  (select cr_call_center_sk,          sum(cr_return_amount) as returns,          sum(cr_net_loss) as profit_loss  from catalog_returns,       date_dim  where cr_returned_date_sk = d_date_sk        and d_date between cast('1998-08-13' as date)                   and dateadd(day, 30, cast('1998-08-13' as date))  group by cr_call_center_sk  ),   ws as  ( select wp_web_page_sk,         sum(ws_ext_sales_price) as sales,         sum(ws_net_profit) as profit  from web_sales,       date_dim,       web_page  where ws_sold_date_sk = d_date_sk        and d_date between cast('1998-08-13' as date)                   and dateadd(day, 30, cast('1998-08-13' as date))        and ws_web_page_sk = wp_web_page_sk  group by wp_web_page_sk),   wr as  (select wp_web_page_sk,         sum(wr_return_amt) as returns,         sum(wr_net_loss) as profit_loss  from web_returns,       date_dim,       web_page  where wr_returned_date_sk = d_date_sk        and d_date between cast('1998-08-13' as date)                   and dateadd(day, 30, cast('1998-08-13' as date))        and wr_web_page_sk = wp_web_page_sk  group by wp_web_page_sk)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , ss.s_store_sk as id         , sales         , coalesce(returns, 0) as returns         , (profit - coalesce(profit_loss,0)) as profit  from   ss left join sr         on  ss.s_store_sk = sr.s_store_sk  union all  select 'catalog channel' as channel         , cs_call_center_sk as id         , sales         , returns         , (profit - profit_loss) as profit  from  cs        , cr  union all  select 'web channel' as channel         , ws.wp_web_page_sk as id         , sales         , coalesce(returns, 0) returns         , (profit - coalesce(profit_loss,0)) as profit  from   ws left join wr         on  ws.wp_web_page_sk = wr.wp_web_page_sk  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_return_amount", "cr_call_center_sk"], "catalog_sales": ["cs_net_profit", "cs_sold_date_sk", "cs_call_center_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_net_loss"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit", "ss_ext_sales_price"], "web_page": ["wp_web_page_sk"], "web_returns": ["wr_web_page_sk", "wr_returned_date_sk", "wr_return_amt", "wr_net_loss"], "web_sales": ["ws_net_profit", "ws_ext_sales_price", "ws_web_page_sk", "ws_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 78, "query_string": " with ws as   (select d_year AS ws_sold_year, ws_item_sk,     ws_bill_customer_sk ws_customer_sk,     sum(ws_quantity) ws_qty,     sum(ws_wholesale_cost) ws_wc,     sum(ws_sales_price) ws_sp    from web_sales    left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk    join date_dim on ws_sold_date_sk = d_date_sk    where wr_order_number is null    group by d_year, ws_item_sk, ws_bill_customer_sk    ), cs as   (select d_year AS cs_sold_year, cs_item_sk,     cs_bill_customer_sk cs_customer_sk,     sum(cs_quantity) cs_qty,     sum(cs_wholesale_cost) cs_wc,     sum(cs_sales_price) cs_sp    from catalog_sales    left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk    join date_dim on cs_sold_date_sk = d_date_sk    where cr_order_number is null    group by d_year, cs_item_sk, cs_bill_customer_sk    ), ss as   (select d_year AS ss_sold_year, ss_item_sk,     ss_customer_sk,     sum(ss_quantity) ss_qty,     sum(ss_wholesale_cost) ss_wc,     sum(ss_sales_price) ss_sp    from store_sales    left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk    join date_dim on ss_sold_date_sk = d_date_sk    where sr_ticket_number is null    group by d_year, ss_item_sk, ss_customer_sk    )  select top (100) ss_customer_sk, round(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk) where (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2002 order by    ss_customer_sk,   ss_qty desc, ss_wc desc, ss_sp desc,   other_chan_qty,   other_chan_wholesale_cost,   other_chan_sales_price,   ratio;", "predicates": {"catalog_returns": ["cr_order_number"], "catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_year"], "store_returns": ["sr_ticket_number"], "store_sales": ["ss_customer_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_bill_customer_sk"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "store_returns": ["sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_item_sk", "ss_sales_price", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_wholesale_cost", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 79, "query_string": " select top (100)   c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,store.s_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (household_demographics.hd_dep_count = 4 or household_demographics.hd_vehicle_count > 0)     and date_dim.d_dow = 1     and date_dim.d_year in (2000,2000+1,2000+2)      and store.s_number_employees between 200 and 295     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer     where ss_customer_sk = c_customer_sk  order by c_last_name,c_first_name,substring(s_city,1,30), profit;", "predicates": {"date_dim": ["d_dow", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_number_employees"]}, "payload": {"customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_city", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_addr_sk", "ss_customer_sk", "ss_ticket_number", "ss_coupon_amt", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {"customer": ["c_last_name", "c_first_name"]}}
{"id": 80, "query_string": " with ssr as  (select  s_store_id as store_id,           sum(ss_ext_sales_price) as sales,           sum(coalesce(sr_return_amt, 0)) as returns,           sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit   from store_sales left outer join store_returns on          (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),      date_dim,      store,      item,      promotion  where ss_sold_date_sk = d_date_sk        and d_date between cast('1998-08-13' as date)                    and dateadd(day, 30, cast('1998-08-13' as date))        and ss_store_sk = s_store_sk        and ss_item_sk = i_item_sk        and i_current_price > 50        and ss_promo_sk = p_promo_sk        and p_channel_tv = 'N'  group by s_store_id)  ,  csr as  (select  cp_catalog_page_id as catalog_page_id,           sum(cs_ext_sales_price) as sales,           sum(coalesce(cr_return_amount, 0)) as returns,           sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit   from catalog_sales left outer join catalog_returns on          (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),      date_dim,      catalog_page,      item,      promotion  where cs_sold_date_sk = d_date_sk        and d_date between cast('1998-08-13' as date)                   and dateadd(day, 30, cast('1998-08-13' as date))         and cs_catalog_page_sk = cp_catalog_page_sk        and cs_item_sk = i_item_sk        and i_current_price > 50        and cs_promo_sk = p_promo_sk        and p_channel_tv = 'N' group by cp_catalog_page_id)  ,  wsr as  (select  web_site_id,           sum(ws_ext_sales_price) as sales,           sum(coalesce(wr_return_amt, 0)) as returns,           sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit   from web_sales left outer join web_returns on          (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),      date_dim,      web_site,      item,      promotion  where ws_sold_date_sk = d_date_sk        and d_date between cast('1998-08-13' as date)                   and dateadd(day, 30, cast('1998-08-13' as date))         and ws_web_site_sk = web_site_sk        and ws_item_sk = i_item_sk        and i_current_price > 50        and ws_promo_sk = p_promo_sk        and p_channel_tv = 'N' group by web_site_id)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , concat('store' , store_id) as id         , sales         , returns         , profit  from   ssr  union all  select 'catalog channel' as channel         , concat('catalog_page' , catalog_page_id) as id         , sales         , returns         , profit  from  csr  union all  select 'web channel' as channel         , concat('web_site' , web_site_id) as id         , sales         , returns         , profit  from   wsr  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"], "promotion": ["p_channel_tv"]}, "payload": {"catalog_page": ["cp_catalog_page_sk", "cp_catalog_page_id"], "catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_amount", "cr_net_loss"], "date_dim": ["d_date_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"], "store": ["s_store_sk", "s_store_id"], "store_returns": ["sr_return_amt", "sr_net_loss", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_net_loss", "wr_return_amt", "wr_order_number"], "web_site": ["web_site_id", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 81, "query_string": " with customer_total_return as  (select cr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   \tsum(cr_return_amt_inc_tax) as ctr_total_return  from catalog_returns      ,date_dim      ,customer_address  where cr_returned_date_sk = d_date_sk     and d_year =1998    and cr_returning_addr_sk = ca_address_sk   group by cr_returning_customer_sk          ,ca_state )   select top (100) c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  \t\t\t  from customer_total_return ctr2                    \t  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'SC'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  ;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_year"]}, "payload": {"catalog_returns": ["cr_returned_date_sk", "cr_returning_customer_sk", "cr_return_amt_inc_tax", "cr_returning_addr_sk"], "customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_current_addr_sk", "c_customer_id"], "customer_address": ["ca_street_type", "ca_county", "ca_street_name", "ca_zip", "ca_street_number", "ca_city", "ca_state", "ca_gmt_offset", "ca_location_type", "ca_address_sk", "ca_suite_number", "ca_country"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer": ["c_salutation", "c_customer_id", "c_last_name", "c_first_name"], "customer_address": ["ca_street_type", "ca_county", "ca_street_name", "ca_zip", "ca_street_number", "ca_city", "ca_gmt_offset", "ca_location_type", "ca_suite_number", "ca_country"]}}
{"id": 82, "query_string": " select top (100) i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, store_sales  where i_current_price between 61 and 61+30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('1998-04-20' as date) and dateadd(day, 60, cast('1998-04-20' as date))  and i_manufact_id in (320,407,898,182)  and inv_quantity_on_hand between 100 and 500  and ss_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  ;", "predicates": {"date_dim": ["d_date"], "inventory": ["inv_quantity_on_hand"], "item": ["i_current_price", "i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc", "i_current_price"]}, "group_by": {}, "order_by": {}}
{"id": 83, "query_string": " with sr_items as  (select i_item_id item_id,         sum(sr_return_quantity) sr_item_qty  from store_returns,       item,       date_dim  where sr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t  where d_date in ('2000-02-27','2000-08-23','2000-11-18')))  and   sr_returned_date_sk   = d_date_sk  group by i_item_id),  cr_items as  (select i_item_id item_id,         sum(cr_return_quantity) cr_item_qty  from catalog_returns,       item,       date_dim  where cr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t  where d_date in ('2000-02-27','2000-08-23','2000-11-18')))  and   cr_returned_date_sk   = d_date_sk  group by i_item_id),  wr_items as  (select i_item_id item_id,         sum(wr_return_quantity) wr_item_qty  from web_returns,       item,       date_dim  where wr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t\twhere d_date in ('2000-02-27','2000-08-23','2000-11-18')))  and   wr_returned_date_sk   = d_date_sk  group by i_item_id)   select top (100) sr_items.item_id        ,sr_item_qty        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev        ,cr_item_qty        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev        ,wr_item_qty        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average  from sr_items      ,cr_items      ,wr_items  where sr_items.item_id=cr_items.item_id    and sr_items.item_id=wr_items.item_id   order by sr_items.item_id          ,sr_item_qty  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_returned_date_sk", "cr_order_number", "cr_return_quantity"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "item": ["i_item_id", "i_item_sk"], "store_returns": ["sr_returned_date_sk", "sr_return_quantity", "sr_item_sk"], "web_returns": ["wr_item_sk", "wr_returned_date_sk", "wr_return_quantity"]}, "group_by": {}, "order_by": {}}
{"id": 84, "query_string": " select top (100) c_customer_id as customer_id        , concat(coalesce(c_last_name,'') , ', ' , coalesce(c_first_name,'')) as customername  from customer      ,customer_address      ,customer_demographics      ,household_demographics      ,income_band      ,store_returns  where ca_city\t        =  'Pleasant Hill'    and c_current_addr_sk = ca_address_sk    and ib_lower_bound   >=  64931    and ib_upper_bound   <=  64931 + 50000    and ib_income_band_sk = hd_income_band_sk    and cd_demo_sk = c_current_cdemo_sk    and hd_demo_sk = c_current_hdemo_sk    and sr_cdemo_sk = cd_demo_sk  order by c_customer_id  ;", "predicates": {"customer": ["c_current_cdemo_sk"], "customer_address": ["ca_city"], "income_band": ["ib_upper_bound", "ib_lower_bound"]}, "payload": {"customer": ["c_last_name", "c_first_name", "c_current_cdemo_sk", "c_current_addr_sk", "c_customer_id", "c_current_hdemo_sk"], "customer_address": ["ca_address_sk"], "household_demographics": ["hd_income_band_sk", "hd_demo_sk"], "income_band": ["ib_income_band_sk"], "store_returns": ["sr_cdemo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 85, "query_string": " select top (100) substring(r_reason_desc,1,20)        ,avg(ws_quantity)        ,avg(wr_refunded_cash)        ,avg(wr_fee)  from web_sales, web_returns, web_page, customer_demographics cd1,       customer_demographics cd2, customer_address, date_dim, reason   where ws_web_page_sk = wp_web_page_sk    and ws_item_sk = wr_item_sk    and ws_order_number = wr_order_number    and ws_sold_date_sk = d_date_sk and d_year = 2000    and cd1.cd_demo_sk = wr_refunded_cdemo_sk     and cd2.cd_demo_sk = wr_returning_cdemo_sk    and ca_address_sk = wr_refunded_addr_sk    and r_reason_sk = wr_reason_sk    and    (     (      cd1.cd_marital_status = 'S'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = '2 yr Degree'      and       cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 100.00 and 150.00     )    or     (      cd1.cd_marital_status = 'D'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Unknown'       and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 50.00 and 100.00     )    or     (      cd1.cd_marital_status = 'W'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Secondary'      and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 150.00 and 200.00     )    )    and    (     (      ca_country = 'United States'      and      ca_state in ('MS', 'FL', 'VA')      and ws_net_profit between 100 and 200       )     or     (      ca_country = 'United States'      and      ca_state in ('NC', 'TX', 'VT')      and ws_net_profit between 150 and 300       )     or     (      ca_country = 'United States'      and      ca_state in ('TN', 'AR', 'MN')      and ws_net_profit between 50 and 250       )    ) group by r_reason_desc order by substring(r_reason_desc,1,20)         ,avg(ws_quantity)         ,avg(wr_refunded_cash)         ,avg(wr_fee);", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "web_sales": ["ws_net_profit", "ws_sales_price"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "reason": ["r_reason_desc", "r_reason_sk"], "web_page": ["wp_web_page_sk"], "web_returns": ["wr_returning_cdemo_sk", "wr_refunded_cdemo_sk", "wr_reason_sk", "wr_item_sk", "wr_refunded_cash", "wr_refunded_addr_sk", "wr_fee", "wr_order_number"], "web_sales": ["ws_net_profit", "ws_item_sk", "ws_sales_price", "ws_quantity", "ws_sold_date_sk", "ws_web_page_sk", "ws_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 86, "query_string": " select top (100)       sum(ws_net_paid) as total_sum    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  \tpartition by grouping(i_category)+grouping(i_class),  \tcase when grouping(i_class) = 0 then i_category end   \torder by sum(ws_net_paid) desc) as rank_within_parent  from     web_sales    ,date_dim       d1    ,item  where     d1.d_month_seq between 1205 and 1205+11  and d1.d_date_sk = ws_sold_date_sk  and i_item_sk  = ws_item_sk  group by rollup(i_category,i_class)  order by    lochierarchy desc,    case when (grouping(i_category)+grouping(i_class)) = 0 then i_category end,    rank_within_parent  ;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_class", "i_item_sk", "i_category"], "web_sales": ["ws_net_paid", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 87, "query_string": " select count(*)  from ((select distinct c_last_name, c_first_name, d_date        from store_sales, date_dim, customer        where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_customer_sk = customer.c_customer_sk          and d_month_seq between 1205 and 1205+11)        except       (select distinct c_last_name, c_first_name, d_date        from catalog_sales, date_dim, customer        where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk          and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk          and d_month_seq between 1205 and 1205+11)        except       (select distinct c_last_name, c_first_name, d_date        from web_sales, date_dim, customer        where web_sales.ws_sold_date_sk = date_dim.d_date_sk          and web_sales.ws_bill_customer_sk = customer.c_customer_sk          and d_month_seq between 1205 and 1205+11) ) cool_cust;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 88, "query_string": " select  * from  (select count(*) h8_30_to_9  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk         and ss_hdemo_sk = household_demographics.hd_demo_sk       and ss_store_sk = s_store_sk      and time_dim.t_hour = 8      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))       and store.s_store_name = 'ese') s1,  (select count(*) h9_to_9_30   from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk       and time_dim.t_hour = 9       and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))      and store.s_store_name = 'ese') s2,  (select count(*) h9_30_to_10   from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 9      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))      and store.s_store_name = 'ese') s3,  (select count(*) h10_to_10_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 10       and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))      and store.s_store_name = 'ese') s4,  (select count(*) h10_30_to_11  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 10       and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))      and store.s_store_name = 'ese') s5,  (select count(*) h11_to_11_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk       and time_dim.t_hour = 11      and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))      and store.s_store_name = 'ese') s6,  (select count(*) h11_30_to_12  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 11      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))      and store.s_store_name = 'ese') s7,  (select count(*) h12_to_12_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 12      and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or           (household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2))      and store.s_store_name = 'ese') s8;", "predicates": {"household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_store_name"], "time_dim": ["t_hour", "t_minute"]}, "payload": {"household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_sold_time_sk"], "time_dim": ["t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 89, "query_string": " select top (100) * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (2000) and         ((i_category in ('Shoes','Children','Women') and           i_class in ('womens','school-uniforms','fragrances')          )       or (i_category in ('Music','Men','Jewelry') and           i_class in ('rock','sports-apparel','womens watch')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name;", "predicates": {"date_dim": ["d_year"], "item": ["i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_brand", "i_class", "i_item_sk", "i_category"], "store": ["s_store_name", "s_store_sk", "s_company_name"]}, "group_by": {}, "order_by": {"store": ["s_store_name"]}}
{"id": 90, "query_string": " select top (100) cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio  from ( select count(*) amc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 11 and 11+1          and household_demographics.hd_dep_count = 4          and web_page.wp_char_count between 5000 and 5200) at,       ( select count(*) pmc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 17 and 17+1          and household_demographics.hd_dep_count = 4          and web_page.wp_char_count between 5000 and 5200) pt  order by am_pm_ratio  ;", "predicates": {"household_demographics": ["hd_dep_count"], "time_dim": ["t_hour"], "web_page": ["wp_char_count"]}, "payload": {"household_demographics": ["hd_demo_sk"], "time_dim": ["t_time_sk"], "web_page": ["wp_web_page_sk"], "web_sales": ["ws_sold_time_sk", "ws_web_page_sk", "ws_ship_hdemo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 91, "query_string": " select           cc_call_center_id Call_Center,         cc_name Call_Center_Name,         cc_manager Manager,         sum(cr_net_loss) Returns_Loss from         call_center,         catalog_returns,         date_dim,         customer,         customer_address,         customer_demographics,         household_demographics where         cr_call_center_sk       = cc_call_center_sk and     cr_returned_date_sk     = d_date_sk and     cr_returning_customer_sk= c_customer_sk and     cd_demo_sk              = c_current_cdemo_sk and     hd_demo_sk              = c_current_hdemo_sk and     ca_address_sk           = c_current_addr_sk and     d_year                  = 2002  and     d_moy                   = 12 and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')         or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree')) and     hd_buy_potential like '1001-5000%' and     ca_gmt_offset           = -6 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc;", "predicates": {"customer_address": ["ca_gmt_offset"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_moy", "d_year"], "household_demographics": ["hd_buy_potential"]}, "payload": {"call_center": ["cc_name", "cc_call_center_id", "cc_manager", "cc_call_center_sk"], "catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_returning_customer_sk", "cr_call_center_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk", "c_current_hdemo_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 92, "query_string": " select top (100)     sum(ws_ext_discount_amt)  as \"Excess Discount Amount\"  from      web_sales     ,item     ,date_dim where i_manufact_id = 645 and i_item_sk = ws_item_sk  and d_date between '2000-01-05' and          dateadd(day, 90, cast('2000-01-05' as date)) and d_date_sk = ws_sold_date_sk  and ws_ext_discount_amt        > (           SELECT              1.3 * avg(ws_ext_discount_amt)           FROM              web_sales             ,date_dim          WHERE                ws_item_sk = i_item_sk            and d_date between '2000-01-05' and                              dateadd(day, 90, cast('2000-01-05' as date))           and d_date_sk = ws_sold_date_sk        )  order by sum(ws_ext_discount_amt);", "predicates": {"date_dim": ["d_date"], "item": ["i_manufact_id"], "web_sales": ["ws_ext_discount_amt"]}, "payload": {"item": ["i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 93, "query_string": " select top (100) ss_customer_sk             ,sum(act_sales) sumsales       from (select ss_item_sk                   ,ss_ticket_number                   ,ss_customer_sk                   ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price                                                             else (ss_quantity*ss_sales_price) end act_sales             from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk                                                                and sr_ticket_number = ss_ticket_number)                 ,reason             where sr_reason_sk = r_reason_sk               and r_reason_desc = 'Gift exchange') t       group by ss_customer_sk       order by sumsales, ss_customer_sk;", "predicates": {"reason": ["r_reason_desc"]}, "payload": {"reason": ["r_reason_sk"], "store_returns": ["sr_reason_sk", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"]}, "group_by": {}, "order_by": {"store_sales": ["ss_customer_sk"]}}
{"id": 94, "query_string": " select top (100)     count(distinct ws_order_number) as \"order count\"   ,sum(ws_ext_ship_cost) as \"total shipping cost\"   ,sum(ws_net_profit) as \"total net profit\" from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '1999-3-01' and             dateadd(day, 60, cast('1999-3-01' as date)) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'CO' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number);", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_date"], "web_site": ["web_company_name"]}, "payload": {"customer_address": ["ca_address_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_net_profit", "ws_ship_date_sk", "ws_ship_addr_sk", "ws_ext_ship_cost", "ws_warehouse_sk", "ws_order_number", "ws_web_site_sk"], "web_site": ["web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 95, "query_string": " with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select top (100)     count(distinct ws_order_number) as \"order count\"   ,sum(ws_ext_ship_cost) as \"total shipping cost\"   ,sum(ws_net_profit) as \"total net profit\" from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '1999-3-01' and             dateadd(day, 60, cast('1999-3-01' as date)) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'CO' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number);", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_date"], "web_site": ["web_company_name"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_net_profit", "ws_ship_date_sk", "ws_item_sk", "ws_ship_addr_sk", "ws_ext_ship_cost", "ws_warehouse_sk", "ws_order_number", "ws_web_site_sk"], "web_site": ["web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 96, "query_string": " select top (100) count(*)  from store_sales     ,household_demographics      ,time_dim, store where ss_sold_time_sk = time_dim.t_time_sk        and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk     and time_dim.t_hour = 20     and time_dim.t_minute >= 30     and household_demographics.hd_dep_count = 0     and store.s_store_name = 'ese' order by count(*);", "predicates": {"household_demographics": ["hd_dep_count"], "store": ["s_store_name"], "time_dim": ["t_hour", "t_minute"]}, "payload": {"household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_sold_time_sk"], "time_dim": ["t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 97, "query_string": " with ssci as ( select ss_customer_sk customer_sk       ,ss_item_sk item_sk from store_sales,date_dim where ss_sold_date_sk = d_date_sk   and d_month_seq between 1205 and 1205 + 11 group by ss_customer_sk         ,ss_item_sk), csci as(  select cs_bill_customer_sk customer_sk       ,cs_item_sk item_sk from catalog_sales,date_dim where cs_sold_date_sk = d_date_sk   and d_month_seq between 1205 and 1205 + 11 group by cs_bill_customer_sk         ,cs_item_sk)  select top (100) sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only       ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only       ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk                                and ssci.item_sk = csci.item_sk);", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk", "cs_item_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 98, "query_string": " select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from\t \tstore_sales     \t,item      \t,date_dim where  \tss_item_sk = i_item_sk    \tand i_category in ('Men', 'Children', 'Books')   \tand ss_sold_date_sk = d_date_sk \tand d_date between cast('1998-03-17' as date)  \t\t\t\tand dateadd(day, 30, cast('1998-03-17' as date)) group by  \ti_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  \ti_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"]}, "group_by": {}, "order_by": {}}
{"id": 99, "query_string": " select top (100)     substring(w_warehouse_name,1,20)   ,sm_type   ,cc_name   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and                   (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and                   (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and                  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    catalog_sales   ,warehouse   ,ship_mode   ,call_center   ,date_dim where     d_month_seq between 1205 and 1205 + 11 and cs_ship_date_sk   = d_date_sk and cs_warehouse_sk   = w_warehouse_sk and cs_ship_mode_sk   = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by    substring(w_warehouse_name,1,20)   ,sm_type   ,cc_name order by substring(w_warehouse_name,1,20)         ,sm_type         ,cc_name;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"call_center": ["cc_name", "cc_call_center_sk"], "catalog_sales": ["cs_warehouse_sk", "cs_call_center_sk", "cs_ship_date_sk", "cs_ship_mode_sk", "cs_sold_date_sk"], "date_dim": ["d_date_sk"], "ship_mode": ["sm_type", "sm_ship_mode_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 1, "query_string": " with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sum(SR_FEE) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2002 group by sr_customer_sk ,sr_store_sk)  select top (100) c_customer_id from customer_total_return ctr1 ,store ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'TN' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id;", "predicates": {"date_dim": ["d_year"], "store": ["s_state"], "store_returns": ["sr_store_sk"]}, "payload": {"customer": ["c_customer_id", "c_customer_sk"], "date_dim": ["d_date_sk"], "store": ["s_store_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_customer_id"]}}
{"id": 2, "query_string": " with wscs as  (select sold_date_sk         ,sales_price   from (select ws_sold_date_sk sold_date_sk               ,ws_ext_sales_price sales_price         from web_sales          union all         select cs_sold_date_sk sold_date_sk               ,cs_ext_sales_price sales_price         from catalog_sales) a),  wswscs as   (select d_week_seq,         sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales  from wscs      ,date_dim  where d_date_sk = sold_date_sk  group by d_week_seq)  select d_week_seq1        ,round(sun_sales1/sun_sales2,2)        ,round(mon_sales1/mon_sales2,2)        ,round(tue_sales1/tue_sales2,2)        ,round(wed_sales1/wed_sales2,2)        ,round(thu_sales1/thu_sales2,2)        ,round(fri_sales1/fri_sales2,2)        ,round(sat_sales1/sat_sales2,2)  from  (select wswscs.d_week_seq d_week_seq1         ,sun_sales sun_sales1         ,mon_sales mon_sales1         ,tue_sales tue_sales1         ,wed_sales wed_sales1         ,thu_sales thu_sales1         ,fri_sales fri_sales1         ,sat_sales sat_sales1   from wswscs,date_dim    where date_dim.d_week_seq = wswscs.d_week_seq and         d_year = 2000) y,  (select wswscs.d_week_seq d_week_seq2         ,sun_sales sun_sales2         ,mon_sales mon_sales2         ,tue_sales tue_sales2         ,wed_sales wed_sales2         ,thu_sales thu_sales2         ,fri_sales fri_sales2         ,sat_sales sat_sales2   from wswscs       ,date_dim    where date_dim.d_week_seq = wswscs.d_week_seq and         d_year = 2000+1) z  where d_week_seq1=d_week_seq2-53  order by d_week_seq1;", "predicates": {"date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_week_seq", "d_day_name"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 3, "query_string": " select top (100) dt.d_year         ,item.i_brand_id brand_id         ,item.i_brand brand        ,sum(ss_net_profit) sum_agg  from  date_dim dt        ,store_sales       ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk    and store_sales.ss_item_sk = item.i_item_sk    and item.i_manufact_id = 324    and dt.d_moy=12  group by dt.d_year       ,item.i_brand       ,item.i_brand_id  order by dt.d_year          ,sum_agg desc          ,brand_id  ;", "predicates": {"date_dim": ["d_moy"], "item": ["i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"date_dim": ["d_year"], "item": ["i_brand_id"]}}
{"id": 4, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year  union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total        ,'c' sale_type  from customer      ,catalog_sales      ,date_dim  where c_customer_sk = cs_bill_customer_sk    and cs_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag          ,c_birth_country          ,c_login          ,c_email_address          ,d_year          )   select top (100)                    t_s_secyear.customer_id                  ,t_s_secyear.customer_first_name                  ,t_s_secyear.customer_last_name                  ,t_s_secyear.customer_login  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_c_firstyear      ,year_total t_c_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id    and t_s_firstyear.customer_id = t_c_secyear.customer_id    and t_s_firstyear.customer_id = t_c_firstyear.customer_id    and t_s_firstyear.customer_id = t_w_firstyear.customer_id    and t_s_firstyear.customer_id = t_w_secyear.customer_id    and t_s_firstyear.sale_type = 's'    and t_c_firstyear.sale_type = 'c'    and t_w_firstyear.sale_type = 'w'    and t_s_secyear.sale_type = 's'    and t_c_secyear.sale_type = 'c'    and t_w_secyear.sale_type = 'w'    and t_s_firstyear.dyear =  2000    and t_s_secyear.dyear = 2000+1    and t_c_firstyear.dyear =  2000    and t_c_secyear.dyear =  2000+1    and t_w_firstyear.dyear = 2000    and t_w_secyear.dyear = 2000+1    and t_s_firstyear.year_total > 0    and t_c_firstyear.year_total > 0    and t_w_firstyear.year_total > 0    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end    and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end            > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end  order by t_s_secyear.customer_id          ,t_s_secyear.customer_first_name          ,t_s_secyear.customer_last_name          ,t_s_secyear.customer_login;", "predicates": {"date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_ext_list_price", "cs_ext_discount_amt", "cs_bill_customer_sk", "cs_ext_sales_price", "cs_ext_wholesale_cost", "cs_sold_date_sk"], "customer": ["c_login", "c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id"], "date_dim": ["d_date_sk"], "store_sales": ["ss_ext_discount_amt", "ss_ext_sales_price", "ss_ext_wholesale_cost", "ss_customer_sk", "ss_ext_list_price", "ss_sold_date_sk"], "web_sales": ["ws_ext_discount_amt", "ws_ext_wholesale_cost", "ws_ext_list_price", "ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 5, "query_string": " with ssr as  (select s_store_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  ss_store_sk as store_sk,             ss_sold_date_sk  as date_sk,             ss_ext_sales_price as sales_price,             ss_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from store_sales     union all     select sr_store_sk as store_sk,            sr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            sr_return_amt as return_amt,            sr_net_loss as net_loss     from store_returns    ) salesreturns,      date_dim,      store  where date_sk = d_date_sk        and d_date between cast('1999-08-09' as date)                    and dateadd(day, 14, cast('1999-08-09' as date))        and store_sk = s_store_sk  group by s_store_id)  ,  csr as  (select cp_catalog_page_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  cs_catalog_page_sk as page_sk,             cs_sold_date_sk  as date_sk,             cs_ext_sales_price as sales_price,             cs_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from catalog_sales     union all     select cr_catalog_page_sk as page_sk,            cr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            cr_return_amount as return_amt,            cr_net_loss as net_loss     from catalog_returns    ) salesreturns,      date_dim,      catalog_page  where date_sk = d_date_sk        and d_date between cast('1999-08-09' as date)                   and dateadd(day, 14, cast('1999-08-09' as date))        and page_sk = cp_catalog_page_sk  group by cp_catalog_page_id)  ,  wsr as  (select web_site_id,         sum(sales_price) as sales,         sum(profit) as profit,         sum(return_amt) as returns,         sum(net_loss) as profit_loss  from   ( select  ws_web_site_sk as wsr_web_site_sk,             ws_sold_date_sk  as date_sk,             ws_ext_sales_price as sales_price,             ws_net_profit as profit,             cast(0 as decimal(7,2)) as return_amt,             cast(0 as decimal(7,2)) as net_loss     from web_sales     union all     select ws_web_site_sk as wsr_web_site_sk,            wr_returned_date_sk as date_sk,            cast(0 as decimal(7,2)) as sales_price,            cast(0 as decimal(7,2)) as profit,            wr_return_amt as return_amt,            wr_net_loss as net_loss     from web_returns left outer join web_sales on          ( wr_item_sk = ws_item_sk            and wr_order_number = ws_order_number)    ) salesreturns,      date_dim,      web_site  where date_sk = d_date_sk        and d_date between cast('1999-08-09' as date)                   and dateadd(day, 14, cast('1999-08-09' as date))        and wsr_web_site_sk = web_site_sk  group by web_site_id)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , concat('store' , s_store_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from   ssr  union all  select 'catalog channel' as channel         , concat('catalog_page' , cp_catalog_page_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from  csr  union all  select 'web channel' as channel         , concat('web_site' , web_site_id) as id         , sales         , returns         , (profit - profit_loss) as profit  from   wsr  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_page": ["cp_catalog_page_sk", "cp_catalog_page_id"], "catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_return_amount", "cr_catalog_page_sk"], "catalog_sales": ["cs_catalog_page_sk", "cs_net_profit", "cs_sold_date_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_net_loss"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit", "ss_ext_sales_price"], "web_returns": ["wr_returned_date_sk", "wr_return_amt", "wr_net_loss", "wr_item_sk", "wr_order_number"], "web_sales": ["ws_net_profit", "ws_ext_sales_price", "ws_sold_date_sk", "ws_web_site_sk"], "web_site": ["web_site_id", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 6, "query_string": " select top (100) a.ca_state state, count(*) cnt  from customer_address a      ,customer c      ,store_sales s      ,date_dim d      ,item i  where       a.ca_address_sk = c.c_current_addr_sk  \tand c.c_customer_sk = s.ss_customer_sk  \tand s.ss_sold_date_sk = d.d_date_sk  \tand s.ss_item_sk = i.i_item_sk  \tand d.d_month_seq =   \t     (select distinct (d_month_seq)  \t      from date_dim                where d_year = 2001  \t        and d_moy = 3 )  \tand i.i_current_price > 1.2 *               (select avg(j.i_current_price)   \t     from item j   \t     where j.i_category = i.i_category)  group by a.ca_state  having count(*) >= 10  order by cnt, a.ca_state   ;", "predicates": {"date_dim": ["d_month_seq", "d_moy", "d_year"], "item": ["i_category", "i_current_price"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk", "d_month_seq"], "item": ["i_item_sk", "i_category", "i_current_price"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_item_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_state"]}}
{"id": 7, "query_string": " select top (100) i_item_id,          avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4   from store_sales, customer_demographics, date_dim, item, promotion  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_cdemo_sk = cd_demo_sk and        ss_promo_sk = p_promo_sk and        cd_gender = 'M' and         cd_marital_status = 'D' and        cd_education_status = 'Secondary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 1999   group by i_item_id  order by i_item_id  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "promotion": ["p_channel_event", "p_channel_email"]}, "payload": {"customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"], "promotion": ["p_promo_sk"], "store_sales": ["ss_promo_sk", "ss_item_sk", "ss_cdemo_sk", "ss_list_price", "ss_quantity", "ss_sales_price", "ss_coupon_amt", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 8, "query_string": " select top (100) s_store_name       ,sum(ss_net_profit)  from store_sales      ,date_dim      ,store,      (select ca_zip      from (       SELECT substring(ca_zip,1,5) ca_zip       FROM customer_address       WHERE substring(ca_zip,1,5) IN (                           '76660','88667','52316','45264','46229','68984',                           '85251','11416','92708','68261','95225',                           '12076','47199','61402','69380','93596',                           '57057','37847','17535','79190','11148',                           '33614','55709','29492','21286','49912',                           '60657','76622','42016','71485','78566',                           '56915','71194','11849','74253','85378',                           '56851','27184','90721','42972','20501',                           '84381','63523','92562','23384','45079',                           '49816','11737','54949','68247','52869',                           '71529','59308','22020','62388','77576',                           '80981','82753','67529','93853','77566',                           '18737','85337','55222','19953','21348',                           '99690','57333','42444','46108','67473',                           '36872','84039','36108','63196','97934',                           '65944','68092','53902','11132','70461',                           '91170','88504','65458','71961','72441',                           '31946','10996','57677','81018','81743',                           '71552','32316','84376','89431','50676',                           '11300','37654','61596','66341','31638',                           '96159','90175','89847','53596','33916',                           '32840','35468','50911','56172','48691',                           '35957','47574','38446','93132','33294',                           '85206','22619','74733','31357','30735',                           '60383','79461','58440','15796','53273',                           '13403','49764','84447','33338','56544',                           '86581','19102','65261','66711','19585',                           '42470','33567','84758','47913','33047',                           '24471','75874','90987','92439','30833',                           '58601','13066','31797','46743','29394',                           '43139','74356','73102','80469','65308',                           '88887','15277','16775','55111','43884',                           '27160','22677','48441','93218','17041',                           '48000','55449','96781','60000','63512',                           '47168','36423','56141','93393','51688',                           '86397','53699','10411','79324','47872',                           '18485','76914','91307','50873','35223',                           '50425','82692','15177','82678','91041',                           '63454','70120','66824','94774','82307',                           '65457','13732','70447','24476','47984',                           '45556','94155','67119','72592','75801',                           '93536','21522','89573','91729','52532',                           '35171','40637','15826','29512','92266',                           '18143','12893','62168','41004','44856',                           '17782','55250','43462','21951','53811',                           '94802','54831','85374','26643','92634',                           '40378','46156','46500','80648','96234',                           '15397','88087','12806','46070','49870',                           '30879','29655','63596','89497','76462',                           '13064','79284','46886','77890','39552',                           '31782','28672','97518','69791','61672',                           '46372','18385','51417','89845','43742',                           '74110','34301','31096','86822','64356',                           '66666','74750','88797','28812','36634',                           '86641','85283','45944','98850','20352',                           '72365','59647','55427','66823','26613',                           '93624','21863','23567','42087','75835',                           '69591','68682','41216','92727','99907',                           '23387','69062','89662','35658','57750',                           '83080','10650','84233','92608','91533',                           '55601','16097','74248','65247','96185',                           '69068','15748','35084','65597','21263',                           '61812','35377','43915','56642','63888',                           '93683','46755','10408','97550','48347',                           '22835','11861','86211','13998','20515',                           '85651','19706','77341','37737','94069',                           '12649','97754','42733','79170','55920',                           '54626','72852','95792','40720','21119',                           '57410','77493','85038','56137','93165',                           '55292','29643','29682','13317','35694',                           '87361','26114','84883','45265','64655',                           '43729','90427','70173','19756','49375',                           '92460','47465','96680','35224','36074',                           '45051','71981','77138','60632','99424',                           '93737','14199','14176','80961','70959',                           '74208','58699','46280','28954','41099',                           '96822','66401','30899','95109','89055',                           '74427','72406','77897','80441','88819',                           '95229','19126','46380','84574','34975',                           '68818','44509','52651','33734')      intersect       select ca_zip       from (SELECT substring(ca_zip,1,5) ca_zip,count(*) cnt             FROM customer_address, customer             WHERE ca_address_sk = c_current_addr_sk and                   c_preferred_cust_flag='Y'             group by ca_zip             having count(*) > 10)A1)A2) V1  where ss_store_sk = s_store_sk   and ss_sold_date_sk = d_date_sk   and d_qoy = 2 and d_year = 1999   and (substring(s_zip,1,2) = substring(V1.ca_zip,1,2))  group by s_store_name  order by s_store_name  ;", "predicates": {"customer": ["c_preferred_cust_flag"], "date_dim": ["d_qoy", "d_year"]}, "payload": {"customer": ["c_current_addr_sk"], "customer_address": ["ca_address_sk", "ca_zip"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 9, "query_string": " select case when (select count(*)                    from store_sales                    where ss_quantity between 1 and 20) > 30380             then (select avg(ss_ext_tax)                    from store_sales                    where ss_quantity between 1 and 20)              else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 1 and 20) end bucket1 ,        case when (select count(*)                   from store_sales                   where ss_quantity between 21 and 40) > 32340             then (select avg(ss_ext_tax)                   from store_sales                   where ss_quantity between 21 and 40)              else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 21 and 40) end bucket2,        case when (select count(*)                   from store_sales                   where ss_quantity between 41 and 60) > 5900             then (select avg(ss_ext_tax)                   from store_sales                   where ss_quantity between 41 and 60)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 41 and 60) end bucket3,        case when (select count(*)                   from store_sales                   where ss_quantity between 61 and 80) > 42556             then (select avg(ss_ext_tax)                   from store_sales                   where ss_quantity between 61 and 80)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 61 and 80) end bucket4,        case when (select count(*)                   from store_sales                   where ss_quantity between 81 and 100) > 18173             then (select avg(ss_ext_tax)                   from store_sales                   where ss_quantity between 81 and 100)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 81 and 100) end bucket5 from reason where r_reason_sk = 1;", "predicates": {"store_sales": ["ss_quantity"]}, "payload": {"store_sales": ["ss_ext_tax", "ss_net_paid_inc_tax"]}, "group_by": {}, "order_by": {}}
{"id": 10, "query_string": " select top (100)    cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3,   cd_dep_count,   count(*) cnt4,   cd_dep_employed_count,   count(*) cnt5,   cd_dep_college_count,   count(*) cnt6  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_county in ('Rankin County','Fulton County','Grant County','Greene County','Portsmouth city') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2002 and                 d_moy between 2 and 2+3) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_moy between 2 ANd 2+3) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_moy between 2 and 2+3))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count;", "predicates": {"customer_address": ["ca_county"], "date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 11, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag           ,c_birth_country          ,c_login          ,c_email_address          ,d_year   union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag           ,c_birth_country          ,c_login          ,c_email_address          ,d_year          )   select top (100)                    t_s_secyear.customer_id                  ,t_s_secyear.customer_first_name                  ,t_s_secyear.customer_last_name                  ,t_s_secyear.customer_login  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id          and t_s_firstyear.customer_id = t_w_secyear.customer_id          and t_s_firstyear.customer_id = t_w_firstyear.customer_id          and t_s_firstyear.sale_type = 's'          and t_w_firstyear.sale_type = 'w'          and t_s_secyear.sale_type = 's'          and t_w_secyear.sale_type = 'w'          and t_s_firstyear.dyear = 2000          and t_s_secyear.dyear = 2000+1          and t_w_firstyear.dyear = 2000          and t_w_secyear.dyear = 2000+1          and t_s_firstyear.year_total > 0          and t_w_firstyear.year_total > 0          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end              > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end  order by t_s_secyear.customer_id          ,t_s_secyear.customer_first_name          ,t_s_secyear.customer_last_name          ,t_s_secyear.customer_login;", "predicates": {"date_dim": ["d_year"]}, "payload": {"customer": ["c_login", "c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_ext_list_price", "ss_ext_discount_amt"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_discount_amt", "ws_ext_list_price"]}, "group_by": {}, "order_by": {}}
{"id": 12, "query_string": " select top (100) i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from\t \tweb_sales     \t,item      \t,date_dim where  \tws_item_sk = i_item_sk    \tand i_category in ('Home', 'Electronics', 'Jewelry')   \tand ws_sold_date_sk = d_date_sk \tand d_date between cast('2000-06-11' as date)  \t\t\t\tand dateadd(day, 30, cast('2000-06-11' as date)) group by  \ti_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  \ti_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_desc", "i_class", "i_item_id", "i_category"]}}
{"id": 13, "query_string": " select avg(ss_quantity)        ,avg(ss_ext_sales_price)        ,avg(ss_ext_wholesale_cost)        ,sum(ss_ext_wholesale_cost)  from store_sales      ,store      ,customer_demographics      ,household_demographics      ,customer_address      ,date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2001  and((ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'S'   and cd_education_status = 'College'   and ss_sales_price between 100.00 and 150.00   and hd_dep_count = 3         )or      (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'W'   and cd_education_status = 'Advanced Degree'   and ss_sales_price between 50.00 and 100.00      and hd_dep_count = 1      ) or       (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'U'   and cd_education_status = 'Unknown'   and ss_sales_price between 150.00 and 200.00    and hd_dep_count = 1        ))  and((ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('SD', 'MN', 'IA')   and ss_net_profit between 100 and 200        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('VA', 'MI', 'OK')   and ss_net_profit between 150 and 300        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('TX', 'IN', 'TN')   and ss_net_profit between 50 and 250        ));", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "household_demographics": ["hd_dep_count"], "store_sales": ["ss_sales_price", "ss_net_profit"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_dep_count", "hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_ext_sales_price", "ss_cdemo_sk", "ss_addr_sk", "ss_quantity", "ss_sales_price", "ss_ext_wholesale_cost", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 14, "query_string": " with  cross_items as  (select i_item_sk ss_item_sk  from item,  (select iss.i_brand_id brand_id      ,iss.i_class_id class_id      ,iss.i_category_id category_id  from store_sales      ,item iss      ,date_dim d1  where ss_item_sk = iss.i_item_sk    and ss_sold_date_sk = d1.d_date_sk    and d1.d_year between 1999 AND 1999 + 2  intersect   select ics.i_brand_id      ,ics.i_class_id      ,ics.i_category_id  from catalog_sales      ,item ics      ,date_dim d2  where cs_item_sk = ics.i_item_sk    and cs_sold_date_sk = d2.d_date_sk    and d2.d_year between 1999 AND 1999 + 2  intersect  select iws.i_brand_id      ,iws.i_class_id      ,iws.i_category_id  from web_sales      ,item iws      ,date_dim d3  where ws_item_sk = iws.i_item_sk    and ws_sold_date_sk = d3.d_date_sk    and d3.d_year between 1999 AND 1999 + 2) a  where i_brand_id = brand_id       and i_class_id = class_id       and i_category_id = category_id ),  avg_sales as  (select avg(quantity*list_price) average_sales   from (select ss_quantity quantity              ,ss_list_price list_price        from store_sales            ,date_dim        where ss_sold_date_sk = d_date_sk          and d_year between 1999 and 1999 + 2        union all         select cs_quantity quantity               ,cs_list_price list_price        from catalog_sales            ,date_dim        where cs_sold_date_sk = d_date_sk          and d_year between 1999 and 1999 + 2         union all        select ws_quantity quantity              ,ws_list_price list_price        from web_sales            ,date_dim        where ws_sold_date_sk = d_date_sk          and d_year between 1999 and 1999 + 2) x)   select top (100) channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)  from(        select 'store' channel, i_brand_id,i_class_id              ,i_category_id,sum(ss_quantity*ss_list_price) sales              , count(*) number_sales        from store_sales            ,item            ,date_dim        where ss_item_sk in (select ss_item_sk from cross_items)          and ss_item_sk = i_item_sk          and ss_sold_date_sk = d_date_sk          and d_year = 1999+2           and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)        union all        select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales        from catalog_sales            ,item            ,date_dim        where cs_item_sk in (select ss_item_sk from cross_items)          and cs_item_sk = i_item_sk          and cs_sold_date_sk = d_date_sk          and d_year = 1999+2           and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)        union all        select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales        from web_sales            ,item            ,date_dim        where ws_item_sk in (select ss_item_sk from cross_items)          and ws_item_sk = i_item_sk          and ws_sold_date_sk = d_date_sk          and d_year = 1999+2          and d_moy = 11        group by i_brand_id,i_class_id,i_category_id        having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)  ) y  group by rollup (channel, i_brand_id,i_class_id,i_category_id)  order by channel,i_brand_id,i_class_id,i_category_id  ; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_list_price", "cs_quantity"], "date_dim": ["d_date_sk"], "item": ["i_category_id", "i_class_id", "i_item_sk", "i_brand_id"], "store_sales": ["ss_sold_date_sk", "ss_list_price", "ss_quantity", "ss_item_sk"], "web_sales": ["ws_list_price", "ws_sold_date_sk", "ws_item_sk", "ws_quantity"]}, "group_by": {}, "order_by": {}}
{"id": 15, "query_string": " select top (100) ca_zip        ,sum(cs_sales_price)  from catalog_sales      ,customer      ,customer_address      ,date_dim  where cs_bill_customer_sk = c_customer_sk  \tand c_current_addr_sk = ca_address_sk   \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',                                    '85392', '85460', '80348', '81792')  \t      or ca_state in ('CA','WA','GA')  \t      or cs_sales_price > 500)  \tand cs_sold_date_sk = d_date_sk  \tand d_qoy = 1 and d_year = 2001  group by ca_zip  order by ca_zip  ;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"catalog_sales": ["cs_sales_price", "cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip", "ca_state"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_zip"]}}
{"id": 16, "query_string": " select top (100)     count(distinct cs_order_number) as \"order count\"   ,sum(cs_ext_ship_cost) as \"total shipping cost\"   ,sum(cs_net_profit) as \"total net profit\" from    catalog_sales cs1   ,date_dim   ,customer_address   ,call_center where     d_date between '2001-3-01' and             dateadd(day, 60, cast('2001-3-01' as date)) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'TX' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County',                   'Williamson County' ) and exists (select *             from catalog_sales cs2             where cs1.cs_order_number = cs2.cs_order_number               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select *                from catalog_returns cr1                where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number);", "predicates": {"call_center": ["cc_county"], "customer_address": ["ca_state"], "date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_order_number"], "catalog_sales": ["cs_order_number", "cs_warehouse_sk", "cs_ext_ship_cost", "cs_ship_addr_sk", "cs_net_profit", "cs_call_center_sk", "cs_ship_date_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 17, "query_string": " select top (100) i_item_id        ,i_item_desc        ,s_state        ,count(ss_quantity) as store_sales_quantitycount        ,avg(ss_quantity) as store_sales_quantityave        ,stdev(ss_quantity) as store_sales_quantitystdev        ,stdev(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov        ,count(sr_return_quantity) as store_returns_quantitycount        ,avg(sr_return_quantity) as store_returns_quantityave        ,stdev(sr_return_quantity) as store_returns_quantitystdev        ,stdev(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov        ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave        ,stdev(cs_quantity) as catalog_sales_quantitystdev        ,stdev(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov  from store_sales      ,store_returns      ,catalog_sales      ,date_dim d1      ,date_dim d2      ,date_dim d3      ,store      ,item  where d1.d_quarter_name = '2000Q1'    and d1.d_date_sk = ss_sold_date_sk    and i_item_sk = ss_item_sk    and s_store_sk = ss_store_sk    and ss_customer_sk = sr_customer_sk    and ss_item_sk = sr_item_sk    and ss_ticket_number = sr_ticket_number    and sr_returned_date_sk = d2.d_date_sk    and d2.d_quarter_name in ('2000Q1','2000Q2','2000Q3')    and sr_customer_sk = cs_bill_customer_sk    and sr_item_sk = cs_item_sk    and cs_sold_date_sk = d3.d_date_sk    and d3.d_quarter_name in ('2000Q1','2000Q2','2000Q3')  group by i_item_id          ,i_item_desc          ,s_state  order by i_item_id          ,i_item_desc          ,s_state;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_quarter_name"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_state", "s_store_sk"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_return_quantity", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 18, "query_string": " select top (100) i_item_id,         ca_country,         ca_state,          ca_county,         avg( cast(cs_quantity as decimal(12,2))) agg1,         avg( cast(cs_list_price as decimal(12,2))) agg2,         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,         avg( cast(cs_sales_price as decimal(12,2))) agg4,         avg( cast(cs_net_profit as decimal(12,2))) agg5,         avg( cast(c_birth_year as decimal(12,2))) agg6,         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7  from catalog_sales, customer_demographics cd1,        customer_demographics cd2, customer, customer_address, date_dim, item  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd1.cd_demo_sk and        cs_bill_customer_sk = c_customer_sk and        cd1.cd_gender = 'F' and         cd1.cd_education_status = 'College' and        c_current_cdemo_sk = cd2.cd_demo_sk and        c_current_addr_sk = ca_address_sk and        c_birth_month in (5,11,10,7,4,2) and        d_year = 2002 and        ca_state in ('NC','MN','IA'                    ,'TX','MS','IN','KY')  group by rollup (i_item_id, ca_country, ca_state, ca_county)  order by ca_country,         ca_state,          ca_county, \ti_item_id  ;", "predicates": {"customer": ["c_birth_month"], "customer_address": ["ca_state"], "customer_demographics": ["cd_education_status", "cd_gender"], "date_dim": ["d_year"]}, "payload": {"catalog_sales": ["cs_quantity", "cs_sales_price", "cs_bill_customer_sk", "cs_item_sk", "cs_net_profit", "cs_list_price", "cs_coupon_amt", "cs_sold_date_sk", "cs_bill_cdemo_sk"], "customer": ["c_birth_year", "c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_county", "ca_country", "ca_state"], "customer_demographics": ["cd_demo_sk", "cd_dep_count"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer_address": ["ca_state", "ca_county", "ca_country"], "item": ["i_item_id"]}}
{"id": 19, "query_string": " select top (100) i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,  \tsum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item,customer,customer_address,store  where d_date_sk = ss_sold_date_sk    and ss_item_sk = i_item_sk    and i_manager_id=14    and d_moy=12    and d_year=1999    and ss_customer_sk = c_customer_sk     and c_current_addr_sk = ca_address_sk    and substring(ca_zip,1,5) <> substring(s_zip,1,5)     and ss_store_sk = s_store_sk   group by i_brand       ,i_brand_id       ,i_manufact_id       ,i_manufact  order by ext_price desc          ,i_brand          ,i_brand_id          ,i_manufact_id          ,i_manufact  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip"], "date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_brand_id", "i_manufact_id", "i_brand", "i_manufact"], "store": ["s_zip", "s_store_sk"]}, "group_by": {}, "order_by": {"item": ["i_brand", "i_manufact", "i_brand_id", "i_manufact_id"]}}
{"id": 20, "query_string": " select top (100) i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from\tcatalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Home', 'Electronics', 'Jewelry')    and cs_sold_date_sk = d_date_sk  and d_date between cast('2000-06-11' as date)   \t\t\t\tand dateadd(day, 30, cast('2000-06-11' as date))  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"]}, "group_by": {}, "order_by": {"item": ["i_item_desc", "i_class", "i_item_id", "i_category"]}}
{"id": 21, "query_string": " select top (100) *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-11' as date)) \t                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between dateadd(day, -30, cast ('1999-02-11' as date))                     and dateadd(day, 30, cast ('1999-02-11' as date))    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  ;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"]}, "payload": {"date_dim": ["d_date_sk", "d_date"], "item": ["i_item_id", "i_item_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 22, "query_string": " select top (100) i_product_name              ,i_brand              ,i_class              ,i_category              ,avg(inv_quantity_on_hand) qoh        from inventory            ,date_dim            ,item        where inv_date_sk=d_date_sk               and inv_item_sk=i_item_sk               and d_month_seq between 1191 and 1191 + 11        group by rollup(i_product_name                        ,i_brand                        ,i_class                        ,i_category) order by qoh, i_product_name, i_brand, i_class, i_category;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_brand", "i_product_name", "i_category", "i_class"]}, "group_by": {}, "order_by": {"item": ["i_product_name", "i_class", "i_brand", "i_category"]}}
{"id": 23, "query_string": " with frequent_ss_items as   (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt   from store_sales       ,date_dim        ,item   where ss_sold_date_sk = d_date_sk     and ss_item_sk = i_item_sk      and d_year in (2000,2000+1,2000+2,2000+3)   group by substring(i_item_desc,1,30),i_item_sk,d_date   having count(*) >4),  max_store_sales as  (select max(csales) tpcds_cmax    from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales         from store_sales             ,customer             ,date_dim          where ss_customer_sk = c_customer_sk          and ss_sold_date_sk = d_date_sk          and d_year in (2000,2000+1,2000+2,2000+3)          group by c_customer_sk) a),  best_ss_customer as  (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales   from store_sales       ,customer   where ss_customer_sk = c_customer_sk   group by c_customer_sk   having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select   * from  max_store_sales))   select top (100) sum(sales)  from (select cs_quantity*cs_list_price sales        from catalog_sales            ,date_dim         where d_year = 2000           and d_moy = 7           and cs_sold_date_sk = d_date_sk           and cs_item_sk in (select item_sk from frequent_ss_items)          and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)       union all       select ws_quantity*ws_list_price sales        from web_sales             ,date_dim         where d_year = 2000           and d_moy = 7           and ws_sold_date_sk = d_date_sk           and ws_item_sk in (select item_sk from frequent_ss_items)          and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) b  ; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"customer": ["c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "item": ["i_item_sk", "i_item_desc"], "store_sales": ["ss_item_sk", "ss_sales_price", "ss_customer_sk", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 24, "query_string": " with ssales as (select c_last_name       ,c_first_name       ,s_store_name       ,ca_state       ,s_state       ,i_color       ,i_current_price       ,i_manager_id       ,i_units       ,i_size       ,sum(ss_ext_sales_price) netpaid from store_sales     ,store_returns     ,store     ,item     ,customer     ,customer_address where ss_ticket_number = sr_ticket_number   and ss_item_sk = sr_item_sk   and ss_customer_sk = c_customer_sk   and ss_item_sk = i_item_sk   and ss_store_sk = s_store_sk   and c_current_addr_sk = ca_address_sk   and c_birth_country <> upper(ca_country)   and s_zip = ca_zip and s_market_id=10 group by c_last_name         ,c_first_name         ,s_store_name         ,ca_state         ,s_state         ,i_color         ,i_current_price         ,i_manager_id         ,i_units         ,i_size) select c_last_name       ,c_first_name       ,s_store_name       ,sum(netpaid) paid from ssales where i_color = 'spring' group by c_last_name         ,c_first_name         ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid)                                  from ssales) order by c_last_name         ,c_first_name         ,s_store_name; ", "predicates": {"item": ["i_color"], "store": ["s_market_id"]}, "payload": {"customer": ["c_customer_sk", "c_birth_country", "c_last_name", "c_first_name", "c_current_addr_sk"], "customer_address": ["ca_address_sk", "ca_country", "ca_zip", "ca_state"], "item": ["i_item_sk", "i_units", "i_manager_id", "i_current_price", "i_size"], "store": ["s_zip", "s_store_name", "s_state", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_net_paid_inc_tax"]}, "group_by": {}, "order_by": {}}
{"id": 25, "query_string": " select top (100)   i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  ,min(ss_net_profit) as store_sales_profit  ,min(sr_net_loss) as store_returns_loss  ,min(cs_net_profit) as catalog_sales_profit  from  store_sales  ,store_returns  ,catalog_sales  ,date_dim d1  ,date_dim d2  ,date_dim d3  ,store  ,item  where  d1.d_moy = 4  and d1.d_year = 2001  and d1.d_date_sk = ss_sold_date_sk  and i_item_sk = ss_item_sk  and s_store_sk = ss_store_sk  and ss_customer_sk = sr_customer_sk  and ss_item_sk = sr_item_sk  and ss_ticket_number = sr_ticket_number  and sr_returned_date_sk = d2.d_date_sk  and d2.d_moy               between 4 and  10  and d2.d_year              = 2001  and sr_customer_sk = cs_bill_customer_sk  and sr_item_sk = cs_item_sk  and cs_sold_date_sk = d3.d_date_sk  and d3.d_moy               between 4 and  10   and d3.d_year              = 2001  group by  i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  order by  i_item_id  ,i_item_desc  ,s_store_id  ,s_store_name  ;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_store_name", "s_store_sk", "s_store_id"], "store_returns": ["sr_returned_date_sk", "sr_net_loss", "sr_customer_sk", "sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 26, "query_string": " select top (100) i_item_id,          avg(cs_quantity) agg1,         avg(cs_list_price) agg2,         avg(cs_coupon_amt) agg3,         avg(cs_sales_price) agg4   from catalog_sales, customer_demographics, date_dim, item, promotion  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd_demo_sk and        cs_promo_sk = p_promo_sk and        cd_gender = 'M' and         cd_marital_status = 'D' and        cd_education_status = 'Secondary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 1999   group by i_item_id  order by i_item_id  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "promotion": ["p_channel_event", "p_channel_email"]}, "payload": {"item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 27, "query_string": " select top (100) i_item_id,         s_state, grouping(s_state) g_state,         avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4  from store_sales, customer_demographics, date_dim, store, item  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_store_sk = s_store_sk and        ss_cdemo_sk = cd_demo_sk and        cd_gender = 'M' and        cd_marital_status = 'U' and        cd_education_status = 'Unknown' and        d_year = 2002 and        s_state in ('TN','TN', 'TN', 'TN', 'TN', 'TN')  group by rollup (i_item_id, s_state)  order by i_item_id          ,s_state  ;", "predicates": {"customer_demographics": ["cd_education_status", "cd_marital_status", "cd_gender"], "date_dim": ["d_year"], "store": ["s_state"]}, "payload": {"customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"], "store": ["s_state", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_cdemo_sk", "ss_list_price", "ss_quantity", "ss_sales_price", "ss_coupon_amt", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_id"], "store": ["s_state"]}}
{"id": 28, "query_string": " select top (100) * from (select avg(ss_list_price) B1_LP             ,count(ss_list_price) B1_CNT             ,count(distinct ss_list_price) B1_CNTD       from store_sales       where ss_quantity between 0 and 5         and (ss_list_price between 8 and 8+10               or ss_coupon_amt between 901 and 901+1000              or ss_wholesale_cost between 24 and 24+20)) B1,      (select avg(ss_list_price) B2_LP             ,count(ss_list_price) B2_CNT             ,count(distinct ss_list_price) B2_CNTD       from store_sales       where ss_quantity between 6 and 10         and (ss_list_price between 1 and 1+10           or ss_coupon_amt between 1723 and 1723+1000           or ss_wholesale_cost between 16 and 16+20)) B2,      (select avg(ss_list_price) B3_LP             ,count(ss_list_price) B3_CNT             ,count(distinct ss_list_price) B3_CNTD       from store_sales       where ss_quantity between 11 and 15         and (ss_list_price between 46 and 46+10           or ss_coupon_amt between 14728 and 14728+1000           or ss_wholesale_cost between 23 and 23+20)) B3,      (select avg(ss_list_price) B4_LP             ,count(ss_list_price) B4_CNT             ,count(distinct ss_list_price) B4_CNTD       from store_sales       where ss_quantity between 16 and 20         and (ss_list_price between 179 and 179+10           or ss_coupon_amt between 622 and 622+1000           or ss_wholesale_cost between 51 and 51+20)) B4,      (select avg(ss_list_price) B5_LP             ,count(ss_list_price) B5_CNT             ,count(distinct ss_list_price) B5_CNTD       from store_sales       where ss_quantity between 21 and 25         and (ss_list_price between 172 and 172+10           or ss_coupon_amt between 8274 and 8274+1000           or ss_wholesale_cost between 61 and 61+20)) B5,      (select avg(ss_list_price) B6_LP             ,count(ss_list_price) B6_CNT             ,count(distinct ss_list_price) B6_CNTD       from store_sales       where ss_quantity between 26 and 30         and (ss_list_price between 190 and 190+10           or ss_coupon_amt between 10252 and 10252+1000           or ss_wholesale_cost between 34 and 34+20)) B6;", "predicates": {"store_sales": ["ss_list_price", "ss_coupon_amt", "ss_quantity", "ss_wholesale_cost"]}, "payload": {"store_sales": ["ss_list_price"]}, "group_by": {}, "order_by": {}}
{"id": 29, "query_string": " select top (100)        i_item_id     ,i_item_desc     ,s_store_id     ,s_store_name     ,avg(ss_quantity)        as store_sales_quantity     ,avg(sr_return_quantity) as store_returns_quantity     ,avg(cs_quantity)        as catalog_sales_quantity  from     store_sales    ,store_returns    ,catalog_sales    ,date_dim             d1    ,date_dim             d2    ,date_dim             d3    ,store    ,item  where      d1.d_moy               = 4   and d1.d_year              = 2000  and d1.d_date_sk           = ss_sold_date_sk  and i_item_sk              = ss_item_sk  and s_store_sk             = ss_store_sk  and ss_customer_sk         = sr_customer_sk  and ss_item_sk             = sr_item_sk  and ss_ticket_number       = sr_ticket_number  and sr_returned_date_sk    = d2.d_date_sk  and d2.d_moy               between 4 and  4 + 3   and d2.d_year              = 2000  and sr_customer_sk         = cs_bill_customer_sk  and sr_item_sk             = cs_item_sk  and cs_sold_date_sk        = d3.d_date_sk       and d3.d_year              in (2000,2000+1,2000+2)  group by     i_item_id    ,i_item_desc    ,s_store_id    ,s_store_name  order by     i_item_id     ,i_item_desc    ,s_store_id    ,s_store_name  ;", "predicates": {"catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_customer_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc"], "store": ["s_store_name", "s_store_sk", "s_store_id"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_return_quantity", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 30, "query_string": " with customer_total_return as  (select wr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   \tsum(wr_return_amt) as ctr_total_return  from web_returns      ,date_dim      ,customer_address  where wr_returned_date_sk = d_date_sk     and d_year =2001    and wr_returning_addr_sk = ca_address_sk   group by wr_returning_customer_sk          ,ca_state)   select top (100) c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag        ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address        ,c_last_review_date,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  \t\t\t  from customer_total_return ctr2                    \t  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'AL'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag                   ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address                   ,c_last_review_date,ctr_total_return;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_year"]}, "payload": {"customer": ["c_birth_year", "c_login", "c_customer_sk", "c_birth_month", "c_salutation", "c_birth_day", "c_birth_country", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_current_addr_sk", "c_email_address", "c_customer_id", "c_last_review_date"], "customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "web_returns": ["wr_return_amt", "wr_returning_addr_sk", "wr_returned_date_sk", "wr_returning_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_birth_year", "c_login", "c_birth_month", "c_birth_country", "c_salutation", "c_birth_day", "c_last_name", "c_first_name", "c_preferred_cust_flag", "c_email_address", "c_customer_id", "c_last_review_date"]}}
{"id": 31, "query_string": " with ss as  (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales  from store_sales,date_dim,customer_address  where ss_sold_date_sk = d_date_sk   and ss_addr_sk=ca_address_sk  group by ca_county,d_qoy, d_year),  ws as  (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales  from web_sales,date_dim,customer_address  where ws_sold_date_sk = d_date_sk   and ws_bill_addr_sk=ca_address_sk  group by ca_county,d_qoy, d_year)  select          ss1.ca_county        ,ss1.d_year        ,ws2.web_sales/ws1.web_sales web_q1_q2_increase        ,ss2.store_sales/ss1.store_sales store_q1_q2_increase        ,ws3.web_sales/ws2.web_sales web_q2_q3_increase        ,ss3.store_sales/ss2.store_sales store_q2_q3_increase  from         ss ss1        ,ss ss2        ,ss ss3        ,ws ws1        ,ws ws2        ,ws ws3  where     ss1.d_qoy = 1     and ss1.d_year = 2001     and ss1.ca_county = ss2.ca_county     and ss2.d_qoy = 2     and ss2.d_year = 2001  and ss2.ca_county = ss3.ca_county     and ss3.d_qoy = 3     and ss3.d_year = 2001     and ss1.ca_county = ws1.ca_county     and ws1.d_qoy = 1     and ws1.d_year = 2001     and ws1.ca_county = ws2.ca_county     and ws2.d_qoy = 2     and ws2.d_year = 2001     and ws1.ca_county = ws3.ca_county     and ws3.d_qoy = 3     and ws3.d_year =2001     and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end         > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end     and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end        > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end  order by web_q2_q3_increase;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"customer_address": ["ca_address_sk", "ca_county"], "date_dim": ["d_date_sk", "d_year"], "store_sales": ["ss_sold_date_sk", "ss_addr_sk", "ss_ext_sales_price"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_bill_addr_sk"]}, "group_by": {}, "order_by": {}}
{"id": 32, "query_string": " select top (100) sum(cs_ext_discount_amt)  as \"excess discount amount\"  from     catalog_sales     ,item     ,date_dim where i_manufact_id = 344 and i_item_sk = cs_item_sk  and d_date between '2001-03-14' and          dateadd(day, 90, cast('2001-03-14' as date)) and d_date_sk = cs_sold_date_sk  and cs_ext_discount_amt        > (           select              1.3 * avg(cs_ext_discount_amt)           from              catalog_sales             ,date_dim          where                cs_item_sk = i_item_sk            and d_date between '2001-03-14' and                              dateadd(day, 90, cast('2001-03-14' as date))           and d_date_sk = cs_sold_date_sk        ) ;", "predicates": {"catalog_sales": ["cs_ext_discount_amt"], "date_dim": ["d_date"], "item": ["i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 33, "query_string": " with ss as (  select           i_manufact_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id in (select   i_manufact_id from  item where i_category in ('Home'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 7  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  cs as (  select           i_manufact_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Home'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 7  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  ws as (  select           i_manufact_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Home'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 7  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_manufact_id)   select top (100) i_manufact_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_manufact_id  order by total_sales;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_category"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_addr_sk", "cs_item_sk", "cs_ext_sales_price"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_manufact_id"], "store_sales": ["ss_sold_date_sk", "ss_addr_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk", "ws_bill_addr_sk"]}, "group_by": {}, "order_by": {}}
{"id": 34, "query_string": " select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '501-1000' or          household_demographics.hd_buy_potential = '0-500')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  \tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  \telse null  \tend)  > 1.2     and date_dim.d_year in (1999,1999+1,1999+2)     and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',                            'Williamson County','Williamson County','Williamson County','Williamson County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;", "predicates": {"date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count", "hd_buy_potential"], "store": ["s_county"]}, "payload": {"customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_preferred_cust_flag"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 35, "query_string": " select top (100)     ca_state,   cd_gender,   cd_marital_status,   cd_dep_count,   count(*) cnt1,   max(cd_dep_count),   avg(cd_dep_count),   min(cd_dep_count),   cd_dep_employed_count,   count(*) cnt2,   max(cd_dep_employed_count),   avg(cd_dep_employed_count),   min(cd_dep_employed_count),   cd_dep_college_count,   count(*) cnt3,   max(cd_dep_college_count),   avg(cd_dep_college_count),   min(cd_dep_college_count)  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2001 and                 d_qoy < 4) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_qoy < 4) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_qoy < 4))  group by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  ;", "predicates": {"date_dim": ["d_qoy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_state"], "customer_demographics": ["cd_dep_college_count", "cd_gender", "cd_demo_sk", "cd_dep_employed_count", "cd_dep_count", "cd_marital_status"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 36, "query_string": " select top (100)      sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  \tpartition by grouping(i_category)+grouping(i_class),  \tcase when grouping(i_class) = 0 then i_category end   \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent  from     store_sales    ,date_dim       d1    ,item    ,store  where     d1.d_year = 2001   and d1.d_date_sk = ss_sold_date_sk  and i_item_sk  = ss_item_sk   and s_store_sk  = ss_store_sk  and s_state in ('TN','TN','TN','TN',                  'TN','TN','TN','TN')  group by rollup(i_category,i_class)  order by    lochierarchy desc   ,case when (grouping(i_category)+grouping(i_class)) = 0 then i_category end   ,rank_within_parent   ;", "predicates": {"date_dim": ["d_year"], "store": ["s_state"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_class", "i_item_sk", "i_category"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_ext_sales_price", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 37, "query_string": " select top (100) i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 25 and 25 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('1998-07-03' as date) and dateadd(day, 60, cast('1998-07-03' as date))  and i_manufact_id in (776,852,883,931)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  ;", "predicates": {"date_dim": ["d_date"], "inventory": ["inv_quantity_on_hand"], "item": ["i_current_price", "i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc", "i_current_price"]}, "group_by": {}, "order_by": {}}
{"id": 38, "query_string": " select top (100) count(*) from (     select distinct c_last_name, c_first_name, d_date     from store_sales, date_dim, customer           where store_sales.ss_sold_date_sk = date_dim.d_date_sk       and store_sales.ss_customer_sk = customer.c_customer_sk       and d_month_seq between 1191 and 1191 + 11   intersect     select distinct c_last_name, c_first_name, d_date     from catalog_sales, date_dim, customer           where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk       and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk       and d_month_seq between 1191 and 1191 + 11   intersect     select distinct c_last_name, c_first_name, d_date     from web_sales, date_dim, customer           where web_sales.ws_sold_date_sk = date_dim.d_date_sk       and web_sales.ws_bill_customer_sk = customer.c_customer_sk       and d_month_seq between 1191 and 1191 + 11 ) hot_cust;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk", "ws_item_sk", "ws_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 39, "query_string": " with inv as (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy        ,stdev,mean, case mean when 0 then null else stdev/mean end cov  from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy             ,stdev(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean       from inventory           ,item           ,warehouse           ,date_dim       where inv_item_sk = i_item_sk         and inv_warehouse_sk = w_warehouse_sk         and inv_date_sk = d_date_sk         and d_year =1999       group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo  where case mean when 0 then 0 else stdev/mean end > 1) select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov         ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov from inv inv1,inv inv2 where inv1.i_item_sk = inv2.i_item_sk   and inv1.w_warehouse_sk =  inv2.w_warehouse_sk   and inv1.d_moy=3   and inv2.d_moy=3+1 order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov         ,inv2.d_moy,inv2.mean, inv2.cov; ", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_item_sk"], "warehouse": ["w_warehouse_sk"]}, "group_by": {}, "order_by": {}}
{"id": 40, "query_string": " select top (100)     w_state   ,i_item_id   ,sum(case when (cast(d_date as date) < cast ('1999-02-11' as date))   \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before   ,sum(case when (cast(d_date as date) >= cast ('1999-02-11' as date))   \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after  from    catalog_sales left outer join catalog_returns on        (cs_order_number = cr_order_number          and cs_item_sk = cr_item_sk)   ,warehouse    ,item   ,date_dim  where      i_current_price between 0.99 and 1.49  and i_item_sk          = cs_item_sk  and cs_warehouse_sk    = w_warehouse_sk   and cs_sold_date_sk    = d_date_sk  and d_date between dateadd(day, -30, cast ('1999-02-11' as date))                 and dateadd(day, 30, cast ('1999-02-11' as date))   group by     w_state,i_item_id  order by w_state,i_item_id;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_refunded_cash"], "date_dim": ["d_date_sk", "d_date"], "item": ["i_item_id", "i_item_sk"], "warehouse": ["w_state", "w_warehouse_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_id"], "warehouse": ["w_state"]}}
{"id": 41, "query_string": " select distinct top (100) i_product_name  from item i1  where i_manufact_id between 965 and 965+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'misty' or i_color = 'frosted') and          (i_units = 'Ounce' or i_units = 'Gram') and         (i_size = 'medium' or i_size = 'economy')         ) or         (i_category = 'Women' and         (i_color = 'azure' or i_color = 'ivory') and         (i_units = 'Case' or i_units = 'Tsp') and         (i_size = 'small' or i_size = 'large')         ) or         (i_category = 'Men' and         (i_color = 'lavender' or i_color = 'pink') and         (i_units = 'Dram' or i_units = 'Ton') and         (i_size = 'N/A' or i_size = 'extra large')         ) or         (i_category = 'Men' and         (i_color = 'dark' or i_color = 'peach') and         (i_units = 'Oz' or i_units = 'Tbl') and         (i_size = 'medium' or i_size = 'economy')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'chocolate' or i_color = 'saddle') and          (i_units = 'Dozen' or i_units = 'N/A') and         (i_size = 'medium' or i_size = 'economy')         ) or         (i_category = 'Women' and         (i_color = 'turquoise' or i_color = 'wheat') and         (i_units = 'Box' or i_units = 'Bundle') and         (i_size = 'small' or i_size = 'large')         ) or         (i_category = 'Men' and         (i_color = 'snow' or i_color = 'gainsboro') and         (i_units = 'Pound' or i_units = 'Gross') and         (i_size = 'N/A' or i_size = 'extra large')         ) or         (i_category = 'Men' and         (i_color = 'lime' or i_color = 'chartreuse') and         (i_units = 'Each' or i_units = 'Carton') and         (i_size = 'medium' or i_size = 'economy')         )))) > 0  order by i_product_name  ;", "predicates": {"item": ["i_color", "i_units", "i_manufact_id", "i_category", "i_size", "i_manufact"]}, "payload": {"item": ["i_color", "i_units", "i_product_name", "i_category", "i_size", "i_manufact"]}, "group_by": {}, "order_by": {}}
{"id": 42, "query_string": " select top (100) dt.d_year  \t,item.i_category_id  \t,item.i_category  \t,sum(ss_ext_sales_price)  from \tdate_dim dt  \t,store_sales  \t,item  where dt.d_date_sk = store_sales.ss_sold_date_sk  \tand store_sales.ss_item_sk = item.i_item_sk  \tand item.i_manager_id = 1  \t  \tand dt.d_moy=11  \tand dt.d_year=1999  group by \tdt.d_year  \t\t,item.i_category_id  \t\t,item.i_category  order by       sum(ss_ext_sales_price) desc,dt.d_year  \t\t,item.i_category_id  \t\t,item.i_category  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_item_sk", "i_category", "i_category_id"]}, "group_by": {}, "order_by": {"item": ["i_category", "i_category_id"]}}
{"id": 43, "query_string": " select top (100) s_store_name, s_store_id,         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales  from date_dim, store_sales, store  where d_date_sk = ss_sold_date_sk and        s_store_sk = ss_store_sk and        s_gmt_offset = -5 and        d_year = 1999   group by s_store_name, s_store_id  order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales  ;", "predicates": {"date_dim": ["d_year"], "store": ["s_gmt_offset"]}, "payload": {"date_dim": ["d_date_sk", "d_day_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 44, "query_string": " select top (100) asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing from(select *      from (select item_sk,rank() over (order by rank_col asc) rnk            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col                   from store_sales ss1                  where ss_store_sk = 5                  group by ss_item_sk                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col                                                   from store_sales                                                   where ss_store_sk = 5                                                     and ss_addr_sk is null                                                   group by ss_store_sk))V1)V11      where rnk  < 11) asceding,     (select *      from (select item_sk,rank() over (order by rank_col desc) rnk            from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col                  from store_sales ss1                  where ss_store_sk = 5                  group by ss_item_sk                  having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col                                                   from store_sales                                                   where ss_store_sk = 5                                                     and ss_addr_sk is null                                                   group by ss_store_sk))V2)V21      where rnk  < 11) descending, item i1, item i2 where asceding.rnk = descending.rnk    and i1.i_item_sk=asceding.item_sk   and i2.i_item_sk=descending.item_sk order by asceding.rnk;", "predicates": {"store_sales": ["ss_store_sk", "ss_customer_sk"]}, "payload": {"store_sales": ["ss_net_profit", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 45, "query_string": " select top (100) ca_zip, ca_state, sum(ws_sales_price)  from web_sales, customer, customer_address, date_dim, item  where ws_bill_customer_sk = c_customer_sk  \tand c_current_addr_sk = ca_address_sk   \tand ws_item_sk = i_item_sk   \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')  \t      or   \t      i_item_id in (select i_item_id                              from item                              where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)                              )  \t    )  \tand ws_sold_date_sk = d_date_sk  \tand d_qoy = 2 and d_year = 2002  group by ca_zip, ca_state  order by ca_zip, ca_state  ;", "predicates": {"customer_address": ["ca_zip"], "date_dim": ["d_qoy", "d_year"], "item": ["i_item_id"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_zip", "ca_city"], "date_dim": ["d_date_sk"], "web_sales": ["ws_sales_price", "ws_sold_date_sk", "ws_bill_customer_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 46, "query_string": " select top (100) c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,ca_city bought_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics,customer_address      where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and (household_demographics.hd_dep_count = 8 or          household_demographics.hd_vehicle_count= -1)     and date_dim.d_dow in (6,0)     and date_dim.d_year in (2000,2000+1,2000+2)      and store.s_city in ('Fairview','Midway','Midway','Fairview','Fairview')      group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr     where ss_customer_sk = c_customer_sk       and customer.c_current_addr_sk = current_addr.ca_address_sk       and current_addr.ca_city <> bought_city   order by c_last_name           ,c_first_name           ,ca_city           ,bought_city           ,ss_ticket_number   ;", "predicates": {"date_dim": ["d_dow", "d_year"], "household_demographics": ["hd_vehicle_count", "hd_dep_count"], "store": ["s_city"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk", "c_first_name", "c_last_name"], "customer_address": ["ca_city", "ca_address_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_addr_sk", "ss_coupon_amt", "ss_customer_sk", "ss_hdemo_sk", "ss_net_profit", "ss_sold_date_sk", "ss_store_sk", "ss_ticket_number"]}, "group_by": {}, "order_by": {}}
{"id": 47, "query_string": " with v1 as(  select i_category, i_brand,         s_store_name, s_company_name,         d_year, d_moy,         sum(ss_sales_price) sum_sales,         avg(sum(ss_sales_price)) over           (partition by i_category, i_brand,                      s_store_name, s_company_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      s_store_name, s_company_name            order by d_year, d_moy) rn  from item, store_sales, date_dim, store  where ss_item_sk = i_item_sk and        ss_sold_date_sk = d_date_sk and        ss_store_sk = s_store_sk and        (          d_year = 2001 or          ( d_year = 2001-1 and d_moy =12) or          ( d_year = 2001+1 and d_moy =1)        )  group by i_category, i_brand,           s_store_name, s_company_name,           d_year, d_moy),  v2 as(  select v1.i_category, v1.i_brand, v1.s_store_name, v1.s_company_name         ,v1.d_year, v1.d_moy         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1.s_store_name = v1_lag.s_store_name and        v1.s_store_name = v1_lead.s_store_name and        v1.s_company_name = v1_lag.s_company_name and        v1.s_company_name = v1_lead.s_company_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select top (100) *  from v2  where  d_year = 2001 and             avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, sum_sales  ;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk", "d_moy", "d_year"], "item": ["i_brand", "i_item_sk", "i_category"], "store": ["s_store_name", "s_store_sk", "s_company_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 48, "query_string": " select sum (ss_quantity)  from store_sales, store, customer_demographics, customer_address, date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2000  and    (   (    cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'W'    and     cd_education_status = '4 yr Degree'    and     ss_sales_price between 100.00 and 150.00      )  or   (   cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'M'    and     cd_education_status = 'Secondary'    and     ss_sales_price between 50.00 and 100.00      )  or   (   cd_demo_sk = ss_cdemo_sk   and     cd_marital_status = 'D'    and     cd_education_status = 'College'    and     ss_sales_price between 150.00 and 200.00    )  )  and  (   (   ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('IA', 'CO', 'MI')   and ss_net_profit between 0 and 2000     )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('TN', 'NE', 'NJ')   and ss_net_profit between 150 and 3000    )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('LA', 'AZ', 'WI')   and ss_net_profit between 50 and 25000    )  );", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "store_sales": ["ss_sales_price", "ss_net_profit"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "date_dim": ["d_date_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_cdemo_sk", "ss_addr_sk", "ss_quantity", "ss_sales_price", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 49, "query_string": " select top (100) channel, item, return_ratio, return_rank, currency_rank from  (select  'web' as channel  ,web.item  ,web.return_ratio  ,web.return_rank  ,web.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect ws.ws_item_sk as item  \t\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\t web_sales ws left outer join web_returns wr   \t\t\ton (ws.ws_order_number = wr.wr_order_number and   \t\t\tws.ws_item_sk = wr.wr_item_sk)                  ,date_dim  \t\twhere   \t\t\twr.wr_return_amt > 10000   \t\t\tand ws.ws_net_profit > 1                          and ws.ws_net_paid > 0                          and ws.ws_quantity > 0                          and ws_sold_date_sk = d_date_sk                          and d_year = 2001                          and d_moy = 11  \t\tgroup by ws.ws_item_sk  \t) in_web  ) web  where   (  web.return_rank <= 10  or  web.currency_rank <= 10  )  union  select   'catalog' as channel  ,catalog.item  ,catalog.return_ratio  ,catalog.return_rank  ,catalog.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect   \t\tcs.cs_item_sk as item  \t\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/  \t\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\tcatalog_sales cs left outer join catalog_returns cr  \t\t\ton (cs.cs_order_number = cr.cr_order_number and   \t\t\tcs.cs_item_sk = cr.cr_item_sk)                 ,date_dim  \t\twhere   \t\t\tcr.cr_return_amount > 10000   \t\t\tand cs.cs_net_profit > 1                          and cs.cs_net_paid > 0                          and cs.cs_quantity > 0                          and cs_sold_date_sk = d_date_sk                          and d_year = 2001                          and d_moy = 11                  group by cs.cs_item_sk  \t) in_cat  ) catalog  where   (  catalog.return_rank <= 10  or  catalog.currency_rank <=10  )  union  select   'store' as channel  ,store.item  ,store.return_ratio  ,store.return_rank  ,store.currency_rank  from (  \tselect   \t item  \t,return_ratio  \t,currency_ratio  \t,rank() over (order by return_ratio) as return_rank  \t,rank() over (order by currency_ratio) as currency_rank  \tfrom  \t(\tselect sts.ss_item_sk as item  \t\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio  \t\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio  \t\tfrom   \t\tstore_sales sts left outer join store_returns sr  \t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)                 ,date_dim  \t\twhere   \t\t\tsr.sr_return_amt > 10000   \t\t\tand sts.ss_net_profit > 1                          and sts.ss_net_paid > 0                           and sts.ss_quantity > 0                          and ss_sold_date_sk = d_date_sk                          and d_year = 2001                          and d_moy = 11  \t\tgroup by sts.ss_item_sk  \t) in_store  ) store  where  (  store.return_rank <= 10  or   store.currency_rank <= 10  )  ) a  order by 1,4,5,2  ;", "predicates": {"catalog_returns": ["cr_return_amount"], "catalog_sales": ["cs_net_paid", "cs_net_profit", "cs_quantity"], "date_dim": ["d_moy", "d_year"], "store_returns": ["sr_return_amt"], "store_sales": ["ss_net_paid", "ss_quantity", "ss_net_profit"], "web_returns": ["wr_return_amt"], "web_sales": ["ws_net_profit", "ws_net_paid", "ws_quantity"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_quantity", "cr_return_amount"], "store_returns": ["sr_return_amt", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_return_amt", "wr_return_quantity", "wr_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 50, "query_string": " select top (100)     s_store_name   ,s_company_id   ,s_street_number   ,s_street_name   ,s_street_type   ,s_suite_number   ,s_city   ,s_county   ,s_state   ,s_zip   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and                   (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and                   (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and                  (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    store_sales   ,store_returns   ,store   ,date_dim d1   ,date_dim d2 where     d2.d_year = 2001 and d2.d_moy  = 9 and ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_sold_date_sk   = d1.d_date_sk and sr_returned_date_sk   = d2.d_date_sk and ss_customer_sk = sr_customer_sk and ss_store_sk = s_store_sk group by    s_store_name   ,s_company_id   ,s_street_number   ,s_street_name   ,s_street_type   ,s_suite_number   ,s_city   ,s_county   ,s_state   ,s_zip order by s_store_name         ,s_company_id         ,s_street_number         ,s_street_name         ,s_street_type         ,s_suite_number         ,s_city         ,s_county         ,s_state         ,s_zip;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_customer_sk", "sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 51, "query_string": " WITH web_v1 as ( select   ws_item_sk item_sk, d_date,   sum(sum(ws_sales_price))       over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from web_sales     ,date_dim where ws_sold_date_sk=d_date_sk   and d_month_seq between 1191 and 1191+11   and ws_item_sk is not NULL group by ws_item_sk, d_date), store_v1 as ( select   ss_item_sk item_sk, d_date,   sum(sum(ss_sales_price))       over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from store_sales     ,date_dim where ss_sold_date_sk=d_date_sk   and d_month_seq between 1191 and 1191+11   and ss_item_sk is not NULL group by ss_item_sk, d_date)  select top (100) * from (select item_sk      ,d_date      ,web_sales      ,store_sales      ,max(web_sales)          over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative      ,max(store_sales)          over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative      from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk                  ,case when web.d_date is not null then web.d_date else store.d_date end d_date                  ,web.cume_sales web_sales                  ,store.cume_sales store_sales            from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk                                                           and web.d_date = store.d_date)           )x )y where web_cumulative > store_cumulative order by item_sk         ,d_date;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_sales_price", "ss_item_sk"], "web_sales": ["ws_sold_date_sk", "ws_sales_price", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 52, "query_string": " select top (100) dt.d_year  \t,item.i_brand_id brand_id  \t,item.i_brand brand  \t,sum(ss_ext_sales_price) ext_price  from date_dim dt      ,store_sales      ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=11     and dt.d_year=1999  group by dt.d_year  \t,item.i_brand  \t,item.i_brand_id  order by dt.d_year  \t,ext_price desc  \t,brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"item": ["i_brand_id"]}}
{"id": 53, "query_string": " select top (100) * from  (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1191,1191+1,1191+2,1191+3,1191+4,1191+5,1191+6,1191+7,1191+8,1191+9,1191+10,1191+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', \t\t'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', \t\t'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0  \tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales  \telse null end > 0.1 order by avg_quarterly_sales, \t sum_sales, \t i_manufact_id;", "predicates": {"date_dim": ["d_month_seq"], "item": ["i_brand", "i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_qoy"], "item": ["i_item_sk", "i_manufact_id", "i_brand", "i_category", "i_class"], "store": ["s_store_sk"]}, "group_by": {}, "order_by": {}}
{"id": 54, "query_string": " with my_customers as (  select distinct c_customer_sk         , c_current_addr_sk  from            ( select cs_sold_date_sk sold_date_sk,                  cs_bill_customer_sk customer_sk,                  cs_item_sk item_sk           from   catalog_sales           union all           select ws_sold_date_sk sold_date_sk,                  ws_bill_customer_sk customer_sk,                  ws_item_sk item_sk           from   web_sales          ) cs_or_ws_sales,          item,          date_dim,          customer  where   sold_date_sk = d_date_sk          and item_sk = i_item_sk          and i_category = 'Men'          and i_class = 'shirts'          and c_customer_sk = cs_or_ws_sales.customer_sk          and d_moy = 7          and d_year = 1999  )  , my_revenue as (  select c_customer_sk,         sum(ss_ext_sales_price) as revenue  from   my_customers,         store_sales,         customer_address,         store,         date_dim  where  c_current_addr_sk = ca_address_sk         and ca_county = s_county         and ca_state = s_state         and ss_sold_date_sk = d_date_sk         and c_customer_sk = ss_customer_sk         and d_month_seq between (select distinct d_month_seq+1                                  from   date_dim where d_year = 1999 and d_moy = 7)                            and  (select distinct d_month_seq+3                                  from   date_dim where d_year = 1999 and d_moy = 7)  group by c_customer_sk  )  , segments as  (select cast((revenue/50) as int) as segment   from   my_revenue  )   select top (100) segment, count(*) as num_customers, segment*50 as segment_base  from segments  group by segment  order by segment, num_customers  ;", "predicates": {"date_dim": ["d_month_seq", "d_moy", "d_year"], "item": ["i_class", "i_category"]}, "payload": {"customer_address": ["ca_address_sk", "ca_county", "ca_state"], "date_dim": ["d_date_sk", "d_month_seq"], "item": ["i_item_sk"], "store": ["s_state", "s_county"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_ext_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 55, "query_string": " select top (100) i_brand_id brand_id, i_brand brand,  \tsum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item  where d_date_sk = ss_sold_date_sk  \tand ss_item_sk = i_item_sk  \tand i_manager_id=24  \tand d_moy=12  \tand d_year=2001  group by i_brand, i_brand_id  order by ext_price desc, i_brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_brand", "i_item_sk", "i_brand_id"]}, "group_by": {}, "order_by": {"item": ["i_brand_id"]}}
{"id": 56, "query_string": " with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('hot','turquoise','saddle'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 7  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('hot','turquoise','saddle'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 7  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('hot','turquoise','saddle'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 7  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_item_id)   select top (100) i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  ;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_color"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 57, "query_string": " with v1 as(  select i_category, i_brand,         cc_name,         d_year, d_moy,         sum(cs_sales_price) sum_sales,         avg(sum(cs_sales_price)) over           (partition by i_category, i_brand,                      cc_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      cc_name            order by d_year, d_moy) rn  from item, catalog_sales, date_dim, call_center  where cs_item_sk = i_item_sk and        cs_sold_date_sk = d_date_sk and        cc_call_center_sk= cs_call_center_sk and        (          d_year = 2001 or          ( d_year = 2001-1 and d_moy =12) or          ( d_year = 2001+1 and d_moy =1)        )  group by i_category, i_brand,           cc_name , d_year, d_moy),  v2 as(  select v1.i_category, v1.i_brand         ,v1.d_year, v1.d_moy         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1. cc_name = v1_lag. cc_name and        v1. cc_name = v1_lead. cc_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select top (100) *  from v2  where  d_year = 2001 and         avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, sum_sales  ;", "predicates": {"date_dim": ["d_moy", "d_year"]}, "payload": {"call_center": ["cc_name", "cc_call_center_sk"], "catalog_sales": ["cs_sales_price", "cs_sold_date_sk", "cs_call_center_sk", "cs_item_sk"], "date_dim": ["d_date_sk", "d_moy", "d_year"], "item": ["i_brand", "i_item_sk", "i_category"]}, "group_by": {}, "order_by": {}}
{"id": 58, "query_string": " with ss_items as  (select i_item_id item_id         ,sum(ss_ext_sales_price) ss_item_rev   from store_sales      ,item      ,date_dim  where ss_item_sk = i_item_sk    and d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '1999-07-09'))    and ss_sold_date_sk   = d_date_sk  group by i_item_id),  cs_items as  (select i_item_id item_id         ,sum(cs_ext_sales_price) cs_item_rev   from catalog_sales       ,item       ,date_dim  where cs_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '1999-07-09'))   and  cs_sold_date_sk = d_date_sk  group by i_item_id),  ws_items as  (select i_item_id item_id         ,sum(ws_ext_sales_price) ws_item_rev   from web_sales       ,item       ,date_dim  where ws_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq =(select d_week_seq                                       from date_dim                                      where d_date = '1999-07-09'))   and ws_sold_date_sk   = d_date_sk  group by i_item_id)   select top (100) ss_items.item_id        ,ss_item_rev        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev        ,cs_item_rev        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev        ,ws_item_rev        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average  from ss_items,cs_items,ws_items  where ss_items.item_id=cs_items.item_id    and ss_items.item_id=ws_items.item_id     and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  order by item_id          ,ss_item_rev  ;", "predicates": {"date_dim": ["d_week_seq", "d_date"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_item_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "item": ["i_item_id", "i_item_sk"], "store_sales": ["ss_sold_date_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 59, "query_string": " with wss as   (select d_week_seq,         ss_store_sk,         sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,         sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,         sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,         sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,         sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,         sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,         sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales  from store_sales,date_dim  where d_date_sk = ss_sold_date_sk  group by d_week_seq,ss_store_sk  )   select top (100) s_store_name1,s_store_id1,d_week_seq1        ,sun_sales1/sun_sales2,mon_sales1/mon_sales2        ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2        ,fri_sales1/fri_sales2,sat_sales1/sat_sales2  from  (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1         ,s_store_id s_store_id1,sun_sales sun_sales1         ,mon_sales mon_sales1,tue_sales tue_sales1         ,wed_sales wed_sales1,thu_sales thu_sales1         ,fri_sales fri_sales1,sat_sales sat_sales1   from wss,store,date_dim d   where d.d_week_seq = wss.d_week_seq and         ss_store_sk = s_store_sk and          d_month_seq between 1210 and 1210 + 11) y,  (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2         ,s_store_id s_store_id2,sun_sales sun_sales2         ,mon_sales mon_sales2,tue_sales tue_sales2         ,wed_sales wed_sales2,thu_sales thu_sales2         ,fri_sales fri_sales2,sat_sales sat_sales2   from wss,store,date_dim d   where d.d_week_seq = wss.d_week_seq and         ss_store_sk = s_store_sk and          d_month_seq between 1210+ 12 and 1210 + 23) x  where s_store_id1=s_store_id2    and d_week_seq1=d_week_seq2-52  order by s_store_name1,s_store_id1,d_week_seq1;", "predicates": {"date_dim": ["d_month_seq"], "store": ["s_store_id"]}, "payload": {"date_dim": ["d_date_sk", "d_week_seq", "d_day_name"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price"]}, "group_by": {}, "order_by": {}}
{"id": 60, "query_string": " with ss as (  select           i_item_id,sum(ss_ext_sales_price) total_sales  from  \tstore_sales,  \tdate_dim,          customer_address,          item  where          i_item_id in (select   i_item_id from  item where i_category in ('Men'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 8  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  cs as (  select           i_item_id,sum(cs_ext_sales_price) total_sales  from  \tcatalog_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Men'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 8  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  ws as (  select           i_item_id,sum(ws_ext_sales_price) total_sales  from  \tweb_sales,  \tdate_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Men'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 8  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_item_id)   select top (100)     i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by i_item_id       ,total_sales  ;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_item_id", "i_category"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 61, "query_string": " select top (100) promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from   (select sum(ss_ext_sales_price) promotions    from  store_sales         ,store         ,promotion         ,date_dim         ,customer         ,customer_address          ,item    where ss_sold_date_sk = d_date_sk    and   ss_store_sk = s_store_sk    and   ss_promo_sk = p_promo_sk    and   ss_customer_sk= c_customer_sk    and   ca_address_sk = c_current_addr_sk    and   ss_item_sk = i_item_sk     and   ca_gmt_offset = -7    and   i_category = 'Home'    and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')    and   s_gmt_offset = -7    and   d_year = 1999    and   d_moy  = 12) promotional_sales,   (select sum(ss_ext_sales_price) total    from  store_sales         ,store         ,date_dim         ,customer         ,customer_address         ,item    where ss_sold_date_sk = d_date_sk    and   ss_store_sk = s_store_sk    and   ss_customer_sk= c_customer_sk    and   ca_address_sk = c_current_addr_sk    and   ss_item_sk = i_item_sk    and   ca_gmt_offset = -7    and   i_category = 'Home'    and   s_gmt_offset = -7    and   d_year = 1999    and   d_moy  = 12) all_sales order by promotions, total;", "predicates": {"customer_address": ["ca_gmt_offset"], "date_dim": ["d_moy", "d_year"], "item": ["i_category"], "promotion": ["p_channel_dmail", "p_channel_email", "p_channel_tv"], "store": ["s_gmt_offset"]}, "payload": {"customer": ["c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_promo_sk", "ss_item_sk", "ss_ext_sales_price", "ss_customer_sk", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 62, "query_string": " select top (100)     substring(w_warehouse_name,1,20)   ,sm_type   ,web_name   ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and                   (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and                   (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and                  (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    web_sales   ,warehouse   ,ship_mode   ,web_site   ,date_dim where     d_month_seq between 1191 and 1191 + 11 and ws_ship_date_sk   = d_date_sk and ws_warehouse_sk   = w_warehouse_sk and ws_ship_mode_sk   = sm_ship_mode_sk and ws_web_site_sk    = web_site_sk group by    substring(w_warehouse_name,1,20)   ,sm_type   ,web_name order by substring(w_warehouse_name,1,20)         ,sm_type        ,web_name;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "ship_mode": ["sm_type", "sm_ship_mode_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"], "web_sales": ["ws_ship_date_sk", "ws_ship_mode_sk", "ws_sold_date_sk", "ws_warehouse_sk", "ws_web_site_sk"], "web_site": ["web_name", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 63, "query_string": " select top (100) *  from (select i_manager_id              ,sum(ss_sales_price) sum_sales              ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales       from item           ,store_sales           ,date_dim           ,store       where ss_item_sk = i_item_sk         and ss_sold_date_sk = d_date_sk         and ss_store_sk = s_store_sk         and d_month_seq in (1191,1191+1,1191+2,1191+3,1191+4,1191+5,1191+6,1191+7,1191+8,1191+9,1191+10,1191+11)         and ((    i_category in ('Books','Children','Electronics')               and i_class in ('personal','portable','reference','self-help')               and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7', \t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))            or(    i_category in ('Women','Music','Men')               and i_class in ('accessories','classical','fragrances','pants')               and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1', \t\t                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id         ,avg_monthly_sales         ,sum_sales;", "predicates": {"date_dim": ["d_month_seq"], "item": ["i_brand", "i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_item_sk", "i_manager_id", "i_brand", "i_category", "i_class"], "store": ["s_store_sk"]}, "group_by": {}, "order_by": {"item": ["i_manager_id"]}}
{"id": 64, "query_string": " with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('indian','aquamarine','azure','medium','violet','mint') and          i_current_price between 67 and 67 + 10 and          i_current_price between 67 + 1 and 67 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;", "predicates": {"customer_demographics": ["cd_marital_status"], "date_dim": ["d_year"], "item": ["i_color", "i_current_price"], "store": ["s_zip", "s_store_name"]}, "payload": {"household_demographics": ["hd_income_band_sk", "hd_demo_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 65, "query_string": " select top (100) \ts_store_name, \ti_item_desc, \tsc.revenue, \ti_current_price, \ti_wholesale_cost, \ti_brand  from store, item,      (select ss_store_sk, avg(revenue) as ave  \tfrom  \t    (select  ss_store_sk, ss_item_sk,   \t\t     sum(ss_sales_price) as revenue  \t\tfrom store_sales, date_dim  \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1191 and 1191+11  \t\tgroup by ss_store_sk, ss_item_sk) sa  \tgroup by ss_store_sk) sb,      (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue  \tfrom store_sales, date_dim  \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1191 and 1191+11  \tgroup by ss_store_sk, ss_item_sk) sc  where sb.ss_store_sk = sc.ss_store_sk and         sc.revenue <= 0.1 * sb.ave and        s_store_sk = sc.ss_store_sk and        i_item_sk = sc.ss_item_sk  order by s_store_name, i_item_desc;", "predicates": {"date_dim": ["d_month_seq"], "store_sales": ["ss_store_sk"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_brand", "i_wholesale_cost", "i_item_desc"], "store": ["s_store_name", "s_store_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_sales_price", "ss_item_sk"]}, "group_by": {}, "order_by": {"item": ["i_item_desc"], "store": ["s_store_name"]}}
{"id": 66, "query_string": " select top (100)            w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country         ,ship_carriers         ,year  \t,sum(jan_sales) as jan_sales  \t,sum(feb_sales) as feb_sales  \t,sum(mar_sales) as mar_sales  \t,sum(apr_sales) as apr_sales  \t,sum(may_sales) as may_sales  \t,sum(jun_sales) as jun_sales  \t,sum(jul_sales) as jul_sales  \t,sum(aug_sales) as aug_sales  \t,sum(sep_sales) as sep_sales  \t,sum(oct_sales) as oct_sales  \t,sum(nov_sales) as nov_sales  \t,sum(dec_sales) as dec_sales  \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot  \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot  \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot  \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot  \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot  \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot  \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot  \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot  \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot  \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot  \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot  \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot  \t,sum(jan_net) as jan_net  \t,sum(feb_net) as feb_net  \t,sum(mar_net) as mar_net  \t,sum(apr_net) as apr_net  \t,sum(may_net) as may_net  \t,sum(jun_net) as jun_net  \t,sum(jul_net) as jul_net  \t,sum(aug_net) as aug_net  \t,sum(sep_net) as sep_net  \t,sum(oct_net) as oct_net  \t,sum(nov_net) as nov_net  \t,sum(dec_net) as dec_net  from (      select   \tw_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,concat('GERMA' , ',' , 'UPS') as ship_carriers        ,d_year as year  \t,sum(case when d_moy = 1   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as jan_sales  \t,sum(case when d_moy = 2   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as feb_sales  \t,sum(case when d_moy = 3   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as mar_sales  \t,sum(case when d_moy = 4   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as apr_sales  \t,sum(case when d_moy = 5   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as may_sales  \t,sum(case when d_moy = 6   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as jun_sales  \t,sum(case when d_moy = 7   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as jul_sales  \t,sum(case when d_moy = 8   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as aug_sales  \t,sum(case when d_moy = 9   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as sep_sales  \t,sum(case when d_moy = 10   \t\tthen ws_ext_list_price* ws_quantity else 0 end) as oct_sales  \t,sum(case when d_moy = 11  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as nov_sales  \t,sum(case when d_moy = 12  \t\tthen ws_ext_list_price* ws_quantity else 0 end) as dec_sales  \t,sum(case when d_moy = 1   \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as jan_net  \t,sum(case when d_moy = 2  \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as feb_net  \t,sum(case when d_moy = 3   \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as mar_net  \t,sum(case when d_moy = 4   \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as apr_net  \t,sum(case when d_moy = 5   \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as may_net  \t,sum(case when d_moy = 6   \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as jun_net  \t,sum(case when d_moy = 7   \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as jul_net  \t,sum(case when d_moy = 8   \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as aug_net  \t,sum(case when d_moy = 9   \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as sep_net  \t,sum(case when d_moy = 10   \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as oct_net  \t,sum(case when d_moy = 11  \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as nov_net  \t,sum(case when d_moy = 12  \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as dec_net      from           web_sales          ,warehouse          ,date_dim          ,time_dim  \t  ,ship_mode      where             ws_warehouse_sk =  w_warehouse_sk         and ws_sold_date_sk = d_date_sk         and ws_sold_time_sk = t_time_sk  \tand ws_ship_mode_sk = sm_ship_mode_sk         and d_year = 2002  \tand t_time between 40705 and 40705+28800   \tand sm_carrier in ('GERMA','UPS')      group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country        ,d_year  union all      select   \tw_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,concat('GERMA', ',', 'UPS') as ship_carriers        ,d_year as year  \t,sum(case when d_moy = 1   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jan_sales  \t,sum(case when d_moy = 2   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as feb_sales  \t,sum(case when d_moy = 3   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as mar_sales  \t,sum(case when d_moy = 4   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as apr_sales  \t,sum(case when d_moy = 5   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as may_sales  \t,sum(case when d_moy = 6   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jun_sales  \t,sum(case when d_moy = 7   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as jul_sales  \t,sum(case when d_moy = 8   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as aug_sales  \t,sum(case when d_moy = 9   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as sep_sales  \t,sum(case when d_moy = 10   \t\tthen cs_ext_list_price* cs_quantity else 0 end) as oct_sales  \t,sum(case when d_moy = 11  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as nov_sales  \t,sum(case when d_moy = 12  \t\tthen cs_ext_list_price* cs_quantity else 0 end) as dec_sales  \t,sum(case when d_moy = 1   \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as jan_net  \t,sum(case when d_moy = 2   \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as feb_net  \t,sum(case when d_moy = 3   \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as mar_net  \t,sum(case when d_moy = 4   \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as apr_net  \t,sum(case when d_moy = 5   \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as may_net  \t,sum(case when d_moy = 6   \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as jun_net  \t,sum(case when d_moy = 7   \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as jul_net  \t,sum(case when d_moy = 8   \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as aug_net  \t,sum(case when d_moy = 9   \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as sep_net  \t,sum(case when d_moy = 10   \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as oct_net  \t,sum(case when d_moy = 11  \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as nov_net  \t,sum(case when d_moy = 12  \t\tthen cs_net_paid_inc_tax * cs_quantity else 0 end) as dec_net      from           catalog_sales          ,warehouse          ,date_dim          ,time_dim  \t ,ship_mode      where             cs_warehouse_sk =  w_warehouse_sk         and cs_sold_date_sk = d_date_sk         and cs_sold_time_sk = t_time_sk  \tand cs_ship_mode_sk = sm_ship_mode_sk         and d_year = 2002  \tand t_time between 40705 AND 40705+28800   \tand sm_carrier in ('GERMA','UPS')      group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country        ,d_year  ) x  group by          w_warehouse_name  \t,w_warehouse_sq_ft  \t,w_city  \t,w_county  \t,w_state  \t,w_country  \t,ship_carriers        ,year  order by w_warehouse_name  ;", "predicates": {"date_dim": ["d_year"], "ship_mode": ["sm_carrier"], "time_dim": ["t_time"]}, "payload": {"catalog_sales": ["cs_warehouse_sk", "cs_ext_list_price", "cs_quantity", "cs_net_paid_inc_tax", "cs_ship_mode_sk", "cs_sold_date_sk", "cs_sold_time_sk"], "date_dim": ["d_date_sk", "d_moy", "d_year"], "ship_mode": ["sm_ship_mode_sk"], "time_dim": ["t_time_sk"], "web_sales": ["ws_ship_mode_sk", "ws_ext_list_price", "ws_sold_date_sk", "ws_quantity", "ws_sold_time_sk", "ws_warehouse_sk", "ws_net_paid"]}, "group_by": {}, "order_by": {}}
{"id": 67, "query_string": " select top (100) * from (select i_category             ,i_class             ,i_brand             ,i_product_name             ,d_year             ,d_qoy             ,d_moy             ,s_store_id             ,sumsales             ,rank() over (partition by i_category order by sumsales desc) rk       from (select i_category                   ,i_class                   ,i_brand                   ,i_product_name                   ,d_year                   ,d_qoy                   ,d_moy                   ,s_store_id                   ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales             from store_sales                 ,date_dim                 ,store                 ,item        where  ss_sold_date_sk=d_date_sk           and ss_item_sk=i_item_sk           and ss_store_sk = s_store_sk           and d_month_seq between 1191 and 1191+11        group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 order by i_category         ,i_class         ,i_brand         ,i_product_name         ,d_year         ,d_qoy         ,d_moy         ,s_store_id         ,sumsales         ,rk;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk", "d_moy", "d_qoy", "d_year"], "item": ["i_item_sk", "i_brand", "i_product_name", "i_category", "i_class"], "store": ["s_store_sk", "s_store_id"], "store_sales": ["ss_store_sk", "ss_item_sk", "ss_sales_price", "ss_quantity", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {"date_dim": ["d_moy", "d_qoy", "d_year"], "item": ["i_brand", "i_class", "i_product_name", "i_category"], "store": ["s_store_id"]}}
{"id": 68, "query_string": " select top (100) c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,extended_price        ,extended_tax        ,list_price  from (select ss_ticket_number              ,ss_customer_sk              ,ca_city bought_city              ,sum(ss_ext_sales_price) extended_price               ,sum(ss_ext_list_price) list_price              ,sum(ss_ext_tax) extended_tax         from store_sales            ,date_dim            ,store            ,household_demographics            ,customer_address         where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_store_sk = store.s_store_sk           and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk         and store_sales.ss_addr_sk = customer_address.ca_address_sk         and date_dim.d_dom between 1 and 2          and (household_demographics.hd_dep_count = 9 or              household_demographics.hd_vehicle_count= 2)         and date_dim.d_year in (1998,1998+1,1998+2)         and store.s_city in ('Midway','Fairview')        group by ss_ticket_number                ,ss_customer_sk                ,ss_addr_sk,ca_city) dn       ,customer       ,customer_address current_addr  where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name          ,ss_ticket_number  ;", "predicates": {"customer_address": ["ca_city"], "date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_city"]}, "payload": {"customer": ["c_current_addr_sk", "c_first_name", "c_last_name", "c_customer_sk"], "customer_address": ["ca_address_sk", "ca_city"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_ext_sales_price", "ss_addr_sk", "ss_customer_sk", "ss_ticket_number", "ss_ext_list_price", "ss_ext_tax", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 69, "query_string": " select top (100)    cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_state in ('NC','RI','VA') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2001 and                 d_moy between 4 and 4+2) and    (not exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 4 and 4+2) and     not exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 4 and 4+2))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  ;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_moy", "d_year"]}, "payload": {"catalog_sales": ["cs_ship_customer_sk", "cs_sold_date_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk"], "customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 70, "query_string": " select top (100)      sum(ss_net_profit) as total_sum    ,s_state    ,s_county    ,grouping(s_state)+grouping(s_county) as lochierarchy    ,rank() over (  \tpartition by grouping(s_state)+grouping(s_county),  \tcase when grouping(s_county) = 0 then s_state end   \torder by sum(ss_net_profit) desc) as rank_within_parent  from     store_sales    ,date_dim       d1    ,store  where     d1.d_month_seq between 1191 and 1191+11  and d1.d_date_sk = ss_sold_date_sk  and s_store_sk  = ss_store_sk  and s_state in              ( select s_state                from  (select s_state as s_state,  \t\t\t    rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking                       from   store_sales, store, date_dim                       where  d_month_seq between 1191 and 1191+11  \t\t\t    and d_date_sk = ss_sold_date_sk  \t\t\t    and s_store_sk  = ss_store_sk                       group by s_state                      ) tmp1                 where ranking <= 5              )  group by rollup(s_state,s_county)  order by    lochierarchy desc   ,case when (grouping(s_state)+grouping(s_county)) = 0 then s_state end   ,rank_within_parent  ;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {}}
{"id": 71, "query_string": " select i_brand_id brand_id, i_brand brand,t_hour,t_minute,  \tsum(ext_price) ext_price  from item, (select ws_ext_sales_price as ext_price,                          ws_sold_date_sk as sold_date_sk,                         ws_item_sk as sold_item_sk,                         ws_sold_time_sk as time_sk                    from web_sales,date_dim                  where d_date_sk = ws_sold_date_sk                    and d_moy=11                    and d_year=2001                  union all                  select cs_ext_sales_price as ext_price,                         cs_sold_date_sk as sold_date_sk,                         cs_item_sk as sold_item_sk,                         cs_sold_time_sk as time_sk                  from catalog_sales,date_dim                  where d_date_sk = cs_sold_date_sk                    and d_moy=11                    and d_year=2001                  union all                  select ss_ext_sales_price as ext_price,                         ss_sold_date_sk as sold_date_sk,                         ss_item_sk as sold_item_sk,                         ss_sold_time_sk as time_sk                  from store_sales,date_dim                  where d_date_sk = ss_sold_date_sk                    and d_moy=11                    and d_year=2001                  ) tmp,time_dim  where    sold_item_sk = i_item_sk    and i_manager_id=1    and time_sk = t_time_sk    and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')  group by i_brand, i_brand_id,t_hour,t_minute  order by ext_price desc, i_brand_id  ;", "predicates": {"date_dim": ["d_moy", "d_year"], "item": ["i_manager_id"], "time_dim": ["t_meal_time"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_brand", "i_item_sk", "i_brand_id"], "time_dim": ["t_hour", "t_minute", "t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 72, "query_string": " select top (100) i_item_desc       ,w_warehouse_name       ,d1.d_week_seq       ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo       ,sum(case when p_promo_sk is not null then 1 else 0 end) promo       ,count(*) total_cnt from catalog_sales join inventory on (cs_item_sk = inv_item_sk) join warehouse on (w_warehouse_sk=inv_warehouse_sk) join item on (i_item_sk = cs_item_sk) join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk) join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk) join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk) join date_dim d2 on (inv_date_sk = d2.d_date_sk) join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk) left outer join promotion on (cs_promo_sk=p_promo_sk) left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number) where d1.d_week_seq = d2.d_week_seq   and inv_quantity_on_hand < cs_quantity    and d3.d_date > dateadd(day, 5, d1.d_date)   and hd_buy_potential = '1001-5000'   and d1.d_year = 2001   and cd_marital_status = 'W' group by i_item_desc,w_warehouse_name,d1.d_week_seq order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq;", "predicates": {"customer_demographics": ["cd_marital_status"], "date_dim": ["d_date", "d_year"], "household_demographics": ["hd_buy_potential"], "inventory": ["inv_warehouse_sk"], "warehouse": ["w_warehouse_sk"]}, "payload": {"catalog_sales": ["cs_quantity", "cs_promo_sk", "cs_item_sk", "cs_ship_date_sk", "cs_bill_cdemo_sk", "cs_sold_date_sk", "cs_bill_hdemo_sk"], "customer_demographics": ["cd_demo_sk"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "household_demographics": ["hd_demo_sk"], "item": ["i_item_sk", "i_item_desc"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {"date_dim": ["d_week_seq"], "item": ["i_item_desc"], "warehouse": ["w_warehouse_name"]}}
{"id": 73, "query_string": " select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '501-1000' or          household_demographics.hd_buy_potential = '0-500')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (1999,1999+1,1999+2)     and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;", "predicates": {"date_dim": ["d_dom", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count", "hd_buy_potential"], "store": ["s_county"]}, "payload": {"customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_preferred_cust_flag"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_customer_sk", "ss_ticket_number", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 74, "query_string": " with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,d_year as year        ,sum(ss_net_paid) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk    and d_year in (1999,1999+1)  group by c_customer_id          ,c_first_name          ,c_last_name          ,d_year  union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,d_year as year        ,sum(ws_net_paid) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk    and d_year in (1999,1999+1)  group by c_customer_id          ,c_first_name          ,c_last_name          ,d_year          )   select top (100)         t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id          and t_s_firstyear.customer_id = t_w_secyear.customer_id          and t_s_firstyear.customer_id = t_w_firstyear.customer_id          and t_s_firstyear.sale_type = 's'          and t_w_firstyear.sale_type = 'w'          and t_s_secyear.sale_type = 's'          and t_w_secyear.sale_type = 'w'          and t_s_firstyear.year = 1999          and t_s_secyear.year = 1999+1          and t_w_firstyear.year = 1999          and t_w_secyear.year = 1999+1          and t_s_firstyear.year_total > 0          and t_w_firstyear.year_total > 0          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end            > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end  order by 3,2,1;", "predicates": {"date_dim": ["d_year"]}, "payload": {"customer": ["c_customer_id", "c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_net_paid"], "web_sales": ["ws_net_paid", "ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {"customer": ["c_customer_id", "c_last_name", "c_first_name"]}}
{"id": 75, "query_string": " WITH all_sales AS (  SELECT d_year        ,i_brand_id        ,i_class_id        ,i_category_id        ,i_manufact_id        ,SUM(sales_cnt) AS sales_cnt        ,SUM(sales_amt) AS sales_amt  FROM (SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt              ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt        FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk                           JOIN date_dim ON d_date_sk=cs_sold_date_sk                           LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number                                                      AND cs_item_sk=cr_item_sk)        WHERE i_category='Books'        UNION        SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt              ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt        FROM store_sales JOIN item ON i_item_sk=ss_item_sk                         JOIN date_dim ON d_date_sk=ss_sold_date_sk                         LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number                                                  AND ss_item_sk=sr_item_sk)        WHERE i_category='Books'        UNION        SELECT d_year              ,i_brand_id              ,i_class_id              ,i_category_id              ,i_manufact_id              ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt              ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt        FROM web_sales JOIN item ON i_item_sk=ws_item_sk                       JOIN date_dim ON d_date_sk=ws_sold_date_sk                       LEFT JOIN web_returns ON (ws_order_number=wr_order_number                                              AND ws_item_sk=wr_item_sk)        WHERE i_category='Books') sales_detail  GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)  SELECT top (100) prev_yr.d_year AS prev_year                           ,curr_yr.d_year AS year                           ,curr_yr.i_brand_id                           ,curr_yr.i_class_id                           ,curr_yr.i_category_id                           ,curr_yr.i_manufact_id                           ,prev_yr.sales_cnt AS prev_yr_cnt                           ,curr_yr.sales_cnt AS curr_yr_cnt                           ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff                           ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff  FROM all_sales curr_yr, all_sales prev_yr  WHERE curr_yr.i_brand_id=prev_yr.i_brand_id    AND curr_yr.i_class_id=prev_yr.i_class_id    AND curr_yr.i_category_id=prev_yr.i_category_id    AND curr_yr.i_manufact_id=prev_yr.i_manufact_id    AND curr_yr.d_year=2001    AND prev_yr.d_year=2001-1    AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9  ORDER BY sales_cnt_diff,sales_amt_diff  ;", "predicates": {"date_dim": ["d_year"], "item": ["i_category"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_quantity", "cr_return_amount"], "date_dim": ["d_date_sk", "d_year"], "item": ["i_class_id", "i_item_sk", "i_category_id", "i_brand_id", "i_manufact_id"], "store_returns": ["sr_return_amt", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_return_amt", "wr_return_quantity", "wr_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 76, "query_string": " select top (100) channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (         SELECT 'store' as channel, 'ss_addr_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price          FROM store_sales, item, date_dim          WHERE ss_addr_sk IS NULL            AND ss_sold_date_sk=d_date_sk            AND ss_item_sk=i_item_sk         UNION ALL         SELECT 'web' as channel, 'ws_ship_customer_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price          FROM web_sales, item, date_dim          WHERE ws_ship_customer_sk IS NULL            AND ws_sold_date_sk=d_date_sk            AND ws_item_sk=i_item_sk         UNION ALL         SELECT 'catalog' as channel, 'cs_ship_customer_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price          FROM catalog_sales, item, date_dim          WHERE cs_ship_customer_sk IS NULL            AND cs_sold_date_sk=d_date_sk            AND cs_item_sk=i_item_sk) foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category;", "predicates": {"catalog_sales": ["cs_ship_addr_sk"], "store_sales": ["ss_promo_sk"], "web_sales": ["ws_promo_sk"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_item_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk", "d_qoy", "d_year"], "item": ["i_item_sk", "i_category"], "store_sales": ["ss_sold_date_sk", "ss_ext_sales_price", "ss_item_sk"], "web_sales": ["ws_ext_sales_price", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 77, "query_string": " with ss as  (select s_store_sk,          sum(ss_ext_sales_price) as sales,          sum(ss_net_profit) as profit  from store_sales,       date_dim,       store  where ss_sold_date_sk = d_date_sk        and d_date between cast('1999-08-09' as date)                    and dateadd(day, 30, cast('1999-08-09' as date))         and ss_store_sk = s_store_sk  group by s_store_sk)  ,  sr as  (select s_store_sk,          sum(sr_return_amt) as returns,          sum(sr_net_loss) as profit_loss  from store_returns,       date_dim,       store  where sr_returned_date_sk = d_date_sk        and d_date between cast('1999-08-09' as date)                   and dateadd(day, 30, cast('1999-08-09' as date))        and sr_store_sk = s_store_sk  group by s_store_sk),   cs as  (select cs_call_center_sk,         sum(cs_ext_sales_price) as sales,         sum(cs_net_profit) as profit  from catalog_sales,       date_dim  where cs_sold_date_sk = d_date_sk        and d_date between cast('1999-08-09' as date)                   and dateadd(day, 30, cast('1999-08-09' as date))  group by cs_call_center_sk   ),   cr as  (select cr_call_center_sk,          sum(cr_return_amount) as returns,          sum(cr_net_loss) as profit_loss  from catalog_returns,       date_dim  where cr_returned_date_sk = d_date_sk        and d_date between cast('1999-08-09' as date)                   and dateadd(day, 30, cast('1999-08-09' as date))  group by cr_call_center_sk  ),   ws as  ( select wp_web_page_sk,         sum(ws_ext_sales_price) as sales,         sum(ws_net_profit) as profit  from web_sales,       date_dim,       web_page  where ws_sold_date_sk = d_date_sk        and d_date between cast('1999-08-09' as date)                   and dateadd(day, 30, cast('1999-08-09' as date))        and ws_web_page_sk = wp_web_page_sk  group by wp_web_page_sk),   wr as  (select wp_web_page_sk,         sum(wr_return_amt) as returns,         sum(wr_net_loss) as profit_loss  from web_returns,       date_dim,       web_page  where wr_returned_date_sk = d_date_sk        and d_date between cast('1999-08-09' as date)                   and dateadd(day, 30, cast('1999-08-09' as date))        and wr_web_page_sk = wp_web_page_sk  group by wp_web_page_sk)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , ss.s_store_sk as id         , sales         , coalesce(returns, 0) as returns         , (profit - coalesce(profit_loss,0)) as profit  from   ss left join sr         on  ss.s_store_sk = sr.s_store_sk  union all  select 'catalog channel' as channel         , cs_call_center_sk as id         , sales         , returns         , (profit - profit_loss) as profit  from  cs        , cr  union all  select 'web channel' as channel         , ws.wp_web_page_sk as id         , sales         , coalesce(returns, 0) returns         , (profit - coalesce(profit_loss,0)) as profit  from   ws left join wr         on  ws.wp_web_page_sk = wr.wp_web_page_sk  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_return_amount", "cr_call_center_sk"], "catalog_sales": ["cs_net_profit", "cs_sold_date_sk", "cs_call_center_sk", "cs_ext_sales_price"], "date_dim": ["d_date_sk"], "store_returns": ["sr_returned_date_sk", "sr_store_sk", "sr_return_amt", "sr_net_loss"], "store_sales": ["ss_sold_date_sk", "ss_store_sk", "ss_net_profit", "ss_ext_sales_price"], "web_page": ["wp_web_page_sk"], "web_returns": ["wr_web_page_sk", "wr_returned_date_sk", "wr_return_amt", "wr_net_loss"], "web_sales": ["ws_net_profit", "ws_ext_sales_price", "ws_web_page_sk", "ws_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 78, "query_string": " with ws as   (select d_year AS ws_sold_year, ws_item_sk,     ws_bill_customer_sk ws_customer_sk,     sum(ws_quantity) ws_qty,     sum(ws_wholesale_cost) ws_wc,     sum(ws_sales_price) ws_sp    from web_sales    left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk    join date_dim on ws_sold_date_sk = d_date_sk    where wr_order_number is null    group by d_year, ws_item_sk, ws_bill_customer_sk    ), cs as   (select d_year AS cs_sold_year, cs_item_sk,     cs_bill_customer_sk cs_customer_sk,     sum(cs_quantity) cs_qty,     sum(cs_wholesale_cost) cs_wc,     sum(cs_sales_price) cs_sp    from catalog_sales    left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk    join date_dim on cs_sold_date_sk = d_date_sk    where cr_order_number is null    group by d_year, cs_item_sk, cs_bill_customer_sk    ), ss as   (select d_year AS ss_sold_year, ss_item_sk,     ss_customer_sk,     sum(ss_quantity) ss_qty,     sum(ss_wholesale_cost) ss_wc,     sum(ss_sales_price) ss_sp    from store_sales    left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk    join date_dim on ss_sold_date_sk = d_date_sk    where sr_ticket_number is null    group by d_year, ss_item_sk, ss_customer_sk    )  select top (100) ss_customer_sk, round(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk) where (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2001 order by    ss_customer_sk,   ss_qty desc, ss_wc desc, ss_sp desc,   other_chan_qty,   other_chan_wholesale_cost,   other_chan_sales_price,   ratio;", "predicates": {"catalog_returns": ["cr_order_number"], "catalog_sales": ["cs_bill_customer_sk"], "date_dim": ["d_year"], "store_returns": ["sr_ticket_number"], "store_sales": ["ss_customer_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_bill_customer_sk"]}, "payload": {"date_dim": ["d_date_sk", "d_year"], "store_returns": ["sr_item_sk", "sr_ticket_number"], "store_sales": ["ss_item_sk", "ss_sales_price", "ss_customer_sk", "ss_ticket_number", "ss_quantity", "ss_wholesale_cost", "ss_sold_date_sk"]}, "group_by": {}, "order_by": {}}
{"id": 79, "query_string": " select top (100)   c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,store.s_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (household_demographics.hd_dep_count = 3 or household_demographics.hd_vehicle_count > 2)     and date_dim.d_dow = 1     and date_dim.d_year in (1998,1998+1,1998+2)      and store.s_number_employees between 200 and 295     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer     where ss_customer_sk = c_customer_sk  order by c_last_name,c_first_name,substring(s_city,1,30), profit;", "predicates": {"date_dim": ["d_dow", "d_year"], "household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_number_employees"]}, "payload": {"customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"], "store": ["s_city", "s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_addr_sk", "ss_customer_sk", "ss_ticket_number", "ss_coupon_amt", "ss_sold_date_sk", "ss_net_profit"]}, "group_by": {}, "order_by": {"customer": ["c_last_name", "c_first_name"]}}
{"id": 80, "query_string": " with ssr as  (select  s_store_id as store_id,           sum(ss_ext_sales_price) as sales,           sum(coalesce(sr_return_amt, 0)) as returns,           sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit   from store_sales left outer join store_returns on          (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),      date_dim,      store,      item,      promotion  where ss_sold_date_sk = d_date_sk        and d_date between cast('1999-08-09' as date)                    and dateadd(day, 30, cast('1999-08-09' as date))        and ss_store_sk = s_store_sk        and ss_item_sk = i_item_sk        and i_current_price > 50        and ss_promo_sk = p_promo_sk        and p_channel_tv = 'N'  group by s_store_id)  ,  csr as  (select  cp_catalog_page_id as catalog_page_id,           sum(cs_ext_sales_price) as sales,           sum(coalesce(cr_return_amount, 0)) as returns,           sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit   from catalog_sales left outer join catalog_returns on          (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),      date_dim,      catalog_page,      item,      promotion  where cs_sold_date_sk = d_date_sk        and d_date between cast('1999-08-09' as date)                   and dateadd(day, 30, cast('1999-08-09' as date))         and cs_catalog_page_sk = cp_catalog_page_sk        and cs_item_sk = i_item_sk        and i_current_price > 50        and cs_promo_sk = p_promo_sk        and p_channel_tv = 'N' group by cp_catalog_page_id)  ,  wsr as  (select  web_site_id,           sum(ws_ext_sales_price) as sales,           sum(coalesce(wr_return_amt, 0)) as returns,           sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit   from web_sales left outer join web_returns on          (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),      date_dim,      web_site,      item,      promotion  where ws_sold_date_sk = d_date_sk        and d_date between cast('1999-08-09' as date)                   and dateadd(day, 30, cast('1999-08-09' as date))         and ws_web_site_sk = web_site_sk        and ws_item_sk = i_item_sk        and i_current_price > 50        and ws_promo_sk = p_promo_sk        and p_channel_tv = 'N' group by web_site_id)   select top (100) channel         , id         , sum(sales) as sales         , sum(returns) as returns         , sum(profit) as profit  from   (select 'store channel' as channel         , concat('store' , store_id) as id         , sales         , returns         , profit  from   ssr  union all  select 'catalog channel' as channel         , concat('catalog_page' , catalog_page_id) as id         , sales         , returns         , profit  from  csr  union all  select 'web channel' as channel         , concat('web_site' , web_site_id) as id         , sales         , returns         , profit  from   wsr  ) x  group by rollup (channel, id)  order by channel          ,id  ;", "predicates": {"date_dim": ["d_date"], "item": ["i_current_price"], "promotion": ["p_channel_tv"]}, "payload": {"catalog_page": ["cp_catalog_page_sk", "cp_catalog_page_id"], "catalog_returns": ["cr_item_sk", "cr_order_number", "cr_return_amount", "cr_net_loss"], "date_dim": ["d_date_sk"], "item": ["i_item_sk"], "promotion": ["p_promo_sk"], "store": ["s_store_sk", "s_store_id"], "store_returns": ["sr_return_amt", "sr_net_loss", "sr_item_sk", "sr_ticket_number"], "web_returns": ["wr_item_sk", "wr_net_loss", "wr_return_amt", "wr_order_number"], "web_site": ["web_site_id", "web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 81, "query_string": " with customer_total_return as  (select cr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   \tsum(cr_return_amt_inc_tax) as ctr_total_return  from catalog_returns      ,date_dim      ,customer_address  where cr_returned_date_sk = d_date_sk     and d_year =1999    and cr_returning_addr_sk = ca_address_sk   group by cr_returning_customer_sk          ,ca_state )   select top (100) c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  \t\t\t  from customer_total_return ctr2                    \t  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'AL'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  ;", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_year"]}, "payload": {"catalog_returns": ["cr_returned_date_sk", "cr_returning_customer_sk", "cr_return_amt_inc_tax", "cr_returning_addr_sk"], "customer": ["c_customer_sk", "c_salutation", "c_last_name", "c_first_name", "c_current_addr_sk", "c_customer_id"], "customer_address": ["ca_street_type", "ca_county", "ca_street_name", "ca_zip", "ca_street_number", "ca_city", "ca_state", "ca_gmt_offset", "ca_location_type", "ca_address_sk", "ca_suite_number", "ca_country"], "date_dim": ["d_date_sk"]}, "group_by": {}, "order_by": {"customer": ["c_salutation", "c_customer_id", "c_last_name", "c_first_name"], "customer_address": ["ca_street_type", "ca_county", "ca_street_name", "ca_zip", "ca_street_number", "ca_city", "ca_gmt_offset", "ca_location_type", "ca_suite_number", "ca_country"]}}
{"id": 82, "query_string": " select top (100) i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, store_sales  where i_current_price between 79 and 79+30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('1998-04-23' as date) and dateadd(day, 60, cast('1998-04-23' as date))  and i_manufact_id in (569,177,493,456)  and inv_quantity_on_hand between 100 and 500  and ss_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  ;", "predicates": {"date_dim": ["d_date"], "inventory": ["inv_quantity_on_hand"], "item": ["i_current_price", "i_manufact_id"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_id", "i_item_sk", "i_item_desc", "i_current_price"]}, "group_by": {}, "order_by": {}}
{"id": 83, "query_string": " with sr_items as  (select i_item_id item_id,         sum(sr_return_quantity) sr_item_qty  from store_returns,       item,       date_dim  where sr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t  where d_date in ('1999-04-13','1999-09-13','1999-11-23')))  and   sr_returned_date_sk   = d_date_sk  group by i_item_id),  cr_items as  (select i_item_id item_id,         sum(cr_return_quantity) cr_item_qty  from catalog_returns,       item,       date_dim  where cr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t  where d_date in ('1999-04-13','1999-09-13','1999-11-23')))  and   cr_returned_date_sk   = d_date_sk  group by i_item_id),  wr_items as  (select i_item_id item_id,         sum(wr_return_quantity) wr_item_qty  from web_returns,       item,       date_dim  where wr_item_sk = i_item_sk  and   d_date    in  \t(select d_date \tfrom date_dim \twhere d_week_seq in  \t\t(select d_week_seq \t\tfrom date_dim \t\twhere d_date in ('1999-04-13','1999-09-13','1999-11-23')))  and   wr_returned_date_sk   = d_date_sk  group by i_item_id)   select top (100) sr_items.item_id        ,sr_item_qty        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev        ,cr_item_qty        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev        ,wr_item_qty        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average  from sr_items      ,cr_items      ,wr_items  where sr_items.item_id=cr_items.item_id    and sr_items.item_id=wr_items.item_id   order by sr_items.item_id          ,sr_item_qty  ;", "predicates": {"date_dim": ["d_date"]}, "payload": {"catalog_returns": ["cr_item_sk", "cr_returned_date_sk", "cr_order_number", "cr_return_quantity"], "date_dim": ["d_date_sk", "d_week_seq", "d_date"], "item": ["i_item_id", "i_item_sk"], "store_returns": ["sr_returned_date_sk", "sr_return_quantity", "sr_item_sk"], "web_returns": ["wr_item_sk", "wr_returned_date_sk", "wr_return_quantity"]}, "group_by": {}, "order_by": {}}
{"id": 84, "query_string": " select top (100) c_customer_id as customer_id        , concat(coalesce(c_last_name,'') , ', ' , coalesce(c_first_name,'')) as customername  from customer      ,customer_address      ,customer_demographics      ,household_demographics      ,income_band      ,store_returns  where ca_city\t        =  'Deerfield'    and c_current_addr_sk = ca_address_sk    and ib_lower_bound   >=  36341    and ib_upper_bound   <=  36341 + 50000    and ib_income_band_sk = hd_income_band_sk    and cd_demo_sk = c_current_cdemo_sk    and hd_demo_sk = c_current_hdemo_sk    and sr_cdemo_sk = cd_demo_sk  order by c_customer_id  ;", "predicates": {"customer": ["c_current_cdemo_sk"], "customer_address": ["ca_city"], "income_band": ["ib_upper_bound", "ib_lower_bound"]}, "payload": {"customer": ["c_last_name", "c_first_name", "c_current_cdemo_sk", "c_current_addr_sk", "c_customer_id", "c_current_hdemo_sk"], "customer_address": ["ca_address_sk"], "household_demographics": ["hd_income_band_sk", "hd_demo_sk"], "income_band": ["ib_income_band_sk"], "store_returns": ["sr_cdemo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 85, "query_string": " select top (100) substring(r_reason_desc,1,20)        ,avg(ws_quantity)        ,avg(wr_refunded_cash)        ,avg(wr_fee)  from web_sales, web_returns, web_page, customer_demographics cd1,       customer_demographics cd2, customer_address, date_dim, reason   where ws_web_page_sk = wp_web_page_sk    and ws_item_sk = wr_item_sk    and ws_order_number = wr_order_number    and ws_sold_date_sk = d_date_sk and d_year = 2000    and cd1.cd_demo_sk = wr_refunded_cdemo_sk     and cd2.cd_demo_sk = wr_returning_cdemo_sk    and ca_address_sk = wr_refunded_addr_sk    and r_reason_sk = wr_reason_sk    and    (     (      cd1.cd_marital_status = 'W'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = '4 yr Degree'      and       cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 100.00 and 150.00     )    or     (      cd1.cd_marital_status = 'M'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Secondary'       and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 50.00 and 100.00     )    or     (      cd1.cd_marital_status = 'D'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'College'      and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 150.00 and 200.00     )    )    and    (     (      ca_country = 'United States'      and      ca_state in ('IA', 'CO', 'MI')      and ws_net_profit between 100 and 200       )     or     (      ca_country = 'United States'      and      ca_state in ('TN', 'NE', 'NJ')      and ws_net_profit between 150 and 300       )     or     (      ca_country = 'United States'      and      ca_state in ('LA', 'AZ', 'WI')      and ws_net_profit between 50 and 250       )    ) group by r_reason_desc order by substring(r_reason_desc,1,20)         ,avg(ws_quantity)         ,avg(wr_refunded_cash)         ,avg(wr_fee);", "predicates": {"customer_address": ["ca_state", "ca_country"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_year"], "web_sales": ["ws_net_profit", "ws_sales_price"]}, "payload": {"customer_address": ["ca_address_sk", "ca_state"], "reason": ["r_reason_desc", "r_reason_sk"], "web_page": ["wp_web_page_sk"], "web_returns": ["wr_returning_cdemo_sk", "wr_refunded_cdemo_sk", "wr_reason_sk", "wr_item_sk", "wr_refunded_cash", "wr_refunded_addr_sk", "wr_fee", "wr_order_number"], "web_sales": ["ws_net_profit", "ws_item_sk", "ws_sales_price", "ws_quantity", "ws_sold_date_sk", "ws_web_page_sk", "ws_order_number"]}, "group_by": {}, "order_by": {}}
{"id": 86, "query_string": " select top (100)       sum(ws_net_paid) as total_sum    ,i_category    ,i_class    ,grouping(i_category)+grouping(i_class) as lochierarchy    ,rank() over (  \tpartition by grouping(i_category)+grouping(i_class),  \tcase when grouping(i_class) = 0 then i_category end   \torder by sum(ws_net_paid) desc) as rank_within_parent  from     web_sales    ,date_dim       d1    ,item  where     d1.d_month_seq between 1191 and 1191+11  and d1.d_date_sk = ws_sold_date_sk  and i_item_sk  = ws_item_sk  group by rollup(i_category,i_class)  order by    lochierarchy desc,    case when (grouping(i_category)+grouping(i_class)) = 0 then i_category end,    rank_within_parent  ;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_class", "i_item_sk", "i_category"], "web_sales": ["ws_net_paid", "ws_sold_date_sk", "ws_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 87, "query_string": " select count(*)  from ((select distinct c_last_name, c_first_name, d_date        from store_sales, date_dim, customer        where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_customer_sk = customer.c_customer_sk          and d_month_seq between 1191 and 1191+11)        except       (select distinct c_last_name, c_first_name, d_date        from catalog_sales, date_dim, customer        where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk          and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk          and d_month_seq between 1191 and 1191+11)        except       (select distinct c_last_name, c_first_name, d_date        from web_sales, date_dim, customer        where web_sales.ws_sold_date_sk = date_dim.d_date_sk          and web_sales.ws_bill_customer_sk = customer.c_customer_sk          and d_month_seq between 1191 and 1191+11) ) cool_cust;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk"], "customer": ["c_first_name", "c_last_name", "c_customer_sk"], "date_dim": ["d_date_sk", "d_date"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk"], "web_sales": ["ws_sold_date_sk", "ws_bill_customer_sk"]}, "group_by": {}, "order_by": {}}
{"id": 88, "query_string": " select  * from  (select count(*) h8_30_to_9  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk         and ss_hdemo_sk = household_demographics.hd_demo_sk       and ss_store_sk = s_store_sk      and time_dim.t_hour = 8      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2))       and store.s_store_name = 'ese') s1,  (select count(*) h9_to_9_30   from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk       and time_dim.t_hour = 9       and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2))      and store.s_store_name = 'ese') s2,  (select count(*) h9_30_to_10   from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 9      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2))      and store.s_store_name = 'ese') s3,  (select count(*) h10_to_10_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 10       and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2))      and store.s_store_name = 'ese') s4,  (select count(*) h10_30_to_11  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 10       and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2))      and store.s_store_name = 'ese') s5,  (select count(*) h11_to_11_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk       and time_dim.t_hour = 11      and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2))      and store.s_store_name = 'ese') s6,  (select count(*) h11_30_to_12  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 11      and time_dim.t_minute >= 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2))      and store.s_store_name = 'ese') s7,  (select count(*) h12_to_12_30  from store_sales, household_demographics , time_dim, store  where ss_sold_time_sk = time_dim.t_time_sk      and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk      and time_dim.t_hour = 12      and time_dim.t_minute < 30      and ((household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2) or           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or           (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2))      and store.s_store_name = 'ese') s8;", "predicates": {"household_demographics": ["hd_dep_count", "hd_vehicle_count"], "store": ["s_store_name"], "time_dim": ["t_hour", "t_minute"]}, "payload": {"household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_sold_time_sk"], "time_dim": ["t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 89, "query_string": " select top (100) * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (1999) and         ((i_category in ('Children','Electronics','Music') and           i_class in ('newborn','stereo','country')          )       or (i_category in ('Women','Sports','Shoes') and           i_class in ('maternity','tennis','kids')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name;", "predicates": {"date_dim": ["d_year"], "item": ["i_class", "i_category"]}, "payload": {"date_dim": ["d_date_sk", "d_moy"], "item": ["i_brand", "i_class", "i_item_sk", "i_category"], "store": ["s_store_name", "s_store_sk", "s_company_name"]}, "group_by": {}, "order_by": {"store": ["s_store_name"]}}
{"id": 90, "query_string": " select top (100) cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio  from ( select count(*) amc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 12 and 12+1          and household_demographics.hd_dep_count = 3          and web_page.wp_char_count between 5000 and 5200) at,       ( select count(*) pmc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 13 and 13+1          and household_demographics.hd_dep_count = 3          and web_page.wp_char_count between 5000 and 5200) pt  order by am_pm_ratio  ;", "predicates": {"household_demographics": ["hd_dep_count"], "time_dim": ["t_hour"], "web_page": ["wp_char_count"]}, "payload": {"household_demographics": ["hd_demo_sk"], "time_dim": ["t_time_sk"], "web_page": ["wp_web_page_sk"], "web_sales": ["ws_sold_time_sk", "ws_web_page_sk", "ws_ship_hdemo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 91, "query_string": " select           cc_call_center_id Call_Center,         cc_name Call_Center_Name,         cc_manager Manager,         sum(cr_net_loss) Returns_Loss from         call_center,         catalog_returns,         date_dim,         customer,         customer_address,         customer_demographics,         household_demographics where         cr_call_center_sk       = cc_call_center_sk and     cr_returned_date_sk     = d_date_sk and     cr_returning_customer_sk= c_customer_sk and     cd_demo_sk              = c_current_cdemo_sk and     hd_demo_sk              = c_current_hdemo_sk and     ca_address_sk           = c_current_addr_sk and     d_year                  = 1999  and     d_moy                   = 12 and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')         or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree')) and     hd_buy_potential like '>10000%' and     ca_gmt_offset           = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc;", "predicates": {"customer_address": ["ca_gmt_offset"], "customer_demographics": ["cd_education_status", "cd_marital_status"], "date_dim": ["d_moy", "d_year"], "household_demographics": ["hd_buy_potential"]}, "payload": {"call_center": ["cc_name", "cc_call_center_id", "cc_manager", "cc_call_center_sk"], "catalog_returns": ["cr_returned_date_sk", "cr_net_loss", "cr_returning_customer_sk", "cr_call_center_sk"], "customer": ["c_current_cdemo_sk", "c_current_addr_sk", "c_customer_sk", "c_current_hdemo_sk"], "date_dim": ["d_date_sk"], "household_demographics": ["hd_demo_sk"]}, "group_by": {}, "order_by": {}}
{"id": 92, "query_string": " select top (100)     sum(ws_ext_discount_amt)  as \"Excess Discount Amount\"  from      web_sales     ,item     ,date_dim where i_manufact_id = 344 and i_item_sk = ws_item_sk  and d_date between '2001-03-14' and          dateadd(day, 90, cast('2001-03-14' as date)) and d_date_sk = ws_sold_date_sk  and ws_ext_discount_amt        > (           SELECT              1.3 * avg(ws_ext_discount_amt)           FROM              web_sales             ,date_dim          WHERE                ws_item_sk = i_item_sk            and d_date between '2001-03-14' and                              dateadd(day, 90, cast('2001-03-14' as date))           and d_date_sk = ws_sold_date_sk        )  order by sum(ws_ext_discount_amt);", "predicates": {"date_dim": ["d_date"], "item": ["i_manufact_id"], "web_sales": ["ws_ext_discount_amt"]}, "payload": {"item": ["i_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 93, "query_string": " select top (100) ss_customer_sk             ,sum(act_sales) sumsales       from (select ss_item_sk                   ,ss_ticket_number                   ,ss_customer_sk                   ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price                                                             else (ss_quantity*ss_sales_price) end act_sales             from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk                                                                and sr_ticket_number = ss_ticket_number)                 ,reason             where sr_reason_sk = r_reason_sk               and r_reason_desc = 'reason 23') t       group by ss_customer_sk       order by sumsales, ss_customer_sk;", "predicates": {"reason": ["r_reason_desc"]}, "payload": {"reason": ["r_reason_sk"], "store_returns": ["sr_reason_sk", "sr_return_quantity", "sr_item_sk", "sr_ticket_number"]}, "group_by": {}, "order_by": {"store_sales": ["ss_customer_sk"]}}
{"id": 94, "query_string": " select top (100)     count(distinct ws_order_number) as \"order count\"   ,sum(ws_ext_ship_cost) as \"total shipping cost\"   ,sum(ws_net_profit) as \"total net profit\" from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2002-3-01' and             dateadd(day, 60, cast('2002-3-01' as date)) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'VA' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number);", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_date"], "web_site": ["web_company_name"]}, "payload": {"customer_address": ["ca_address_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_net_profit", "ws_ship_date_sk", "ws_ship_addr_sk", "ws_ext_ship_cost", "ws_warehouse_sk", "ws_order_number", "ws_web_site_sk"], "web_site": ["web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 95, "query_string": " with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select top (100)     count(distinct ws_order_number) as \"order count\"   ,sum(ws_ext_ship_cost) as \"total shipping cost\"   ,sum(ws_net_profit) as \"total net profit\" from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2002-3-01' and             dateadd(day, 60, cast('2002-3-01' as date)) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'VA' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number);", "predicates": {"customer_address": ["ca_state"], "date_dim": ["d_date"], "web_site": ["web_company_name"]}, "payload": {"customer_address": ["ca_address_sk"], "date_dim": ["d_date_sk"], "web_returns": ["wr_order_number"], "web_sales": ["ws_net_profit", "ws_ship_date_sk", "ws_item_sk", "ws_ship_addr_sk", "ws_ext_ship_cost", "ws_warehouse_sk", "ws_order_number", "ws_web_site_sk"], "web_site": ["web_site_sk"]}, "group_by": {}, "order_by": {}}
{"id": 96, "query_string": " select top (100) count(*)  from store_sales     ,household_demographics      ,time_dim, store where ss_sold_time_sk = time_dim.t_time_sk        and ss_hdemo_sk = household_demographics.hd_demo_sk      and ss_store_sk = s_store_sk     and time_dim.t_hour = 16     and time_dim.t_minute >= 30     and household_demographics.hd_dep_count = 6     and store.s_store_name = 'ese' order by count(*);", "predicates": {"household_demographics": ["hd_dep_count"], "store": ["s_store_name"], "time_dim": ["t_hour", "t_minute"]}, "payload": {"household_demographics": ["hd_demo_sk"], "store": ["s_store_sk"], "store_sales": ["ss_store_sk", "ss_hdemo_sk", "ss_sold_time_sk"], "time_dim": ["t_time_sk"]}, "group_by": {}, "order_by": {}}
{"id": 97, "query_string": " with ssci as ( select ss_customer_sk customer_sk       ,ss_item_sk item_sk from store_sales,date_dim where ss_sold_date_sk = d_date_sk   and d_month_seq between 1191 and 1191 + 11 group by ss_customer_sk         ,ss_item_sk), csci as(  select cs_bill_customer_sk customer_sk       ,cs_item_sk item_sk from catalog_sales,date_dim where cs_sold_date_sk = d_date_sk   and d_month_seq between 1191 and 1191 + 11 group by cs_bill_customer_sk         ,cs_item_sk)  select top (100) sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only       ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only       ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk                                and ssci.item_sk = csci.item_sk);", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"catalog_sales": ["cs_sold_date_sk", "cs_bill_customer_sk", "cs_item_sk"], "date_dim": ["d_date_sk"], "store_sales": ["ss_sold_date_sk", "ss_customer_sk", "ss_item_sk"]}, "group_by": {}, "order_by": {}}
{"id": 98, "query_string": " select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from\t \tstore_sales     \t,item      \t,date_dim where  \tss_item_sk = i_item_sk    \tand i_category in ('Home', 'Electronics', 'Jewelry')   \tand ss_sold_date_sk = d_date_sk \tand d_date between cast('2000-06-11' as date)  \t\t\t\tand dateadd(day, 30, cast('2000-06-11' as date)) group by  \ti_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  \ti_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;", "predicates": {"date_dim": ["d_date"], "item": ["i_category"]}, "payload": {"date_dim": ["d_date_sk"], "item": ["i_item_sk", "i_current_price", "i_item_id", "i_item_desc", "i_category", "i_class"]}, "group_by": {}, "order_by": {}}
{"id": 99, "query_string": " select top (100)     substring(w_warehouse_name,1,20)   ,sm_type   ,cc_name   ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and                   (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and                   (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and                  (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"    ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"  from    catalog_sales   ,warehouse   ,ship_mode   ,call_center   ,date_dim where     d_month_seq between 1191 and 1191 + 11 and cs_ship_date_sk   = d_date_sk and cs_warehouse_sk   = w_warehouse_sk and cs_ship_mode_sk   = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by    substring(w_warehouse_name,1,20)   ,sm_type   ,cc_name order by substring(w_warehouse_name,1,20)         ,sm_type         ,cc_name;", "predicates": {"date_dim": ["d_month_seq"]}, "payload": {"call_center": ["cc_name", "cc_call_center_sk"], "catalog_sales": ["cs_warehouse_sk", "cs_call_center_sk", "cs_ship_date_sk", "cs_ship_mode_sk", "cs_sold_date_sk"], "date_dim": ["d_date_sk"], "ship_mode": ["sm_type", "sm_ship_mode_sk"], "warehouse": ["w_warehouse_name", "w_warehouse_sk"]}, "group_by": {}, "order_by": {}}